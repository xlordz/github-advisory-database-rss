{
    "version": "https://jsonfeed.org/version/1",
    "title": "Security Advisory for .NET packages hosted at the NuGet Gallery",
    "home_page_url": "https://github.com/advisories?query=type%3Areviewed+ecosystem%3Anuget",
    "feed_url": "https://azu.github.io/github-advisory-database-rss/nuget.json",
    "description": "Security Advisory for .NET packages hosted at the NuGet Gallery on GitHub",
    "items": [
        {
            "content_html": "<h3 id=\"impact\">Impact</h3>\n<p><em>What kind of vulnerability is it? Who is impacted?</em></p>\n<p>A vulnerability in <code>OpenTelemetry.Api</code> package <code>1.10.0</code> to <code>1.11.1</code> could cause a <a href=\"https://github.com/open-telemetry/opentelemetry-dotnet/security/advisories/GHSA-8785-wc3w-h8q6\">Denial of Service (DoS) when a tracestate and traceparent header is received</a>. These versions are used in OpenTelemetry .NET Automatic Instrumentation <code>1.10.0-beta.1</code> and <code>1.10.0</code>.</p>\n<p>Even if an application does not explicitly use trace context propagation, receiving these headers can still trigger high CPU usage.\nThis issue impacts any application accessible over the web or backend services that process HTTP requests containing a tracestate header.\nApplication may experience excessive resource consumption, leading to increased latency, degraded performance, or downtime.</p>\n<h3 id=\"patches\">Patches</h3>\n<p><em>Has the problem been patched? What versions should users upgrade to?</em></p>\n<p>This issue has been resolved in <code>OpenTelemetry.Api</code> <code>1.11.2</code> by reverting the change that introduced the problematic behavior in versions <code>1.10.0</code> to <code>1.11.1</code>. OpenTelemetry .NET Automatic Instrumentation fixes it in <code>1.11.0</code> release.</p>\n<h2 id=\"fixed-version\">Fixed version</h2>\n<table>\n<thead>\n<tr>\n<th>OpenTelemetry .NET Automatic Instrumentation</th>\n<th>Status</th>\n</tr>\n</thead>\n<tbody><tr>\n<td>&lt;= 1.9.0</td>\n<td>✅ Not affected</td>\n</tr>\n<tr>\n<td>1.10.0-beta.1, 1.10.0</td>\n<td>❌ Vulnerable</td>\n</tr>\n<tr>\n<td>1.11.0 (Fixed)</td>\n<td>✅ Safe to use</td>\n</tr>\n</tbody></table>\n<h3 id=\"workarounds\">Workarounds</h3>\n<p><em>Is there a way for users to fix or remediate the vulnerability without upgrading?</em></p>\n<h3 id=\"references\">References</h3>\n<p><em>Are there any links users can visit to find out more?</em></p>\n<h3 id=\"references-1\">References</h3>\n<ul>\n<li><a href=\"https://github.com/open-telemetry/opentelemetry-dotnet-instrumentation/security/advisories/GHSA-vc29-vg52-6643\">https://github.com/open-telemetry/opentelemetry-dotnet-instrumentation/security/advisories/GHSA-vc29-vg52-6643</a></li>\n<li><a href=\"https://github.com/open-telemetry/opentelemetry-dotnet/security/advisories/GHSA-8785-wc3w-h8q6\">https://github.com/open-telemetry/opentelemetry-dotnet/security/advisories/GHSA-8785-wc3w-h8q6</a></li>\n<li><a href=\"https://nvd.nist.gov/vuln/detail/CVE-2025-27513\">https://nvd.nist.gov/vuln/detail/CVE-2025-27513</a></li>\n<li><a href=\"https://github.com/advisories/GHSA-vc29-vg52-6643\">https://github.com/advisories/GHSA-vc29-vg52-6643</a></li>\n</ul>\n",
            "url": "https://github.com/advisories/GHSA-vc29-vg52-6643",
            "title": "[OpenTelemetry.AutoInstrumentation] DoS Vulnerability in TraceContextPropagator.Extract - OpenTelemetry.Api",
            "date_modified": "2025-03-06T22:33:44.000Z",
            "date_published": "2025-03-06T22:33:43.000Z",
            "author": {
                "name": "GitHub",
                "url": "https://github.com/advisories/GHSA-vc29-vg52-6643"
            },
            "tags": [
                "severity"
            ]
        },
        {
            "content_html": "<h3 id=\"impact\">Impact</h3>\n<p>An Out-of-bounds Write vulnerability has been found in the ImageSharp gif decoder, allowing attackers to cause a crash using a specially crafted gif. This can potentially lead to denial of service.</p>\n<h3 id=\"patches\">Patches</h3>\n<p>The problem has been patched. All users are advised to upgrade to v3.1.7 or v2.1.10.</p>\n<h3 id=\"workarounds\">Workarounds</h3>\n<p>None.</p>\n<h3 id=\"references\">References</h3>\n<p><a href=\"https://github.com/SixLabors/ImageSharp/issues/2859\">https://github.com/SixLabors/ImageSharp/issues/2859</a>\n<a href=\"https://github.com/SixLabors/ImageSharp/issues/2890\">https://github.com/SixLabors/ImageSharp/issues/2890</a></p>\n<h3 id=\"references-1\">References</h3>\n<ul>\n<li><a href=\"https://github.com/SixLabors/ImageSharp/security/advisories/GHSA-2cmq-823j-5qj8\">https://github.com/SixLabors/ImageSharp/security/advisories/GHSA-2cmq-823j-5qj8</a></li>\n<li><a href=\"https://github.com/SixLabors/ImageSharp/issues/2859\">https://github.com/SixLabors/ImageSharp/issues/2859</a></li>\n<li><a href=\"https://github.com/SixLabors/ImageSharp/pull/2890\">https://github.com/SixLabors/ImageSharp/pull/2890</a></li>\n<li><a href=\"https://nvd.nist.gov/vuln/detail/CVE-2025-27598\">https://nvd.nist.gov/vuln/detail/CVE-2025-27598</a></li>\n<li><a href=\"https://github.com/advisories/GHSA-2cmq-823j-5qj8\">https://github.com/advisories/GHSA-2cmq-823j-5qj8</a></li>\n</ul>\n",
            "url": "https://github.com/advisories/GHSA-2cmq-823j-5qj8",
            "title": "[SixLabors.ImageSharp] Out-of-bounds Write in SixLabors ImageSharp",
            "date_modified": "2025-03-07T13:45:23.000Z",
            "date_published": "2025-03-06T22:23:48.000Z",
            "author": {
                "name": "GitHub",
                "url": "https://github.com/advisories/GHSA-2cmq-823j-5qj8"
            },
            "tags": [
                "severity"
            ]
        },
        {
            "content_html": "<h3 id=\"impact\">Impact</h3>\n<p>An Out-of-bounds Write vulnerability has been found in the ImageSharp gif decoder, allowing attackers to cause a crash using a specially crafted gif. This can potentially lead to denial of service.</p>\n<h3 id=\"patches\">Patches</h3>\n<p>The problem has been patched. All users are advised to upgrade to v3.1.7 or v2.1.10.</p>\n<h3 id=\"workarounds\">Workarounds</h3>\n<p>None.</p>\n<h3 id=\"references\">References</h3>\n<p><a href=\"https://github.com/SixLabors/ImageSharp/issues/2859\">https://github.com/SixLabors/ImageSharp/issues/2859</a>\n<a href=\"https://github.com/SixLabors/ImageSharp/issues/2890\">https://github.com/SixLabors/ImageSharp/issues/2890</a></p>\n<h3 id=\"references-1\">References</h3>\n<ul>\n<li><a href=\"https://github.com/SixLabors/ImageSharp/security/advisories/GHSA-2cmq-823j-5qj8\">https://github.com/SixLabors/ImageSharp/security/advisories/GHSA-2cmq-823j-5qj8</a></li>\n<li><a href=\"https://github.com/SixLabors/ImageSharp/issues/2859\">https://github.com/SixLabors/ImageSharp/issues/2859</a></li>\n<li><a href=\"https://github.com/SixLabors/ImageSharp/pull/2890\">https://github.com/SixLabors/ImageSharp/pull/2890</a></li>\n<li><a href=\"https://nvd.nist.gov/vuln/detail/CVE-2025-27598\">https://nvd.nist.gov/vuln/detail/CVE-2025-27598</a></li>\n<li><a href=\"https://github.com/advisories/GHSA-2cmq-823j-5qj8\">https://github.com/advisories/GHSA-2cmq-823j-5qj8</a></li>\n</ul>\n",
            "url": "https://github.com/advisories/GHSA-2cmq-823j-5qj8",
            "title": "[SixLabors.ImageSharp] Out-of-bounds Write in SixLabors ImageSharp",
            "date_modified": "2025-03-07T13:45:23.000Z",
            "date_published": "2025-03-06T22:23:48.000Z",
            "author": {
                "name": "GitHub",
                "url": "https://github.com/advisories/GHSA-2cmq-823j-5qj8"
            },
            "tags": [
                "severity"
            ]
        },
        {
            "content_html": "<h3 id=\"impact\">Impact</h3>\n<p><em>What kind of vulnerability is it? Who is impacted?</em></p>\n<p>A vulnerability in <code>OpenTelemetry.Api</code> package <code>1.10.0</code> to <code>1.11.1</code> could cause a Denial of Service (DoS) when a <code>tracestate</code> and <code>traceparent</code> header is received.</p>\n<ul>\n<li>Even if an application does not explicitly use trace context propagation, receiving these headers can still trigger high CPU usage.</li>\n<li>This issue impacts any application accessible over the web or backend services that process HTTP requests containing a <code>tracestate</code> header.</li>\n<li>Application may experience excessive resource consumption, leading to increased latency, degraded performance, or downtime.</li>\n</ul>\n<h3 id=\"patches\">Patches</h3>\n<p><em>Has the problem been patched? What versions should users upgrade to?</em></p>\n<p>This issue has been <strong data-end=\"1184\" data-start=\"1143\">resolved in OpenTelemetry.Api 1.11.2</strong> by <strong data-end=\"1212\" data-start=\"1188\">reverting the change</strong> that introduced the problematic behavior in versions <strong data-end=\"1286\" data-start=\"1266\">1.10.0 to 1.11.1</strong>.</p><li data-end=\"1409\" data-start=\"1290\">The fix ensures that <strong data-end=\"1380\" data-start=\"1313\">valid tracing headers no longer cause excessive CPU consumption</strong> when received in requests.</li><h4 data-end=\"1434\" data-start=\"1411\"><strong data-end=\"1434\" data-start=\"1416\">Fixed Version:</strong></h4><p></p>\n<table>\n<thead>\n<tr>\n<th>OpenTelemetry .NET Version</th>\n<th>Status</th>\n</tr>\n</thead>\n<tbody><tr>\n<td>&lt;= 1.9.x</td>\n<td>✅ Not affected</td>\n</tr>\n<tr>\n<td>1.10.0 - 1.11.1</td>\n<td>❌ Vulnerable</td>\n</tr>\n<tr>\n<td>1.11.2 (Fixed)</td>\n<td>✅ Safe to use</td>\n</tr>\n</tbody></table>\n<p><strong>Upgrade Command:</strong></p>\n<pre><code>dotnet add package OpenTelemetry --version 1.11.2\n</code></pre>\n<p><strong>Delisting of Affected Packages</strong>\nTo prevent accidental usage, we have delisted the affected versions (1.10.0 to 1.11.1) from NuGet. Users should avoid these versions and upgrade to 1.11.2 immediately.</p>\n<h3 id=\"workarounds\">Workarounds</h3>\n<p><em>Is there a way for users to fix or remediate the vulnerability without upgrading?</em></p>\n<h3 id=\"references\">References</h3>\n<p><em>Are there any links users can visit to find out more?</em></p>\n<h3 id=\"references-1\">References</h3>\n<ul>\n<li><a href=\"https://github.com/open-telemetry/opentelemetry-dotnet/security/advisories/GHSA-8785-wc3w-h8q6\">https://github.com/open-telemetry/opentelemetry-dotnet/security/advisories/GHSA-8785-wc3w-h8q6</a></li>\n<li><a href=\"https://github.com/open-telemetry/opentelemetry-dotnet/pull/6161\">https://github.com/open-telemetry/opentelemetry-dotnet/pull/6161</a></li>\n<li><a href=\"https://nvd.nist.gov/vuln/detail/CVE-2025-27513\">https://nvd.nist.gov/vuln/detail/CVE-2025-27513</a></li>\n<li><a href=\"https://github.com/open-telemetry/opentelemetry-dotnet/commit/1b555c1201413f2f55f2cd3c4ba03ef4b615b6b5\">https://github.com/open-telemetry/opentelemetry-dotnet/commit/1b555c1201413f2f55f2cd3c4ba03ef4b615b6b5</a></li>\n<li><a href=\"https://github.com/advisories/GHSA-8785-wc3w-h8q6\">https://github.com/advisories/GHSA-8785-wc3w-h8q6</a></li>\n</ul>\n",
            "url": "https://github.com/advisories/GHSA-8785-wc3w-h8q6",
            "title": "[OpenTelemetry.Api] OpenTelemetry .NET has Denial of Service (DoS) Vulnerability in API Package",
            "date_modified": "2025-03-05T21:54:15.000Z",
            "date_published": "2025-03-05T18:15:22.000Z",
            "author": {
                "name": "GitHub",
                "url": "https://github.com/advisories/GHSA-8785-wc3w-h8q6"
            },
            "tags": [
                "severity"
            ]
        },
        {
            "content_html": "<h3 id=\"impact\">Impact</h3>\n<p><em>What kind of vulnerability is it? Who is impacted?</em></p>\n<p>A vulnerability in <code>OpenTelemetry.Api</code> package <code>1.10.0</code> to <code>1.11.1</code> could cause a Denial of Service (DoS) when a <code>tracestate</code> and <code>traceparent</code> header is received.</p>\n<ul>\n<li>Even if an application does not explicitly use trace context propagation, receiving these headers can still trigger high CPU usage.</li>\n<li>This issue impacts any application accessible over the web or backend services that process HTTP requests containing a <code>tracestate</code> header.</li>\n<li>Application may experience excessive resource consumption, leading to increased latency, degraded performance, or downtime.</li>\n</ul>\n<h3 id=\"patches\">Patches</h3>\n<p><em>Has the problem been patched? What versions should users upgrade to?</em></p>\n<p>This issue has been <strong data-end=\"1184\" data-start=\"1143\">resolved in OpenTelemetry.Api 1.11.2</strong> by <strong data-end=\"1212\" data-start=\"1188\">reverting the change</strong> that introduced the problematic behavior in versions <strong data-end=\"1286\" data-start=\"1266\">1.10.0 to 1.11.1</strong>.</p><li data-end=\"1409\" data-start=\"1290\">The fix ensures that <strong data-end=\"1380\" data-start=\"1313\">valid tracing headers no longer cause excessive CPU consumption</strong> when received in requests.</li><h4 data-end=\"1434\" data-start=\"1411\"><strong data-end=\"1434\" data-start=\"1416\">Fixed Version:</strong></h4><p></p>\n<table>\n<thead>\n<tr>\n<th>OpenTelemetry .NET Version</th>\n<th>Status</th>\n</tr>\n</thead>\n<tbody><tr>\n<td>&lt;= 1.9.x</td>\n<td>✅ Not affected</td>\n</tr>\n<tr>\n<td>1.10.0 - 1.11.1</td>\n<td>❌ Vulnerable</td>\n</tr>\n<tr>\n<td>1.11.2 (Fixed)</td>\n<td>✅ Safe to use</td>\n</tr>\n</tbody></table>\n<p><strong>Upgrade Command:</strong></p>\n<pre><code>dotnet add package OpenTelemetry --version 1.11.2\n</code></pre>\n<p><strong>Delisting of Affected Packages</strong>\nTo prevent accidental usage, we have delisted the affected versions (1.10.0 to 1.11.1) from NuGet. Users should avoid these versions and upgrade to 1.11.2 immediately.</p>\n<h3 id=\"workarounds\">Workarounds</h3>\n<p><em>Is there a way for users to fix or remediate the vulnerability without upgrading?</em></p>\n<h3 id=\"references\">References</h3>\n<p><em>Are there any links users can visit to find out more?</em></p>\n<h3 id=\"references-1\">References</h3>\n<ul>\n<li><a href=\"https://github.com/open-telemetry/opentelemetry-dotnet/security/advisories/GHSA-8785-wc3w-h8q6\">https://github.com/open-telemetry/opentelemetry-dotnet/security/advisories/GHSA-8785-wc3w-h8q6</a></li>\n<li><a href=\"https://github.com/open-telemetry/opentelemetry-dotnet/pull/6161\">https://github.com/open-telemetry/opentelemetry-dotnet/pull/6161</a></li>\n<li><a href=\"https://nvd.nist.gov/vuln/detail/CVE-2025-27513\">https://nvd.nist.gov/vuln/detail/CVE-2025-27513</a></li>\n<li><a href=\"https://github.com/open-telemetry/opentelemetry-dotnet/commit/1b555c1201413f2f55f2cd3c4ba03ef4b615b6b5\">https://github.com/open-telemetry/opentelemetry-dotnet/commit/1b555c1201413f2f55f2cd3c4ba03ef4b615b6b5</a></li>\n<li><a href=\"https://github.com/advisories/GHSA-8785-wc3w-h8q6\">https://github.com/advisories/GHSA-8785-wc3w-h8q6</a></li>\n</ul>\n",
            "url": "https://github.com/advisories/GHSA-8785-wc3w-h8q6",
            "title": "[OpenTelemetry.Api] OpenTelemetry .NET has Denial of Service (DoS) Vulnerability in API Package",
            "date_modified": "2025-03-05T21:54:15.000Z",
            "date_published": "2025-03-05T18:15:22.000Z",
            "author": {
                "name": "GitHub",
                "url": "https://github.com/advisories/GHSA-8785-wc3w-h8q6"
            },
            "tags": [
                "severity"
            ]
        },
        {
            "content_html": "<h3 id=\"impact\">Impact</h3>\n<p><em>What kind of vulnerability is it? Who is impacted?</em></p>\n<p>A vulnerability in <code>OpenTelemetry.Api</code> package <code>1.10.0</code> to <code>1.11.1</code> could cause a Denial of Service (DoS) when a <code>tracestate</code> and <code>traceparent</code> header is received.</p>\n<ul>\n<li>Even if an application does not explicitly use trace context propagation, receiving these headers can still trigger high CPU usage.</li>\n<li>This issue impacts any application accessible over the web or backend services that process HTTP requests containing a <code>tracestate</code> header.</li>\n<li>Application may experience excessive resource consumption, leading to increased latency, degraded performance, or downtime.</li>\n</ul>\n<h3 id=\"patches\">Patches</h3>\n<p><em>Has the problem been patched? What versions should users upgrade to?</em></p>\n<p>This issue has been <strong data-end=\"1184\" data-start=\"1143\">resolved in OpenTelemetry.Api 1.11.2</strong> by <strong data-end=\"1212\" data-start=\"1188\">reverting the change</strong> that introduced the problematic behavior in versions <strong data-end=\"1286\" data-start=\"1266\">1.10.0 to 1.11.1</strong>.</p><li data-end=\"1409\" data-start=\"1290\">The fix ensures that <strong data-end=\"1380\" data-start=\"1313\">valid tracing headers no longer cause excessive CPU consumption</strong> when received in requests.</li><h4 data-end=\"1434\" data-start=\"1411\"><strong data-end=\"1434\" data-start=\"1416\">Fixed Version:</strong></h4><p></p>\n<table>\n<thead>\n<tr>\n<th>OpenTelemetry .NET Version</th>\n<th>Status</th>\n</tr>\n</thead>\n<tbody><tr>\n<td>&lt;= 1.9.x</td>\n<td>✅ Not affected</td>\n</tr>\n<tr>\n<td>1.10.0 - 1.11.1</td>\n<td>❌ Vulnerable</td>\n</tr>\n<tr>\n<td>1.11.2 (Fixed)</td>\n<td>✅ Safe to use</td>\n</tr>\n</tbody></table>\n<p><strong>Upgrade Command:</strong></p>\n<pre><code>dotnet add package OpenTelemetry --version 1.11.2\n</code></pre>\n<p><strong>Delisting of Affected Packages</strong>\nTo prevent accidental usage, we have delisted the affected versions (1.10.0 to 1.11.1) from NuGet. Users should avoid these versions and upgrade to 1.11.2 immediately.</p>\n<h3 id=\"workarounds\">Workarounds</h3>\n<p><em>Is there a way for users to fix or remediate the vulnerability without upgrading?</em></p>\n<h3 id=\"references\">References</h3>\n<p><em>Are there any links users can visit to find out more?</em></p>\n<h3 id=\"references-1\">References</h3>\n<ul>\n<li><a href=\"https://github.com/open-telemetry/opentelemetry-dotnet/security/advisories/GHSA-8785-wc3w-h8q6\">https://github.com/open-telemetry/opentelemetry-dotnet/security/advisories/GHSA-8785-wc3w-h8q6</a></li>\n<li><a href=\"https://github.com/open-telemetry/opentelemetry-dotnet/pull/6161\">https://github.com/open-telemetry/opentelemetry-dotnet/pull/6161</a></li>\n<li><a href=\"https://nvd.nist.gov/vuln/detail/CVE-2025-27513\">https://nvd.nist.gov/vuln/detail/CVE-2025-27513</a></li>\n<li><a href=\"https://github.com/open-telemetry/opentelemetry-dotnet/commit/1b555c1201413f2f55f2cd3c4ba03ef4b615b6b5\">https://github.com/open-telemetry/opentelemetry-dotnet/commit/1b555c1201413f2f55f2cd3c4ba03ef4b615b6b5</a></li>\n<li><a href=\"https://github.com/advisories/GHSA-8785-wc3w-h8q6\">https://github.com/advisories/GHSA-8785-wc3w-h8q6</a></li>\n</ul>\n",
            "url": "https://github.com/advisories/GHSA-8785-wc3w-h8q6",
            "title": "[OpenTelemetry.Api] OpenTelemetry .NET has Denial of Service (DoS) Vulnerability in API Package",
            "date_modified": "2025-03-05T21:54:15.000Z",
            "date_published": "2025-03-05T18:15:22.000Z",
            "author": {
                "name": "GitHub",
                "url": "https://github.com/advisories/GHSA-8785-wc3w-h8q6"
            },
            "tags": [
                "severity"
            ]
        },
        {
            "content_html": "<h3 id=\"impact\">Impact</h3>\n<p><em>What kind of vulnerability is it? Who is impacted?</em></p>\n<p>A vulnerability in <code>OpenTelemetry.Api</code> package <code>1.10.0</code> to <code>1.11.1</code> could cause a Denial of Service (DoS) when a <code>tracestate</code> and <code>traceparent</code> header is received.</p>\n<ul>\n<li>Even if an application does not explicitly use trace context propagation, receiving these headers can still trigger high CPU usage.</li>\n<li>This issue impacts any application accessible over the web or backend services that process HTTP requests containing a <code>tracestate</code> header.</li>\n<li>Application may experience excessive resource consumption, leading to increased latency, degraded performance, or downtime.</li>\n</ul>\n<h3 id=\"patches\">Patches</h3>\n<p><em>Has the problem been patched? What versions should users upgrade to?</em></p>\n<p>This issue has been <strong data-end=\"1184\" data-start=\"1143\">resolved in OpenTelemetry.Api 1.11.2</strong> by <strong data-end=\"1212\" data-start=\"1188\">reverting the change</strong> that introduced the problematic behavior in versions <strong data-end=\"1286\" data-start=\"1266\">1.10.0 to 1.11.1</strong>.</p><li data-end=\"1409\" data-start=\"1290\">The fix ensures that <strong data-end=\"1380\" data-start=\"1313\">valid tracing headers no longer cause excessive CPU consumption</strong> when received in requests.</li><h4 data-end=\"1434\" data-start=\"1411\"><strong data-end=\"1434\" data-start=\"1416\">Fixed Version:</strong></h4><p></p>\n<table>\n<thead>\n<tr>\n<th>OpenTelemetry .NET Version</th>\n<th>Status</th>\n</tr>\n</thead>\n<tbody><tr>\n<td>&lt;= 1.9.x</td>\n<td>✅ Not affected</td>\n</tr>\n<tr>\n<td>1.10.0 - 1.11.1</td>\n<td>❌ Vulnerable</td>\n</tr>\n<tr>\n<td>1.11.2 (Fixed)</td>\n<td>✅ Safe to use</td>\n</tr>\n</tbody></table>\n<p><strong>Upgrade Command:</strong></p>\n<pre><code>dotnet add package OpenTelemetry --version 1.11.2\n</code></pre>\n<p><strong>Delisting of Affected Packages</strong>\nTo prevent accidental usage, we have delisted the affected versions (1.10.0 to 1.11.1) from NuGet. Users should avoid these versions and upgrade to 1.11.2 immediately.</p>\n<h3 id=\"workarounds\">Workarounds</h3>\n<p><em>Is there a way for users to fix or remediate the vulnerability without upgrading?</em></p>\n<h3 id=\"references\">References</h3>\n<p><em>Are there any links users can visit to find out more?</em></p>\n<h3 id=\"references-1\">References</h3>\n<ul>\n<li><a href=\"https://github.com/open-telemetry/opentelemetry-dotnet/security/advisories/GHSA-8785-wc3w-h8q6\">https://github.com/open-telemetry/opentelemetry-dotnet/security/advisories/GHSA-8785-wc3w-h8q6</a></li>\n<li><a href=\"https://github.com/open-telemetry/opentelemetry-dotnet/pull/6161\">https://github.com/open-telemetry/opentelemetry-dotnet/pull/6161</a></li>\n<li><a href=\"https://nvd.nist.gov/vuln/detail/CVE-2025-27513\">https://nvd.nist.gov/vuln/detail/CVE-2025-27513</a></li>\n<li><a href=\"https://github.com/open-telemetry/opentelemetry-dotnet/commit/1b555c1201413f2f55f2cd3c4ba03ef4b615b6b5\">https://github.com/open-telemetry/opentelemetry-dotnet/commit/1b555c1201413f2f55f2cd3c4ba03ef4b615b6b5</a></li>\n<li><a href=\"https://github.com/advisories/GHSA-8785-wc3w-h8q6\">https://github.com/advisories/GHSA-8785-wc3w-h8q6</a></li>\n</ul>\n",
            "url": "https://github.com/advisories/GHSA-8785-wc3w-h8q6",
            "title": "[OpenTelemetry.Api] OpenTelemetry .NET has Denial of Service (DoS) Vulnerability in API Package",
            "date_modified": "2025-03-05T21:54:15.000Z",
            "date_published": "2025-03-05T18:15:22.000Z",
            "author": {
                "name": "GitHub",
                "url": "https://github.com/advisories/GHSA-8785-wc3w-h8q6"
            },
            "tags": [
                "severity"
            ]
        },
        {
            "content_html": "<h3 id=\"impact\">Impact</h3>\n<p><em>What kind of vulnerability is it? Who is impacted?</em></p>\n<p>A vulnerability in <code>OpenTelemetry.Api</code> package <code>1.10.0</code> to <code>1.11.1</code> could cause a Denial of Service (DoS) when a <code>tracestate</code> and <code>traceparent</code> header is received.</p>\n<ul>\n<li>Even if an application does not explicitly use trace context propagation, receiving these headers can still trigger high CPU usage.</li>\n<li>This issue impacts any application accessible over the web or backend services that process HTTP requests containing a <code>tracestate</code> header.</li>\n<li>Application may experience excessive resource consumption, leading to increased latency, degraded performance, or downtime.</li>\n</ul>\n<h3 id=\"patches\">Patches</h3>\n<p><em>Has the problem been patched? What versions should users upgrade to?</em></p>\n<p>This issue has been <strong data-end=\"1184\" data-start=\"1143\">resolved in OpenTelemetry.Api 1.11.2</strong> by <strong data-end=\"1212\" data-start=\"1188\">reverting the change</strong> that introduced the problematic behavior in versions <strong data-end=\"1286\" data-start=\"1266\">1.10.0 to 1.11.1</strong>.</p><li data-end=\"1409\" data-start=\"1290\">The fix ensures that <strong data-end=\"1380\" data-start=\"1313\">valid tracing headers no longer cause excessive CPU consumption</strong> when received in requests.</li><h4 data-end=\"1434\" data-start=\"1411\"><strong data-end=\"1434\" data-start=\"1416\">Fixed Version:</strong></h4><p></p>\n<table>\n<thead>\n<tr>\n<th>OpenTelemetry .NET Version</th>\n<th>Status</th>\n</tr>\n</thead>\n<tbody><tr>\n<td>&lt;= 1.9.x</td>\n<td>✅ Not affected</td>\n</tr>\n<tr>\n<td>1.10.0 - 1.11.1</td>\n<td>❌ Vulnerable</td>\n</tr>\n<tr>\n<td>1.11.2 (Fixed)</td>\n<td>✅ Safe to use</td>\n</tr>\n</tbody></table>\n<p><strong>Upgrade Command:</strong></p>\n<pre><code>dotnet add package OpenTelemetry --version 1.11.2\n</code></pre>\n<p><strong>Delisting of Affected Packages</strong>\nTo prevent accidental usage, we have delisted the affected versions (1.10.0 to 1.11.1) from NuGet. Users should avoid these versions and upgrade to 1.11.2 immediately.</p>\n<h3 id=\"workarounds\">Workarounds</h3>\n<p><em>Is there a way for users to fix or remediate the vulnerability without upgrading?</em></p>\n<h3 id=\"references\">References</h3>\n<p><em>Are there any links users can visit to find out more?</em></p>\n<h3 id=\"references-1\">References</h3>\n<ul>\n<li><a href=\"https://github.com/open-telemetry/opentelemetry-dotnet/security/advisories/GHSA-8785-wc3w-h8q6\">https://github.com/open-telemetry/opentelemetry-dotnet/security/advisories/GHSA-8785-wc3w-h8q6</a></li>\n<li><a href=\"https://github.com/open-telemetry/opentelemetry-dotnet/pull/6161\">https://github.com/open-telemetry/opentelemetry-dotnet/pull/6161</a></li>\n<li><a href=\"https://nvd.nist.gov/vuln/detail/CVE-2025-27513\">https://nvd.nist.gov/vuln/detail/CVE-2025-27513</a></li>\n<li><a href=\"https://github.com/open-telemetry/opentelemetry-dotnet/commit/1b555c1201413f2f55f2cd3c4ba03ef4b615b6b5\">https://github.com/open-telemetry/opentelemetry-dotnet/commit/1b555c1201413f2f55f2cd3c4ba03ef4b615b6b5</a></li>\n<li><a href=\"https://github.com/advisories/GHSA-8785-wc3w-h8q6\">https://github.com/advisories/GHSA-8785-wc3w-h8q6</a></li>\n</ul>\n",
            "url": "https://github.com/advisories/GHSA-8785-wc3w-h8q6",
            "title": "[OpenTelemetry.Api] OpenTelemetry .NET has Denial of Service (DoS) Vulnerability in API Package",
            "date_modified": "2025-03-05T21:54:15.000Z",
            "date_published": "2025-03-05T18:15:22.000Z",
            "author": {
                "name": "GitHub",
                "url": "https://github.com/advisories/GHSA-8785-wc3w-h8q6"
            },
            "tags": [
                "severity"
            ]
        },
        {
            "content_html": "<p>This security update resolves a vulnerability in the OPC UA .NET Standard Stack that allows an unauthorized attacker to bypass application authentication when the deprecated Basic128Rsa15 security policy is enabled.</p>\n<p>Note that the Basic128Rsa15 is disabled by default so most users will not be affected. When this patch is applied the Server closes all channels using the Basic128Rsa15 if an attack is detected. This introduces a DoS before any compromise can occur which is preferable to a compromise. To prevent this failure, applications must stop using Basic128Rsa15.</p>\n<h3 id=\"references\">References</h3>\n<ul>\n<li><a href=\"https://github.com/OPCFoundation/UA-.NETStandard/security/advisories/GHSA-h958-fxgg-g7w3\">https://github.com/OPCFoundation/UA-.NETStandard/security/advisories/GHSA-h958-fxgg-g7w3</a></li>\n<li><a href=\"https://nvd.nist.gov/vuln/detail/CVE-2024-42512\">https://nvd.nist.gov/vuln/detail/CVE-2024-42512</a></li>\n<li><a href=\"https://files.opcfoundation.org/SecurityBulletins/OPC%20Foundation%20Security%20Bulletin%20CVE-2024-42512.pdf\">https://files.opcfoundation.org/SecurityBulletins/OPC%20Foundation%20Security%20Bulletin%20CVE-2024-42512.pdf</a></li>\n<li><a href=\"https://github.com/advisories/GHSA-h958-fxgg-g7w3\">https://github.com/advisories/GHSA-h958-fxgg-g7w3</a></li>\n</ul>\n",
            "url": "https://github.com/advisories/GHSA-h958-fxgg-g7w3",
            "title": "[OPCFoundation.NetStandard.Opc.Ua.Core] Security Update for the OPC UA .NET Standard Stack",
            "date_modified": "2025-03-03T20:11:01.000Z",
            "date_published": "2025-03-03T20:10:59.000Z",
            "author": {
                "name": "GitHub",
                "url": "https://github.com/advisories/GHSA-h958-fxgg-g7w3"
            },
            "tags": [
                "severity"
            ]
        },
        {
            "content_html": "<p>This security update resolves a vulnerability in the OPC UA .NET Standard Stack that allows an unauthorized attacker to bypass application authentication when using HTTPS endpoints.</p>\n<h3 id=\"references\">References</h3>\n<ul>\n<li><a href=\"https://github.com/OPCFoundation/UA-.NETStandard/security/advisories/GHSA-4rcc-7pg7-f57f\">https://github.com/OPCFoundation/UA-.NETStandard/security/advisories/GHSA-4rcc-7pg7-f57f</a></li>\n<li><a href=\"https://nvd.nist.gov/vuln/detail/CVE-2024-42513\">https://nvd.nist.gov/vuln/detail/CVE-2024-42513</a></li>\n<li><a href=\"https://files.opcfoundation.org/SecurityBulletins/OPC%20Foundation%20Security%20Bulletin%20CVE-2024-42513.pdf\">https://files.opcfoundation.org/SecurityBulletins/OPC%20Foundation%20Security%20Bulletin%20CVE-2024-42513.pdf</a></li>\n<li><a href=\"https://github.com/OPCFoundation/UA-.NETStandard/tree/1.5.374.158\">https://github.com/OPCFoundation/UA-.NETStandard/tree/1.5.374.158</a></li>\n<li><a href=\"https://github.com/advisories/GHSA-4rcc-7pg7-f57f\">https://github.com/advisories/GHSA-4rcc-7pg7-f57f</a></li>\n</ul>\n",
            "url": "https://github.com/advisories/GHSA-4rcc-7pg7-f57f",
            "title": "[OPCFoundation.NetStandard.Opc.Ua.Bindings.Https] Security Update for the OPC UA .NET Standard Stack",
            "date_modified": "2025-03-03T20:09:57.000Z",
            "date_published": "2025-03-03T20:09:54.000Z",
            "author": {
                "name": "GitHub",
                "url": "https://github.com/advisories/GHSA-4rcc-7pg7-f57f"
            },
            "tags": [
                "severity"
            ]
        },
        {
            "content_html": "<p>An issue in trenoncourt AutoQueryable v.1.7.0 allows a remote attacker to obtain sensitive information via the Unselectable function.</p>\n<h3 id=\"references\">References</h3>\n<ul>\n<li><a href=\"https://nvd.nist.gov/vuln/detail/CVE-2024-57716\">https://nvd.nist.gov/vuln/detail/CVE-2024-57716</a></li>\n<li><a href=\"https://github.com/pentesttoolscom/vulnerability-research/tree/master/CVE-2024-57716\">https://github.com/pentesttoolscom/vulnerability-research/tree/master/CVE-2024-57716</a></li>\n<li><a href=\"https://github.com/trenoncourt/AutoQueryable\">https://github.com/trenoncourt/AutoQueryable</a></li>\n<li><a href=\"https://github.com/advisories/GHSA-m4mm-534h-5cp5\">https://github.com/advisories/GHSA-m4mm-534h-5cp5</a></li>\n</ul>\n",
            "url": "https://github.com/advisories/GHSA-m4mm-534h-5cp5",
            "title": "[AutoQueryable] AutoQueryable leaks sensitive information",
            "date_modified": "2025-02-20T22:58:43.000Z",
            "date_published": "2025-02-20T18:31:24.000Z",
            "author": {
                "name": "GitHub",
                "url": "https://github.com/advisories/GHSA-m4mm-534h-5cp5"
            },
            "tags": [
                "severity"
            ]
        },
        {
            "content_html": "<h3 id=\"impact\">Impact</h3>\n<p>Authenticated users are able to exploit an XSS vulnerability when viewing previewed content.</p>\n<h3 id=\"patches\">Patches</h3>\n<p>Will be patched in 10.8.8, 13.5.3, 14.3.2 and 15.1.2.</p>\n<h3 id=\"workarounds\">Workarounds</h3>\n<p>None available.</p>\n<h3 id=\"references\">References</h3>\n<ul>\n<li><a href=\"https://github.com/umbraco/Umbraco-CMS/security/advisories/GHSA-69cg-w8vm-h229\">https://github.com/umbraco/Umbraco-CMS/security/advisories/GHSA-69cg-w8vm-h229</a></li>\n<li><a href=\"https://nvd.nist.gov/vuln/detail/CVE-2024-10761\">https://nvd.nist.gov/vuln/detail/CVE-2024-10761</a></li>\n<li><a href=\"https://drive.google.com/file/d/1YoZgdlS3QT7Xu005j9RO-FFUT8RbB0Da/view?usp=sharing\">https://drive.google.com/file/d/1YoZgdlS3QT7Xu005j9RO-FFUT8RbB0Da/view?usp=sharing</a></li>\n<li><a href=\"https://vuldb.com/?ctiid.282930\">https://vuldb.com/?ctiid.282930</a></li>\n<li><a href=\"https://vuldb.com/?id.282930\">https://vuldb.com/?id.282930</a></li>\n<li><a href=\"https://vuldb.com/?submit.427091\">https://vuldb.com/?submit.427091</a></li>\n<li><a href=\"https://github.com/advisories/GHSA-69cg-w8vm-h229\">https://github.com/advisories/GHSA-69cg-w8vm-h229</a></li>\n</ul>\n",
            "url": "https://github.com/advisories/GHSA-69cg-w8vm-h229",
            "title": "[Umbraco.Cms.Web.Common] XSS/HTML Injection Vulnerability in Umbraco Preview Badge",
            "date_modified": "2025-02-19T17:59:40.000Z",
            "date_published": "2025-01-21T21:24:20.000Z",
            "author": {
                "name": "GitHub",
                "url": "https://github.com/advisories/GHSA-69cg-w8vm-h229"
            },
            "tags": [
                "severity"
            ]
        },
        {
            "content_html": "<h3 id=\"impact\">Impact</h3>\n<p>Authenticated users are able to exploit an XSS vulnerability when viewing previewed content.</p>\n<h3 id=\"patches\">Patches</h3>\n<p>Will be patched in 10.8.8, 13.5.3, 14.3.2 and 15.1.2.</p>\n<h3 id=\"workarounds\">Workarounds</h3>\n<p>None available.</p>\n<h3 id=\"references\">References</h3>\n<ul>\n<li><a href=\"https://github.com/umbraco/Umbraco-CMS/security/advisories/GHSA-69cg-w8vm-h229\">https://github.com/umbraco/Umbraco-CMS/security/advisories/GHSA-69cg-w8vm-h229</a></li>\n<li><a href=\"https://nvd.nist.gov/vuln/detail/CVE-2024-10761\">https://nvd.nist.gov/vuln/detail/CVE-2024-10761</a></li>\n<li><a href=\"https://drive.google.com/file/d/1YoZgdlS3QT7Xu005j9RO-FFUT8RbB0Da/view?usp=sharing\">https://drive.google.com/file/d/1YoZgdlS3QT7Xu005j9RO-FFUT8RbB0Da/view?usp=sharing</a></li>\n<li><a href=\"https://vuldb.com/?ctiid.282930\">https://vuldb.com/?ctiid.282930</a></li>\n<li><a href=\"https://vuldb.com/?id.282930\">https://vuldb.com/?id.282930</a></li>\n<li><a href=\"https://vuldb.com/?submit.427091\">https://vuldb.com/?submit.427091</a></li>\n<li><a href=\"https://github.com/advisories/GHSA-69cg-w8vm-h229\">https://github.com/advisories/GHSA-69cg-w8vm-h229</a></li>\n</ul>\n",
            "url": "https://github.com/advisories/GHSA-69cg-w8vm-h229",
            "title": "[Umbraco.Cms.Web.Common] XSS/HTML Injection Vulnerability in Umbraco Preview Badge",
            "date_modified": "2025-02-19T17:59:40.000Z",
            "date_published": "2025-01-21T21:24:20.000Z",
            "author": {
                "name": "GitHub",
                "url": "https://github.com/advisories/GHSA-69cg-w8vm-h229"
            },
            "tags": [
                "severity"
            ]
        },
        {
            "content_html": "<h3 id=\"impact\">Impact</h3>\n<p>Authenticated users are able to exploit an XSS vulnerability when viewing previewed content.</p>\n<h3 id=\"patches\">Patches</h3>\n<p>Will be patched in 10.8.8, 13.5.3, 14.3.2 and 15.1.2.</p>\n<h3 id=\"workarounds\">Workarounds</h3>\n<p>None available.</p>\n<h3 id=\"references\">References</h3>\n<ul>\n<li><a href=\"https://github.com/umbraco/Umbraco-CMS/security/advisories/GHSA-69cg-w8vm-h229\">https://github.com/umbraco/Umbraco-CMS/security/advisories/GHSA-69cg-w8vm-h229</a></li>\n<li><a href=\"https://nvd.nist.gov/vuln/detail/CVE-2024-10761\">https://nvd.nist.gov/vuln/detail/CVE-2024-10761</a></li>\n<li><a href=\"https://drive.google.com/file/d/1YoZgdlS3QT7Xu005j9RO-FFUT8RbB0Da/view?usp=sharing\">https://drive.google.com/file/d/1YoZgdlS3QT7Xu005j9RO-FFUT8RbB0Da/view?usp=sharing</a></li>\n<li><a href=\"https://vuldb.com/?ctiid.282930\">https://vuldb.com/?ctiid.282930</a></li>\n<li><a href=\"https://vuldb.com/?id.282930\">https://vuldb.com/?id.282930</a></li>\n<li><a href=\"https://vuldb.com/?submit.427091\">https://vuldb.com/?submit.427091</a></li>\n<li><a href=\"https://github.com/advisories/GHSA-69cg-w8vm-h229\">https://github.com/advisories/GHSA-69cg-w8vm-h229</a></li>\n</ul>\n",
            "url": "https://github.com/advisories/GHSA-69cg-w8vm-h229",
            "title": "[Umbraco.Cms.Web.Common] XSS/HTML Injection Vulnerability in Umbraco Preview Badge",
            "date_modified": "2025-02-19T17:59:40.000Z",
            "date_published": "2025-01-21T21:24:20.000Z",
            "author": {
                "name": "GitHub",
                "url": "https://github.com/advisories/GHSA-69cg-w8vm-h229"
            },
            "tags": [
                "severity"
            ]
        },
        {
            "content_html": "<h3 id=\"impact\">Impact</h3>\n<p>Authenticated users are able to exploit an XSS vulnerability when viewing previewed content.</p>\n<h3 id=\"patches\">Patches</h3>\n<p>Will be patched in 10.8.8, 13.5.3, 14.3.2 and 15.1.2.</p>\n<h3 id=\"workarounds\">Workarounds</h3>\n<p>None available.</p>\n<h3 id=\"references\">References</h3>\n<ul>\n<li><a href=\"https://github.com/umbraco/Umbraco-CMS/security/advisories/GHSA-69cg-w8vm-h229\">https://github.com/umbraco/Umbraco-CMS/security/advisories/GHSA-69cg-w8vm-h229</a></li>\n<li><a href=\"https://nvd.nist.gov/vuln/detail/CVE-2024-10761\">https://nvd.nist.gov/vuln/detail/CVE-2024-10761</a></li>\n<li><a href=\"https://drive.google.com/file/d/1YoZgdlS3QT7Xu005j9RO-FFUT8RbB0Da/view?usp=sharing\">https://drive.google.com/file/d/1YoZgdlS3QT7Xu005j9RO-FFUT8RbB0Da/view?usp=sharing</a></li>\n<li><a href=\"https://vuldb.com/?ctiid.282930\">https://vuldb.com/?ctiid.282930</a></li>\n<li><a href=\"https://vuldb.com/?id.282930\">https://vuldb.com/?id.282930</a></li>\n<li><a href=\"https://vuldb.com/?submit.427091\">https://vuldb.com/?submit.427091</a></li>\n<li><a href=\"https://github.com/advisories/GHSA-69cg-w8vm-h229\">https://github.com/advisories/GHSA-69cg-w8vm-h229</a></li>\n</ul>\n",
            "url": "https://github.com/advisories/GHSA-69cg-w8vm-h229",
            "title": "[Umbraco.Cms.Web.Common] XSS/HTML Injection Vulnerability in Umbraco Preview Badge",
            "date_modified": "2025-02-19T17:59:40.000Z",
            "date_published": "2025-01-21T21:24:20.000Z",
            "author": {
                "name": "GitHub",
                "url": "https://github.com/advisories/GHSA-69cg-w8vm-h229"
            },
            "tags": [
                "severity"
            ]
        },
        {
            "content_html": "<h3 id=\"summary\">Summary</h3>\n<p>Duende.AccessTokenManagement contains a race condition when requesting access tokens using the client credentials flow. Concurrent requests to obtain an access token using differing protocol parameters can return access tokens obtained with the wrong scope, resource indicator, or other protocol parameters. Such usage is somewhat atypical, and only a small percentage of users are likely to be affected.</p>\n<h3 id=\"details\">Details</h3>\n<p>Duende.AccessTokenManagement can request access tokens using the client credentials flow in several ways. In basic usage, the client credentials flow is configured once and the parameters do not vary. In more advanced situations, requests with varying protocol parameters may be made by calling specific overloads of these methods:</p>\n<ul>\n<li><code>HttpContext.GetClientAccessTokenAsync()</code></li>\n<li><code>IClientCredentialsTokenManagementService.GetAccessTokenAsync()</code></li>\n</ul>\n<p>There are overloads of both of these methods that accept a <code>TokenRequestParameters</code> object that customizes token request parameters. However, concurrent requests with varying <code>TokenRequestParameters</code> will result in the same token for all concurrent calls.</p>\n<h3 id=\"upgrading\">Upgrading</h3>\n<p>Most users can simply update the NuGet package to the latest version. Customizations of the <code>IClientCredentialsTokenCache</code> that derive from the default implementation (<code>DistributedClientCredentialsTokenCache</code>) will require a small code change, as its constructor was changed to add a dependency on the <code>ITokenRequestSynchronization</code> service. The synchronization service will need to be injected into the derived class and passed to the base constructor.</p>\n<h3 id=\"impact\">Impact</h3>\n<p>The impact of this vulnerability depends on how Duende.AccessTokenManagement is used and on the security architecture of the solution. Most users will not be vulnerable to this issue. More advanced users may run into this issue by calling the methods specified above with customized token request parameters. The impact of obtaining an access token with different than intended protocol parameters will vary depending on application logic, security architecture, and the authorization policy of the resource servers.</p>\n<p>Thank you to <strong>Michael Dimoudis</strong> of <strong>PageUp</strong> for finding this issue and responsibly disclosing it!</p>\n<h3 id=\"references\">References</h3>\n<ul>\n<li><a href=\"https://github.com/DuendeSoftware/foss/security/advisories/GHSA-qxj7-2x7w-3mpp\">https://github.com/DuendeSoftware/foss/security/advisories/GHSA-qxj7-2x7w-3mpp</a></li>\n<li><a href=\"https://nvd.nist.gov/vuln/detail/CVE-2025-26620\">https://nvd.nist.gov/vuln/detail/CVE-2025-26620</a></li>\n<li><a href=\"https://github.com/DuendeSoftware/foss/commit/a33332ddec0ebf3c048ba85427e3c77d47c68dac\">https://github.com/DuendeSoftware/foss/commit/a33332ddec0ebf3c048ba85427e3c77d47c68dac</a></li>\n<li><a href=\"https://github.com/advisories/GHSA-qxj7-2x7w-3mpp\">https://github.com/advisories/GHSA-qxj7-2x7w-3mpp</a></li>\n</ul>\n",
            "url": "https://github.com/advisories/GHSA-qxj7-2x7w-3mpp",
            "title": "[Duende.AccessTokenManagement] Duende.AccessTokenManagement race condition when concurrently retrieving customized Client Credentials Access Tokens",
            "date_modified": "2025-02-19T17:47:22.000Z",
            "date_published": "2025-02-19T17:47:19.000Z",
            "author": {
                "name": "GitHub",
                "url": "https://github.com/advisories/GHSA-qxj7-2x7w-3mpp"
            },
            "tags": [
                "severity"
            ]
        },
        {
            "content_html": "<h3 id=\"description\">Description</h3>\n<p>Authentication using Spid and CIE is based on the SAML2 standard which provides for two entities:</p>\n<p>Identity Provider (IdP): the system that authenticates users and provides identity information ( SAML assertions ) to the Service Provider, essentially, it is responsible for managing user credentials and identity;\nService Provider (SP): The system that provides a service to the user and relies on the Identity Provider to authenticate the user, receives SAML assertions from the IdP to grant access to resources.\nThe library <code>cie-aspnetcorerefers</code> to the second entity, i.e. the SP, and implements the validation logic of the SAML assertions present within the SAML response . The following is a summary diagram of an authentication flow via SAML:</p>\n<p><img alt=\"\" src=\"https://github.com/user-attachments/assets/5b10c8f8-5121-446f-95f8-c0355daa5959\"></p>\n<p>As shown in the diagram, the IdP, after verifying the user's credentials, generates a signed SAML response, this is propagated to the SP by the user's browser and the SP, after verifying the signature, can extract the data needed to build the user's session.</p>\n<p>The signature validation logic is central as it ensures that you cannot craft a SAML response with arbitrary assertions and thus impersonate other users.</p>\n<p>The following is the validation code implemented in <code>cie-aspnetcore</code>.</p>\n<pre><code class=\"language-csharp\">internal static bool VerifySignature(XmlDocument signedDocument, IdentityProvider? identityProvider = null){\n    //...SNIP...\n    SignedXml signedXml = new SignedXml(signedDocument);\n    if (identityProvider is not null)\n    {\n        bool validated = false;\n        foreach (var certificate in identityProvider.X509SigningCertificates){\n            var publicMetadataCert = new X509Certificate2(Convert.FromBase64String(certificate));\n            XmlNodeList nodeList = (signedDocument.GetElementsByTagName(\"ds:Signature\")?.Count &gt; 1) ?\n                                    signedDocument.GetElementsByTagName(\"ds:Signature\") :\n                                   (signedDocument.GetElementsByTagName(\"ns2:Signature\")?.Count &gt; 1) ?\n                                    signedDocument.GetElementsByTagName(\"ns2:Signature\") :\n                                    signedDocument.GetElementsByTagName(\"Signature\");\n            signedXml.LoadXml((XmlElement)nodeList[0]);\n            validated |= signedXml.CheckSignature(publicMetadataCert, true);\n        }\n        return validated;\n    }\n    else{\n        XmlNodeList nodeList = (signedDocument.GetElementsByTagName(\"ds:Signature\")?.Count &gt; 0) ?\n                               signedDocument.GetElementsByTagName(\"ds:Signature\") :\n                               signedDocument.GetElementsByTagName(\"Signature\");\n        signedXml.LoadXml((XmlElement)nodeList[0]);\n        return signedXml.CheckSignature();\n    }\n    //...SNIP...\n}\n</code></pre>\n<p>The parameter <code>signedDocument</code> contains the SAML response in XML format, while the parameter <code>identityProvider</code> can contain the IdP info. If the parameter <code>identityProvider</code> has been specified, the public certificates of that IdP are extracted, so as to force their use during the signature verification, otherwise the certificates configured within the application are used.</p>\n<p>Next, a response envelope is generated nodeList within which all XML elements containing an XML signature of part or all of the SAML response envelope are saved.</p>\n<p>Finally, the first element of this list, i.e. the first signature found, is extracted and verified.</p>\n<p>In a normal authentication flow, the SAML response looks like this (note that some fields and attributes have been omitted for ease of reading):</p>\n<pre><code class=\"language-xml\">&lt;samlp:Response ID=\"response_id\" IssueInstant=\"2025-01-07T13:37:00Z\" Version=\"2.0\" xmlns:saml=\"urn:oasis:names:tc:SAML:2.0:assertion\" xmlns:samlp=\"urn:oasis:names:tc:SAML:2.0:protocol\"&gt;\n    &lt;saml:Issuer Format=\"urn:oasis:names:tc:SAML:2.0:nameid-format:entity\"&gt;\n        https://demo.spid.gov.it/validator\n    &lt;/saml:Issuer&gt;\n    &lt;ds:Signature xmlns:ds=\"http://www.w3.org/2000/09/xmldsig#\"&gt;\n        &lt;ds:SignedInfo&gt;\n            &lt;ds:CanonicalizationMethod Algorithm=\"http://www.w3.org/2001/10/xml-exc-c14n#\"/&gt;\n            &lt;ds:SignatureMethod Algorithm=\"http://www.w3.org/2001/04/xmldsig-more#rsa-sha256\"/&gt;\n            &lt;ds:Reference URI=\"#response_id\"&gt;\n                &lt;ds:Transforms&gt;\n                    &lt;ds:Transform Algorithm=\"http://www.w3.org/2000/09/xmldsig#enveloped-signature\"/&gt;\n                &lt;/ds:Transforms&gt;\n                &lt;ds:DigestMethod Algorithm=\"http://www.w3.org/2001/04/xmlenc#sha256\"/&gt;\n                &lt;ds:DigestValue&gt;\n                    &lt;!-- DIGEST --&gt;\n                &lt;/ds:DigestValue&gt;\n            &lt;/ds:Reference&gt;\n        &lt;/ds:SignedInfo&gt;\n        &lt;ds:SignatureValue&gt;\n           &lt;!-- SIGNATURE --&gt;\n        &lt;/ds:SignatureValue&gt;\n        &lt;ds:KeyInfo&gt;\n            &lt;ds:X509Data&gt;\n                &lt;ds:X509Certificate&gt;\n                    &lt;!-- CERTIFICATE --&gt;\n                &lt;/ds:X509Certificate&gt;\n            &lt;/ds:X509Data&gt;\n        &lt;/ds:KeyInfo&gt;\n    &lt;/ds:Signature&gt;\n    &lt;samlp:Status&gt;\n        &lt;samlp:StatusCode Value=\"urn:oasis:names:tc:SAML:2.0:status:Success\"/&gt;\n    &lt;/samlp:Status&gt;\n    &lt;saml:Assertion ID=\"assertion_id\" IssueInstant=\"2025-01-07T13:37:00Z\" Version=\"2.0\" xmlns:xs=\"http://www.w3.org/2001/XMLSchema\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\"&gt;\n        &lt;saml:Issuer Format=\"urn:oasis:names:tc:SAML:2.0:nameid-format:entity\"&gt;\n            https://demo.spid.gov.it/validator\n        &lt;/saml:Issuer&gt;\n        &lt;ds:Signature xmlns:ds=\"http://www.w3.org/2000/09/xmldsig#\"&gt;\n            &lt;ds:SignedInfo&gt;\n                &lt;ds:CanonicalizationMethod Algorithm=\"http://www.w3.org/2001/10/xml-exc-c14n#\"/&gt;\n                &lt;ds:SignatureMethod Algorithm=\"http://www.w3.org/2001/04/xmldsig-more#rsa-sha256\"/&gt;\n                &lt;ds:Reference URI=\"#assertion_id\"&gt;\n                    &lt;ds:Transforms&gt;\n                        &lt;ds:Transform Algorithm=\"http://www.w3.org/2000/09/xmldsig#enveloped-signature\"/&gt;\n                    &lt;/ds:Transforms&gt;\n                    &lt;ds:DigestMethod Algorithm=\"http://www.w3.org/2001/04/xmlenc#sha256\"/&gt;\n                    &lt;ds:DigestValue&gt;\n                        &lt;!-- DIGEST --&gt;\n                    &lt;/ds:DigestValue&gt;\n                &lt;/ds:Reference&gt;\n            &lt;/ds:SignedInfo&gt;\n            &lt;ds:SignatureValue&gt;\n                &lt;!-- SIGNATURE --&gt;\n            &lt;/ds:SignatureValue&gt;\n            &lt;ds:KeyInfo&gt;\n                &lt;ds:X509Data&gt;\n                    &lt;ds:X509Certificate&gt;\n                        &lt;!-- CERTIFICATE --&gt;\n                    &lt;/ds:X509Certificate&gt;\n                &lt;/ds:X509Data&gt;\n            &lt;/ds:KeyInfo&gt;\n        &lt;/ds:Signature&gt;\n        &lt;saml:AttributeStatement&gt;\n            &lt;saml:Attribute Name=\"spidCode\" NameFormat=\"urn:oasis:names:tc:SAML:2.0:attrname-format:basic\"&gt;\n                &lt;saml:AttributeValue xmlns:xs=\"http://www.w3.org/2001/XMLSchema\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" xsi:type=\"xs:string\"&gt;\n                    AGID-001\n                &lt;/saml:AttributeValue&gt;\n            &lt;/saml:Attribute&gt;\n            &lt;!-- ... SNIP ... --&gt;\n        &lt;/saml:AttributeStatement&gt;\n    &lt;/saml:Assertion&gt;\n&lt;/samlp:Response&gt;\n</code></pre>\n<p>The SDK code would get as the first element of the <code>nodeList</code>, that is <code>nodeList[0]</code>, the signature referring to the entire SAML response, in fact the reference of the first signature <code>&lt;ds:Reference URI=\"#response_id\"&gt;</code> points to the root object <code>&lt;samlp:Response ID=\"response_id\" ...&gt;</code>. Therefore, verifying this signature will ensure that the entire content of the SAML response is intact and authentic.</p>\n<p>However, there is no guarantee that the first signature refers to the root object, so if an attacker injects a signed element as the first element, all other signatures will not be verified. The only requirement is to have a legitimately signed XML element from the IdP, which is easily accomplished using the public metadata of the IdP.</p>\n<p>The SAML response would be structured like this:</p>\n<p><img alt=\"\" src=\"https://github.com/user-attachments/assets/42b8c97a-96ae-45c9-afed-aab7066201a1\"></p>\n<h3 id=\"impact\">Impact</h3>\n<p>An attacker could craft an arbitrary SAML response that would be accepted by SPs using the vulnerable SDKs, allowing him to impersonate any Spid and/or CIE user.</p>\n<h3 id=\"complexity-of-the-attack\">Complexity of the attack</h3>\n<p>The attacker needs an XML block containing a valid signature from one of the IdPs accepted by the SP. As described above, this requirement is satisfied by reading the public metadata of the IdP which is represented by a signed XML block of the IdP.</p>\n<h3 id=\"related-issues\">Related issues</h3>\n<p>N/A</p>\n<h3 id=\"poc\">PoC</h3>\n<ol>\n<li>Clone the repository <a href=\"https://github.com/italia/spid-aspnetcore.git\">https://github.com/italia/spid-aspnetcore.git</a></li>\n<li>From the root of the project, enter the folder relating to the example webapp: <code>samples/1_SimpleSPWebApp/SPID.AspNetCore.WebApp/</code></li>\n<li>Change the value of the <code>AssertionConsumerServiceURL</code> key in the file <code>appsettings.json</code> to a custom domain: <code>https://$CUSTOM_DOMAIN:$CUSTOM_PORT/signin-spid</code></li>\n<li>Compile and run the sample webapp using the following command, taking care to replace the placeholders with the same values ​​used in step 3: <code>dotnet build \"SPID.AspNetCore.WebApp.csproj\" -o ./app/build &amp;&amp; dotnet publish \"SPID.AspNetCore.WebApp.csproj\" -o ./app/publish &amp;&amp; dotnet ./app/publish/SPID.AspNetCore.WebApp.dll -urls=https://$CUSTOM_DOMAIN:$CUSTOM_PORT</code></li>\n<li>Visit URL: <code>https://$CUSTOM_DOMAIN:$CUSTOM_PORT/</code></li>\n<li>Click \"Enter with SPID\" &gt; \"DemoSpid\" (second IdP in the list)</li>\n<li>Visit the \"Response\" &gt; \"Check Response\" section</li>\n<li>Insert the following string into the \"Audience\" field (right column): <code>https://spid.aspnetcore.it/</code></li>\n<li>Click \"Send response to Service Provider\", note the redirect to  <code>/home/loggedin</code> and consequently the correct execution of the login on the example portal</li>\n</ol>\n<p><img alt=\"\" src=\"https://github.com/user-attachments/assets/af3775a1-5f01-4ffa-9b28-730fef487869\"></p>\n<ol start=\"10\">\n<li>Repeat steps 5 to 8 inclusive</li>\n<li>Intercept the HTTP request generated in step 8 via an HTTP Proxy, such as PortSwigger's BurpSuite</li>\n<li>Perform URL-decoding and Base64-decoding of the POST <code>SAMLResponse</code> parameter</li>\n<li>Insert the content present at the following URL in the second line of the XML: <a href=\"https://demo.spid.gov.it/metadata.xml\">https://demo.spid.gov.it/metadata.xml</a></li>\n<li>Change the contents of the tag <code>&lt;saml:Assertion&gt;</code>, for example change the <code>email</code> attribute to an arbitrary value: <code>spid.tech@shielder.it</code></li>\n<li>Run Base64-encoding and then URL-encoding the <code>SAMLResponse</code> parameter</li>\n<li>Send the request and note the redirect to <code>/home/loggedin</code> which demonstrates the correct identification and therefore also the verification of the arbitrary signature inserted in <code>SAMLResponse</code> despite the modification of the assertion</li>\n</ol>\n<p><img alt=\"\" src=\"https://github.com/user-attachments/assets/a725401f-7884-4910-b4e5-b6c55c1cde83\"></p>\n<h3 id=\"recommended-solution\">Recommended Solution</h3>\n<p>Verify all signatures within the SAML response and do not accept unsigned XML elements.</p>\n<h3 id=\"references\">References</h3>\n<ul>\n<li><a href=\"https://cheatsheetseries.owasp.org/cheatsheets/SAML_Security_Cheat_Sheet.html\">https://cheatsheetseries.owasp.org/cheatsheets/SAML_Security_Cheat_Sheet.html</a></li>\n</ul>\n<h3 id=\"credits\">Credits</h3>\n<ul>\n<li><a href=\"https://x.com/smaury92\">Abdel Adim <code>smaury</code> Oisfi</a> di <a href=\"https://www.shielder.com\">Shielder</a></li>\n<li><a href=\"https://x.com/paupu_95\">Paolo<code>paupu</code> Cavaglià</a> di <a href=\"https://www.shielder.com\">Shielder</a></li>\n<li><a href=\"https://x.com/fromveeko\">Nicola <code>fromveeko</code> Davico</a> di <a href=\"https://www.shielder.com\">Shielder</a></li>\n</ul>\n<h3 id=\"references-1\">References</h3>\n<ul>\n<li><a href=\"https://github.com/italia/cie-aspnetcore/security/advisories/GHSA-vq63-8f72-f486\">https://github.com/italia/cie-aspnetcore/security/advisories/GHSA-vq63-8f72-f486</a></li>\n<li><a href=\"https://github.com/italia/cie-aspnetcore/commit/e66b7f336ff5d4c69f95f197f27f3145f2484994\">https://github.com/italia/cie-aspnetcore/commit/e66b7f336ff5d4c69f95f197f27f3145f2484994</a></li>\n<li><a href=\"https://github.com/advisories/GHSA-vq63-8f72-f486\">https://github.com/advisories/GHSA-vq63-8f72-f486</a></li>\n</ul>\n",
            "url": "https://github.com/advisories/GHSA-vq63-8f72-f486",
            "title": "[CIE.AspNetCore.Authentication] AspNetCore Remote Authenticator for CIE3.0 Allows SAML Response Signature Verification Bypass",
            "date_modified": "2025-02-18T19:25:20.000Z",
            "date_published": "2025-02-18T19:25:19.000Z",
            "author": {
                "name": "GitHub",
                "url": "https://github.com/advisories/GHSA-vq63-8f72-f486"
            },
            "tags": [
                "severity"
            ]
        },
        {
            "content_html": "<h3 id=\"description\">Description</h3>\n<p>Authentication using Spid and CIE is based on the SAML2 standard which provides for two entities:</p>\n<p>Identity Provider (IdP): the system that authenticates users and provides identity information ( SAML assertions ) to the Service Provider, essentially, it is responsible for managing user credentials and identity;\nService Provider (SP): The system that provides a service to the user and relies on the Identity Provider to authenticate the user, receives SAML assertions from the IdP to grant access to resources.\nThe library <code>spid-aspnetcorerefers</code> to the second entity, i.e. the SP, and implements the validation logic of the SAML assertions present within the SAML response . The following is a summary diagram of an authentication flow via SAML:</p>\n<p><img alt=\"\" src=\"https://github.com/user-attachments/assets/5b10c8f8-5121-446f-95f8-c0355daa5959\"></p>\n<p>As shown in the diagram, the IdP, after verifying the user's credentials, generates a signed SAML response, this is propagated to the SP by the user's browser and the SP, after verifying the signature, can extract the data needed to build the user's session.</p>\n<p>The signature validation logic is central as it ensures that you cannot craft a SAML response with arbitrary assertions and thus impersonate other users.</p>\n<p>The following is the validation code implemented in <code>spid-aspnetcore</code>.</p>\n<pre><code class=\"language-csharp\">internal static bool VerifySignature(XmlDocument signedDocument, IdentityProvider? identityProvider = null){\n    //...SNIP...\n    SignedXml signedXml = new SignedXml(signedDocument);\n    if (identityProvider is not null)\n    {\n        bool validated = false;\n        foreach (var certificate in identityProvider.X509SigningCertificates){\n            var publicMetadataCert = new X509Certificate2(Convert.FromBase64String(certificate));\n            XmlNodeList nodeList = (signedDocument.GetElementsByTagName(\"ds:Signature\")?.Count &gt; 1) ?\n                                    signedDocument.GetElementsByTagName(\"ds:Signature\") :\n                                   (signedDocument.GetElementsByTagName(\"ns2:Signature\")?.Count &gt; 1) ?\n                                    signedDocument.GetElementsByTagName(\"ns2:Signature\") :\n                                    signedDocument.GetElementsByTagName(\"Signature\");\n            signedXml.LoadXml((XmlElement)nodeList[0]);\n            validated |= signedXml.CheckSignature(publicMetadataCert, true);\n        }\n        return validated;\n    }\n    else{\n        XmlNodeList nodeList = (signedDocument.GetElementsByTagName(\"ds:Signature\")?.Count &gt; 0) ?\n                               signedDocument.GetElementsByTagName(\"ds:Signature\") :\n                               signedDocument.GetElementsByTagName(\"Signature\");\n        signedXml.LoadXml((XmlElement)nodeList[0]);\n        return signedXml.CheckSignature();\n    }\n    //...SNIP...\n}\n</code></pre>\n<p>The parameter <code>signedDocument</code> contains the SAML response in XML format, while the parameter <code>identityProvider</code> can contain the IdP info. If the parameter <code>identityProvider</code> has been specified, the public certificates of that IdP are extracted, so as to force their use during the signature verification, otherwise the certificates configured within the application are used.</p>\n<p>Next, a response envelope is generated nodeList within which all XML elements containing an XML signature of part or all of the SAML response envelope are saved.</p>\n<p>Finally, the first element of this list, i.e. the first signature found, is extracted and verified.</p>\n<p>In a normal authentication flow, the SAML response looks like this (note that some fields and attributes have been omitted for ease of reading):</p>\n<pre><code class=\"language-xml\">&lt;samlp:Response ID=\"response_id\" IssueInstant=\"2025-01-07T13:37:00Z\" Version=\"2.0\" xmlns:saml=\"urn:oasis:names:tc:SAML:2.0:assertion\" xmlns:samlp=\"urn:oasis:names:tc:SAML:2.0:protocol\"&gt;\n    &lt;saml:Issuer Format=\"urn:oasis:names:tc:SAML:2.0:nameid-format:entity\"&gt;\n        https://demo.spid.gov.it/validator\n    &lt;/saml:Issuer&gt;\n    &lt;ds:Signature xmlns:ds=\"http://www.w3.org/2000/09/xmldsig#\"&gt;\n        &lt;ds:SignedInfo&gt;\n            &lt;ds:CanonicalizationMethod Algorithm=\"http://www.w3.org/2001/10/xml-exc-c14n#\"/&gt;\n            &lt;ds:SignatureMethod Algorithm=\"http://www.w3.org/2001/04/xmldsig-more#rsa-sha256\"/&gt;\n            &lt;ds:Reference URI=\"#response_id\"&gt;\n                &lt;ds:Transforms&gt;\n                    &lt;ds:Transform Algorithm=\"http://www.w3.org/2000/09/xmldsig#enveloped-signature\"/&gt;\n                &lt;/ds:Transforms&gt;\n                &lt;ds:DigestMethod Algorithm=\"http://www.w3.org/2001/04/xmlenc#sha256\"/&gt;\n                &lt;ds:DigestValue&gt;\n                    &lt;!-- DIGEST --&gt;\n                &lt;/ds:DigestValue&gt;\n            &lt;/ds:Reference&gt;\n        &lt;/ds:SignedInfo&gt;\n        &lt;ds:SignatureValue&gt;\n           &lt;!-- SIGNATURE --&gt;\n        &lt;/ds:SignatureValue&gt;\n        &lt;ds:KeyInfo&gt;\n            &lt;ds:X509Data&gt;\n                &lt;ds:X509Certificate&gt;\n                    &lt;!-- CERTIFICATE --&gt;\n                &lt;/ds:X509Certificate&gt;\n            &lt;/ds:X509Data&gt;\n        &lt;/ds:KeyInfo&gt;\n    &lt;/ds:Signature&gt;\n    &lt;samlp:Status&gt;\n        &lt;samlp:StatusCode Value=\"urn:oasis:names:tc:SAML:2.0:status:Success\"/&gt;\n    &lt;/samlp:Status&gt;\n    &lt;saml:Assertion ID=\"assertion_id\" IssueInstant=\"2025-01-07T13:37:00Z\" Version=\"2.0\" xmlns:xs=\"http://www.w3.org/2001/XMLSchema\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\"&gt;\n        &lt;saml:Issuer Format=\"urn:oasis:names:tc:SAML:2.0:nameid-format:entity\"&gt;\n            https://demo.spid.gov.it/validator\n        &lt;/saml:Issuer&gt;\n        &lt;ds:Signature xmlns:ds=\"http://www.w3.org/2000/09/xmldsig#\"&gt;\n            &lt;ds:SignedInfo&gt;\n                &lt;ds:CanonicalizationMethod Algorithm=\"http://www.w3.org/2001/10/xml-exc-c14n#\"/&gt;\n                &lt;ds:SignatureMethod Algorithm=\"http://www.w3.org/2001/04/xmldsig-more#rsa-sha256\"/&gt;\n                &lt;ds:Reference URI=\"#assertion_id\"&gt;\n                    &lt;ds:Transforms&gt;\n                        &lt;ds:Transform Algorithm=\"http://www.w3.org/2000/09/xmldsig#enveloped-signature\"/&gt;\n                    &lt;/ds:Transforms&gt;\n                    &lt;ds:DigestMethod Algorithm=\"http://www.w3.org/2001/04/xmlenc#sha256\"/&gt;\n                    &lt;ds:DigestValue&gt;\n                        &lt;!-- DIGEST --&gt;\n                    &lt;/ds:DigestValue&gt;\n                &lt;/ds:Reference&gt;\n            &lt;/ds:SignedInfo&gt;\n            &lt;ds:SignatureValue&gt;\n                &lt;!-- SIGNATURE --&gt;\n            &lt;/ds:SignatureValue&gt;\n            &lt;ds:KeyInfo&gt;\n                &lt;ds:X509Data&gt;\n                    &lt;ds:X509Certificate&gt;\n                        &lt;!-- CERTIFICATE --&gt;\n                    &lt;/ds:X509Certificate&gt;\n                &lt;/ds:X509Data&gt;\n            &lt;/ds:KeyInfo&gt;\n        &lt;/ds:Signature&gt;\n        &lt;saml:AttributeStatement&gt;\n            &lt;saml:Attribute Name=\"spidCode\" NameFormat=\"urn:oasis:names:tc:SAML:2.0:attrname-format:basic\"&gt;\n                &lt;saml:AttributeValue xmlns:xs=\"http://www.w3.org/2001/XMLSchema\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" xsi:type=\"xs:string\"&gt;\n                    AGID-001\n                &lt;/saml:AttributeValue&gt;\n            &lt;/saml:Attribute&gt;\n            &lt;!-- ... SNIP ... --&gt;\n        &lt;/saml:AttributeStatement&gt;\n    &lt;/saml:Assertion&gt;\n&lt;/samlp:Response&gt;\n</code></pre>\n<p>The SDK code would get as the first element of the <code>nodeList</code>, that is <code>nodeList[0]</code>, the signature referring to the entire SAML response, in fact the reference of the first signature <code>&lt;ds:Reference URI=\"#response_id\"&gt;</code> points to the root object <code>&lt;samlp:Response ID=\"response_id\" ...&gt;</code>. Therefore, verifying this signature will ensure that the entire content of the SAML response is intact and authentic.</p>\n<p>However, there is no guarantee that the first signature refers to the root object, so if an attacker injects a signed element as the first element, all other signatures will not be verified. The only requirement is to have a legitimately signed XML element from the IdP, which is easily accomplished using the public metadata of the IdP.</p>\n<p>The SAML response would be structured like this:</p>\n<p><img alt=\"\" src=\"https://github.com/user-attachments/assets/42b8c97a-96ae-45c9-afed-aab7066201a1\"></p>\n<h3 id=\"impact\">Impact</h3>\n<p>An attacker could craft an arbitrary SAML response that would be accepted by SPs using the vulnerable SDKs, allowing him to impersonate any Spid and/or CIE user.</p>\n<h3 id=\"complexity-of-the-attack\">Complexity of the attack</h3>\n<p>The attacker needs an XML block containing a valid signature from one of the IdPs accepted by the SP. As described above, this requirement is satisfied by reading the public metadata of the IdP which is represented by a signed XML block of the IdP.</p>\n<h3 id=\"related-issues\">Related issues</h3>\n<p>N/A</p>\n<h3 id=\"poc\">PoC</h3>\n<ol>\n<li>Clone the repository <a href=\"https://github.com/italia/spid-aspnetcore.git\">https://github.com/italia/spid-aspnetcore.git</a></li>\n<li>From the root of the project, enter the folder relating to the example webapp: <code>samples/1_SimpleSPWebApp/SPID.AspNetCore.WebApp/</code></li>\n<li>Change the value of the <code>AssertionConsumerServiceURL</code> key in the file <code>appsettings.json</code> to a custom domain: <code>https://$CUSTOM_DOMAIN:$CUSTOM_PORT/signin-spid</code></li>\n<li>Compile and run the sample webapp using the following command, taking care to replace the placeholders with the same values ​​used in step 3: <code>dotnet build \"SPID.AspNetCore.WebApp.csproj\" -o ./app/build &amp;&amp; dotnet publish \"SPID.AspNetCore.WebApp.csproj\" -o ./app/publish &amp;&amp; dotnet ./app/publish/SPID.AspNetCore.WebApp.dll -urls=https://$CUSTOM_DOMAIN:$CUSTOM_PORT</code></li>\n<li>Visit URL: <code>https://$CUSTOM_DOMAIN:$CUSTOM_PORT/</code></li>\n<li>Click \"Enter with SPID\" &gt; \"DemoSpid\" (second IdP in the list)</li>\n<li>Visit the \"Response\" &gt; \"Check Response\" section</li>\n<li>Insert the following string into the \"Audience\" field (right column): <code>https://spid.aspnetcore.it/</code></li>\n<li>Click \"Send response to Service Provider\", note the redirect to  <code>/home/loggedin</code> and consequently the correct execution of the login on the example portal</li>\n</ol>\n<p><img alt=\"\" src=\"https://github.com/user-attachments/assets/af3775a1-5f01-4ffa-9b28-730fef487869\"></p>\n<ol start=\"10\">\n<li>Repeat steps 5 to 8 inclusive</li>\n<li>Intercept the HTTP request generated in step 8 via an HTTP Proxy, such as PortSwigger's BurpSuite</li>\n<li>Perform URL-decoding and Base64-decoding of the POST <code>SAMLResponse</code> parameter</li>\n<li>Insert the content present at the following URL in the second line of the XML: <a href=\"https://demo.spid.gov.it/metadata.xml\">https://demo.spid.gov.it/metadata.xml</a></li>\n<li>Change the contents of the tag <code>&lt;saml:Assertion&gt;</code>, for example change the <code>email</code> attribute to an arbitrary value: <code>spid.tech@shielder.it</code></li>\n<li>Run Base64-encoding and then URL-encoding the <code>SAMLResponse</code> parameter</li>\n<li>Send the request and note the redirect to <code>/home/loggedin</code> which demonstrates the correct identification and therefore also the verification of the arbitrary signature inserted in <code>SAMLResponse</code> despite the modification of the assertion</li>\n</ol>\n<p><img alt=\"\" src=\"https://github.com/user-attachments/assets/a725401f-7884-4910-b4e5-b6c55c1cde83\"></p>\n<h3 id=\"recommended-solution\">Recommended Solution</h3>\n<p>Verify all signatures within the SAML response and do not accept unsigned XML elements.</p>\n<h3 id=\"references\">References</h3>\n<ul>\n<li><a href=\"https://cheatsheetseries.owasp.org/cheatsheets/SAML_Security_Cheat_Sheet.html\">https://cheatsheetseries.owasp.org/cheatsheets/SAML_Security_Cheat_Sheet.html</a></li>\n</ul>\n<h3 id=\"credits\">Credits</h3>\n<ul>\n<li><a href=\"https://x.com/smaury92\">Abdel Adim <code>smaury</code> Oisfi</a> di <a href=\"https://www.shielder.com\">Shielder</a></li>\n<li><a href=\"https://x.com/paupu_95\">Paolo<code>paupu</code> Cavaglià</a> di <a href=\"https://www.shielder.com\">Shielder</a></li>\n<li><a href=\"https://x.com/fromveeko\">Nicola <code>fromveeko</code> Davico</a> di <a href=\"https://www.shielder.com\">Shielder</a></li>\n</ul>\n<h3 id=\"references-1\">References</h3>\n<ul>\n<li><a href=\"https://github.com/italia/spid-aspnetcore/security/advisories/GHSA-36h8-r92j-w9vw\">https://github.com/italia/spid-aspnetcore/security/advisories/GHSA-36h8-r92j-w9vw</a></li>\n<li><a href=\"https://github.com/italia/spid-aspnetcore/commit/093efa2273f8a1e0481f678a0bfcd57fbdc7b029\">https://github.com/italia/spid-aspnetcore/commit/093efa2273f8a1e0481f678a0bfcd57fbdc7b029</a></li>\n<li><a href=\"https://github.com/advisories/GHSA-36h8-r92j-w9vw\">https://github.com/advisories/GHSA-36h8-r92j-w9vw</a></li>\n</ul>\n",
            "url": "https://github.com/advisories/GHSA-36h8-r92j-w9vw",
            "title": "[SPID.AspNetCore.Authentication] The AspNetCore Remote Authenticator for SPID Allows SAML Response Signature Verification Bypass",
            "date_modified": "2025-02-18T19:25:15.000Z",
            "date_published": "2025-02-18T19:25:13.000Z",
            "author": {
                "name": "GitHub",
                "url": "https://github.com/advisories/GHSA-36h8-r92j-w9vw"
            },
            "tags": [
                "severity"
            ]
        },
        {
            "content_html": "<h2 id=\"duplicate-advisory\">Duplicate Advisory</h2>\n<p>This advisory has been withdrawn because it is a duplicate of GHSA-4rcc-7pg7-f57f. This link is maintained to preserve external references.</p>\n<h2 id=\"original-description\">Original Description</h2>\n<p>Vulnerability in the OPC UA .NET Standard Stack before 1.5.374.158 allows an unauthorized attacker to bypass application authentication when using HTTPS endpoints.</p>\n<h3 id=\"references\">References</h3>\n<ul>\n<li><a href=\"https://nvd.nist.gov/vuln/detail/CVE-2024-42513\">https://nvd.nist.gov/vuln/detail/CVE-2024-42513</a></li>\n<li><a href=\"https://files.opcfoundation.org/SecurityBulletins/OPC%20Foundation%20Security%20Bulletin%20CVE-2024-42513.pdf\">https://files.opcfoundation.org/SecurityBulletins/OPC%20Foundation%20Security%20Bulletin%20CVE-2024-42513.pdf</a></li>\n<li><a href=\"https://github.com/OPCFoundation/UA-.NETStandard/tree/1.5.374.158\">https://github.com/OPCFoundation/UA-.NETStandard/tree/1.5.374.158</a></li>\n<li><a href=\"https://github.com/advisories/GHSA-7wwr-h8cm-9jf7\">https://github.com/advisories/GHSA-7wwr-h8cm-9jf7</a></li>\n</ul>\n",
            "url": "https://github.com/advisories/GHSA-7wwr-h8cm-9jf7",
            "title": "[OPCFoundation.NetStandard.Opc.Ua] Duplicate Advisory: Authentication Bypass by Spoofing in OPC UA .NET Standard Stack",
            "date_modified": "2025-03-03T20:08:31.000Z",
            "date_published": "2025-02-10T21:31:37.000Z",
            "author": {
                "name": "GitHub",
                "url": "https://github.com/advisories/GHSA-7wwr-h8cm-9jf7"
            },
            "tags": [
                "severity"
            ]
        },
        {
            "content_html": "<h2 id=\"duplicate-advisory\">Duplicate Advisory</h2>\n<p>This advisory has been withdrawn because it is a duplicate of GHSA-h958-fxgg-g7w3. This link is maintained to preserve external references.</p>\n<h2 id=\"original-description\">Original Description</h2>\n<p>Vulnerability in the OPC UA .NET Standard Stack before 1.5.374.158 allows an unauthorized attacker to bypass application authentication when the deprecated Basic128Rsa15 security policy is enabled.</p>\n<h3 id=\"references\">References</h3>\n<ul>\n<li><a href=\"https://nvd.nist.gov/vuln/detail/CVE-2024-42512\">https://nvd.nist.gov/vuln/detail/CVE-2024-42512</a></li>\n<li><a href=\"https://files.opcfoundation.org/SecurityBulletins/OPC%20Foundation%20Security%20Bulletin%20CVE-2024-42512.pdf\">https://files.opcfoundation.org/SecurityBulletins/OPC%20Foundation%20Security%20Bulletin%20CVE-2024-42512.pdf</a></li>\n<li><a href=\"https://github.com/advisories/GHSA-qv5f-57gw-vx3h\">https://github.com/advisories/GHSA-qv5f-57gw-vx3h</a></li>\n</ul>\n",
            "url": "https://github.com/advisories/GHSA-qv5f-57gw-vx3h",
            "title": "[OPCFoundation.NetStandard.Opc.Ua] Duplicate Advisory: Authorization Bypass in OPC UA .NET Standard Stack",
            "date_modified": "2025-03-03T20:10:41.000Z",
            "date_published": "2025-02-10T21:31:37.000Z",
            "author": {
                "name": "GitHub",
                "url": "https://github.com/advisories/GHSA-qv5f-57gw-vx3h"
            },
            "tags": [
                "severity"
            ]
        }
    ]
}