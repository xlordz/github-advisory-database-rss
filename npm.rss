<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
    <id>https://azu.github.io/github-advisory-database-rss/npm.rss</id>
    <title>Security Advisory for JavaScript packages hosted at npmjs.com</title>
    <updated>2025-03-16T12:01:59.589Z</updated>
    <generator>github-advisory-database-rss</generator>
    <link rel="alternate" href="https://github.com/advisories?query=type%3Areviewed+ecosystem%3Anpm"/>
    <subtitle>Security Advisory for JavaScript packages hosted at npmjs.com on GitHub</subtitle>
    <rights>github-advisory-database-rss</rights>
    <category term="CRITICAL"/>
    <category term="HIGH"/>
    <category term="MODERATE"/>
    <category term="LOW"/>
    <entry>
        <title type="html"><![CDATA[[@jitbit/htmlsanitizer] JS Html Sanitizer allows XSS when used with contentEditable]]></title>
        <id>https://github.com/advisories/GHSA-vhv4-fh94-jm5x</id>
        <link href="https://github.com/advisories/GHSA-vhv4-fh94-jm5x"/>
        <updated>2025-03-14T21:41:27.000Z</updated>
        <content type="html"><![CDATA[<h3 id="impact">Impact</h3>
<p>XSS vulnerability when the sanitizer is used with a <code>contentEditable</code> element to set the elements <code>innerHTML</code> to a sanitized string produced by the package. If the code is particularly crafted to abuse the code beautifier, that runs AFTER sanitation.</p>
<h3 id="patches">Patches</h3>
<p>Patched in version 2.0.3</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/jitbit/HtmlSanitizer/security/advisories/GHSA-vhv4-fh94-jm5x">https://github.com/jitbit/HtmlSanitizer/security/advisories/GHSA-vhv4-fh94-jm5x</a></li>
<li><a href="https://github.com/jitbit/HtmlSanitizer/commit/af6d2a78877e7277cd01c825b7fb50edb5956963">https://github.com/jitbit/HtmlSanitizer/commit/af6d2a78877e7277cd01c825b7fb50edb5956963</a></li>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2025-29771">https://nvd.nist.gov/vuln/detail/CVE-2025-29771</a></li>
<li><a href="https://github.com/advisories/GHSA-vhv4-fh94-jm5x">https://github.com/advisories/GHSA-vhv4-fh94-jm5x</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-vhv4-fh94-jm5x</uri>
        </author>
        <category label="severity" term="MODERATE"/>
        <published>2025-03-14T19:54:52.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[froala-editor] Froala WYSIWYG editor allows cross-site scripting (XSS)]]></title>
        <id>https://github.com/advisories/GHSA-549p-5c7f-c5p4</id>
        <link href="https://github.com/advisories/GHSA-549p-5c7f-c5p4"/>
        <updated>2025-03-14T18:51:50.000Z</updated>
        <content type="html"><![CDATA[<p>Inconsistent </p>]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-549p-5c7f-c5p4</uri>
        </author>
        <category label="severity" term="MODERATE"/>
        <published>2024-11-08T00:30:45.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[flowise] Flowise allows arbitrary file write to RCE]]></title>
        <id>https://github.com/advisories/GHSA-8vvx-qvq9-5948</id>
        <link href="https://github.com/advisories/GHSA-8vvx-qvq9-5948"/>
        <updated>2025-03-14T18:48:45.000Z</updated>
        <content type="html"><![CDATA[<h3 id="summary">Summary</h3>
<p>An attacker could write files with arbitrary content to the filesystem via the <code>/api/v1/document-store/loader/process</code> API.
An attacker can reach RCE(Remote Code Execution) via file writing.</p>
<h3 id="details">Details</h3>
<p>All file writing functions in <a href="https://github.com/FlowiseAI/Flowise/blob/main/packages/components/src/storageUtils.ts">packages/components/src/storageUtils.ts</a> are vulnerable.</p>
<ul>
<li>addBase64FilesToStorage</li>
<li>addArrayFilesToStorage</li>
<li>addSingleFileToStorage</li>
</ul>
<p>The fileName parameter, which is an untrusted external input, is being used as an argument to path.join() without verification.</p>
<pre><code class="language-javascript">const filePath = path.join(dir, fileName)
fs.writeFileSync(filePath, bf)
</code></pre>
<p>Therefore, users can move to the parent folder via <code>../</code> and write files to any path.</p>
<p>Once file writing is possible in all paths, an attacker can reach RCE (Remote Code Execution) in a variety of ways.</p>
<p>In PoC (Proof of Concept), RCE was reached by overwriting package.json.</p>
<h3 id="poc">PoC</h3>
<p>In PoC, <code>package.json</code> is overwritten.
This is a scenario in which arbitrary code is executed when <code>pnpm start</code> is executed by changing the start command in the <code>scripts{}</code> statement to an arbitrary value.</p>
<p><strong>- original start command</strong></p>
<pre><code>"start": "run-script-os",
</code></pre>
<p><strong>- modify start command</strong></p>
<pre><code>"start": "touch /tmp/pyozzi-poc &amp;&amp; run-script-os",
</code></pre>
<p>When a user runs the <code>pnpm start</code> command, a <code>pyozzi-poc</code> file is created in the <code>/tmp</code> path.</p>
<h4 id="1-packagejson-content-base64-encoding">1. package.json content base64 encoding</h4>
<pre><code class="language-json">{
    "name": "flowise",
    "version": "1.8.2",
    "private": true,
    "homepage": "https://flowiseai.com",
    "workspaces": [
        "packages/*",
        "flowise",
        "ui",
        "components"
    ],
    "scripts": {
        "build": "turbo run build &amp;&amp; echo poc",
        "build-force": "pnpm clean &amp;&amp; turbo run build --force",
        "dev": "turbo run dev --parallel",
        "start": "touch /tmp/pyozzi-poc &amp;&amp; run-script-os", --&gt; modify (add touch /tmp/pyozzi &amp;&amp;)
        "start:windows": "cd packages/server/bin &amp;&amp; run start",
        "start:default": "cd packages/server/bin &amp;&amp; ./run start",
        "clean": "pnpm --filter \"./packages/**\" clean",
        "nuke": "pnpm --filter \"./packages/**\" nuke &amp;&amp; rimraf node_modules .turbo",
        "format": "prettier --write \"**/*.{ts,tsx,md}\"",
        "lint": "eslint \"**/*.{js,jsx,ts,tsx,json,md}\"",
        "lint-fix": "pnpm lint --fix",
        "quick": "pretty-quick --staged",
        "postinstall": "husky install",
        "migration:create": "pnpm typeorm migration:create"
    }, ... skip
</code></pre>
<h4 id="2-overwrite-packagejson-via-apiv1document-storeloaderprocess">2. Overwrite <code>package.json</code> via <code>/api/v1/document-store/loader/process</code></h4>
<img src="https://github.com/FlowiseAI/Flowise/assets/86613161/a548732d-4bee-4cd0-8565-54fb8e560500" alt="image" width="1329">

<blockquote>
<p><strong>Request Body</strong></p>
</blockquote>
<pre><code class="language-json">{
    "loaderId": "textFile",
    "storeId": "c4b8a8fb-9eb6-47ae-9caa-7702ef8baabb",
    "loaderName": "Text File",
    "loaderConfig": {
        "txtFile": "data:text/plain;BASE64_ENCODEING_CONTENT,filename:/../../../../../usr/src/package.json",
        "textSplitter": "",
        "metadata": "",
        "omitMetadataKeys": ""
    }
}
</code></pre>
<p>The part after <code>filename:</code> of the <code>txtFile</code> parameter is the value used as <code>fileName</code> in the function.
Add <code>../</code> to the filename value to move to the top path, then specify <code>package.json</code> in the project folder <code>/usr/src/</code> as the path.</p>
<img src="https://github.com/FlowiseAI/Flowise/assets/86613161/13fdc756-f4d3-45f9-9929-fd978f532a02" alt="image" width="663">

<p>Afterwards, when the user starts the server (<code>pnpm start</code>), the added script will be executed. (<code>touch /tmp/pyozzi-poc</code>)</p>
<p><strong>- starting server with <code>touch /tmp/pyozzi-poc</code> command</strong>
<img src="https://github.com/FlowiseAI/Flowise/assets/86613161/341be379-43ca-4acc-9126-dc398475fcf3" alt="image" width="737"></p>
<p><strong>- <code>/tmp/pyozzi-poc</code> file created</strong>
<img src="https://github.com/FlowiseAI/Flowise/assets/86613161/15707068-c000-4d59-972d-89d969c27087" alt="image" width="751"></p>
<h3 id="impact">Impact</h3>
<p><strong>Remote Code Execution (RCE)</strong>
Although it is demonstrated here using the file creation command, you can obtain full server shell privileges by opening a reverse shell.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/FlowiseAI/Flowise/security/advisories/GHSA-8vvx-qvq9-5948">https://github.com/FlowiseAI/Flowise/security/advisories/GHSA-8vvx-qvq9-5948</a></li>
<li><a href="https://github.com/FlowiseAI/Flowise/commit/c2b830f279e454e8b758da441016b2234f220ac7">https://github.com/FlowiseAI/Flowise/commit/c2b830f279e454e8b758da441016b2234f220ac7</a></li>
<li><a href="https://github.com/advisories/GHSA-8vvx-qvq9-5948">https://github.com/advisories/GHSA-8vvx-qvq9-5948</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-8vvx-qvq9-5948</uri>
        </author>
        <category label="severity" term="CRITICAL"/>
        <published>2025-03-14T18:48:44.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[azle] In Azle, calling `setTimer` causes infinite loop of timers]]></title>
        <id>https://github.com/advisories/GHSA-xc76-5pf9-mx8m</id>
        <link href="https://github.com/advisories/GHSA-xc76-5pf9-mx8m"/>
        <updated>2025-03-14T17:31:08.000Z</updated>
        <content type="html"><![CDATA[<h3 id="impact">Impact</h3>
<p>Calling <code>setTimer</code> in Azle versions <code>0.27.0</code>, <code>0.28.0</code>, and <code>0.29.0</code> causes an immediate infinite loop of timers to be executed on the canister, each timer attempting to clean up the global state of the previous timer.</p>
<p>The infinite loop will occur with any valid invocation of <code>setTimer</code>.</p>
<h3 id="patches">Patches</h3>
<p>The problem has been fixed as of Azle version <code>0.30.0</code>.</p>
<h3 id="workarounds">Workarounds</h3>
<p>If a canister is caught in this infinite loop after calling <code>setTimer</code>, the canister can be upgraded and the timers will all be cleared, thus ending the loop.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/demergent-labs/azle/security/advisories/GHSA-xc76-5pf9-mx8m">https://github.com/demergent-labs/azle/security/advisories/GHSA-xc76-5pf9-mx8m</a></li>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2025-29776">https://nvd.nist.gov/vuln/detail/CVE-2025-29776</a></li>
<li><a href="https://github.com/demergent-labs/azle/releases/tag/0.30.0">https://github.com/demergent-labs/azle/releases/tag/0.30.0</a></li>
<li><a href="https://github.com/advisories/GHSA-xc76-5pf9-mx8m">https://github.com/advisories/GHSA-xc76-5pf9-mx8m</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-xc76-5pf9-mx8m</uri>
        </author>
        <category label="severity" term="HIGH"/>
        <published>2025-03-14T17:31:07.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[xml-crypto] xml-crypto Vulnerable to XML Signature Verification Bypass via DigestValue Comment]]></title>
        <id>https://github.com/advisories/GHSA-x3m8-899r-f7c3</id>
        <link href="https://github.com/advisories/GHSA-x3m8-899r-f7c3"/>
        <updated>2025-03-14T20:23:58.000Z</updated>
        <content type="html"><![CDATA[<h1 id="impact">Impact</h1>
<p>An attacker may be able to exploit this vulnerability to bypass authentication or authorization mechanisms in systems that rely on xml-crypto for verifying signed XML documents. The vulnerability allows an attacker to modify a valid signed XML message in a way that still passes signature verification checks. For example, it could be used to alter critical identity or access control attributes, enabling an attacker to escalate privileges or impersonate another user.</p>
<h1 id="patches">Patches</h1>
<p>All versions &lt;= 6.0.0 are affected. Please upgrade to version 6.0.1.</p>
<p>If you are still using v2.x or v3.x please upgrade to the associated patch version.</p>
<h1 id="indicators-of-compromise">Indicators of Compromise</h1>
<p>When logging XML payloads, check for the following indicators. If the payload includes encrypted elements, ensure you analyze the decrypted version for a complete assessment. (If encryption is not used, analyze the original XML document directly). This applies to various XML-based authentication and authorization flows, such as SAML Response payloads.</p>
<h3 id="presence-of-comments-in-digestvalue">Presence of Comments in <code>DigestValue</code></h3>
<p>A <code>DigestValue</code> should <strong>not</strong> contain comments. If you find comments within it, this may indicate tampering.</p>
<p><strong>Example of a compromised <code>DigestValue</code>:</strong></p>
<pre><code class="language-xml">&lt;DigestValue&gt;
    &lt;!--TBlYWE0ZWM4ODI1NjliYzE3NmViN2E1OTlkOGDhhNmI=--&gt;
    c7RuVDYo83z2su5uk0Nla8DXcXvKYKgf7tZklJxL/LZ=
&lt;/DigestValue&gt;
</code></pre>
<h3 id="code-to-test">Code to test</h3>
<p>Pass in the decrypted version of the document</p>
<pre><code class="language-js">decryptedDocument = ... // yours to implement

const digestValues = xpath.select(
  "//*[local-name()='DigestValue'][count(node()) &gt; 1]",
  decryptedDocument,
);

if (digestValues.length &gt; 0) {
  // Compromise detected, yours to implement
}
</code></pre>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/node-saml/xml-crypto/security/advisories/GHSA-x3m8-899r-f7c3">https://github.com/node-saml/xml-crypto/security/advisories/GHSA-x3m8-899r-f7c3</a></li>
<li><a href="https://github.com/node-saml/xml-crypto/commit/28f92218ecbb8dcbd238afa4efbbd50302aa9aed">https://github.com/node-saml/xml-crypto/commit/28f92218ecbb8dcbd238afa4efbbd50302aa9aed</a></li>
<li><a href="https://github.com/node-saml/xml-crypto/commit/886dc63a8b4bb5ae1db9f41c7854b171eb83aa98">https://github.com/node-saml/xml-crypto/commit/886dc63a8b4bb5ae1db9f41c7854b171eb83aa98</a></li>
<li><a href="https://github.com/node-saml/xml-crypto/commit/8ac6118ee7978b46aa56b82cbcaa5fca58c93a07">https://github.com/node-saml/xml-crypto/commit/8ac6118ee7978b46aa56b82cbcaa5fca58c93a07</a></li>
<li><a href="https://github.com/node-saml/xml-crypto/releases/tag/v2.1.6">https://github.com/node-saml/xml-crypto/releases/tag/v2.1.6</a></li>
<li><a href="https://github.com/node-saml/xml-crypto/releases/tag/v3.2.1">https://github.com/node-saml/xml-crypto/releases/tag/v3.2.1</a></li>
<li><a href="https://github.com/node-saml/xml-crypto/releases/tag/v6.0.1">https://github.com/node-saml/xml-crypto/releases/tag/v6.0.1</a></li>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2025-29775">https://nvd.nist.gov/vuln/detail/CVE-2025-29775</a></li>
<li><a href="https://github.com/advisories/GHSA-x3m8-899r-f7c3">https://github.com/advisories/GHSA-x3m8-899r-f7c3</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-x3m8-899r-f7c3</uri>
        </author>
        <category label="severity" term="CRITICAL"/>
        <published>2025-03-14T17:16:47.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[xml-crypto] xml-crypto Vulnerable to XML Signature Verification Bypass via DigestValue Comment]]></title>
        <id>https://github.com/advisories/GHSA-x3m8-899r-f7c3</id>
        <link href="https://github.com/advisories/GHSA-x3m8-899r-f7c3"/>
        <updated>2025-03-14T20:23:58.000Z</updated>
        <content type="html"><![CDATA[<h1 id="impact">Impact</h1>
<p>An attacker may be able to exploit this vulnerability to bypass authentication or authorization mechanisms in systems that rely on xml-crypto for verifying signed XML documents. The vulnerability allows an attacker to modify a valid signed XML message in a way that still passes signature verification checks. For example, it could be used to alter critical identity or access control attributes, enabling an attacker to escalate privileges or impersonate another user.</p>
<h1 id="patches">Patches</h1>
<p>All versions &lt;= 6.0.0 are affected. Please upgrade to version 6.0.1.</p>
<p>If you are still using v2.x or v3.x please upgrade to the associated patch version.</p>
<h1 id="indicators-of-compromise">Indicators of Compromise</h1>
<p>When logging XML payloads, check for the following indicators. If the payload includes encrypted elements, ensure you analyze the decrypted version for a complete assessment. (If encryption is not used, analyze the original XML document directly). This applies to various XML-based authentication and authorization flows, such as SAML Response payloads.</p>
<h3 id="presence-of-comments-in-digestvalue">Presence of Comments in <code>DigestValue</code></h3>
<p>A <code>DigestValue</code> should <strong>not</strong> contain comments. If you find comments within it, this may indicate tampering.</p>
<p><strong>Example of a compromised <code>DigestValue</code>:</strong></p>
<pre><code class="language-xml">&lt;DigestValue&gt;
    &lt;!--TBlYWE0ZWM4ODI1NjliYzE3NmViN2E1OTlkOGDhhNmI=--&gt;
    c7RuVDYo83z2su5uk0Nla8DXcXvKYKgf7tZklJxL/LZ=
&lt;/DigestValue&gt;
</code></pre>
<h3 id="code-to-test">Code to test</h3>
<p>Pass in the decrypted version of the document</p>
<pre><code class="language-js">decryptedDocument = ... // yours to implement

const digestValues = xpath.select(
  "//*[local-name()='DigestValue'][count(node()) &gt; 1]",
  decryptedDocument,
);

if (digestValues.length &gt; 0) {
  // Compromise detected, yours to implement
}
</code></pre>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/node-saml/xml-crypto/security/advisories/GHSA-x3m8-899r-f7c3">https://github.com/node-saml/xml-crypto/security/advisories/GHSA-x3m8-899r-f7c3</a></li>
<li><a href="https://github.com/node-saml/xml-crypto/commit/28f92218ecbb8dcbd238afa4efbbd50302aa9aed">https://github.com/node-saml/xml-crypto/commit/28f92218ecbb8dcbd238afa4efbbd50302aa9aed</a></li>
<li><a href="https://github.com/node-saml/xml-crypto/commit/886dc63a8b4bb5ae1db9f41c7854b171eb83aa98">https://github.com/node-saml/xml-crypto/commit/886dc63a8b4bb5ae1db9f41c7854b171eb83aa98</a></li>
<li><a href="https://github.com/node-saml/xml-crypto/commit/8ac6118ee7978b46aa56b82cbcaa5fca58c93a07">https://github.com/node-saml/xml-crypto/commit/8ac6118ee7978b46aa56b82cbcaa5fca58c93a07</a></li>
<li><a href="https://github.com/node-saml/xml-crypto/releases/tag/v2.1.6">https://github.com/node-saml/xml-crypto/releases/tag/v2.1.6</a></li>
<li><a href="https://github.com/node-saml/xml-crypto/releases/tag/v3.2.1">https://github.com/node-saml/xml-crypto/releases/tag/v3.2.1</a></li>
<li><a href="https://github.com/node-saml/xml-crypto/releases/tag/v6.0.1">https://github.com/node-saml/xml-crypto/releases/tag/v6.0.1</a></li>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2025-29775">https://nvd.nist.gov/vuln/detail/CVE-2025-29775</a></li>
<li><a href="https://github.com/advisories/GHSA-x3m8-899r-f7c3">https://github.com/advisories/GHSA-x3m8-899r-f7c3</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-x3m8-899r-f7c3</uri>
        </author>
        <category label="severity" term="CRITICAL"/>
        <published>2025-03-14T17:16:47.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[xml-crypto] xml-crypto Vulnerable to XML Signature Verification Bypass via DigestValue Comment]]></title>
        <id>https://github.com/advisories/GHSA-x3m8-899r-f7c3</id>
        <link href="https://github.com/advisories/GHSA-x3m8-899r-f7c3"/>
        <updated>2025-03-14T20:23:58.000Z</updated>
        <content type="html"><![CDATA[<h1 id="impact">Impact</h1>
<p>An attacker may be able to exploit this vulnerability to bypass authentication or authorization mechanisms in systems that rely on xml-crypto for verifying signed XML documents. The vulnerability allows an attacker to modify a valid signed XML message in a way that still passes signature verification checks. For example, it could be used to alter critical identity or access control attributes, enabling an attacker to escalate privileges or impersonate another user.</p>
<h1 id="patches">Patches</h1>
<p>All versions &lt;= 6.0.0 are affected. Please upgrade to version 6.0.1.</p>
<p>If you are still using v2.x or v3.x please upgrade to the associated patch version.</p>
<h1 id="indicators-of-compromise">Indicators of Compromise</h1>
<p>When logging XML payloads, check for the following indicators. If the payload includes encrypted elements, ensure you analyze the decrypted version for a complete assessment. (If encryption is not used, analyze the original XML document directly). This applies to various XML-based authentication and authorization flows, such as SAML Response payloads.</p>
<h3 id="presence-of-comments-in-digestvalue">Presence of Comments in <code>DigestValue</code></h3>
<p>A <code>DigestValue</code> should <strong>not</strong> contain comments. If you find comments within it, this may indicate tampering.</p>
<p><strong>Example of a compromised <code>DigestValue</code>:</strong></p>
<pre><code class="language-xml">&lt;DigestValue&gt;
    &lt;!--TBlYWE0ZWM4ODI1NjliYzE3NmViN2E1OTlkOGDhhNmI=--&gt;
    c7RuVDYo83z2su5uk0Nla8DXcXvKYKgf7tZklJxL/LZ=
&lt;/DigestValue&gt;
</code></pre>
<h3 id="code-to-test">Code to test</h3>
<p>Pass in the decrypted version of the document</p>
<pre><code class="language-js">decryptedDocument = ... // yours to implement

const digestValues = xpath.select(
  "//*[local-name()='DigestValue'][count(node()) &gt; 1]",
  decryptedDocument,
);

if (digestValues.length &gt; 0) {
  // Compromise detected, yours to implement
}
</code></pre>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/node-saml/xml-crypto/security/advisories/GHSA-x3m8-899r-f7c3">https://github.com/node-saml/xml-crypto/security/advisories/GHSA-x3m8-899r-f7c3</a></li>
<li><a href="https://github.com/node-saml/xml-crypto/commit/28f92218ecbb8dcbd238afa4efbbd50302aa9aed">https://github.com/node-saml/xml-crypto/commit/28f92218ecbb8dcbd238afa4efbbd50302aa9aed</a></li>
<li><a href="https://github.com/node-saml/xml-crypto/commit/886dc63a8b4bb5ae1db9f41c7854b171eb83aa98">https://github.com/node-saml/xml-crypto/commit/886dc63a8b4bb5ae1db9f41c7854b171eb83aa98</a></li>
<li><a href="https://github.com/node-saml/xml-crypto/commit/8ac6118ee7978b46aa56b82cbcaa5fca58c93a07">https://github.com/node-saml/xml-crypto/commit/8ac6118ee7978b46aa56b82cbcaa5fca58c93a07</a></li>
<li><a href="https://github.com/node-saml/xml-crypto/releases/tag/v2.1.6">https://github.com/node-saml/xml-crypto/releases/tag/v2.1.6</a></li>
<li><a href="https://github.com/node-saml/xml-crypto/releases/tag/v3.2.1">https://github.com/node-saml/xml-crypto/releases/tag/v3.2.1</a></li>
<li><a href="https://github.com/node-saml/xml-crypto/releases/tag/v6.0.1">https://github.com/node-saml/xml-crypto/releases/tag/v6.0.1</a></li>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2025-29775">https://nvd.nist.gov/vuln/detail/CVE-2025-29775</a></li>
<li><a href="https://github.com/advisories/GHSA-x3m8-899r-f7c3">https://github.com/advisories/GHSA-x3m8-899r-f7c3</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-x3m8-899r-f7c3</uri>
        </author>
        <category label="severity" term="CRITICAL"/>
        <published>2025-03-14T17:16:47.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[xml-crypto] xml-crypto Vulnerable to XML Signature Verification Bypass via Multiple SignedInfo References]]></title>
        <id>https://github.com/advisories/GHSA-9p8x-f768-wp2g</id>
        <link href="https://github.com/advisories/GHSA-9p8x-f768-wp2g"/>
        <updated>2025-03-14T20:24:08.000Z</updated>
        <content type="html"><![CDATA[<h1 id="impact">Impact</h1>
<p>An attacker may be able to exploit this vulnerability to bypass authentication or authorization mechanisms in systems that rely on xml-crypto for verifying signed XML documents. The vulnerability allows an attacker to modify a valid signed XML message in a way that still passes signature verification checks. For example, it could be used to alter critical identity or access control attributes, enabling an attacker with a valid account to escalate privileges or impersonate another user.</p>
<h1 id="patches">Patches</h1>
<p>All versions &lt;= 6.0.0 are affected. Please upgrade to version 6.0.1.</p>
<p>If you are still using v2.x or v3.x please upgrade to the associated patch version.</p>
<h1 id="indicators-of-compromise">Indicators of Compromise</h1>
<p>When logging XML payloads, check for the following indicators. If the payload includes encrypted elements, ensure you analyze the decrypted version for a complete assessment. (If encryption is not used, analyze the original XML document directly). This applies to various XML-based authentication and authorization flows, such as SAML Response payloads.</p>
<h3 id="multiple-signedinfo-nodes">Multiple SignedInfo Nodes</h3>
<p>There should not be more than one SignedInfo node inside a Signature. If you find multiple SignedInfo nodes, it could indicate an attack.</p>
<pre><code class="language-xml">&lt;Signature&gt;
    &lt;SomeNode&gt;
      &lt;SignedInfo&gt;
        &lt;Reference URI="somefakereference"&gt;
          &lt;DigestValue&gt;forgeddigestvalue&lt;/DigestValue&gt;
        &lt;/Reference&gt;
      &lt;/SignedInfo&gt;
    &lt;/SomeNode&gt;
    &lt;SignedInfo&gt;
        &lt;Reference URI="realsignedreference"&gt;
          &lt;DigestValue&gt;realdigestvalue&lt;/DigestValue&gt;
        &lt;/Reference&gt;
      &lt;/SignedInfo&gt;
    &lt;/SignedInfo&gt;
&lt;/Signature&gt;
</code></pre>
<h3 id="code-to-test">Code to test</h3>
<p>Pass in the decrypted version of the document</p>
<pre><code class="language-js">decryptedDocument = ... // yours to implement

// This check is per-Signature node, not per-document
const signedInfoNodes = xpath.select(".//*[local-name(.)='SignedInfo']", signatureNode);

if (signedInfoNodes.length === 0) {
  // Not necessarily a compromise, but invalid. Should contain exactly one SignedInfo node
  // Yours to implement
}

if (signedInfoNodes.length &gt; 1) {
  // Compromise detected, yours to implement
}
</code></pre>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/node-saml/xml-crypto/security/advisories/GHSA-9p8x-f768-wp2g">https://github.com/node-saml/xml-crypto/security/advisories/GHSA-9p8x-f768-wp2g</a></li>
<li><a href="https://github.com/node-saml/xml-crypto/commit/28f92218ecbb8dcbd238afa4efbbd50302aa9aed">https://github.com/node-saml/xml-crypto/commit/28f92218ecbb8dcbd238afa4efbbd50302aa9aed</a></li>
<li><a href="https://github.com/node-saml/xml-crypto/commit/886dc63a8b4bb5ae1db9f41c7854b171eb83aa98">https://github.com/node-saml/xml-crypto/commit/886dc63a8b4bb5ae1db9f41c7854b171eb83aa98</a></li>
<li><a href="https://github.com/node-saml/xml-crypto/commit/8ac6118ee7978b46aa56b82cbcaa5fca58c93a07">https://github.com/node-saml/xml-crypto/commit/8ac6118ee7978b46aa56b82cbcaa5fca58c93a07</a></li>
<li><a href="https://github.com/node-saml/xml-crypto/releases/tag/v2.1.6">https://github.com/node-saml/xml-crypto/releases/tag/v2.1.6</a></li>
<li><a href="https://github.com/node-saml/xml-crypto/releases/tag/v3.2.1">https://github.com/node-saml/xml-crypto/releases/tag/v3.2.1</a></li>
<li><a href="https://github.com/node-saml/xml-crypto/releases/tag/v6.0.1">https://github.com/node-saml/xml-crypto/releases/tag/v6.0.1</a></li>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2025-29774">https://nvd.nist.gov/vuln/detail/CVE-2025-29774</a></li>
<li><a href="https://github.com/advisories/GHSA-9p8x-f768-wp2g">https://github.com/advisories/GHSA-9p8x-f768-wp2g</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-9p8x-f768-wp2g</uri>
        </author>
        <category label="severity" term="CRITICAL"/>
        <published>2025-03-14T17:14:23.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[xml-crypto] xml-crypto Vulnerable to XML Signature Verification Bypass via Multiple SignedInfo References]]></title>
        <id>https://github.com/advisories/GHSA-9p8x-f768-wp2g</id>
        <link href="https://github.com/advisories/GHSA-9p8x-f768-wp2g"/>
        <updated>2025-03-14T20:24:08.000Z</updated>
        <content type="html"><![CDATA[<h1 id="impact">Impact</h1>
<p>An attacker may be able to exploit this vulnerability to bypass authentication or authorization mechanisms in systems that rely on xml-crypto for verifying signed XML documents. The vulnerability allows an attacker to modify a valid signed XML message in a way that still passes signature verification checks. For example, it could be used to alter critical identity or access control attributes, enabling an attacker with a valid account to escalate privileges or impersonate another user.</p>
<h1 id="patches">Patches</h1>
<p>All versions &lt;= 6.0.0 are affected. Please upgrade to version 6.0.1.</p>
<p>If you are still using v2.x or v3.x please upgrade to the associated patch version.</p>
<h1 id="indicators-of-compromise">Indicators of Compromise</h1>
<p>When logging XML payloads, check for the following indicators. If the payload includes encrypted elements, ensure you analyze the decrypted version for a complete assessment. (If encryption is not used, analyze the original XML document directly). This applies to various XML-based authentication and authorization flows, such as SAML Response payloads.</p>
<h3 id="multiple-signedinfo-nodes">Multiple SignedInfo Nodes</h3>
<p>There should not be more than one SignedInfo node inside a Signature. If you find multiple SignedInfo nodes, it could indicate an attack.</p>
<pre><code class="language-xml">&lt;Signature&gt;
    &lt;SomeNode&gt;
      &lt;SignedInfo&gt;
        &lt;Reference URI="somefakereference"&gt;
          &lt;DigestValue&gt;forgeddigestvalue&lt;/DigestValue&gt;
        &lt;/Reference&gt;
      &lt;/SignedInfo&gt;
    &lt;/SomeNode&gt;
    &lt;SignedInfo&gt;
        &lt;Reference URI="realsignedreference"&gt;
          &lt;DigestValue&gt;realdigestvalue&lt;/DigestValue&gt;
        &lt;/Reference&gt;
      &lt;/SignedInfo&gt;
    &lt;/SignedInfo&gt;
&lt;/Signature&gt;
</code></pre>
<h3 id="code-to-test">Code to test</h3>
<p>Pass in the decrypted version of the document</p>
<pre><code class="language-js">decryptedDocument = ... // yours to implement

// This check is per-Signature node, not per-document
const signedInfoNodes = xpath.select(".//*[local-name(.)='SignedInfo']", signatureNode);

if (signedInfoNodes.length === 0) {
  // Not necessarily a compromise, but invalid. Should contain exactly one SignedInfo node
  // Yours to implement
}

if (signedInfoNodes.length &gt; 1) {
  // Compromise detected, yours to implement
}
</code></pre>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/node-saml/xml-crypto/security/advisories/GHSA-9p8x-f768-wp2g">https://github.com/node-saml/xml-crypto/security/advisories/GHSA-9p8x-f768-wp2g</a></li>
<li><a href="https://github.com/node-saml/xml-crypto/commit/28f92218ecbb8dcbd238afa4efbbd50302aa9aed">https://github.com/node-saml/xml-crypto/commit/28f92218ecbb8dcbd238afa4efbbd50302aa9aed</a></li>
<li><a href="https://github.com/node-saml/xml-crypto/commit/886dc63a8b4bb5ae1db9f41c7854b171eb83aa98">https://github.com/node-saml/xml-crypto/commit/886dc63a8b4bb5ae1db9f41c7854b171eb83aa98</a></li>
<li><a href="https://github.com/node-saml/xml-crypto/commit/8ac6118ee7978b46aa56b82cbcaa5fca58c93a07">https://github.com/node-saml/xml-crypto/commit/8ac6118ee7978b46aa56b82cbcaa5fca58c93a07</a></li>
<li><a href="https://github.com/node-saml/xml-crypto/releases/tag/v2.1.6">https://github.com/node-saml/xml-crypto/releases/tag/v2.1.6</a></li>
<li><a href="https://github.com/node-saml/xml-crypto/releases/tag/v3.2.1">https://github.com/node-saml/xml-crypto/releases/tag/v3.2.1</a></li>
<li><a href="https://github.com/node-saml/xml-crypto/releases/tag/v6.0.1">https://github.com/node-saml/xml-crypto/releases/tag/v6.0.1</a></li>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2025-29774">https://nvd.nist.gov/vuln/detail/CVE-2025-29774</a></li>
<li><a href="https://github.com/advisories/GHSA-9p8x-f768-wp2g">https://github.com/advisories/GHSA-9p8x-f768-wp2g</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-9p8x-f768-wp2g</uri>
        </author>
        <category label="severity" term="CRITICAL"/>
        <published>2025-03-14T17:14:23.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[xml-crypto] xml-crypto Vulnerable to XML Signature Verification Bypass via Multiple SignedInfo References]]></title>
        <id>https://github.com/advisories/GHSA-9p8x-f768-wp2g</id>
        <link href="https://github.com/advisories/GHSA-9p8x-f768-wp2g"/>
        <updated>2025-03-14T20:24:08.000Z</updated>
        <content type="html"><![CDATA[<h1 id="impact">Impact</h1>
<p>An attacker may be able to exploit this vulnerability to bypass authentication or authorization mechanisms in systems that rely on xml-crypto for verifying signed XML documents. The vulnerability allows an attacker to modify a valid signed XML message in a way that still passes signature verification checks. For example, it could be used to alter critical identity or access control attributes, enabling an attacker with a valid account to escalate privileges or impersonate another user.</p>
<h1 id="patches">Patches</h1>
<p>All versions &lt;= 6.0.0 are affected. Please upgrade to version 6.0.1.</p>
<p>If you are still using v2.x or v3.x please upgrade to the associated patch version.</p>
<h1 id="indicators-of-compromise">Indicators of Compromise</h1>
<p>When logging XML payloads, check for the following indicators. If the payload includes encrypted elements, ensure you analyze the decrypted version for a complete assessment. (If encryption is not used, analyze the original XML document directly). This applies to various XML-based authentication and authorization flows, such as SAML Response payloads.</p>
<h3 id="multiple-signedinfo-nodes">Multiple SignedInfo Nodes</h3>
<p>There should not be more than one SignedInfo node inside a Signature. If you find multiple SignedInfo nodes, it could indicate an attack.</p>
<pre><code class="language-xml">&lt;Signature&gt;
    &lt;SomeNode&gt;
      &lt;SignedInfo&gt;
        &lt;Reference URI="somefakereference"&gt;
          &lt;DigestValue&gt;forgeddigestvalue&lt;/DigestValue&gt;
        &lt;/Reference&gt;
      &lt;/SignedInfo&gt;
    &lt;/SomeNode&gt;
    &lt;SignedInfo&gt;
        &lt;Reference URI="realsignedreference"&gt;
          &lt;DigestValue&gt;realdigestvalue&lt;/DigestValue&gt;
        &lt;/Reference&gt;
      &lt;/SignedInfo&gt;
    &lt;/SignedInfo&gt;
&lt;/Signature&gt;
</code></pre>
<h3 id="code-to-test">Code to test</h3>
<p>Pass in the decrypted version of the document</p>
<pre><code class="language-js">decryptedDocument = ... // yours to implement

// This check is per-Signature node, not per-document
const signedInfoNodes = xpath.select(".//*[local-name(.)='SignedInfo']", signatureNode);

if (signedInfoNodes.length === 0) {
  // Not necessarily a compromise, but invalid. Should contain exactly one SignedInfo node
  // Yours to implement
}

if (signedInfoNodes.length &gt; 1) {
  // Compromise detected, yours to implement
}
</code></pre>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/node-saml/xml-crypto/security/advisories/GHSA-9p8x-f768-wp2g">https://github.com/node-saml/xml-crypto/security/advisories/GHSA-9p8x-f768-wp2g</a></li>
<li><a href="https://github.com/node-saml/xml-crypto/commit/28f92218ecbb8dcbd238afa4efbbd50302aa9aed">https://github.com/node-saml/xml-crypto/commit/28f92218ecbb8dcbd238afa4efbbd50302aa9aed</a></li>
<li><a href="https://github.com/node-saml/xml-crypto/commit/886dc63a8b4bb5ae1db9f41c7854b171eb83aa98">https://github.com/node-saml/xml-crypto/commit/886dc63a8b4bb5ae1db9f41c7854b171eb83aa98</a></li>
<li><a href="https://github.com/node-saml/xml-crypto/commit/8ac6118ee7978b46aa56b82cbcaa5fca58c93a07">https://github.com/node-saml/xml-crypto/commit/8ac6118ee7978b46aa56b82cbcaa5fca58c93a07</a></li>
<li><a href="https://github.com/node-saml/xml-crypto/releases/tag/v2.1.6">https://github.com/node-saml/xml-crypto/releases/tag/v2.1.6</a></li>
<li><a href="https://github.com/node-saml/xml-crypto/releases/tag/v3.2.1">https://github.com/node-saml/xml-crypto/releases/tag/v3.2.1</a></li>
<li><a href="https://github.com/node-saml/xml-crypto/releases/tag/v6.0.1">https://github.com/node-saml/xml-crypto/releases/tag/v6.0.1</a></li>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2025-29774">https://nvd.nist.gov/vuln/detail/CVE-2025-29774</a></li>
<li><a href="https://github.com/advisories/GHSA-9p8x-f768-wp2g">https://github.com/advisories/GHSA-9p8x-f768-wp2g</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-9p8x-f768-wp2g</uri>
        </author>
        <category label="severity" term="CRITICAL"/>
        <published>2025-03-14T17:14:23.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[froala-editor] Froala Editor Cross-site Scripting vulnerability]]></title>
        <id>https://github.com/advisories/GHSA-hvpq-7vcc-5hj5</id>
        <link href="https://github.com/advisories/GHSA-hvpq-7vcc-5hj5"/>
        <updated>2025-03-14T14:50:14.000Z</updated>
        <content type="html"><![CDATA[<p>Froala Editor v4.0.1 to v4.1.1 was discovered to contain a cross-site scripting (XSS) vulnerability.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2023-41592">https://nvd.nist.gov/vuln/detail/CVE-2023-41592</a></li>
<li><a href="https://github.com/froala/wysiwyg-editor/issues/4612#issuecomment-1729818089">https://github.com/froala/wysiwyg-editor/issues/4612#issuecomment-1729818089</a></li>
<li><a href="https://froala.com/wysiwyg-editor/changelog/#4.1.4">https://froala.com/wysiwyg-editor/changelog/#4.1.4</a></li>
<li><a href="https://hacker.soarescorp.com/cve/2023-41592">https://hacker.soarescorp.com/cve/2023-41592</a></li>
<li><a href="https://owasp.org/Top10/A03_2021-Injection">https://owasp.org/Top10/A03_2021-Injection</a></li>
<li><a href="https://owasp.org/www-project-top-ten">https://owasp.org/www-project-top-ten</a></li>
<li><a href="https://github.com/advisories/GHSA-hvpq-7vcc-5hj5">https://github.com/advisories/GHSA-hvpq-7vcc-5hj5</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-hvpq-7vcc-5hj5</uri>
        </author>
        <category label="severity" term="MODERATE"/>
        <published>2023-09-15T00:30:29.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[flowise] Flowise Pre-auth Arbitrary File Upload]]></title>
        <id>https://github.com/advisories/GHSA-h42x-xx2q-6v6g</id>
        <link href="https://github.com/advisories/GHSA-h42x-xx2q-6v6g"/>
        <updated>2025-03-13T22:38:03.000Z</updated>
        <content type="html"><![CDATA[<h2 id="summary">Summary</h2>
<p>An unauthorized attacker can leverage the whitelisted route <code>/api/v1/attachments</code> to upload arbitrary files when the <code>storageType</code> is set to <strong>local</strong> (default).</p>
<h2 id="details">Details</h2>
<p>When a new request arrives, the system first checks if the URL starts with <code>/api/v1/</code>. If it does, the system then verifies whether the URL is included in the whitelist (<em>whitelistURLs</em>). If the URL is whitelisted, the request proceeds; otherwise, the system enforces authentication.</p>
<p>@ <em>/packages/server/src/index.ts</em></p>
<pre><code class="language-typescript">           this.app.use(async (req, res, next) =&gt; {
                // Step 1: Check if the req path contains /api/v1 regardless of case
                if (URL_CASE_INSENSITIVE_REGEX.test(req.path)) {
                    // Step 2: Check if the req path is case sensitive
                    if (URL_CASE_SENSITIVE_REGEX.test(req.path)) {
                        // Step 3: Check if the req path is in the whitelist
                        const isWhitelisted = whitelistURLs.some((url) =&gt; req.path.startsWith(url))
                        if (isWhitelisted) {
                            next()
                        } else if (req.headers['x-request-from'] === 'internal') {
                            basicAuthMiddleware(req, res, next)
                        } else {
                            const isKeyValidated = await validateAPIKey(req)
                            if (!isKeyValidated) {
                                return res.status(401).json({ error: 'Unauthorized Access' })
                            }
                            next()
                        }
                    } else {
                        return res.status(401).json({ error: 'Unauthorized Access' })
                    }
                } else {
                    // If the req path does not contain /api/v1, then allow the request to pass through, example: /assets, /canvas
                    next()
                }
            }
</code></pre>
<p><strong>The whitelist is defined as follows</strong></p>
<pre><code class="language-typescript">export const WHITELIST_URLS = [
    '/api/v1/verify/apikey/',
    '/api/v1/chatflows/apikey/',
    '/api/v1/public-chatflows',
    '/api/v1/public-chatbotConfig',
    '/api/v1/prediction/',
    '/api/v1/vector/upsert/',
    '/api/v1/node-icon/',
    '/api/v1/components-credentials-icon/',
    '/api/v1/chatflows-streaming',
    '/api/v1/chatflows-uploads',
    '/api/v1/openai-assistants-file/download',
    '/api/v1/feedback',
    '/api/v1/leads',
    '/api/v1/get-upload-file',
    '/api/v1/ip',
    '/api/v1/ping',
    '/api/v1/version',
    '/api/v1/attachments',
    '/api/v1/metrics'
]
</code></pre>
<p>This means that every route in the whitelist does not require authentication. Now, let's examine the <code>/api/v1/attachments</code> route.</p>
<p>@ <em>/packages/server/src/routes/attachments/index.ts</em></p>
<pre><code class="language-typescript">const router = express.Router()
// CREATE
router.post('/:chatflowId/:chatId', getMulterStorage().array('files'), attachmentsController.createAttachment)
export default router
</code></pre>
<p>After several calls, the request reaches the <code>createFileAttachment</code> function @ (<em>packages/server/src/utils/createAttachment.ts</em>)
Initially, the function retrieves <em>chatflowid</em> and <em>chatId</em> from the request without any additional validation. The only check performed is whether these parameters exist in the request.</p>
<pre><code class="language-typescript">    const chatflowid = req.params.chatflowId
    if (!chatflowid) {
        throw new Error(
            'Params chatflowId is required! Please provide chatflowId and chatId in the URL: /api/v1/attachments/:chatflowId/:chatId'
        )
    }

    const chatId = req.params.chatId
    if (!chatId) {
        throw new Error(
            'Params chatId is required! Please provide chatflowId and chatId in the URL: /api/v1/attachments/:chatflowId/:chatId'
        )
    }
</code></pre>
<p>Next, the function retrieves the uploaded files and attempts to add them to the storage by calling the <code>addArrayFilesToStorage</code> function.</p>
<pre><code class="language-typescript">const files = (req.files as Express.Multer.File[]) || []
    const fileAttachments = []
    if (files.length) {
        // ...
        for (const file of files) {
            const fileBuffer = await getFileFromUpload(file.path ?? file.key)  // get the uploaded file
            const fileNames: string[] = []
            file.originalname = Buffer.from(file.originalname, 'latin1').toString('utf8')
            // add it to the storage
            const storagePath = await addArrayFilesToStorage(file.mimetype, 
                                                             fileBuffer,
                                                             file.originalname,
                                                             fileNames,
                                                             chatflowid, chatId) // add it to the storage

            // ...

            await removeSpecificFileFromUpload(file.path ?? file.key) // delete from tmp
           //  ...

                fileAttachments.push({
                    name: file.originalname,
                    mimeType: file.mimetype,
                    size: file.size,
                    content
                })
            } catch (error) {
                throw new Error(`Failed operation: createFileAttachment - ${getErrorMessage(error)}`)
            }
        }
    }

    return fileAttachments
</code></pre>
<p>Now lets take a look at <code>addArrayFilesToStorage</code> function @ (<em>/packages/components/src/storageUtils.ts</em>)</p>
<pre><code class="language-typescript">export const addArrayFilesToStorage = async (mime: string, bf: Buffer, fileName: string, fileNames: string[], ...paths: string[]) =&gt; {
    const storageType = getStorageType()

    const sanitizedFilename = _sanitizeFilename(fileName)
    if (storageType === 's3') {
      // ...
    } else {
        const dir = path.join(getStoragePath(), ...paths) // PATH TRAVERSAL.
        if (!fs.existsSync(dir)) {
            fs.mkdirSync(dir, { recursive: true })
        }
        const filePath = path.join(dir, sanitizedFilename)
        fs.writeFileSync(filePath, bf)
        fileNames.push(sanitizedFilename)
        return 'FILE-STORAGE::' + JSON.stringify(fileNames)
    }
}
</code></pre>
<p>As noted in the comment, to construct the directory, the function joins the output of the <code>getStoragePath</code> function with <code>...paths</code>, which are essentially the <code>chatflowid</code> and <code>chatId</code> extracted earlier from the request.
However, as mentioned previously, these values are not validated to ensure they are UUIDs or numbers. As a result, an attacker could manipulate these variables to set the <strong>dir</strong> variable to any value.
Combined with the fact that the filename is also provided by the user, this leads to <strong>unauthenticated arbitrary file upload</strong>.</p>
<h2 id="poc">POC</h2>
<p>This is the a HTTP request. As observed, we are not authenticated, and by manipulating the <code>chatId</code> parameter, we can perform a path traversal. In this example, we overwrite the <code>api.json</code> file, which contains the API keys for the system.</p>
<p><img alt="File Uplaod Vulnerability." src="https://lh3.googleusercontent.com/d/1zcr-MSJUnRbGRmnoD_meo5uh8Hf8FaEK"></p>
<blockquote>
<p>in this example, the <strong>dir</strong> variable will be</p>
</blockquote>
<pre><code class="language-typescript">var dir = '/root/.flowise/storage/test/../../../../../../../../root/.flowise/'
</code></pre>
<blockquote>
<p>and the file name is <code>api.json</code></p>
</blockquote>
<p>And the API Keys in the UI</p>
<p><img alt="File Uplaod Vulnerability." src="https://lh3.googleusercontent.com/d/1Y0jl8uQuzpp0EFyUzCItifiG5UW35hhV"></p>
<h3 id="impact">Impact</h3>
<p>This vulnerability could potentially lead to</p>
<ul>
<li>Remote Code Execution</li>
<li>Server Takeover</li>
<li>Data Theft
And more</li>
</ul>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/FlowiseAI/Flowise/security/advisories/GHSA-h42x-xx2q-6v6g">https://github.com/FlowiseAI/Flowise/security/advisories/GHSA-h42x-xx2q-6v6g</a></li>
<li><a href="https://github.com/FlowiseAI/Flowise/commit/c2b830f279e454e8b758da441016b2234f220ac7">https://github.com/FlowiseAI/Flowise/commit/c2b830f279e454e8b758da441016b2234f220ac7</a></li>
<li><a href="https://github.com/advisories/GHSA-h42x-xx2q-6v6g">https://github.com/advisories/GHSA-h42x-xx2q-6v6g</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-h42x-xx2q-6v6g</uri>
        </author>
        <category label="severity" term="CRITICAL"/>
        <published>2025-03-13T22:38:03.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[canvg] canvg Prototype Pollution vulnerability]]></title>
        <id>https://github.com/advisories/GHSA-v2mw-5mch-w8c5</id>
        <link href="https://github.com/advisories/GHSA-v2mw-5mch-w8c5"/>
        <updated>2025-03-13T14:09:32.000Z</updated>
        <content type="html"><![CDATA[<p>An issue in canvg v.4.0.2 can lead to prototype pollution via the Constructor of the class StyleElement.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2025-25977">https://nvd.nist.gov/vuln/detail/CVE-2025-25977</a></li>
<li><a href="https://github.com/canvg/canvg/issues/1749">https://github.com/canvg/canvg/issues/1749</a></li>
<li><a href="https://github.com/canvg/canvg/blob/937668eced93e0335c67a255d0d2277ea708b2cb/src/Document/StyleElement.ts">https://github.com/canvg/canvg/blob/937668eced93e0335c67a255d0d2277ea708b2cb/src/Document/StyleElement.ts</a></li>
<li><a href="https://github.com/canvg/canvg/commit/c3743e6345f3e01aefdcdd412c3f26494f4b5d7d">https://github.com/canvg/canvg/commit/c3743e6345f3e01aefdcdd412c3f26494f4b5d7d</a></li>
<li><a href="https://github.com/advisories/GHSA-v2mw-5mch-w8c5">https://github.com/advisories/GHSA-v2mw-5mch-w8c5</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-v2mw-5mch-w8c5</uri>
        </author>
        <category label="severity" term="HIGH"/>
        <published>2025-03-10T18:31:56.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[@mockoon/cli] Mockoon has a Path Traversal and LFI in the static file serving endpoint]]></title>
        <id>https://github.com/advisories/GHSA-w7f9-wqc4-3wxr</id>
        <link href="https://github.com/advisories/GHSA-w7f9-wqc4-3wxr"/>
        <updated>2025-03-12T14:45:14.000Z</updated>
        <content type="html"><![CDATA[<h3 id="summary">Summary</h3>
<p>A mock API configuration for static file serving following the same approach presented in the <a href="https://mockoon.com/tutorials/create-endpoint-serving-static-file/">documentation page</a>, where the server filename is generated via templating features from user input is vulnerable to Path Traversal and LFI, allowing an attacker to get any file in the mock server filesystem.
The issue may be particularly relevant in cloud hosted server instances</p>
<h3 id="details">Details</h3>
<p>In <code>sendFileWithCallback</code>(<a href="https://github.com/mockoon/mockoon/blob/1ed31c4059d7f757f6cb2a43e10dc81b0d9c55a9/packages/commons-server/src/libs/server/server.ts#L1400">code</a>) and <code>sendFile</code>(<a href="https://github.com/mockoon/mockoon/blob/1ed31c4059d7f757f6cb2a43e10dc81b0d9c55a9/packages/commons-server/src/libs/server/server.ts#L1551">code</a>) the <code>filePath</code> variable is parsed using <code>TemplateParser</code></p>
<pre><code class="language-js">let filePath = TemplateParser({
        shouldOmitDataHelper: false,
        // replace backslashes with forward slashes, but not if followed by a dot (to allow helpers with paths containing properties with dots: e.g. {{queryParam 'path.prop\.with\.dots'}})
        content: routeResponse.filePath.replace(/\\(?!\.)/g, '/'),
        environment: this.environment,
        processedDatabuckets: this.processedDatabuckets,
        globalVariables: this.globalVariables,
        request: serverRequest,
        envVarsPrefix: this.options.envVarsPrefix
      });
</code></pre>
<p>The path extracted from the request parameters used when composing the final file path is not sanitized and is vulnerable to path traversal exploits (e.g. <code>../../../../../etc/passwd</code>)</p>
<h3 id="poc">PoC</h3>
<h4 id="test-setup">Test setup</h4>
<p>The issue has been tested with <code>mockoon-cli</code>, using the Docker image <code>mockoon/cli:latest</code></p>
<p><a href="https://github.com/user-attachments/files/18199899/config.json">config.json</a></p>
<pre><code class="language-bash"># Folder setup
mkdir mockoon-test
cd mockoon-test

# put config.json in mockooon-test dir

mkdir static
</code></pre>
<pre><code class="language-bash"># Run container
docker run -d --mount type=bind,source=./config.json,target=/data,readonly -v ./static:/static -p 3000:3000 mockoon/cli:latest -d data -p 3000
</code></pre>
<h4 id="payload-to-reproduce">Payload to reproduce</h4>
<p>Browsing directly to <code>http://localhost:3000/static/%2F..%2F..%2F..%2F..%2F..%2Fetc%2Fpasswd</code> is going to display the <code>/etc/passwd</code> file in the container filesystem</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/mockoon/mockoon/security/advisories/GHSA-w7f9-wqc4-3wxr">https://github.com/mockoon/mockoon/security/advisories/GHSA-w7f9-wqc4-3wxr</a></li>
<li><a href="https://github.com/mockoon/mockoon/commit/c7f6e23e87dc3b8cc44e5802af046200a797bd2e">https://github.com/mockoon/mockoon/commit/c7f6e23e87dc3b8cc44e5802af046200a797bd2e</a></li>
<li><a href="https://github.com/mockoon/mockoon/blob/1ed31c4059d7f757f6cb2a43e10dc81b0d9c55a9/packages/commons-server/src/libs/server/server.ts#L1400">https://github.com/mockoon/mockoon/blob/1ed31c4059d7f757f6cb2a43e10dc81b0d9c55a9/packages/commons-server/src/libs/server/server.ts#L1400</a></li>
<li><a href="https://github.com/mockoon/mockoon/blob/1ed31c4059d7f757f6cb2a43e10dc81b0d9c55a9/packages/commons-server/src/libs/server/server.ts#L1551">https://github.com/mockoon/mockoon/blob/1ed31c4059d7f757f6cb2a43e10dc81b0d9c55a9/packages/commons-server/src/libs/server/server.ts#L1551</a></li>
<li><a href="https://github.com/advisories/GHSA-w7f9-wqc4-3wxr">https://github.com/advisories/GHSA-w7f9-wqc4-3wxr</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-w7f9-wqc4-3wxr</uri>
        </author>
        <category label="severity" term="HIGH"/>
        <published>2025-03-11T16:17:42.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[@mockoon/commons-server] Mockoon has a Path Traversal and LFI in the static file serving endpoint]]></title>
        <id>https://github.com/advisories/GHSA-w7f9-wqc4-3wxr</id>
        <link href="https://github.com/advisories/GHSA-w7f9-wqc4-3wxr"/>
        <updated>2025-03-12T14:45:14.000Z</updated>
        <content type="html"><![CDATA[<h3 id="summary">Summary</h3>
<p>A mock API configuration for static file serving following the same approach presented in the <a href="https://mockoon.com/tutorials/create-endpoint-serving-static-file/">documentation page</a>, where the server filename is generated via templating features from user input is vulnerable to Path Traversal and LFI, allowing an attacker to get any file in the mock server filesystem.
The issue may be particularly relevant in cloud hosted server instances</p>
<h3 id="details">Details</h3>
<p>In <code>sendFileWithCallback</code>(<a href="https://github.com/mockoon/mockoon/blob/1ed31c4059d7f757f6cb2a43e10dc81b0d9c55a9/packages/commons-server/src/libs/server/server.ts#L1400">code</a>) and <code>sendFile</code>(<a href="https://github.com/mockoon/mockoon/blob/1ed31c4059d7f757f6cb2a43e10dc81b0d9c55a9/packages/commons-server/src/libs/server/server.ts#L1551">code</a>) the <code>filePath</code> variable is parsed using <code>TemplateParser</code></p>
<pre><code class="language-js">let filePath = TemplateParser({
        shouldOmitDataHelper: false,
        // replace backslashes with forward slashes, but not if followed by a dot (to allow helpers with paths containing properties with dots: e.g. {{queryParam 'path.prop\.with\.dots'}})
        content: routeResponse.filePath.replace(/\\(?!\.)/g, '/'),
        environment: this.environment,
        processedDatabuckets: this.processedDatabuckets,
        globalVariables: this.globalVariables,
        request: serverRequest,
        envVarsPrefix: this.options.envVarsPrefix
      });
</code></pre>
<p>The path extracted from the request parameters used when composing the final file path is not sanitized and is vulnerable to path traversal exploits (e.g. <code>../../../../../etc/passwd</code>)</p>
<h3 id="poc">PoC</h3>
<h4 id="test-setup">Test setup</h4>
<p>The issue has been tested with <code>mockoon-cli</code>, using the Docker image <code>mockoon/cli:latest</code></p>
<p><a href="https://github.com/user-attachments/files/18199899/config.json">config.json</a></p>
<pre><code class="language-bash"># Folder setup
mkdir mockoon-test
cd mockoon-test

# put config.json in mockooon-test dir

mkdir static
</code></pre>
<pre><code class="language-bash"># Run container
docker run -d --mount type=bind,source=./config.json,target=/data,readonly -v ./static:/static -p 3000:3000 mockoon/cli:latest -d data -p 3000
</code></pre>
<h4 id="payload-to-reproduce">Payload to reproduce</h4>
<p>Browsing directly to <code>http://localhost:3000/static/%2F..%2F..%2F..%2F..%2F..%2Fetc%2Fpasswd</code> is going to display the <code>/etc/passwd</code> file in the container filesystem</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/mockoon/mockoon/security/advisories/GHSA-w7f9-wqc4-3wxr">https://github.com/mockoon/mockoon/security/advisories/GHSA-w7f9-wqc4-3wxr</a></li>
<li><a href="https://github.com/mockoon/mockoon/commit/c7f6e23e87dc3b8cc44e5802af046200a797bd2e">https://github.com/mockoon/mockoon/commit/c7f6e23e87dc3b8cc44e5802af046200a797bd2e</a></li>
<li><a href="https://github.com/mockoon/mockoon/blob/1ed31c4059d7f757f6cb2a43e10dc81b0d9c55a9/packages/commons-server/src/libs/server/server.ts#L1400">https://github.com/mockoon/mockoon/blob/1ed31c4059d7f757f6cb2a43e10dc81b0d9c55a9/packages/commons-server/src/libs/server/server.ts#L1400</a></li>
<li><a href="https://github.com/mockoon/mockoon/blob/1ed31c4059d7f757f6cb2a43e10dc81b0d9c55a9/packages/commons-server/src/libs/server/server.ts#L1551">https://github.com/mockoon/mockoon/blob/1ed31c4059d7f757f6cb2a43e10dc81b0d9c55a9/packages/commons-server/src/libs/server/server.ts#L1551</a></li>
<li><a href="https://github.com/advisories/GHSA-w7f9-wqc4-3wxr">https://github.com/advisories/GHSA-w7f9-wqc4-3wxr</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-w7f9-wqc4-3wxr</uri>
        </author>
        <category label="severity" term="HIGH"/>
        <published>2025-03-11T16:17:42.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[@babel/runtime-corejs3] Babel has inefficient RexExp complexity in generated code with .replace when transpiling named capturing groups]]></title>
        <id>https://github.com/advisories/GHSA-968p-4wvh-cqc8</id>
        <link href="https://github.com/advisories/GHSA-968p-4wvh-cqc8"/>
        <updated>2025-03-12T14:48:10.000Z</updated>
        <content type="html"><![CDATA[<h3 id="impact">Impact</h3>
<p>When using Babel to compile <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Regular_expressions/Named_capturing_group">regular expression named capturing groups</a>, Babel will generate a polyfill for the <code>.replace</code> method that has quadratic complexity on some specific replacement pattern strings (i.e. the second argument passed to <code>.replace</code>).</p>
<p>Your generated code is vulnerable if <em>all</em> the following conditions are true:</p>
<ul>
<li>You use Babel to compile <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Regular_expressions/Named_capturing_group">regular expression named capturing groups</a></li>
<li>You use the <code>.replace</code> method on a regular expression that contains named capturing groups</li>
<li><strong>Your code uses untrusted strings as the second argument of <code>.replace</code></strong></li>
</ul>
<p>If you are using <code>@babel/preset-env</code> with the <a href="https://babeljs.io/docs/options#targets"><code>targets</code></a> option, the transform that injects the vulnerable code is automatically enabled if:</p>
<ul>
<li>you use <a href="https://github.com/tc39/proposal-duplicate-named-capturing-groups"><em>duplicated</em> named capturing groups</a>, and target any browser older than Chrome/Edge 126, Opera 112, Firefox 129, Safari 17.4, or Node.js 23</li>
<li>you use any <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Regular_expressions/Named_capturing_group">named capturing groups</a>, and target any browser older than Chrome 64, Opera 71, Edge 79, Firefox 78, Safari 11.1, or Node.js 10</li>
</ul>
<p>You can verify what transforms <code>@babel/preset-env</code> is using by enabling the <a href="https://babeljs.io/docs/babel-preset-env#debug"><code>debug</code> option</a>.</p>
<h3 id="patches">Patches</h3>
<p>This problem has been fixed in <code>@babel/helpers</code> and <code>@babel/runtime</code> 7.26.10 and 8.0.0-alpha.17, please upgrade. It's likely that you do not directly depend on <code>@babel/helpers</code>, and instead you depend on <code>@babel/core</code> (which itself depends on <code>@babel/helpers</code>). Upgrading to <code>@babel/core</code> 7.26.10 is not required, but it guarantees that you are on a new enough <code>@babel/helpers</code> version.</p>
<p>Please note that just updating your Babel dependencies is not enough: you will also need to re-compile your code.</p>
<h3 id="workarounds">Workarounds</h3>
<p>If you are passing user-provided strings as the second argument of <code>.replace</code> on regular expressions that contain named capturing groups, validate the input and make sure it does not contain the substring <code>$&lt;</code> if it's then not followed by <code>&gt;</code> (possibly with other characters in between).</p>
<h3 id="references">References</h3>
<p>This vulnerability was reported and fixed in <a href="https://github.com/babel/babel/pull/17173">https://github.com/babel/babel/pull/17173</a>.</p>
<h3 id="references-1">References</h3>
<ul>
<li><a href="https://github.com/babel/babel/security/advisories/GHSA-968p-4wvh-cqc8">https://github.com/babel/babel/security/advisories/GHSA-968p-4wvh-cqc8</a></li>
<li><a href="https://github.com/babel/babel/pull/17173">https://github.com/babel/babel/pull/17173</a></li>
<li><a href="https://github.com/babel/babel/commit/d5952e80c0faa5ec20e35085531b6e572d31dad4">https://github.com/babel/babel/commit/d5952e80c0faa5ec20e35085531b6e572d31dad4</a></li>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2025-27789">https://nvd.nist.gov/vuln/detail/CVE-2025-27789</a></li>
<li><a href="https://github.com/advisories/GHSA-968p-4wvh-cqc8">https://github.com/advisories/GHSA-968p-4wvh-cqc8</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-968p-4wvh-cqc8</uri>
        </author>
        <category label="severity" term="MODERATE"/>
        <published>2025-03-11T20:30:18.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[@babel/runtime-corejs2] Babel has inefficient RexExp complexity in generated code with .replace when transpiling named capturing groups]]></title>
        <id>https://github.com/advisories/GHSA-968p-4wvh-cqc8</id>
        <link href="https://github.com/advisories/GHSA-968p-4wvh-cqc8"/>
        <updated>2025-03-12T14:48:10.000Z</updated>
        <content type="html"><![CDATA[<h3 id="impact">Impact</h3>
<p>When using Babel to compile <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Regular_expressions/Named_capturing_group">regular expression named capturing groups</a>, Babel will generate a polyfill for the <code>.replace</code> method that has quadratic complexity on some specific replacement pattern strings (i.e. the second argument passed to <code>.replace</code>).</p>
<p>Your generated code is vulnerable if <em>all</em> the following conditions are true:</p>
<ul>
<li>You use Babel to compile <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Regular_expressions/Named_capturing_group">regular expression named capturing groups</a></li>
<li>You use the <code>.replace</code> method on a regular expression that contains named capturing groups</li>
<li><strong>Your code uses untrusted strings as the second argument of <code>.replace</code></strong></li>
</ul>
<p>If you are using <code>@babel/preset-env</code> with the <a href="https://babeljs.io/docs/options#targets"><code>targets</code></a> option, the transform that injects the vulnerable code is automatically enabled if:</p>
<ul>
<li>you use <a href="https://github.com/tc39/proposal-duplicate-named-capturing-groups"><em>duplicated</em> named capturing groups</a>, and target any browser older than Chrome/Edge 126, Opera 112, Firefox 129, Safari 17.4, or Node.js 23</li>
<li>you use any <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Regular_expressions/Named_capturing_group">named capturing groups</a>, and target any browser older than Chrome 64, Opera 71, Edge 79, Firefox 78, Safari 11.1, or Node.js 10</li>
</ul>
<p>You can verify what transforms <code>@babel/preset-env</code> is using by enabling the <a href="https://babeljs.io/docs/babel-preset-env#debug"><code>debug</code> option</a>.</p>
<h3 id="patches">Patches</h3>
<p>This problem has been fixed in <code>@babel/helpers</code> and <code>@babel/runtime</code> 7.26.10 and 8.0.0-alpha.17, please upgrade. It's likely that you do not directly depend on <code>@babel/helpers</code>, and instead you depend on <code>@babel/core</code> (which itself depends on <code>@babel/helpers</code>). Upgrading to <code>@babel/core</code> 7.26.10 is not required, but it guarantees that you are on a new enough <code>@babel/helpers</code> version.</p>
<p>Please note that just updating your Babel dependencies is not enough: you will also need to re-compile your code.</p>
<h3 id="workarounds">Workarounds</h3>
<p>If you are passing user-provided strings as the second argument of <code>.replace</code> on regular expressions that contain named capturing groups, validate the input and make sure it does not contain the substring <code>$&lt;</code> if it's then not followed by <code>&gt;</code> (possibly with other characters in between).</p>
<h3 id="references">References</h3>
<p>This vulnerability was reported and fixed in <a href="https://github.com/babel/babel/pull/17173">https://github.com/babel/babel/pull/17173</a>.</p>
<h3 id="references-1">References</h3>
<ul>
<li><a href="https://github.com/babel/babel/security/advisories/GHSA-968p-4wvh-cqc8">https://github.com/babel/babel/security/advisories/GHSA-968p-4wvh-cqc8</a></li>
<li><a href="https://github.com/babel/babel/pull/17173">https://github.com/babel/babel/pull/17173</a></li>
<li><a href="https://github.com/babel/babel/commit/d5952e80c0faa5ec20e35085531b6e572d31dad4">https://github.com/babel/babel/commit/d5952e80c0faa5ec20e35085531b6e572d31dad4</a></li>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2025-27789">https://nvd.nist.gov/vuln/detail/CVE-2025-27789</a></li>
<li><a href="https://github.com/advisories/GHSA-968p-4wvh-cqc8">https://github.com/advisories/GHSA-968p-4wvh-cqc8</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-968p-4wvh-cqc8</uri>
        </author>
        <category label="severity" term="MODERATE"/>
        <published>2025-03-11T20:30:18.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[@babel/runtime] Babel has inefficient RexExp complexity in generated code with .replace when transpiling named capturing groups]]></title>
        <id>https://github.com/advisories/GHSA-968p-4wvh-cqc8</id>
        <link href="https://github.com/advisories/GHSA-968p-4wvh-cqc8"/>
        <updated>2025-03-12T14:48:10.000Z</updated>
        <content type="html"><![CDATA[<h3 id="impact">Impact</h3>
<p>When using Babel to compile <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Regular_expressions/Named_capturing_group">regular expression named capturing groups</a>, Babel will generate a polyfill for the <code>.replace</code> method that has quadratic complexity on some specific replacement pattern strings (i.e. the second argument passed to <code>.replace</code>).</p>
<p>Your generated code is vulnerable if <em>all</em> the following conditions are true:</p>
<ul>
<li>You use Babel to compile <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Regular_expressions/Named_capturing_group">regular expression named capturing groups</a></li>
<li>You use the <code>.replace</code> method on a regular expression that contains named capturing groups</li>
<li><strong>Your code uses untrusted strings as the second argument of <code>.replace</code></strong></li>
</ul>
<p>If you are using <code>@babel/preset-env</code> with the <a href="https://babeljs.io/docs/options#targets"><code>targets</code></a> option, the transform that injects the vulnerable code is automatically enabled if:</p>
<ul>
<li>you use <a href="https://github.com/tc39/proposal-duplicate-named-capturing-groups"><em>duplicated</em> named capturing groups</a>, and target any browser older than Chrome/Edge 126, Opera 112, Firefox 129, Safari 17.4, or Node.js 23</li>
<li>you use any <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Regular_expressions/Named_capturing_group">named capturing groups</a>, and target any browser older than Chrome 64, Opera 71, Edge 79, Firefox 78, Safari 11.1, or Node.js 10</li>
</ul>
<p>You can verify what transforms <code>@babel/preset-env</code> is using by enabling the <a href="https://babeljs.io/docs/babel-preset-env#debug"><code>debug</code> option</a>.</p>
<h3 id="patches">Patches</h3>
<p>This problem has been fixed in <code>@babel/helpers</code> and <code>@babel/runtime</code> 7.26.10 and 8.0.0-alpha.17, please upgrade. It's likely that you do not directly depend on <code>@babel/helpers</code>, and instead you depend on <code>@babel/core</code> (which itself depends on <code>@babel/helpers</code>). Upgrading to <code>@babel/core</code> 7.26.10 is not required, but it guarantees that you are on a new enough <code>@babel/helpers</code> version.</p>
<p>Please note that just updating your Babel dependencies is not enough: you will also need to re-compile your code.</p>
<h3 id="workarounds">Workarounds</h3>
<p>If you are passing user-provided strings as the second argument of <code>.replace</code> on regular expressions that contain named capturing groups, validate the input and make sure it does not contain the substring <code>$&lt;</code> if it's then not followed by <code>&gt;</code> (possibly with other characters in between).</p>
<h3 id="references">References</h3>
<p>This vulnerability was reported and fixed in <a href="https://github.com/babel/babel/pull/17173">https://github.com/babel/babel/pull/17173</a>.</p>
<h3 id="references-1">References</h3>
<ul>
<li><a href="https://github.com/babel/babel/security/advisories/GHSA-968p-4wvh-cqc8">https://github.com/babel/babel/security/advisories/GHSA-968p-4wvh-cqc8</a></li>
<li><a href="https://github.com/babel/babel/pull/17173">https://github.com/babel/babel/pull/17173</a></li>
<li><a href="https://github.com/babel/babel/commit/d5952e80c0faa5ec20e35085531b6e572d31dad4">https://github.com/babel/babel/commit/d5952e80c0faa5ec20e35085531b6e572d31dad4</a></li>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2025-27789">https://nvd.nist.gov/vuln/detail/CVE-2025-27789</a></li>
<li><a href="https://github.com/advisories/GHSA-968p-4wvh-cqc8">https://github.com/advisories/GHSA-968p-4wvh-cqc8</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-968p-4wvh-cqc8</uri>
        </author>
        <category label="severity" term="MODERATE"/>
        <published>2025-03-11T20:30:18.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[@babel/helpers] Babel has inefficient RexExp complexity in generated code with .replace when transpiling named capturing groups]]></title>
        <id>https://github.com/advisories/GHSA-968p-4wvh-cqc8</id>
        <link href="https://github.com/advisories/GHSA-968p-4wvh-cqc8"/>
        <updated>2025-03-12T14:48:10.000Z</updated>
        <content type="html"><![CDATA[<h3 id="impact">Impact</h3>
<p>When using Babel to compile <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Regular_expressions/Named_capturing_group">regular expression named capturing groups</a>, Babel will generate a polyfill for the <code>.replace</code> method that has quadratic complexity on some specific replacement pattern strings (i.e. the second argument passed to <code>.replace</code>).</p>
<p>Your generated code is vulnerable if <em>all</em> the following conditions are true:</p>
<ul>
<li>You use Babel to compile <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Regular_expressions/Named_capturing_group">regular expression named capturing groups</a></li>
<li>You use the <code>.replace</code> method on a regular expression that contains named capturing groups</li>
<li><strong>Your code uses untrusted strings as the second argument of <code>.replace</code></strong></li>
</ul>
<p>If you are using <code>@babel/preset-env</code> with the <a href="https://babeljs.io/docs/options#targets"><code>targets</code></a> option, the transform that injects the vulnerable code is automatically enabled if:</p>
<ul>
<li>you use <a href="https://github.com/tc39/proposal-duplicate-named-capturing-groups"><em>duplicated</em> named capturing groups</a>, and target any browser older than Chrome/Edge 126, Opera 112, Firefox 129, Safari 17.4, or Node.js 23</li>
<li>you use any <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Regular_expressions/Named_capturing_group">named capturing groups</a>, and target any browser older than Chrome 64, Opera 71, Edge 79, Firefox 78, Safari 11.1, or Node.js 10</li>
</ul>
<p>You can verify what transforms <code>@babel/preset-env</code> is using by enabling the <a href="https://babeljs.io/docs/babel-preset-env#debug"><code>debug</code> option</a>.</p>
<h3 id="patches">Patches</h3>
<p>This problem has been fixed in <code>@babel/helpers</code> and <code>@babel/runtime</code> 7.26.10 and 8.0.0-alpha.17, please upgrade. It's likely that you do not directly depend on <code>@babel/helpers</code>, and instead you depend on <code>@babel/core</code> (which itself depends on <code>@babel/helpers</code>). Upgrading to <code>@babel/core</code> 7.26.10 is not required, but it guarantees that you are on a new enough <code>@babel/helpers</code> version.</p>
<p>Please note that just updating your Babel dependencies is not enough: you will also need to re-compile your code.</p>
<h3 id="workarounds">Workarounds</h3>
<p>If you are passing user-provided strings as the second argument of <code>.replace</code> on regular expressions that contain named capturing groups, validate the input and make sure it does not contain the substring <code>$&lt;</code> if it's then not followed by <code>&gt;</code> (possibly with other characters in between).</p>
<h3 id="references">References</h3>
<p>This vulnerability was reported and fixed in <a href="https://github.com/babel/babel/pull/17173">https://github.com/babel/babel/pull/17173</a>.</p>
<h3 id="references-1">References</h3>
<ul>
<li><a href="https://github.com/babel/babel/security/advisories/GHSA-968p-4wvh-cqc8">https://github.com/babel/babel/security/advisories/GHSA-968p-4wvh-cqc8</a></li>
<li><a href="https://github.com/babel/babel/pull/17173">https://github.com/babel/babel/pull/17173</a></li>
<li><a href="https://github.com/babel/babel/commit/d5952e80c0faa5ec20e35085531b6e572d31dad4">https://github.com/babel/babel/commit/d5952e80c0faa5ec20e35085531b6e572d31dad4</a></li>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2025-27789">https://nvd.nist.gov/vuln/detail/CVE-2025-27789</a></li>
<li><a href="https://github.com/advisories/GHSA-968p-4wvh-cqc8">https://github.com/advisories/GHSA-968p-4wvh-cqc8</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-968p-4wvh-cqc8</uri>
        </author>
        <category label="severity" term="MODERATE"/>
        <published>2025-03-11T20:30:18.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[@babel/runtime-corejs3] Babel has inefficient RexExp complexity in generated code with .replace when transpiling named capturing groups]]></title>
        <id>https://github.com/advisories/GHSA-968p-4wvh-cqc8</id>
        <link href="https://github.com/advisories/GHSA-968p-4wvh-cqc8"/>
        <updated>2025-03-12T14:48:10.000Z</updated>
        <content type="html"><![CDATA[<h3 id="impact">Impact</h3>
<p>When using Babel to compile <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Regular_expressions/Named_capturing_group">regular expression named capturing groups</a>, Babel will generate a polyfill for the <code>.replace</code> method that has quadratic complexity on some specific replacement pattern strings (i.e. the second argument passed to <code>.replace</code>).</p>
<p>Your generated code is vulnerable if <em>all</em> the following conditions are true:</p>
<ul>
<li>You use Babel to compile <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Regular_expressions/Named_capturing_group">regular expression named capturing groups</a></li>
<li>You use the <code>.replace</code> method on a regular expression that contains named capturing groups</li>
<li><strong>Your code uses untrusted strings as the second argument of <code>.replace</code></strong></li>
</ul>
<p>If you are using <code>@babel/preset-env</code> with the <a href="https://babeljs.io/docs/options#targets"><code>targets</code></a> option, the transform that injects the vulnerable code is automatically enabled if:</p>
<ul>
<li>you use <a href="https://github.com/tc39/proposal-duplicate-named-capturing-groups"><em>duplicated</em> named capturing groups</a>, and target any browser older than Chrome/Edge 126, Opera 112, Firefox 129, Safari 17.4, or Node.js 23</li>
<li>you use any <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Regular_expressions/Named_capturing_group">named capturing groups</a>, and target any browser older than Chrome 64, Opera 71, Edge 79, Firefox 78, Safari 11.1, or Node.js 10</li>
</ul>
<p>You can verify what transforms <code>@babel/preset-env</code> is using by enabling the <a href="https://babeljs.io/docs/babel-preset-env#debug"><code>debug</code> option</a>.</p>
<h3 id="patches">Patches</h3>
<p>This problem has been fixed in <code>@babel/helpers</code> and <code>@babel/runtime</code> 7.26.10 and 8.0.0-alpha.17, please upgrade. It's likely that you do not directly depend on <code>@babel/helpers</code>, and instead you depend on <code>@babel/core</code> (which itself depends on <code>@babel/helpers</code>). Upgrading to <code>@babel/core</code> 7.26.10 is not required, but it guarantees that you are on a new enough <code>@babel/helpers</code> version.</p>
<p>Please note that just updating your Babel dependencies is not enough: you will also need to re-compile your code.</p>
<h3 id="workarounds">Workarounds</h3>
<p>If you are passing user-provided strings as the second argument of <code>.replace</code> on regular expressions that contain named capturing groups, validate the input and make sure it does not contain the substring <code>$&lt;</code> if it's then not followed by <code>&gt;</code> (possibly with other characters in between).</p>
<h3 id="references">References</h3>
<p>This vulnerability was reported and fixed in <a href="https://github.com/babel/babel/pull/17173">https://github.com/babel/babel/pull/17173</a>.</p>
<h3 id="references-1">References</h3>
<ul>
<li><a href="https://github.com/babel/babel/security/advisories/GHSA-968p-4wvh-cqc8">https://github.com/babel/babel/security/advisories/GHSA-968p-4wvh-cqc8</a></li>
<li><a href="https://github.com/babel/babel/pull/17173">https://github.com/babel/babel/pull/17173</a></li>
<li><a href="https://github.com/babel/babel/commit/d5952e80c0faa5ec20e35085531b6e572d31dad4">https://github.com/babel/babel/commit/d5952e80c0faa5ec20e35085531b6e572d31dad4</a></li>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2025-27789">https://nvd.nist.gov/vuln/detail/CVE-2025-27789</a></li>
<li><a href="https://github.com/advisories/GHSA-968p-4wvh-cqc8">https://github.com/advisories/GHSA-968p-4wvh-cqc8</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-968p-4wvh-cqc8</uri>
        </author>
        <category label="severity" term="MODERATE"/>
        <published>2025-03-11T20:30:18.000Z</published>
    </entry>
</feed>