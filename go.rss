<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
    <id>https://azu.github.io/github-advisory-database-rss/go.rss</id>
    <title>Security Advisory for Go modules</title>
    <updated>2024-10-27T05:01:25.011Z</updated>
    <generator>github-advisory-database-rss</generator>
    <link rel="alternate" href="https://github.com/advisories?query=type%3Areviewed+ecosystem%3Ago"/>
    <subtitle>Security Advisory for Go modules on GitHub</subtitle>
    <rights>github-advisory-database-rss</rights>
    <category term="CRITICAL"/>
    <category term="HIGH"/>
    <category term="MODERATE"/>
    <category term="LOW"/>
    <entry>
        <title type="html"><![CDATA[[github.com/ginuerzh/gost] Missing key verification in gost]]></title>
        <id>https://github.com/advisories/GHSA-8wxx-35qc-vp6r</id>
        <link href="https://github.com/advisories/GHSA-8wxx-35qc-vp6r"/>
        <updated>2024-10-25T22:07:26.000Z</updated>
        <content type="html"><![CDATA[<p>An authentication bypass in the SSH service of gost v2.11.5 allows attackers to intercept communications via setting the HostKeyCallback function to ssh.InsecureIgnoreHostKey</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2024-39223">https://nvd.nist.gov/vuln/detail/CVE-2024-39223</a></li>
<li><a href="https://github.com/ginuerzh/gost/issues/1034">https://github.com/ginuerzh/gost/issues/1034</a></li>
<li><a href="https://gist.github.com/nyxfqq/a7242170b1118e78436a62dee4e09e8a">https://gist.github.com/nyxfqq/a7242170b1118e78436a62dee4e09e8a</a></li>
<li><a href="https://github.com/ginuerzh/gost/blob/729d0e70005607dc7c69fc1de62fd8fe21f85355/ssh.go#L229">https://github.com/ginuerzh/gost/blob/729d0e70005607dc7c69fc1de62fd8fe21f85355/ssh.go#L229</a></li>
<li><a href="https://github.com/advisories/GHSA-8wxx-35qc-vp6r">https://github.com/advisories/GHSA-8wxx-35qc-vp6r</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-8wxx-35qc-vp6r</uri>
        </author>
        <category label="severity" term="CRITICAL"/>
        <published>2024-07-03T18:48:20.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[github.com/libp2p/go-libp2p-kad-dht] Content Censorship in the InterPlanetary File System (IPFS) via Kademlia DHT abuse]]></title>
        <id>https://github.com/advisories/GHSA-mqr9-hjr8-2m9w</id>
        <link href="https://github.com/advisories/GHSA-mqr9-hjr8-2m9w"/>
        <updated>2024-10-25T21:35:14.000Z</updated>
        <content type="html"><![CDATA[<p>The Kademlia DHT (go-libp2p-kad-dht 0.20.0 and earlier) used in IPFS (0.18.1 and earlier) assigns routing information for content (i.e., information about who holds the content) to be stored by peers whose peer IDs have a small DHT distance from the content ID. This allows an attacker to censor content by generating many Sybil peers whose peer IDs have a small distance from the content ID, thus hijacking the content resolution process.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2023-26248">https://nvd.nist.gov/vuln/detail/CVE-2023-26248</a></li>
<li><a href="https://arxiv.org/abs/2307.12212">https://arxiv.org/abs/2307.12212</a></li>
<li><a href="https://github.com/libp2p/go-libp2p-kad-dht">https://github.com/libp2p/go-libp2p-kad-dht</a></li>
<li><a href="https://github.com/advisories/GHSA-mqr9-hjr8-2m9w">https://github.com/advisories/GHSA-mqr9-hjr8-2m9w</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-mqr9-hjr8-2m9w</uri>
        </author>
        <category label="severity" term="MODERATE"/>
        <published>2024-10-25T18:30:49.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[github.com/crossplane/crossplane] github.com/crossplane/crossplane: Unexpected behavior from Is methods for IPv4-mapped IPv6 addresses]]></title>
        <id>https://github.com/advisories/GHSA-7h65-4p22-39j6</id>
        <link href="https://github.com/advisories/GHSA-7h65-4p22-39j6"/>
        <updated>2024-10-25T19:42:31.000Z</updated>
        <content type="html"><![CDATA[<p>A critical vulnerability was reported in the versions of golang that Crossplane depends on. Details of the golang vulnerability are included below. Crossplane does not directly use the vulnerable functions from the <code>net/netip</code> package, but the version of golang libraries, runtime, and build tools have still been updated as part of this security advisory nonetheless.</p>
<p><strong>Critical Vulnerabilities</strong>
Vulnerability: <a href="https://nvd.nist.gov/vuln/detail/CVE-2024-24790">CVE-2024-24790</a>, <code>golang: net/netip: Unexpected behavior from Is methods for IPv4-mapped IPv6 addresses</code>
Description: The various Is methods (IsPrivate, IsLoopback, etc) did not work as expected for IPv4-mapped IPv6 addresses, returning false for addresses which would return true in their traditional IPv4 forms.</p>
<p>Affected versions: 1.17.1,1.16.2,1.15.5</p>
<p>See screenshot for more details
<img alt="Screenshot from 2024-09-18 17-36-37" src="https://github.com/user-attachments/assets/2e7ad31f-228a-4534-a4aa-b63d4911351d"></p>
<p>Fixed versions: 1.17.2,1.16.3,1.15.6</p>
<p>Release notes:</p>
<ul>
<li><a href="https://github.com/crossplane/crossplane/releases/tag/v1.17.2">https://github.com/crossplane/crossplane/releases/tag/v1.17.2</a></li>
<li><a href="https://github.com/crossplane/crossplane/releases/tag/v1.16.3">https://github.com/crossplane/crossplane/releases/tag/v1.16.3</a></li>
<li><a href="https://github.com/crossplane/crossplane/releases/tag/v1.15.6">https://github.com/crossplane/crossplane/releases/tag/v1.15.6</a></li>
</ul>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/crossplane/crossplane/security/advisories/GHSA-7h65-4p22-39j6">https://github.com/crossplane/crossplane/security/advisories/GHSA-7h65-4p22-39j6</a></li>
<li><a href="https://github.com/advisories/GHSA-7h65-4p22-39j6">https://github.com/advisories/GHSA-7h65-4p22-39j6</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-7h65-4p22-39j6</uri>
        </author>
        <category label="severity" term="CRITICAL"/>
        <published>2024-10-25T19:42:31.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[github.com/crossplane/crossplane] github.com/crossplane/crossplane: Unexpected behavior from Is methods for IPv4-mapped IPv6 addresses]]></title>
        <id>https://github.com/advisories/GHSA-7h65-4p22-39j6</id>
        <link href="https://github.com/advisories/GHSA-7h65-4p22-39j6"/>
        <updated>2024-10-25T19:42:31.000Z</updated>
        <content type="html"><![CDATA[<p>A critical vulnerability was reported in the versions of golang that Crossplane depends on. Details of the golang vulnerability are included below. Crossplane does not directly use the vulnerable functions from the <code>net/netip</code> package, but the version of golang libraries, runtime, and build tools have still been updated as part of this security advisory nonetheless.</p>
<p><strong>Critical Vulnerabilities</strong>
Vulnerability: <a href="https://nvd.nist.gov/vuln/detail/CVE-2024-24790">CVE-2024-24790</a>, <code>golang: net/netip: Unexpected behavior from Is methods for IPv4-mapped IPv6 addresses</code>
Description: The various Is methods (IsPrivate, IsLoopback, etc) did not work as expected for IPv4-mapped IPv6 addresses, returning false for addresses which would return true in their traditional IPv4 forms.</p>
<p>Affected versions: 1.17.1,1.16.2,1.15.5</p>
<p>See screenshot for more details
<img alt="Screenshot from 2024-09-18 17-36-37" src="https://github.com/user-attachments/assets/2e7ad31f-228a-4534-a4aa-b63d4911351d"></p>
<p>Fixed versions: 1.17.2,1.16.3,1.15.6</p>
<p>Release notes:</p>
<ul>
<li><a href="https://github.com/crossplane/crossplane/releases/tag/v1.17.2">https://github.com/crossplane/crossplane/releases/tag/v1.17.2</a></li>
<li><a href="https://github.com/crossplane/crossplane/releases/tag/v1.16.3">https://github.com/crossplane/crossplane/releases/tag/v1.16.3</a></li>
<li><a href="https://github.com/crossplane/crossplane/releases/tag/v1.15.6">https://github.com/crossplane/crossplane/releases/tag/v1.15.6</a></li>
</ul>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/crossplane/crossplane/security/advisories/GHSA-7h65-4p22-39j6">https://github.com/crossplane/crossplane/security/advisories/GHSA-7h65-4p22-39j6</a></li>
<li><a href="https://github.com/advisories/GHSA-7h65-4p22-39j6">https://github.com/advisories/GHSA-7h65-4p22-39j6</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-7h65-4p22-39j6</uri>
        </author>
        <category label="severity" term="CRITICAL"/>
        <published>2024-10-25T19:42:31.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[github.com/crossplane/crossplane] github.com/crossplane/crossplane: Unexpected behavior from Is methods for IPv4-mapped IPv6 addresses]]></title>
        <id>https://github.com/advisories/GHSA-7h65-4p22-39j6</id>
        <link href="https://github.com/advisories/GHSA-7h65-4p22-39j6"/>
        <updated>2024-10-25T19:42:31.000Z</updated>
        <content type="html"><![CDATA[<p>A critical vulnerability was reported in the versions of golang that Crossplane depends on. Details of the golang vulnerability are included below. Crossplane does not directly use the vulnerable functions from the <code>net/netip</code> package, but the version of golang libraries, runtime, and build tools have still been updated as part of this security advisory nonetheless.</p>
<p><strong>Critical Vulnerabilities</strong>
Vulnerability: <a href="https://nvd.nist.gov/vuln/detail/CVE-2024-24790">CVE-2024-24790</a>, <code>golang: net/netip: Unexpected behavior from Is methods for IPv4-mapped IPv6 addresses</code>
Description: The various Is methods (IsPrivate, IsLoopback, etc) did not work as expected for IPv4-mapped IPv6 addresses, returning false for addresses which would return true in their traditional IPv4 forms.</p>
<p>Affected versions: 1.17.1,1.16.2,1.15.5</p>
<p>See screenshot for more details
<img alt="Screenshot from 2024-09-18 17-36-37" src="https://github.com/user-attachments/assets/2e7ad31f-228a-4534-a4aa-b63d4911351d"></p>
<p>Fixed versions: 1.17.2,1.16.3,1.15.6</p>
<p>Release notes:</p>
<ul>
<li><a href="https://github.com/crossplane/crossplane/releases/tag/v1.17.2">https://github.com/crossplane/crossplane/releases/tag/v1.17.2</a></li>
<li><a href="https://github.com/crossplane/crossplane/releases/tag/v1.16.3">https://github.com/crossplane/crossplane/releases/tag/v1.16.3</a></li>
<li><a href="https://github.com/crossplane/crossplane/releases/tag/v1.15.6">https://github.com/crossplane/crossplane/releases/tag/v1.15.6</a></li>
</ul>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/crossplane/crossplane/security/advisories/GHSA-7h65-4p22-39j6">https://github.com/crossplane/crossplane/security/advisories/GHSA-7h65-4p22-39j6</a></li>
<li><a href="https://github.com/advisories/GHSA-7h65-4p22-39j6">https://github.com/advisories/GHSA-7h65-4p22-39j6</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-7h65-4p22-39j6</uri>
        </author>
        <category label="severity" term="CRITICAL"/>
        <published>2024-10-25T19:42:31.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[github.com/rancher/rke2] RKE2 allows privilege escalation in Windows nodes due to Insecure Access Control Lists]]></title>
        <id>https://github.com/advisories/GHSA-x7xj-jvwp-97rv</id>
        <link href="https://github.com/advisories/GHSA-x7xj-jvwp-97rv"/>
        <updated>2024-10-25T19:39:08.000Z</updated>
        <content type="html"><![CDATA[<h3 id="impact">Impact</h3>
<p>A vulnerability has been identified whereby RKE2 deployments in Windows nodes have weak Access Control Lists (ACL), allowing <code>BUILTIN\Users</code> or <code>NT AUTHORITY\Authenticated Users</code> to view or edit sensitive files which could lead to privilege escalation.</p>
<p>The affected files include binaries, scripts, configuration and log files:</p>
<pre><code>C:\etc\rancher\node\password
C:\var\lib\rancher\rke2\agent\logs\kubelet.log
C:\var\lib\rancher\rke2\data\v1.**.**-rke2r*-windows-amd64-*\bin\*
C:\var\lib\rancher\rke2\bin\*
</code></pre>
<p><strong>This vulnerability is exclusive to RKE2 in Windows environments. Linux environments are not affected by it.</strong></p>
<p>Please consult the associated <a href="https://attack.mitre.org/techniques/T1068/">MITRE ATT&amp;CK - Technique - Exploitation for Privilege Escalation</a> for further information about this category of attack.</p>
<h3 id="patches">Patches</h3>
<p>Patched versions include RKE2 <code>1.31.0</code>, <code>1.30.2</code>, <code>1.29.6</code>, <code>1.28.11</code> and <code>1.27.15</code>.</p>
<h3 id="workarounds">Workarounds</h3>
<p>Users are advised to do a fresh install of their RKE2 Windows nodes using a patched RKE2 version. 
When that is not possible, users can enforce stricter ACLs for all sensitive files affected by this Security Advisory running <a href="https://github.com/rancherlabs/support-tools/blob/master/windows-access-control-lists/README.md">this</a> PowerShell script as an Administrator on each node.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-32197">CVE-2023-32197</a></li>
<li><a href="https://github.com/rancher/rancher/security/advisories/GHSA-7h8m-pvw3-5gh4">Rancher Manager’s GHSA-7h8m-pvw3-5gh4</a></li>
</ul>
<h3 id="for-more-information">For more information</h3>
<p>If you have any questions or comments about this advisory:</p>
<ul>
<li>Reach out to the <a href="https://github.com/rancher/rancher/security/policy">SUSE Rancher Security team</a> for security related inquiries.</li>
<li>Open an issue in the <a href="https://github.com/rancher/rancher/issues/new/choose">Rancher</a> repository.</li>
<li>Verify with our <a href="https://www.suse.com/suse-rancher/support-matrix/all-supported-versions/">support matrix</a> and <a href="https://www.suse.com/lifecycle/">product support lifecycle</a>.</li>
</ul>
<h3 id="references-1">References</h3>
<ul>
<li><a href="https://github.com/rancher/rancher/security/advisories/GHSA-7h8m-pvw3-5gh4">https://github.com/rancher/rancher/security/advisories/GHSA-7h8m-pvw3-5gh4</a></li>
<li><a href="https://github.com/rancher/rke2/security/advisories/GHSA-x7xj-jvwp-97rv">https://github.com/rancher/rke2/security/advisories/GHSA-x7xj-jvwp-97rv</a></li>
<li><a href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-32197">https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-32197</a></li>
<li><a href="https://github.com/advisories/GHSA-x7xj-jvwp-97rv">https://github.com/advisories/GHSA-x7xj-jvwp-97rv</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-x7xj-jvwp-97rv</uri>
        </author>
        <category label="severity" term="CRITICAL"/>
        <published>2024-10-25T19:39:07.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[github.com/rancher/rke2] RKE2 allows privilege escalation in Windows nodes due to Insecure Access Control Lists]]></title>
        <id>https://github.com/advisories/GHSA-x7xj-jvwp-97rv</id>
        <link href="https://github.com/advisories/GHSA-x7xj-jvwp-97rv"/>
        <updated>2024-10-25T19:39:08.000Z</updated>
        <content type="html"><![CDATA[<h3 id="impact">Impact</h3>
<p>A vulnerability has been identified whereby RKE2 deployments in Windows nodes have weak Access Control Lists (ACL), allowing <code>BUILTIN\Users</code> or <code>NT AUTHORITY\Authenticated Users</code> to view or edit sensitive files which could lead to privilege escalation.</p>
<p>The affected files include binaries, scripts, configuration and log files:</p>
<pre><code>C:\etc\rancher\node\password
C:\var\lib\rancher\rke2\agent\logs\kubelet.log
C:\var\lib\rancher\rke2\data\v1.**.**-rke2r*-windows-amd64-*\bin\*
C:\var\lib\rancher\rke2\bin\*
</code></pre>
<p><strong>This vulnerability is exclusive to RKE2 in Windows environments. Linux environments are not affected by it.</strong></p>
<p>Please consult the associated <a href="https://attack.mitre.org/techniques/T1068/">MITRE ATT&amp;CK - Technique - Exploitation for Privilege Escalation</a> for further information about this category of attack.</p>
<h3 id="patches">Patches</h3>
<p>Patched versions include RKE2 <code>1.31.0</code>, <code>1.30.2</code>, <code>1.29.6</code>, <code>1.28.11</code> and <code>1.27.15</code>.</p>
<h3 id="workarounds">Workarounds</h3>
<p>Users are advised to do a fresh install of their RKE2 Windows nodes using a patched RKE2 version. 
When that is not possible, users can enforce stricter ACLs for all sensitive files affected by this Security Advisory running <a href="https://github.com/rancherlabs/support-tools/blob/master/windows-access-control-lists/README.md">this</a> PowerShell script as an Administrator on each node.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-32197">CVE-2023-32197</a></li>
<li><a href="https://github.com/rancher/rancher/security/advisories/GHSA-7h8m-pvw3-5gh4">Rancher Manager’s GHSA-7h8m-pvw3-5gh4</a></li>
</ul>
<h3 id="for-more-information">For more information</h3>
<p>If you have any questions or comments about this advisory:</p>
<ul>
<li>Reach out to the <a href="https://github.com/rancher/rancher/security/policy">SUSE Rancher Security team</a> for security related inquiries.</li>
<li>Open an issue in the <a href="https://github.com/rancher/rancher/issues/new/choose">Rancher</a> repository.</li>
<li>Verify with our <a href="https://www.suse.com/suse-rancher/support-matrix/all-supported-versions/">support matrix</a> and <a href="https://www.suse.com/lifecycle/">product support lifecycle</a>.</li>
</ul>
<h3 id="references-1">References</h3>
<ul>
<li><a href="https://github.com/rancher/rancher/security/advisories/GHSA-7h8m-pvw3-5gh4">https://github.com/rancher/rancher/security/advisories/GHSA-7h8m-pvw3-5gh4</a></li>
<li><a href="https://github.com/rancher/rke2/security/advisories/GHSA-x7xj-jvwp-97rv">https://github.com/rancher/rke2/security/advisories/GHSA-x7xj-jvwp-97rv</a></li>
<li><a href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-32197">https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-32197</a></li>
<li><a href="https://github.com/advisories/GHSA-x7xj-jvwp-97rv">https://github.com/advisories/GHSA-x7xj-jvwp-97rv</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-x7xj-jvwp-97rv</uri>
        </author>
        <category label="severity" term="CRITICAL"/>
        <published>2024-10-25T19:39:07.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[github.com/rancher/rke2] RKE2 allows privilege escalation in Windows nodes due to Insecure Access Control Lists]]></title>
        <id>https://github.com/advisories/GHSA-x7xj-jvwp-97rv</id>
        <link href="https://github.com/advisories/GHSA-x7xj-jvwp-97rv"/>
        <updated>2024-10-25T19:39:08.000Z</updated>
        <content type="html"><![CDATA[<h3 id="impact">Impact</h3>
<p>A vulnerability has been identified whereby RKE2 deployments in Windows nodes have weak Access Control Lists (ACL), allowing <code>BUILTIN\Users</code> or <code>NT AUTHORITY\Authenticated Users</code> to view or edit sensitive files which could lead to privilege escalation.</p>
<p>The affected files include binaries, scripts, configuration and log files:</p>
<pre><code>C:\etc\rancher\node\password
C:\var\lib\rancher\rke2\agent\logs\kubelet.log
C:\var\lib\rancher\rke2\data\v1.**.**-rke2r*-windows-amd64-*\bin\*
C:\var\lib\rancher\rke2\bin\*
</code></pre>
<p><strong>This vulnerability is exclusive to RKE2 in Windows environments. Linux environments are not affected by it.</strong></p>
<p>Please consult the associated <a href="https://attack.mitre.org/techniques/T1068/">MITRE ATT&amp;CK - Technique - Exploitation for Privilege Escalation</a> for further information about this category of attack.</p>
<h3 id="patches">Patches</h3>
<p>Patched versions include RKE2 <code>1.31.0</code>, <code>1.30.2</code>, <code>1.29.6</code>, <code>1.28.11</code> and <code>1.27.15</code>.</p>
<h3 id="workarounds">Workarounds</h3>
<p>Users are advised to do a fresh install of their RKE2 Windows nodes using a patched RKE2 version. 
When that is not possible, users can enforce stricter ACLs for all sensitive files affected by this Security Advisory running <a href="https://github.com/rancherlabs/support-tools/blob/master/windows-access-control-lists/README.md">this</a> PowerShell script as an Administrator on each node.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-32197">CVE-2023-32197</a></li>
<li><a href="https://github.com/rancher/rancher/security/advisories/GHSA-7h8m-pvw3-5gh4">Rancher Manager’s GHSA-7h8m-pvw3-5gh4</a></li>
</ul>
<h3 id="for-more-information">For more information</h3>
<p>If you have any questions or comments about this advisory:</p>
<ul>
<li>Reach out to the <a href="https://github.com/rancher/rancher/security/policy">SUSE Rancher Security team</a> for security related inquiries.</li>
<li>Open an issue in the <a href="https://github.com/rancher/rancher/issues/new/choose">Rancher</a> repository.</li>
<li>Verify with our <a href="https://www.suse.com/suse-rancher/support-matrix/all-supported-versions/">support matrix</a> and <a href="https://www.suse.com/lifecycle/">product support lifecycle</a>.</li>
</ul>
<h3 id="references-1">References</h3>
<ul>
<li><a href="https://github.com/rancher/rancher/security/advisories/GHSA-7h8m-pvw3-5gh4">https://github.com/rancher/rancher/security/advisories/GHSA-7h8m-pvw3-5gh4</a></li>
<li><a href="https://github.com/rancher/rke2/security/advisories/GHSA-x7xj-jvwp-97rv">https://github.com/rancher/rke2/security/advisories/GHSA-x7xj-jvwp-97rv</a></li>
<li><a href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-32197">https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-32197</a></li>
<li><a href="https://github.com/advisories/GHSA-x7xj-jvwp-97rv">https://github.com/advisories/GHSA-x7xj-jvwp-97rv</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-x7xj-jvwp-97rv</uri>
        </author>
        <category label="severity" term="CRITICAL"/>
        <published>2024-10-25T19:39:07.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[github.com/rancher/rke2] RKE2 allows privilege escalation in Windows nodes due to Insecure Access Control Lists]]></title>
        <id>https://github.com/advisories/GHSA-x7xj-jvwp-97rv</id>
        <link href="https://github.com/advisories/GHSA-x7xj-jvwp-97rv"/>
        <updated>2024-10-25T19:39:08.000Z</updated>
        <content type="html"><![CDATA[<h3 id="impact">Impact</h3>
<p>A vulnerability has been identified whereby RKE2 deployments in Windows nodes have weak Access Control Lists (ACL), allowing <code>BUILTIN\Users</code> or <code>NT AUTHORITY\Authenticated Users</code> to view or edit sensitive files which could lead to privilege escalation.</p>
<p>The affected files include binaries, scripts, configuration and log files:</p>
<pre><code>C:\etc\rancher\node\password
C:\var\lib\rancher\rke2\agent\logs\kubelet.log
C:\var\lib\rancher\rke2\data\v1.**.**-rke2r*-windows-amd64-*\bin\*
C:\var\lib\rancher\rke2\bin\*
</code></pre>
<p><strong>This vulnerability is exclusive to RKE2 in Windows environments. Linux environments are not affected by it.</strong></p>
<p>Please consult the associated <a href="https://attack.mitre.org/techniques/T1068/">MITRE ATT&amp;CK - Technique - Exploitation for Privilege Escalation</a> for further information about this category of attack.</p>
<h3 id="patches">Patches</h3>
<p>Patched versions include RKE2 <code>1.31.0</code>, <code>1.30.2</code>, <code>1.29.6</code>, <code>1.28.11</code> and <code>1.27.15</code>.</p>
<h3 id="workarounds">Workarounds</h3>
<p>Users are advised to do a fresh install of their RKE2 Windows nodes using a patched RKE2 version. 
When that is not possible, users can enforce stricter ACLs for all sensitive files affected by this Security Advisory running <a href="https://github.com/rancherlabs/support-tools/blob/master/windows-access-control-lists/README.md">this</a> PowerShell script as an Administrator on each node.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-32197">CVE-2023-32197</a></li>
<li><a href="https://github.com/rancher/rancher/security/advisories/GHSA-7h8m-pvw3-5gh4">Rancher Manager’s GHSA-7h8m-pvw3-5gh4</a></li>
</ul>
<h3 id="for-more-information">For more information</h3>
<p>If you have any questions or comments about this advisory:</p>
<ul>
<li>Reach out to the <a href="https://github.com/rancher/rancher/security/policy">SUSE Rancher Security team</a> for security related inquiries.</li>
<li>Open an issue in the <a href="https://github.com/rancher/rancher/issues/new/choose">Rancher</a> repository.</li>
<li>Verify with our <a href="https://www.suse.com/suse-rancher/support-matrix/all-supported-versions/">support matrix</a> and <a href="https://www.suse.com/lifecycle/">product support lifecycle</a>.</li>
</ul>
<h3 id="references-1">References</h3>
<ul>
<li><a href="https://github.com/rancher/rancher/security/advisories/GHSA-7h8m-pvw3-5gh4">https://github.com/rancher/rancher/security/advisories/GHSA-7h8m-pvw3-5gh4</a></li>
<li><a href="https://github.com/rancher/rke2/security/advisories/GHSA-x7xj-jvwp-97rv">https://github.com/rancher/rke2/security/advisories/GHSA-x7xj-jvwp-97rv</a></li>
<li><a href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-32197">https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-32197</a></li>
<li><a href="https://github.com/advisories/GHSA-x7xj-jvwp-97rv">https://github.com/advisories/GHSA-x7xj-jvwp-97rv</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-x7xj-jvwp-97rv</uri>
        </author>
        <category label="severity" term="CRITICAL"/>
        <published>2024-10-25T19:39:07.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[github.com/rancher/rancher] Rancher Remote Code Execution via Cluster/Node Drivers]]></title>
        <id>https://github.com/advisories/GHSA-h99m-6755-rgwc</id>
        <link href="https://github.com/advisories/GHSA-h99m-6755-rgwc"/>
        <updated>2024-10-25T19:37:22.000Z</updated>
        <content type="html"><![CDATA[<h3 id="impact">Impact</h3>
<p>A vulnerability has been identified within Rancher where a cluster or node driver can be used to escape the <code>chroot</code> jail and gain root access to the Rancher container itself. In production environments, further privilege escalation is possible based on living off the land within the Rancher container itself. For the test and development environments, based on a –privileged Docker container, it is possible to escape the Docker container and gain execution access on the host system. </p>
<p>This happens because:</p>
<ul>
<li>During startup, Rancher appends the <code>/opt/drivers/management-state/bin</code> directory to the <code>PATH</code> environment variable.</li>
<li>In Rancher, the binaries <code>/usr/bin/rancher-machine</code>, <code>/usr/bin/helm_v3</code>, and <code>/usr/bin/kustomize</code> are assigned a UID of 1001 and a GID of 127 instead of being owned by the root user.</li>
<li>Rancher employs a jail mechanism to isolate the execution of node drivers from the main process. However, the drivers are executed with excessive permissions.</li>
<li>During the registration of new node drivers, its binary is executed with the same user as the parent process, which could enable an attacker to gain elevated privileges by registering a malicious driver.</li>
<li>Lack of validation on the driver file type, which allows symbolic links to be used.</li>
</ul>
<p>Please consult the associated  <a href="https://attack.mitre.org/tactics/TA0004/">MITRE ATT&amp;CK - Technique - Privilege Escalation</a> and <a href="https://attack.mitre.org/tactics/TA0002/">MITRE ATT&amp;CK - Technique - Execution</a> for further information about this category of attack.</p>
<p><strong>Since they run at a privileged level, it is recommended to use trusted drivers only.</strong></p>
<h3 id="patches">Patches</h3>
<p>The fix involves some key areas with the following changes:</p>
<p>Fixing the <code>PATH</code> environment variable:</p>
<ul>
<li>Remove the step that appends <code>/opt/drivers/management-state/bin</code> to the <code>PATH</code> environment variable.</li>
</ul>
<p>Binaries permissions:</p>
<ul>
<li>Correct the permission of the binaries <code>/usr/bin/rancher-machine</code>, <code>/usr/bin/helm_v3</code>, and <code>/usr/bin/kustomize</code> so that they are owned by the root user.</li>
</ul>
<p>Improving Rancher jail security mechanism:</p>
<ul>
<li>A new group <code>jail-accessors</code> has been created, and the rancher user has been added to this group.</li>
<li>The <code>jail-accessors</code> group is granted read and execute permissions for the directories <code>/var/lib/rancher</code>, <code>/var/lib/cattle</code>, and <code>/usr/local/bin</code>.</li>
<li>The jail mechanism has been enhanced to execute commands using the non-root <code>rancher</code> user and the <code>jail-accessors</code> group. Additionally, a new setting, <code>UnprivilegedJailUser</code>, has been introduced to manage this behavior, allowing users to opt-out if they need to run drivers in a more privileged context.</li>
<li>Limit the devices copied to the jail directory to a minimal set.</li>
</ul>
<p>Fixing node driver registration:</p>
<ul>
<li>The <code>NewPlugin(driver)</code> function in the <code>rancher/machine</code> module has been updated to allow setting the UID and GID for starting the plugin server. If the environment variables <code>MACHINE_PLUGIN_UID</code> and <code>MACHINE_PLUGIN_GID</code> are set, their values will be used to configure the user credentials for launching the plugin server. </li>
<li>Rancher now sets these environment variables with a non-root UID and GID before invoking the <code>NewPlugin(driver)</code> function and then unsets them after retrieving the creation flags.</li>
</ul>
<p>Improvements on driver package:</p>
<ul>
<li>The <code>driver</code> package has been revised to verify that the downloaded driver binary is a regular file.</li>
<li>The <code>driver</code> package has been revised to verify that the target file in the downloaded tar file is a regular file.</li>
<li>The <code>driver</code> package now executes the downloaded driver binary within a jail, with a default timeout of 5 seconds.</li>
</ul>
<p>Other improvements:</p>
<ul>
<li>The helm package has been updated to ensure appropriate permissions are set on the generated kubeconfig file.</li>
<li>The <code>nodeConfig</code> package has been updated to ensure proper permissions are applied when extracting the node configuration.</li>
</ul>
<p>Patched versions include releases <code>2.7.16</code>, <code>2.8.9</code> and <code>2.9.3</code>.</p>
<h3 id="workarounds">Workarounds</h3>
<p>If you can't upgrade to a fixed version, please make sure that:</p>
<ol>
<li>Drivers are only executed from trusted sources.</li>
<li>The use of Admins/Restricted Admins is limited to trusted users.</li>
</ol>
<h3 id="references">References</h3>
<p>If you have any questions or comments about this advisory:</p>
<ul>
<li>Reach out to the <a href="https://github.com/rancher/rancher/security/policy">SUSE Rancher Security team</a> for security related inquiries.</li>
<li>Open an issue in the <a href="https://github.com/rancher/rancher/issues/new/choose">Rancher</a> repository.</li>
<li>Verify with our <a href="https://www.suse.com/suse-rancher/support-matrix/all-supported-versions/">support matrix</a> and <a href="https://www.suse.com/lifecycle/">product support lifecycle</a>.</li>
</ul>
<h3 id="references-1">References</h3>
<ul>
<li><a href="https://github.com/rancher/rancher/security/advisories/GHSA-h99m-6755-rgwc">https://github.com/rancher/rancher/security/advisories/GHSA-h99m-6755-rgwc</a></li>
<li><a href="https://github.com/advisories/GHSA-h99m-6755-rgwc">https://github.com/advisories/GHSA-h99m-6755-rgwc</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-h99m-6755-rgwc</uri>
        </author>
        <category label="severity" term="CRITICAL"/>
        <published>2024-10-25T19:37:22.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[github.com/rancher/rancher] Rancher Remote Code Execution via Cluster/Node Drivers]]></title>
        <id>https://github.com/advisories/GHSA-h99m-6755-rgwc</id>
        <link href="https://github.com/advisories/GHSA-h99m-6755-rgwc"/>
        <updated>2024-10-25T19:37:22.000Z</updated>
        <content type="html"><![CDATA[<h3 id="impact">Impact</h3>
<p>A vulnerability has been identified within Rancher where a cluster or node driver can be used to escape the <code>chroot</code> jail and gain root access to the Rancher container itself. In production environments, further privilege escalation is possible based on living off the land within the Rancher container itself. For the test and development environments, based on a –privileged Docker container, it is possible to escape the Docker container and gain execution access on the host system. </p>
<p>This happens because:</p>
<ul>
<li>During startup, Rancher appends the <code>/opt/drivers/management-state/bin</code> directory to the <code>PATH</code> environment variable.</li>
<li>In Rancher, the binaries <code>/usr/bin/rancher-machine</code>, <code>/usr/bin/helm_v3</code>, and <code>/usr/bin/kustomize</code> are assigned a UID of 1001 and a GID of 127 instead of being owned by the root user.</li>
<li>Rancher employs a jail mechanism to isolate the execution of node drivers from the main process. However, the drivers are executed with excessive permissions.</li>
<li>During the registration of new node drivers, its binary is executed with the same user as the parent process, which could enable an attacker to gain elevated privileges by registering a malicious driver.</li>
<li>Lack of validation on the driver file type, which allows symbolic links to be used.</li>
</ul>
<p>Please consult the associated  <a href="https://attack.mitre.org/tactics/TA0004/">MITRE ATT&amp;CK - Technique - Privilege Escalation</a> and <a href="https://attack.mitre.org/tactics/TA0002/">MITRE ATT&amp;CK - Technique - Execution</a> for further information about this category of attack.</p>
<p><strong>Since they run at a privileged level, it is recommended to use trusted drivers only.</strong></p>
<h3 id="patches">Patches</h3>
<p>The fix involves some key areas with the following changes:</p>
<p>Fixing the <code>PATH</code> environment variable:</p>
<ul>
<li>Remove the step that appends <code>/opt/drivers/management-state/bin</code> to the <code>PATH</code> environment variable.</li>
</ul>
<p>Binaries permissions:</p>
<ul>
<li>Correct the permission of the binaries <code>/usr/bin/rancher-machine</code>, <code>/usr/bin/helm_v3</code>, and <code>/usr/bin/kustomize</code> so that they are owned by the root user.</li>
</ul>
<p>Improving Rancher jail security mechanism:</p>
<ul>
<li>A new group <code>jail-accessors</code> has been created, and the rancher user has been added to this group.</li>
<li>The <code>jail-accessors</code> group is granted read and execute permissions for the directories <code>/var/lib/rancher</code>, <code>/var/lib/cattle</code>, and <code>/usr/local/bin</code>.</li>
<li>The jail mechanism has been enhanced to execute commands using the non-root <code>rancher</code> user and the <code>jail-accessors</code> group. Additionally, a new setting, <code>UnprivilegedJailUser</code>, has been introduced to manage this behavior, allowing users to opt-out if they need to run drivers in a more privileged context.</li>
<li>Limit the devices copied to the jail directory to a minimal set.</li>
</ul>
<p>Fixing node driver registration:</p>
<ul>
<li>The <code>NewPlugin(driver)</code> function in the <code>rancher/machine</code> module has been updated to allow setting the UID and GID for starting the plugin server. If the environment variables <code>MACHINE_PLUGIN_UID</code> and <code>MACHINE_PLUGIN_GID</code> are set, their values will be used to configure the user credentials for launching the plugin server. </li>
<li>Rancher now sets these environment variables with a non-root UID and GID before invoking the <code>NewPlugin(driver)</code> function and then unsets them after retrieving the creation flags.</li>
</ul>
<p>Improvements on driver package:</p>
<ul>
<li>The <code>driver</code> package has been revised to verify that the downloaded driver binary is a regular file.</li>
<li>The <code>driver</code> package has been revised to verify that the target file in the downloaded tar file is a regular file.</li>
<li>The <code>driver</code> package now executes the downloaded driver binary within a jail, with a default timeout of 5 seconds.</li>
</ul>
<p>Other improvements:</p>
<ul>
<li>The helm package has been updated to ensure appropriate permissions are set on the generated kubeconfig file.</li>
<li>The <code>nodeConfig</code> package has been updated to ensure proper permissions are applied when extracting the node configuration.</li>
</ul>
<p>Patched versions include releases <code>2.7.16</code>, <code>2.8.9</code> and <code>2.9.3</code>.</p>
<h3 id="workarounds">Workarounds</h3>
<p>If you can't upgrade to a fixed version, please make sure that:</p>
<ol>
<li>Drivers are only executed from trusted sources.</li>
<li>The use of Admins/Restricted Admins is limited to trusted users.</li>
</ol>
<h3 id="references">References</h3>
<p>If you have any questions or comments about this advisory:</p>
<ul>
<li>Reach out to the <a href="https://github.com/rancher/rancher/security/policy">SUSE Rancher Security team</a> for security related inquiries.</li>
<li>Open an issue in the <a href="https://github.com/rancher/rancher/issues/new/choose">Rancher</a> repository.</li>
<li>Verify with our <a href="https://www.suse.com/suse-rancher/support-matrix/all-supported-versions/">support matrix</a> and <a href="https://www.suse.com/lifecycle/">product support lifecycle</a>.</li>
</ul>
<h3 id="references-1">References</h3>
<ul>
<li><a href="https://github.com/rancher/rancher/security/advisories/GHSA-h99m-6755-rgwc">https://github.com/rancher/rancher/security/advisories/GHSA-h99m-6755-rgwc</a></li>
<li><a href="https://github.com/advisories/GHSA-h99m-6755-rgwc">https://github.com/advisories/GHSA-h99m-6755-rgwc</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-h99m-6755-rgwc</uri>
        </author>
        <category label="severity" term="CRITICAL"/>
        <published>2024-10-25T19:37:22.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[github.com/rancher/rancher] Rancher Remote Code Execution via Cluster/Node Drivers]]></title>
        <id>https://github.com/advisories/GHSA-h99m-6755-rgwc</id>
        <link href="https://github.com/advisories/GHSA-h99m-6755-rgwc"/>
        <updated>2024-10-25T19:37:22.000Z</updated>
        <content type="html"><![CDATA[<h3 id="impact">Impact</h3>
<p>A vulnerability has been identified within Rancher where a cluster or node driver can be used to escape the <code>chroot</code> jail and gain root access to the Rancher container itself. In production environments, further privilege escalation is possible based on living off the land within the Rancher container itself. For the test and development environments, based on a –privileged Docker container, it is possible to escape the Docker container and gain execution access on the host system. </p>
<p>This happens because:</p>
<ul>
<li>During startup, Rancher appends the <code>/opt/drivers/management-state/bin</code> directory to the <code>PATH</code> environment variable.</li>
<li>In Rancher, the binaries <code>/usr/bin/rancher-machine</code>, <code>/usr/bin/helm_v3</code>, and <code>/usr/bin/kustomize</code> are assigned a UID of 1001 and a GID of 127 instead of being owned by the root user.</li>
<li>Rancher employs a jail mechanism to isolate the execution of node drivers from the main process. However, the drivers are executed with excessive permissions.</li>
<li>During the registration of new node drivers, its binary is executed with the same user as the parent process, which could enable an attacker to gain elevated privileges by registering a malicious driver.</li>
<li>Lack of validation on the driver file type, which allows symbolic links to be used.</li>
</ul>
<p>Please consult the associated  <a href="https://attack.mitre.org/tactics/TA0004/">MITRE ATT&amp;CK - Technique - Privilege Escalation</a> and <a href="https://attack.mitre.org/tactics/TA0002/">MITRE ATT&amp;CK - Technique - Execution</a> for further information about this category of attack.</p>
<p><strong>Since they run at a privileged level, it is recommended to use trusted drivers only.</strong></p>
<h3 id="patches">Patches</h3>
<p>The fix involves some key areas with the following changes:</p>
<p>Fixing the <code>PATH</code> environment variable:</p>
<ul>
<li>Remove the step that appends <code>/opt/drivers/management-state/bin</code> to the <code>PATH</code> environment variable.</li>
</ul>
<p>Binaries permissions:</p>
<ul>
<li>Correct the permission of the binaries <code>/usr/bin/rancher-machine</code>, <code>/usr/bin/helm_v3</code>, and <code>/usr/bin/kustomize</code> so that they are owned by the root user.</li>
</ul>
<p>Improving Rancher jail security mechanism:</p>
<ul>
<li>A new group <code>jail-accessors</code> has been created, and the rancher user has been added to this group.</li>
<li>The <code>jail-accessors</code> group is granted read and execute permissions for the directories <code>/var/lib/rancher</code>, <code>/var/lib/cattle</code>, and <code>/usr/local/bin</code>.</li>
<li>The jail mechanism has been enhanced to execute commands using the non-root <code>rancher</code> user and the <code>jail-accessors</code> group. Additionally, a new setting, <code>UnprivilegedJailUser</code>, has been introduced to manage this behavior, allowing users to opt-out if they need to run drivers in a more privileged context.</li>
<li>Limit the devices copied to the jail directory to a minimal set.</li>
</ul>
<p>Fixing node driver registration:</p>
<ul>
<li>The <code>NewPlugin(driver)</code> function in the <code>rancher/machine</code> module has been updated to allow setting the UID and GID for starting the plugin server. If the environment variables <code>MACHINE_PLUGIN_UID</code> and <code>MACHINE_PLUGIN_GID</code> are set, their values will be used to configure the user credentials for launching the plugin server. </li>
<li>Rancher now sets these environment variables with a non-root UID and GID before invoking the <code>NewPlugin(driver)</code> function and then unsets them after retrieving the creation flags.</li>
</ul>
<p>Improvements on driver package:</p>
<ul>
<li>The <code>driver</code> package has been revised to verify that the downloaded driver binary is a regular file.</li>
<li>The <code>driver</code> package has been revised to verify that the target file in the downloaded tar file is a regular file.</li>
<li>The <code>driver</code> package now executes the downloaded driver binary within a jail, with a default timeout of 5 seconds.</li>
</ul>
<p>Other improvements:</p>
<ul>
<li>The helm package has been updated to ensure appropriate permissions are set on the generated kubeconfig file.</li>
<li>The <code>nodeConfig</code> package has been updated to ensure proper permissions are applied when extracting the node configuration.</li>
</ul>
<p>Patched versions include releases <code>2.7.16</code>, <code>2.8.9</code> and <code>2.9.3</code>.</p>
<h3 id="workarounds">Workarounds</h3>
<p>If you can't upgrade to a fixed version, please make sure that:</p>
<ol>
<li>Drivers are only executed from trusted sources.</li>
<li>The use of Admins/Restricted Admins is limited to trusted users.</li>
</ol>
<h3 id="references">References</h3>
<p>If you have any questions or comments about this advisory:</p>
<ul>
<li>Reach out to the <a href="https://github.com/rancher/rancher/security/policy">SUSE Rancher Security team</a> for security related inquiries.</li>
<li>Open an issue in the <a href="https://github.com/rancher/rancher/issues/new/choose">Rancher</a> repository.</li>
<li>Verify with our <a href="https://www.suse.com/suse-rancher/support-matrix/all-supported-versions/">support matrix</a> and <a href="https://www.suse.com/lifecycle/">product support lifecycle</a>.</li>
</ul>
<h3 id="references-1">References</h3>
<ul>
<li><a href="https://github.com/rancher/rancher/security/advisories/GHSA-h99m-6755-rgwc">https://github.com/rancher/rancher/security/advisories/GHSA-h99m-6755-rgwc</a></li>
<li><a href="https://github.com/advisories/GHSA-h99m-6755-rgwc">https://github.com/advisories/GHSA-h99m-6755-rgwc</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-h99m-6755-rgwc</uri>
        </author>
        <category label="severity" term="CRITICAL"/>
        <published>2024-10-25T19:37:22.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[github.com/rancher/rancher] Exposure of vSphere's CPI and CSI credentials in Rancher]]></title>
        <id>https://github.com/advisories/GHSA-xj7w-r753-vj8v</id>
        <link href="https://github.com/advisories/GHSA-xj7w-r753-vj8v"/>
        <updated>2024-10-25T19:35:56.000Z</updated>
        <content type="html"><![CDATA[<h3 id="impact">Impact</h3>
<p>A vulnerability has been identified in the way that Rancher stores vSphere's CPI (Cloud Provider Interface) and CSI (Container Storage Interface) credentials used to deploy clusters through the vSphere cloud provider. This issue leads to the vSphere CPI and CSI passwords being stored in a plaintext object inside Rancher. This vulnerability is only applicable to users that deploy clusters in vSphere environments.</p>
<p>The exposed passwords were accessible in the following objects:</p>
<ul>
<li>Can be accessed by users that are cluster members of the provisioned clusters:<ul>
<li>When provisioning a new cluster with the vSphere cloud provider through Rancher's UI (user interface), Cluster Templates and Terraform on the object <code>provisioning.cattle.io</code> in <code>spec.rkeConfig.chartValues.rancher-vsphere-cpi</code> and <code>spec.rkeConfig.chartValues.rancher-vsphere-csi</code>.</li>
<li>On the object <code>rke.cattle.io.rkecontrolplane</code> in <code>spec.chartValues.rancher-vsphere-cpi</code> and <code>spec.chartValues.rancher-vsphere-csi</code>.</li>
</ul>
</li>
<li>Can be accessed by users with privileged access to the clusters' infrastructure (host OS):<ul>
<li>Inside the <code>plan</code> files in the provisioned downstream clusters' filesystems.</li>
</ul>
</li>
</ul>
<p><strong>Note:</strong> if you believe that the vSphere credentials might have been accessed by unauthorized users, it's highly recommended to change them, after updating Rancher to a patched version.</p>
<p>Please consult the associated  <a href="https://attack.mitre.org/tactics/TA0006/">MITRE ATT&amp;CK - Technique -  Credential Access</a> for further information about this category of attack.</p>
<h3 id="patches">Patches</h3>
<p>Patched versions include Rancher releases <strong>2.8.9 and 2.9.3</strong>.</p>
<p>After updating your environment to one of the patched Rancher's versions, it's mandatory to execute <a href="https://github.com/rancherlabs/support-tools/tree/master/migrate-vsphere-clusters">this script</a> that provides an automated way to mitigate any vulnerable leftover vSphere clusters' credentials within Rancher's local cluster. This script doesn't need to be executed in case you are installing a fresh and new environment.</p>
<p>The script will fetch all objects in Rancher's local cluster,  loops through them, if the affected vSphere charts are present, then it extracts the <code>username</code> and <code>password</code> parameters into a secret in the <code>fleet-default</code> namespace for both with the appropriate annotation to synchronize them to the downstream clusters. Finally, it updates the cluster's <code>chartValues</code> to reference those secrets rather than existing plaintext values.</p>
<p>The script confirms on write operations, as well as backs up configurations of the cluster objects before operating so rolling back is simple.</p>
<p>To run the script, fetch the <code>kubeconfig</code> for your local cluster and run with <code>KUBECONFIG=/path/to/kubeconfig.yml bash migrate.sh</code>. The script is idempotent and can be run multiple times safely if you want to validate just one at a time.</p>
<p><strong>Notes:</strong></p>
<ul>
<li>The <a href="https://ranchermanager.docs.rancher.com/getting-started/installation-and-upgrade/installation-references/feature-flags">feature flag</a> <code>provisioningprebootstrap</code> must be enabled after updating to one of the patched versions. This feature flag is also mandatory when installing a new cluster.</li>
<li><strong>Rancher 2.7 release line is not receiving a backport security patch for this vulnerability.</strong> For users running Rancher 2.7 with vSphere provisioning and that are concerned with this security issue, the recommendation is to update Rancher to one of the patched versions by following the standard update procedure based on the 2.7 version that is being used. Refer to the release notes for the proper update process for <a href="https://github.com/rancher/rancher/releases/tag/v2.8.9">2.8.9</a> and <a href="https://github.com/rancher/rancher/releases/tag/v2.9.3">2.9.3</a>.</li>
</ul>
<h3 id="workarounds">Workarounds</h3>
<p>Besides only granting access to Rancher to trusted users and not allowing direct access to untrusted users to the clusters' infrastructure, there is no direct workaround for this security issue, except updating Rancher to one of the patched versions.</p>
<h3 id="references">References</h3>
<p>If you have any questions or comments about this advisory:</p>
<ul>
<li>Reach out to the <a href="https://github.com/rancher/rancher/security/policy">SUSE Rancher Security team</a> for security related inquiries.</li>
<li>Open an issue in the <a href="https://github.com/rancher/rancher/issues/new/choose">Rancher</a> repository.</li>
<li>Verify with our <a href="https://www.suse.com/suse-rancher/support-matrix/all-supported-versions/">support matrix</a> and <a href="https://www.suse.com/lifecycle/">product support lifecycle</a>.</li>
</ul>
<h3 id="references-1">References</h3>
<ul>
<li><a href="https://github.com/rancher/rancher/security/advisories/GHSA-xj7w-r753-vj8v">https://github.com/rancher/rancher/security/advisories/GHSA-xj7w-r753-vj8v</a></li>
<li><a href="https://github.com/advisories/GHSA-xj7w-r753-vj8v">https://github.com/advisories/GHSA-xj7w-r753-vj8v</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-xj7w-r753-vj8v</uri>
        </author>
        <category label="severity" term="CRITICAL"/>
        <published>2024-10-25T19:35:55.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[github.com/rancher/rancher] Exposure of vSphere's CPI and CSI credentials in Rancher]]></title>
        <id>https://github.com/advisories/GHSA-xj7w-r753-vj8v</id>
        <link href="https://github.com/advisories/GHSA-xj7w-r753-vj8v"/>
        <updated>2024-10-25T19:35:56.000Z</updated>
        <content type="html"><![CDATA[<h3 id="impact">Impact</h3>
<p>A vulnerability has been identified in the way that Rancher stores vSphere's CPI (Cloud Provider Interface) and CSI (Container Storage Interface) credentials used to deploy clusters through the vSphere cloud provider. This issue leads to the vSphere CPI and CSI passwords being stored in a plaintext object inside Rancher. This vulnerability is only applicable to users that deploy clusters in vSphere environments.</p>
<p>The exposed passwords were accessible in the following objects:</p>
<ul>
<li>Can be accessed by users that are cluster members of the provisioned clusters:<ul>
<li>When provisioning a new cluster with the vSphere cloud provider through Rancher's UI (user interface), Cluster Templates and Terraform on the object <code>provisioning.cattle.io</code> in <code>spec.rkeConfig.chartValues.rancher-vsphere-cpi</code> and <code>spec.rkeConfig.chartValues.rancher-vsphere-csi</code>.</li>
<li>On the object <code>rke.cattle.io.rkecontrolplane</code> in <code>spec.chartValues.rancher-vsphere-cpi</code> and <code>spec.chartValues.rancher-vsphere-csi</code>.</li>
</ul>
</li>
<li>Can be accessed by users with privileged access to the clusters' infrastructure (host OS):<ul>
<li>Inside the <code>plan</code> files in the provisioned downstream clusters' filesystems.</li>
</ul>
</li>
</ul>
<p><strong>Note:</strong> if you believe that the vSphere credentials might have been accessed by unauthorized users, it's highly recommended to change them, after updating Rancher to a patched version.</p>
<p>Please consult the associated  <a href="https://attack.mitre.org/tactics/TA0006/">MITRE ATT&amp;CK - Technique -  Credential Access</a> for further information about this category of attack.</p>
<h3 id="patches">Patches</h3>
<p>Patched versions include Rancher releases <strong>2.8.9 and 2.9.3</strong>.</p>
<p>After updating your environment to one of the patched Rancher's versions, it's mandatory to execute <a href="https://github.com/rancherlabs/support-tools/tree/master/migrate-vsphere-clusters">this script</a> that provides an automated way to mitigate any vulnerable leftover vSphere clusters' credentials within Rancher's local cluster. This script doesn't need to be executed in case you are installing a fresh and new environment.</p>
<p>The script will fetch all objects in Rancher's local cluster,  loops through them, if the affected vSphere charts are present, then it extracts the <code>username</code> and <code>password</code> parameters into a secret in the <code>fleet-default</code> namespace for both with the appropriate annotation to synchronize them to the downstream clusters. Finally, it updates the cluster's <code>chartValues</code> to reference those secrets rather than existing plaintext values.</p>
<p>The script confirms on write operations, as well as backs up configurations of the cluster objects before operating so rolling back is simple.</p>
<p>To run the script, fetch the <code>kubeconfig</code> for your local cluster and run with <code>KUBECONFIG=/path/to/kubeconfig.yml bash migrate.sh</code>. The script is idempotent and can be run multiple times safely if you want to validate just one at a time.</p>
<p><strong>Notes:</strong></p>
<ul>
<li>The <a href="https://ranchermanager.docs.rancher.com/getting-started/installation-and-upgrade/installation-references/feature-flags">feature flag</a> <code>provisioningprebootstrap</code> must be enabled after updating to one of the patched versions. This feature flag is also mandatory when installing a new cluster.</li>
<li><strong>Rancher 2.7 release line is not receiving a backport security patch for this vulnerability.</strong> For users running Rancher 2.7 with vSphere provisioning and that are concerned with this security issue, the recommendation is to update Rancher to one of the patched versions by following the standard update procedure based on the 2.7 version that is being used. Refer to the release notes for the proper update process for <a href="https://github.com/rancher/rancher/releases/tag/v2.8.9">2.8.9</a> and <a href="https://github.com/rancher/rancher/releases/tag/v2.9.3">2.9.3</a>.</li>
</ul>
<h3 id="workarounds">Workarounds</h3>
<p>Besides only granting access to Rancher to trusted users and not allowing direct access to untrusted users to the clusters' infrastructure, there is no direct workaround for this security issue, except updating Rancher to one of the patched versions.</p>
<h3 id="references">References</h3>
<p>If you have any questions or comments about this advisory:</p>
<ul>
<li>Reach out to the <a href="https://github.com/rancher/rancher/security/policy">SUSE Rancher Security team</a> for security related inquiries.</li>
<li>Open an issue in the <a href="https://github.com/rancher/rancher/issues/new/choose">Rancher</a> repository.</li>
<li>Verify with our <a href="https://www.suse.com/suse-rancher/support-matrix/all-supported-versions/">support matrix</a> and <a href="https://www.suse.com/lifecycle/">product support lifecycle</a>.</li>
</ul>
<h3 id="references-1">References</h3>
<ul>
<li><a href="https://github.com/rancher/rancher/security/advisories/GHSA-xj7w-r753-vj8v">https://github.com/rancher/rancher/security/advisories/GHSA-xj7w-r753-vj8v</a></li>
<li><a href="https://github.com/advisories/GHSA-xj7w-r753-vj8v">https://github.com/advisories/GHSA-xj7w-r753-vj8v</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-xj7w-r753-vj8v</uri>
        </author>
        <category label="severity" term="CRITICAL"/>
        <published>2024-10-25T19:35:55.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[github.com/rancher/rancher] Rancher allows privilege escalation in Windows nodes due to Insecure Access Control Lists]]></title>
        <id>https://github.com/advisories/GHSA-7h8m-pvw3-5gh4</id>
        <link href="https://github.com/advisories/GHSA-7h8m-pvw3-5gh4"/>
        <updated>2024-10-25T19:35:01.000Z</updated>
        <content type="html"><![CDATA[<h3 id="impact">Impact</h3>
<p>A vulnerability has been identified whereby Rancher Manager deployments containing Windows nodes have weak Access Control Lists (ACL), allowing <code>BUILTIN\Users</code> or <code>NT AUTHORITY\Authenticated Users</code> to view or edit sensitive files which could lead to privilege escalation.</p>
<p>The affected files include binaries, scripts, configuration and log files:</p>
<pre><code>C:\etc\rancher\wins\config
C:\var\lib\rancher\agent\rancher2_connection_info.json
C:\etc\rancher\rke2\config.yaml.d\50-rancher.yaml
C:\var\lib\rancher\agent\applied\*-*-applied.plan
C:\usr\local\bin\rke2
C:\var\lib\rancher\capr\idempotence\idempotent.sh
</code></pre>
<p>RKE2 nodes expand the list to include the files below:</p>
<pre><code>C:\etc\rancher\node\password
C:\var\lib\rancher\rke2\agent\logs\kubelet.log
C:\var\lib\rancher\rke2\data\v1.**.**-rke2r*-windows-amd64-*\bin\*
C:\var\lib\rancher\rke2\bin\*
</code></pre>
<p><strong>This vulnerability is exclusive to deployments that contain Windows nodes. Linux-only environments are not affected by it.</strong></p>
<p>Please consult the associated <a href="https://attack.mitre.org/techniques/T1068/">MITRE ATT&amp;CK - Technique - Exploitation for Privilege Escalation</a> for further information about this category of attack.</p>
<h3 id="patches">Patches</h3>
<p>Patched versions include Rancher Manager <code>2.8.9</code> and <code>2.9.3</code>. For RKE2 Windows nodes, please refer to its <a href="https://github.com/rancher/rke2/security/advisories/GHSA-x7xj-jvwp-97rv">specific advisory</a>. No patches are available for 2.7, therefore users are urged to upgrade to newer minor versions or to apply the manual workaround below.</p>
<h3 id="workarounds">Workarounds</h3>
<p>Users are advised to upgrade to a patched version of Rancher Manager. When that is not possible, users can enforce stricter ACLs for all sensitive files affected by this Security Advisory running <a href="https://github.com/rancherlabs/support-tools/blob/master/windows-access-control-lists/README.md">this</a> PowerShell script as an Administrator on each node.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-32197">CVE-2023-32197</a></li>
<li><a href="https://github.com/rancher/rke2/security/advisories/GHSA-x7xj-jvwp-97rv">RKE2’s GHSA-x7xj-jvwp-97rv</a></li>
</ul>
<h3 id="for-more-information">For more information</h3>
<p>If you have any questions or comments about this advisory:</p>
<ul>
<li>Reach out to the <a href="https://github.com/rancher/rancher/security/policy">SUSE Rancher Security team</a> for security related inquiries.</li>
<li>Open an issue in the <a href="https://github.com/rancher/rancher/issues/new/choose">Rancher</a> repository.</li>
<li>Verify with our <a href="https://www.suse.com/suse-rancher/support-matrix/all-supported-versions/">support matrix</a> and <a href="https://www.suse.com/lifecycle/">product support lifecycle</a>.</li>
</ul>
<h3 id="references-1">References</h3>
<ul>
<li><a href="https://github.com/rancher/rancher/security/advisories/GHSA-7h8m-pvw3-5gh4">https://github.com/rancher/rancher/security/advisories/GHSA-7h8m-pvw3-5gh4</a></li>
<li><a href="https://github.com/advisories/GHSA-7h8m-pvw3-5gh4">https://github.com/advisories/GHSA-7h8m-pvw3-5gh4</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-7h8m-pvw3-5gh4</uri>
        </author>
        <category label="severity" term="CRITICAL"/>
        <published>2024-10-25T19:35:00.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[github.com/rancher/rancher] Rancher allows privilege escalation in Windows nodes due to Insecure Access Control Lists]]></title>
        <id>https://github.com/advisories/GHSA-7h8m-pvw3-5gh4</id>
        <link href="https://github.com/advisories/GHSA-7h8m-pvw3-5gh4"/>
        <updated>2024-10-25T19:35:01.000Z</updated>
        <content type="html"><![CDATA[<h3 id="impact">Impact</h3>
<p>A vulnerability has been identified whereby Rancher Manager deployments containing Windows nodes have weak Access Control Lists (ACL), allowing <code>BUILTIN\Users</code> or <code>NT AUTHORITY\Authenticated Users</code> to view or edit sensitive files which could lead to privilege escalation.</p>
<p>The affected files include binaries, scripts, configuration and log files:</p>
<pre><code>C:\etc\rancher\wins\config
C:\var\lib\rancher\agent\rancher2_connection_info.json
C:\etc\rancher\rke2\config.yaml.d\50-rancher.yaml
C:\var\lib\rancher\agent\applied\*-*-applied.plan
C:\usr\local\bin\rke2
C:\var\lib\rancher\capr\idempotence\idempotent.sh
</code></pre>
<p>RKE2 nodes expand the list to include the files below:</p>
<pre><code>C:\etc\rancher\node\password
C:\var\lib\rancher\rke2\agent\logs\kubelet.log
C:\var\lib\rancher\rke2\data\v1.**.**-rke2r*-windows-amd64-*\bin\*
C:\var\lib\rancher\rke2\bin\*
</code></pre>
<p><strong>This vulnerability is exclusive to deployments that contain Windows nodes. Linux-only environments are not affected by it.</strong></p>
<p>Please consult the associated <a href="https://attack.mitre.org/techniques/T1068/">MITRE ATT&amp;CK - Technique - Exploitation for Privilege Escalation</a> for further information about this category of attack.</p>
<h3 id="patches">Patches</h3>
<p>Patched versions include Rancher Manager <code>2.8.9</code> and <code>2.9.3</code>. For RKE2 Windows nodes, please refer to its <a href="https://github.com/rancher/rke2/security/advisories/GHSA-x7xj-jvwp-97rv">specific advisory</a>. No patches are available for 2.7, therefore users are urged to upgrade to newer minor versions or to apply the manual workaround below.</p>
<h3 id="workarounds">Workarounds</h3>
<p>Users are advised to upgrade to a patched version of Rancher Manager. When that is not possible, users can enforce stricter ACLs for all sensitive files affected by this Security Advisory running <a href="https://github.com/rancherlabs/support-tools/blob/master/windows-access-control-lists/README.md">this</a> PowerShell script as an Administrator on each node.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-32197">CVE-2023-32197</a></li>
<li><a href="https://github.com/rancher/rke2/security/advisories/GHSA-x7xj-jvwp-97rv">RKE2’s GHSA-x7xj-jvwp-97rv</a></li>
</ul>
<h3 id="for-more-information">For more information</h3>
<p>If you have any questions or comments about this advisory:</p>
<ul>
<li>Reach out to the <a href="https://github.com/rancher/rancher/security/policy">SUSE Rancher Security team</a> for security related inquiries.</li>
<li>Open an issue in the <a href="https://github.com/rancher/rancher/issues/new/choose">Rancher</a> repository.</li>
<li>Verify with our <a href="https://www.suse.com/suse-rancher/support-matrix/all-supported-versions/">support matrix</a> and <a href="https://www.suse.com/lifecycle/">product support lifecycle</a>.</li>
</ul>
<h3 id="references-1">References</h3>
<ul>
<li><a href="https://github.com/rancher/rancher/security/advisories/GHSA-7h8m-pvw3-5gh4">https://github.com/rancher/rancher/security/advisories/GHSA-7h8m-pvw3-5gh4</a></li>
<li><a href="https://github.com/advisories/GHSA-7h8m-pvw3-5gh4">https://github.com/advisories/GHSA-7h8m-pvw3-5gh4</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-7h8m-pvw3-5gh4</uri>
        </author>
        <category label="severity" term="CRITICAL"/>
        <published>2024-10-25T19:35:00.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[github.com/zitadel/zitadel] User Registration Bypass in Zitadel]]></title>
        <id>https://github.com/advisories/GHSA-3rmw-76m6-4gjc</id>
        <link href="https://github.com/advisories/GHSA-3rmw-76m6-4gjc"/>
        <updated>2024-10-25T19:30:15.000Z</updated>
        <content type="html"><![CDATA[<h3 id="impact">Impact</h3>
<p>Zitadel allows administrators to disable the user self-registration. Due to a missing security check in versions prior to 2.63.4, disabling the "User Registration allowed" option only hid the registration button on the login page. Users could bypass this restriction by directly accessing the registration URL (/ui/login/loginname) and register a user that way.</p>
<h3 id="patches">Patches</h3>
<p>2.x versions are fixed on &gt;= <a href="https://github.com/zitadel/zitadel/releases/tag/v2.64.0">2.64.0</a>
2.63.x versions are fixed on &gt;= <a href="https://github.com/zitadel/zitadel/releases/tag/v2.63.5">2.63.5</a>
2.62.x versions are fixed on &gt;= <a href="https://github.com/zitadel/zitadel/releases/tag/v2.62.7">2.62.7</a>
2.61.x versions are fixed on &gt;= <a href="https://github.com/zitadel/zitadel/releases/tag/v2.61.4">2.61.4</a>
2.60.x versions are fixed on &gt;= <a href="https://github.com/zitadel/zitadel/releases/tag/v2.60.4">2.60.4</a>
2.59.x versions are fixed on &gt;= <a href="https://github.com/zitadel/zitadel/releases/tag/v2.59.5">2.59.5</a>
2.58.x versions are fixed on &gt;= <a href="https://github.com/zitadel/zitadel/releases/tag/v2.58.7">2.58.7</a></p>
<h3 id="workarounds">Workarounds</h3>
<p>Updating to the patched version is the recommended solution.</p>
<h3 id="questions">Questions</h3>
<p>If you have any questions or comments about this advisory, please email us at <a href="mailto:security@zitadel.com">security@zitadel.com</a></p>
<h3 id="credits">Credits</h3>
<p>Thanks to @sevensolutions and @evilgensec for disclosing this!</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/zitadel/zitadel/security/advisories/GHSA-3rmw-76m6-4gjc">https://github.com/zitadel/zitadel/security/advisories/GHSA-3rmw-76m6-4gjc</a></li>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2024-49757">https://nvd.nist.gov/vuln/detail/CVE-2024-49757</a></li>
<li><a href="https://github.com/zitadel/zitadel/releases/tag/v2.58.7">https://github.com/zitadel/zitadel/releases/tag/v2.58.7</a></li>
<li><a href="https://github.com/zitadel/zitadel/releases/tag/v2.59.5">https://github.com/zitadel/zitadel/releases/tag/v2.59.5</a></li>
<li><a href="https://github.com/zitadel/zitadel/releases/tag/v2.60.4">https://github.com/zitadel/zitadel/releases/tag/v2.60.4</a></li>
<li><a href="https://github.com/zitadel/zitadel/releases/tag/v2.61.4">https://github.com/zitadel/zitadel/releases/tag/v2.61.4</a></li>
<li><a href="https://github.com/zitadel/zitadel/releases/tag/v2.62.7">https://github.com/zitadel/zitadel/releases/tag/v2.62.7</a></li>
<li><a href="https://github.com/zitadel/zitadel/releases/tag/v2.63.5">https://github.com/zitadel/zitadel/releases/tag/v2.63.5</a></li>
<li><a href="https://github.com/zitadel/zitadel/releases/tag/v2.64.0">https://github.com/zitadel/zitadel/releases/tag/v2.64.0</a></li>
<li><a href="https://github.com/advisories/GHSA-3rmw-76m6-4gjc">https://github.com/advisories/GHSA-3rmw-76m6-4gjc</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-3rmw-76m6-4gjc</uri>
        </author>
        <category label="severity" term="HIGH"/>
        <published>2024-10-25T19:30:14.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[github.com/zitadel/zitadel] User Registration Bypass in Zitadel]]></title>
        <id>https://github.com/advisories/GHSA-3rmw-76m6-4gjc</id>
        <link href="https://github.com/advisories/GHSA-3rmw-76m6-4gjc"/>
        <updated>2024-10-25T19:30:15.000Z</updated>
        <content type="html"><![CDATA[<h3 id="impact">Impact</h3>
<p>Zitadel allows administrators to disable the user self-registration. Due to a missing security check in versions prior to 2.63.4, disabling the "User Registration allowed" option only hid the registration button on the login page. Users could bypass this restriction by directly accessing the registration URL (/ui/login/loginname) and register a user that way.</p>
<h3 id="patches">Patches</h3>
<p>2.x versions are fixed on &gt;= <a href="https://github.com/zitadel/zitadel/releases/tag/v2.64.0">2.64.0</a>
2.63.x versions are fixed on &gt;= <a href="https://github.com/zitadel/zitadel/releases/tag/v2.63.5">2.63.5</a>
2.62.x versions are fixed on &gt;= <a href="https://github.com/zitadel/zitadel/releases/tag/v2.62.7">2.62.7</a>
2.61.x versions are fixed on &gt;= <a href="https://github.com/zitadel/zitadel/releases/tag/v2.61.4">2.61.4</a>
2.60.x versions are fixed on &gt;= <a href="https://github.com/zitadel/zitadel/releases/tag/v2.60.4">2.60.4</a>
2.59.x versions are fixed on &gt;= <a href="https://github.com/zitadel/zitadel/releases/tag/v2.59.5">2.59.5</a>
2.58.x versions are fixed on &gt;= <a href="https://github.com/zitadel/zitadel/releases/tag/v2.58.7">2.58.7</a></p>
<h3 id="workarounds">Workarounds</h3>
<p>Updating to the patched version is the recommended solution.</p>
<h3 id="questions">Questions</h3>
<p>If you have any questions or comments about this advisory, please email us at <a href="mailto:security@zitadel.com">security@zitadel.com</a></p>
<h3 id="credits">Credits</h3>
<p>Thanks to @sevensolutions and @evilgensec for disclosing this!</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/zitadel/zitadel/security/advisories/GHSA-3rmw-76m6-4gjc">https://github.com/zitadel/zitadel/security/advisories/GHSA-3rmw-76m6-4gjc</a></li>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2024-49757">https://nvd.nist.gov/vuln/detail/CVE-2024-49757</a></li>
<li><a href="https://github.com/zitadel/zitadel/releases/tag/v2.58.7">https://github.com/zitadel/zitadel/releases/tag/v2.58.7</a></li>
<li><a href="https://github.com/zitadel/zitadel/releases/tag/v2.59.5">https://github.com/zitadel/zitadel/releases/tag/v2.59.5</a></li>
<li><a href="https://github.com/zitadel/zitadel/releases/tag/v2.60.4">https://github.com/zitadel/zitadel/releases/tag/v2.60.4</a></li>
<li><a href="https://github.com/zitadel/zitadel/releases/tag/v2.61.4">https://github.com/zitadel/zitadel/releases/tag/v2.61.4</a></li>
<li><a href="https://github.com/zitadel/zitadel/releases/tag/v2.62.7">https://github.com/zitadel/zitadel/releases/tag/v2.62.7</a></li>
<li><a href="https://github.com/zitadel/zitadel/releases/tag/v2.63.5">https://github.com/zitadel/zitadel/releases/tag/v2.63.5</a></li>
<li><a href="https://github.com/zitadel/zitadel/releases/tag/v2.64.0">https://github.com/zitadel/zitadel/releases/tag/v2.64.0</a></li>
<li><a href="https://github.com/advisories/GHSA-3rmw-76m6-4gjc">https://github.com/advisories/GHSA-3rmw-76m6-4gjc</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-3rmw-76m6-4gjc</uri>
        </author>
        <category label="severity" term="HIGH"/>
        <published>2024-10-25T19:30:14.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[github.com/zitadel/zitadel] User Registration Bypass in Zitadel]]></title>
        <id>https://github.com/advisories/GHSA-3rmw-76m6-4gjc</id>
        <link href="https://github.com/advisories/GHSA-3rmw-76m6-4gjc"/>
        <updated>2024-10-25T19:30:15.000Z</updated>
        <content type="html"><![CDATA[<h3 id="impact">Impact</h3>
<p>Zitadel allows administrators to disable the user self-registration. Due to a missing security check in versions prior to 2.63.4, disabling the "User Registration allowed" option only hid the registration button on the login page. Users could bypass this restriction by directly accessing the registration URL (/ui/login/loginname) and register a user that way.</p>
<h3 id="patches">Patches</h3>
<p>2.x versions are fixed on &gt;= <a href="https://github.com/zitadel/zitadel/releases/tag/v2.64.0">2.64.0</a>
2.63.x versions are fixed on &gt;= <a href="https://github.com/zitadel/zitadel/releases/tag/v2.63.5">2.63.5</a>
2.62.x versions are fixed on &gt;= <a href="https://github.com/zitadel/zitadel/releases/tag/v2.62.7">2.62.7</a>
2.61.x versions are fixed on &gt;= <a href="https://github.com/zitadel/zitadel/releases/tag/v2.61.4">2.61.4</a>
2.60.x versions are fixed on &gt;= <a href="https://github.com/zitadel/zitadel/releases/tag/v2.60.4">2.60.4</a>
2.59.x versions are fixed on &gt;= <a href="https://github.com/zitadel/zitadel/releases/tag/v2.59.5">2.59.5</a>
2.58.x versions are fixed on &gt;= <a href="https://github.com/zitadel/zitadel/releases/tag/v2.58.7">2.58.7</a></p>
<h3 id="workarounds">Workarounds</h3>
<p>Updating to the patched version is the recommended solution.</p>
<h3 id="questions">Questions</h3>
<p>If you have any questions or comments about this advisory, please email us at <a href="mailto:security@zitadel.com">security@zitadel.com</a></p>
<h3 id="credits">Credits</h3>
<p>Thanks to @sevensolutions and @evilgensec for disclosing this!</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/zitadel/zitadel/security/advisories/GHSA-3rmw-76m6-4gjc">https://github.com/zitadel/zitadel/security/advisories/GHSA-3rmw-76m6-4gjc</a></li>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2024-49757">https://nvd.nist.gov/vuln/detail/CVE-2024-49757</a></li>
<li><a href="https://github.com/zitadel/zitadel/releases/tag/v2.58.7">https://github.com/zitadel/zitadel/releases/tag/v2.58.7</a></li>
<li><a href="https://github.com/zitadel/zitadel/releases/tag/v2.59.5">https://github.com/zitadel/zitadel/releases/tag/v2.59.5</a></li>
<li><a href="https://github.com/zitadel/zitadel/releases/tag/v2.60.4">https://github.com/zitadel/zitadel/releases/tag/v2.60.4</a></li>
<li><a href="https://github.com/zitadel/zitadel/releases/tag/v2.61.4">https://github.com/zitadel/zitadel/releases/tag/v2.61.4</a></li>
<li><a href="https://github.com/zitadel/zitadel/releases/tag/v2.62.7">https://github.com/zitadel/zitadel/releases/tag/v2.62.7</a></li>
<li><a href="https://github.com/zitadel/zitadel/releases/tag/v2.63.5">https://github.com/zitadel/zitadel/releases/tag/v2.63.5</a></li>
<li><a href="https://github.com/zitadel/zitadel/releases/tag/v2.64.0">https://github.com/zitadel/zitadel/releases/tag/v2.64.0</a></li>
<li><a href="https://github.com/advisories/GHSA-3rmw-76m6-4gjc">https://github.com/advisories/GHSA-3rmw-76m6-4gjc</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-3rmw-76m6-4gjc</uri>
        </author>
        <category label="severity" term="HIGH"/>
        <published>2024-10-25T19:30:14.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[github.com/zitadel/zitadel] User Registration Bypass in Zitadel]]></title>
        <id>https://github.com/advisories/GHSA-3rmw-76m6-4gjc</id>
        <link href="https://github.com/advisories/GHSA-3rmw-76m6-4gjc"/>
        <updated>2024-10-25T19:30:15.000Z</updated>
        <content type="html"><![CDATA[<h3 id="impact">Impact</h3>
<p>Zitadel allows administrators to disable the user self-registration. Due to a missing security check in versions prior to 2.63.4, disabling the "User Registration allowed" option only hid the registration button on the login page. Users could bypass this restriction by directly accessing the registration URL (/ui/login/loginname) and register a user that way.</p>
<h3 id="patches">Patches</h3>
<p>2.x versions are fixed on &gt;= <a href="https://github.com/zitadel/zitadel/releases/tag/v2.64.0">2.64.0</a>
2.63.x versions are fixed on &gt;= <a href="https://github.com/zitadel/zitadel/releases/tag/v2.63.5">2.63.5</a>
2.62.x versions are fixed on &gt;= <a href="https://github.com/zitadel/zitadel/releases/tag/v2.62.7">2.62.7</a>
2.61.x versions are fixed on &gt;= <a href="https://github.com/zitadel/zitadel/releases/tag/v2.61.4">2.61.4</a>
2.60.x versions are fixed on &gt;= <a href="https://github.com/zitadel/zitadel/releases/tag/v2.60.4">2.60.4</a>
2.59.x versions are fixed on &gt;= <a href="https://github.com/zitadel/zitadel/releases/tag/v2.59.5">2.59.5</a>
2.58.x versions are fixed on &gt;= <a href="https://github.com/zitadel/zitadel/releases/tag/v2.58.7">2.58.7</a></p>
<h3 id="workarounds">Workarounds</h3>
<p>Updating to the patched version is the recommended solution.</p>
<h3 id="questions">Questions</h3>
<p>If you have any questions or comments about this advisory, please email us at <a href="mailto:security@zitadel.com">security@zitadel.com</a></p>
<h3 id="credits">Credits</h3>
<p>Thanks to @sevensolutions and @evilgensec for disclosing this!</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/zitadel/zitadel/security/advisories/GHSA-3rmw-76m6-4gjc">https://github.com/zitadel/zitadel/security/advisories/GHSA-3rmw-76m6-4gjc</a></li>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2024-49757">https://nvd.nist.gov/vuln/detail/CVE-2024-49757</a></li>
<li><a href="https://github.com/zitadel/zitadel/releases/tag/v2.58.7">https://github.com/zitadel/zitadel/releases/tag/v2.58.7</a></li>
<li><a href="https://github.com/zitadel/zitadel/releases/tag/v2.59.5">https://github.com/zitadel/zitadel/releases/tag/v2.59.5</a></li>
<li><a href="https://github.com/zitadel/zitadel/releases/tag/v2.60.4">https://github.com/zitadel/zitadel/releases/tag/v2.60.4</a></li>
<li><a href="https://github.com/zitadel/zitadel/releases/tag/v2.61.4">https://github.com/zitadel/zitadel/releases/tag/v2.61.4</a></li>
<li><a href="https://github.com/zitadel/zitadel/releases/tag/v2.62.7">https://github.com/zitadel/zitadel/releases/tag/v2.62.7</a></li>
<li><a href="https://github.com/zitadel/zitadel/releases/tag/v2.63.5">https://github.com/zitadel/zitadel/releases/tag/v2.63.5</a></li>
<li><a href="https://github.com/zitadel/zitadel/releases/tag/v2.64.0">https://github.com/zitadel/zitadel/releases/tag/v2.64.0</a></li>
<li><a href="https://github.com/advisories/GHSA-3rmw-76m6-4gjc">https://github.com/advisories/GHSA-3rmw-76m6-4gjc</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-3rmw-76m6-4gjc</uri>
        </author>
        <category label="severity" term="HIGH"/>
        <published>2024-10-25T19:30:14.000Z</published>
    </entry>
</feed>