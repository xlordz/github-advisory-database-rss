<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
    <id>https://azu.github.io/github-advisory-database-rss/go.rss</id>
    <title>Security Advisory for Go modules</title>
    <updated>2024-10-28T23:01:20.441Z</updated>
    <generator>github-advisory-database-rss</generator>
    <link rel="alternate" href="https://github.com/advisories?query=type%3Areviewed+ecosystem%3Ago"/>
    <subtitle>Security Advisory for Go modules on GitHub</subtitle>
    <rights>github-advisory-database-rss</rights>
    <category term="CRITICAL"/>
    <category term="HIGH"/>
    <category term="MODERATE"/>
    <category term="LOW"/>
    <entry>
        <title type="html"><![CDATA[[github.com/mattermost/mattermost/server/v8] Mattermost incorrectly issues two sessions when using desktop SSO]]></title>
        <id>https://github.com/advisories/GHSA-hm57-h27x-599c</id>
        <link href="https://github.com/advisories/GHSA-hm57-h27x-599c"/>
        <updated>2024-10-28T18:43:50.000Z</updated>
        <content type="html"><![CDATA[<p>Mattermost versions 9.11.X &lt;= 9.11.1, 9.5.x &lt;= 9.5.9 incorrectly issues two sessions when using desktop SSO - one in the browser and one in desktop with incorrect settings.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2024-10214">https://nvd.nist.gov/vuln/detail/CVE-2024-10214</a></li>
<li><a href="https://mattermost.com/security-updates">https://mattermost.com/security-updates</a></li>
<li><a href="https://github.com/mattermost/mattermost/commit/0d6b1070a26f0b9fc13f7e7fbbe18b6a31570c5a">https://github.com/mattermost/mattermost/commit/0d6b1070a26f0b9fc13f7e7fbbe18b6a31570c5a</a></li>
<li><a href="https://github.com/advisories/GHSA-hm57-h27x-599c">https://github.com/advisories/GHSA-hm57-h27x-599c</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-hm57-h27x-599c</uri>
        </author>
        <category label="severity" term="LOW"/>
        <published>2024-10-28T15:31:16.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[github.com/coder/coder/v2] Coder vulnerable to post-auth URL redirection to untrusted site ('Open Redirect')]]></title>
        <id>https://github.com/advisories/GHSA-wcx9-ccpj-hx3c</id>
        <link href="https://github.com/advisories/GHSA-wcx9-ccpj-hx3c"/>
        <updated>2024-10-28T18:31:58.000Z</updated>
        <content type="html"><![CDATA[<h3 id="summary">Summary</h3>
<p>An issue on Coder's login page allows attackers to craft a Coder URL that when clicked by a logged in user could redirect them to a website the attacker controls, e.g. <a href="https://google.com">https://google.com</a>.</p>
<h3 id="details">Details</h3>
<p>On the login page, Coder checks for the presence of a <code>redirect</code> query parameter. On successful login, the user would be redirected to the location of the parameter. Improper sanitization allows attackers to specify a URL outside of the Coder application to redirect users to.</p>
<h3 id="impact">Impact</h3>
<p>Coder users could potentially be redirected to a untrusted website if tricked into clicking a URL crafted by the attacker. Coder authentication tokens are <strong>not</strong> leaked to the resulting website.</p>
<p>To check if your deployment is vulnerable, visit the following URL for your Coder deployment:</p>
<ul>
<li><code>https://&lt;coder url&gt;/login?redirect=https%3A%2F%2Fcoder.com%2Fdocs</code></li>
</ul>
<h3 id="patched-versions">Patched Versions</h3>
<p>This vulnerability is remedied in</p>
<ul>
<li>v2.16.1</li>
<li>v2.15.3</li>
<li>v2.14.4</li>
</ul>
<p>All versions prior to 2.3.1 are not affected.</p>
<h3 id="thanks">Thanks</h3>
<ul>
<li><a href="https://github.com/jchristov">https://github.com/jchristov</a></li>
</ul>
<h3 id="references">References</h3>
<p><a href="https://github.com/coder/coder/security/advisories/GHSA-wcx9-ccpj-hx3c">https://github.com/coder/coder/security/advisories/GHSA-wcx9-ccpj-hx3c</a>
<a href="https://github.com/coder/coder/commit/69c1d981e3131e50d52b01f6a360abadaad699e6">https://github.com/coder/coder/commit/69c1d981e3131e50d52b01f6a360abadaad699e6</a></p>
<h3 id="references-1">References</h3>
<ul>
<li><a href="https://github.com/coder/coder/security/advisories/GHSA-wcx9-ccpj-hx3c">https://github.com/coder/coder/security/advisories/GHSA-wcx9-ccpj-hx3c</a></li>
<li><a href="https://github.com/coder/coder/commit/69c1d981e3131e50d52b01f6a360abadaad699e6">https://github.com/coder/coder/commit/69c1d981e3131e50d52b01f6a360abadaad699e6</a></li>
<li><a href="https://github.com/advisories/GHSA-wcx9-ccpj-hx3c">https://github.com/advisories/GHSA-wcx9-ccpj-hx3c</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-wcx9-ccpj-hx3c</uri>
        </author>
        <category label="severity" term="MODERATE"/>
        <published>2024-10-28T18:31:57.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[github.com/coder/coder/v2] Coder vulnerable to post-auth URL redirection to untrusted site ('Open Redirect')]]></title>
        <id>https://github.com/advisories/GHSA-wcx9-ccpj-hx3c</id>
        <link href="https://github.com/advisories/GHSA-wcx9-ccpj-hx3c"/>
        <updated>2024-10-28T18:31:58.000Z</updated>
        <content type="html"><![CDATA[<h3 id="summary">Summary</h3>
<p>An issue on Coder's login page allows attackers to craft a Coder URL that when clicked by a logged in user could redirect them to a website the attacker controls, e.g. <a href="https://google.com">https://google.com</a>.</p>
<h3 id="details">Details</h3>
<p>On the login page, Coder checks for the presence of a <code>redirect</code> query parameter. On successful login, the user would be redirected to the location of the parameter. Improper sanitization allows attackers to specify a URL outside of the Coder application to redirect users to.</p>
<h3 id="impact">Impact</h3>
<p>Coder users could potentially be redirected to a untrusted website if tricked into clicking a URL crafted by the attacker. Coder authentication tokens are <strong>not</strong> leaked to the resulting website.</p>
<p>To check if your deployment is vulnerable, visit the following URL for your Coder deployment:</p>
<ul>
<li><code>https://&lt;coder url&gt;/login?redirect=https%3A%2F%2Fcoder.com%2Fdocs</code></li>
</ul>
<h3 id="patched-versions">Patched Versions</h3>
<p>This vulnerability is remedied in</p>
<ul>
<li>v2.16.1</li>
<li>v2.15.3</li>
<li>v2.14.4</li>
</ul>
<p>All versions prior to 2.3.1 are not affected.</p>
<h3 id="thanks">Thanks</h3>
<ul>
<li><a href="https://github.com/jchristov">https://github.com/jchristov</a></li>
</ul>
<h3 id="references">References</h3>
<p><a href="https://github.com/coder/coder/security/advisories/GHSA-wcx9-ccpj-hx3c">https://github.com/coder/coder/security/advisories/GHSA-wcx9-ccpj-hx3c</a>
<a href="https://github.com/coder/coder/commit/69c1d981e3131e50d52b01f6a360abadaad699e6">https://github.com/coder/coder/commit/69c1d981e3131e50d52b01f6a360abadaad699e6</a></p>
<h3 id="references-1">References</h3>
<ul>
<li><a href="https://github.com/coder/coder/security/advisories/GHSA-wcx9-ccpj-hx3c">https://github.com/coder/coder/security/advisories/GHSA-wcx9-ccpj-hx3c</a></li>
<li><a href="https://github.com/coder/coder/commit/69c1d981e3131e50d52b01f6a360abadaad699e6">https://github.com/coder/coder/commit/69c1d981e3131e50d52b01f6a360abadaad699e6</a></li>
<li><a href="https://github.com/advisories/GHSA-wcx9-ccpj-hx3c">https://github.com/advisories/GHSA-wcx9-ccpj-hx3c</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-wcx9-ccpj-hx3c</uri>
        </author>
        <category label="severity" term="MODERATE"/>
        <published>2024-10-28T18:31:57.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[github.com/coder/coder/v2] Coder vulnerable to post-auth URL redirection to untrusted site ('Open Redirect')]]></title>
        <id>https://github.com/advisories/GHSA-wcx9-ccpj-hx3c</id>
        <link href="https://github.com/advisories/GHSA-wcx9-ccpj-hx3c"/>
        <updated>2024-10-28T18:31:58.000Z</updated>
        <content type="html"><![CDATA[<h3 id="summary">Summary</h3>
<p>An issue on Coder's login page allows attackers to craft a Coder URL that when clicked by a logged in user could redirect them to a website the attacker controls, e.g. <a href="https://google.com">https://google.com</a>.</p>
<h3 id="details">Details</h3>
<p>On the login page, Coder checks for the presence of a <code>redirect</code> query parameter. On successful login, the user would be redirected to the location of the parameter. Improper sanitization allows attackers to specify a URL outside of the Coder application to redirect users to.</p>
<h3 id="impact">Impact</h3>
<p>Coder users could potentially be redirected to a untrusted website if tricked into clicking a URL crafted by the attacker. Coder authentication tokens are <strong>not</strong> leaked to the resulting website.</p>
<p>To check if your deployment is vulnerable, visit the following URL for your Coder deployment:</p>
<ul>
<li><code>https://&lt;coder url&gt;/login?redirect=https%3A%2F%2Fcoder.com%2Fdocs</code></li>
</ul>
<h3 id="patched-versions">Patched Versions</h3>
<p>This vulnerability is remedied in</p>
<ul>
<li>v2.16.1</li>
<li>v2.15.3</li>
<li>v2.14.4</li>
</ul>
<p>All versions prior to 2.3.1 are not affected.</p>
<h3 id="thanks">Thanks</h3>
<ul>
<li><a href="https://github.com/jchristov">https://github.com/jchristov</a></li>
</ul>
<h3 id="references">References</h3>
<p><a href="https://github.com/coder/coder/security/advisories/GHSA-wcx9-ccpj-hx3c">https://github.com/coder/coder/security/advisories/GHSA-wcx9-ccpj-hx3c</a>
<a href="https://github.com/coder/coder/commit/69c1d981e3131e50d52b01f6a360abadaad699e6">https://github.com/coder/coder/commit/69c1d981e3131e50d52b01f6a360abadaad699e6</a></p>
<h3 id="references-1">References</h3>
<ul>
<li><a href="https://github.com/coder/coder/security/advisories/GHSA-wcx9-ccpj-hx3c">https://github.com/coder/coder/security/advisories/GHSA-wcx9-ccpj-hx3c</a></li>
<li><a href="https://github.com/coder/coder/commit/69c1d981e3131e50d52b01f6a360abadaad699e6">https://github.com/coder/coder/commit/69c1d981e3131e50d52b01f6a360abadaad699e6</a></li>
<li><a href="https://github.com/advisories/GHSA-wcx9-ccpj-hx3c">https://github.com/advisories/GHSA-wcx9-ccpj-hx3c</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-wcx9-ccpj-hx3c</uri>
        </author>
        <category label="severity" term="MODERATE"/>
        <published>2024-10-28T18:31:57.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[github.com/argoproj/argo-workflows/v3] Argo Workflows Controller: Denial of Service via malicious daemon Workflows]]></title>
        <id>https://github.com/advisories/GHSA-ghjw-32xw-ffwr</id>
        <link href="https://github.com/advisories/GHSA-ghjw-32xw-ffwr"/>
        <updated>2024-10-28T19:44:06.000Z</updated>
        <content type="html"><![CDATA[<h3 id="summary">Summary</h3>
<p>Due to a race condition in a global variable, the argo workflows controller can be made to crash on-command by any user with access to execute a workflow.</p>
<p>This was resolved by <a href="https://github.com/argoproj/argo-workflows/pull/13641">https://github.com/argoproj/argo-workflows/pull/13641</a></p>
<h3 id="details">Details</h3>
<p>These two lines introduce a data race in the underlying SPDY implementation of the Kubernetes API client. If a second request is made before the first completes, it results in a panic due to a null pointer.</p>
<ul>
<li><a href="https://github.com/argoproj/argo-workflows/blob/ce7f9bfb9b45f009b3e85fabe5e6410de23c7c5f/workflow/metrics/metrics_k8s_request.go#L49">https://github.com/argoproj/argo-workflows/blob/ce7f9bfb9b45f009b3e85fabe5e6410de23c7c5f/workflow/metrics/metrics_k8s_request.go#L49</a></li>
<li><a href="https://github.com/argoproj/argo-workflows/blob/ce7f9bfb9b45f009b3e85fabe5e6410de23c7c5f/workflow/metrics/metrics_k8s_request.go#L75">https://github.com/argoproj/argo-workflows/blob/ce7f9bfb9b45f009b3e85fabe5e6410de23c7c5f/workflow/metrics/metrics_k8s_request.go#L75</a></li>
</ul>
<p>This appears to have been added in this commit <a href="https://github.com/argoproj/argo-workflows/commit/9756babd0ed589d1cd24592f05725f748f74130b">https://github.com/argoproj/argo-workflows/commit/9756babd0ed589d1cd24592f05725f748f74130b</a> / #13265 / v3.6.0-rc1</p>
<h3 id="poc">PoC</h3>
<p>With the <code>KUBECONFIG</code> variable set to an appropriate file with <code>create</code> permissions for the <code>Workflow</code> kind, execute the following bash script:</p>
<pre><code class="language-bash">#!/bin/bash -xeu

while true ; do
    name=$(
        { argo submit /dev/stdin &lt;&lt;'EOF'
apiVersion: argoproj.io/v1alpha1
kind: Workflow
metadata:
  generateName: curl-
spec:
  entrypoint: main
  templates:
  - name: main
    dag:
      tasks:
        - name: no-op
          template: no-op
          withSequence:
            count: 3
  - name: no-op
    daemon: true
    container:
      image: alpine:3.13
      command: [sleep, infinity]
EOF
    } | head -n1 | awk '{ print $2 }'
    )
    ( sleep 30; argo terminate $name ) &amp;
    sleep 15
done
</code></pre>
<p>This script creates, and subsequently cleans up, multiple <code>daemon</code> pods in rapid succession. Each pod cleanup involves executing a <code>kill</code> instruction using the Kubernetes <code>exec</code> API, triggering the conditions for the panic. This can be seen when the tests mark the pods as complete, but the workflow itself never completes. Observing the controller logs when this happens shows the panic and restart of the controller every few seconds. In a setup with exponential backoff (e.g. a Kubernetes Pod) this is enough to reliably cause crashes enough to extend this backoff significantly and leave other workflows stalled.</p>
<p>Because the restarted controller believes it has sent the <code>kill</code> signal, it will wait indefinitely for the pod to terminate, which it never will, so the attack must constantly garbage-collect its own workflows with the <code>argo terminate</code> command, otherwise the maximum concurrently running workflows will be reached. A more sophisticated attack could detect when the workflow has been signaled to clean up and terminate it then instead of relying on a simple timer.</p>
<h3 id="impact">Impact</h3>
<p>A malicious user with access to create workflows can continually submit workflows that do nothing except create and then clean up multiple daemon pods, resulting in a crash-loop that prevents other users' workflows from running. This can be done with only a handful of pods and very little cpu and memory, meaning typical multi-tenant Kubernetes controls such as Pod count and resource quotas are not effective at preventing it.</p>
<p>Because the panic log does not in any way suggest that the issue has anything to do with the daemon pods, and an attacker could easily disguise these daemon pods as part of a genuine workflow, it would be difficult for administrators to discover the root cause of the DoS and the individuals responsible to remove their access.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/argoproj/argo-workflows/security/advisories/GHSA-ghjw-32xw-ffwr">https://github.com/argoproj/argo-workflows/security/advisories/GHSA-ghjw-32xw-ffwr</a></li>
<li><a href="https://github.com/argoproj/argo-workflows/pull/13641">https://github.com/argoproj/argo-workflows/pull/13641</a></li>
<li><a href="https://github.com/argoproj/argo-workflows/commit/524406451f4dfa57bf3371fb85becdb56a2b309a">https://github.com/argoproj/argo-workflows/commit/524406451f4dfa57bf3371fb85becdb56a2b309a</a></li>
<li><a href="https://github.com/argoproj/argo-workflows/blob/ce7f9bfb9b45f009b3e85fabe5e6410de23c7c5f/workflow/metrics/metrics_k8s_request.go#L75">https://github.com/argoproj/argo-workflows/blob/ce7f9bfb9b45f009b3e85fabe5e6410de23c7c5f/workflow/metrics/metrics_k8s_request.go#L75</a></li>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2024-47827">https://nvd.nist.gov/vuln/detail/CVE-2024-47827</a></li>
<li><a href="https://github.com/advisories/GHSA-ghjw-32xw-ffwr">https://github.com/advisories/GHSA-ghjw-32xw-ffwr</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-ghjw-32xw-ffwr</uri>
        </author>
        <category label="severity" term="MODERATE"/>
        <published>2024-10-28T18:28:03.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[github.com/go-mysql-org/go-mysql] go-mysql affected by go.uuid's Predictable UUID Identifiers]]></title>
        <id>https://github.com/advisories/GHSA-rc7v-65v6-m2v3</id>
        <link href="https://github.com/advisories/GHSA-rc7v-65v6-m2v3"/>
        <updated>2024-10-28T15:12:22.000Z</updated>
        <content type="html"><![CDATA[<p>Affected by CVE-2021-3538</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/apptainer/sif/security/advisories/GHSA-33m6-q9v5-62r7">https://github.com/apptainer/sif/security/advisories/GHSA-33m6-q9v5-62r7</a></li>
<li><a href="https://github.com/go-mysql-org/go-mysql/security/advisories/GHSA-rc7v-65v6-m2v3">https://github.com/go-mysql-org/go-mysql/security/advisories/GHSA-rc7v-65v6-m2v3</a></li>
<li><a href="https://github.com/hpcng/sif/security/advisories/GHSA-33m6-q9v5-62r7">https://github.com/hpcng/sif/security/advisories/GHSA-33m6-q9v5-62r7</a></li>
<li><a href="https://github.com/advisories/GHSA-rc7v-65v6-m2v3">https://github.com/advisories/GHSA-rc7v-65v6-m2v3</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-rc7v-65v6-m2v3</uri>
        </author>
        <category label="severity" term="CRITICAL"/>
        <published>2024-10-28T15:12:22.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[github.com/ginuerzh/gost] Missing key verification in gost]]></title>
        <id>https://github.com/advisories/GHSA-8wxx-35qc-vp6r</id>
        <link href="https://github.com/advisories/GHSA-8wxx-35qc-vp6r"/>
        <updated>2024-10-25T22:07:26.000Z</updated>
        <content type="html"><![CDATA[<p>An authentication bypass in the SSH service of gost v2.11.5 allows attackers to intercept communications via setting the HostKeyCallback function to ssh.InsecureIgnoreHostKey</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2024-39223">https://nvd.nist.gov/vuln/detail/CVE-2024-39223</a></li>
<li><a href="https://github.com/ginuerzh/gost/issues/1034">https://github.com/ginuerzh/gost/issues/1034</a></li>
<li><a href="https://gist.github.com/nyxfqq/a7242170b1118e78436a62dee4e09e8a">https://gist.github.com/nyxfqq/a7242170b1118e78436a62dee4e09e8a</a></li>
<li><a href="https://github.com/ginuerzh/gost/blob/729d0e70005607dc7c69fc1de62fd8fe21f85355/ssh.go#L229">https://github.com/ginuerzh/gost/blob/729d0e70005607dc7c69fc1de62fd8fe21f85355/ssh.go#L229</a></li>
<li><a href="https://github.com/advisories/GHSA-8wxx-35qc-vp6r">https://github.com/advisories/GHSA-8wxx-35qc-vp6r</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-8wxx-35qc-vp6r</uri>
        </author>
        <category label="severity" term="CRITICAL"/>
        <published>2024-07-03T18:48:20.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[github.com/libp2p/go-libp2p-kad-dht] Content Censorship in the InterPlanetary File System (IPFS) via Kademlia DHT abuse]]></title>
        <id>https://github.com/advisories/GHSA-mqr9-hjr8-2m9w</id>
        <link href="https://github.com/advisories/GHSA-mqr9-hjr8-2m9w"/>
        <updated>2024-10-25T21:35:14.000Z</updated>
        <content type="html"><![CDATA[<p>The Kademlia DHT (go-libp2p-kad-dht 0.20.0 and earlier) used in IPFS (0.18.1 and earlier) assigns routing information for content (i.e., information about who holds the content) to be stored by peers whose peer IDs have a small DHT distance from the content ID. This allows an attacker to censor content by generating many Sybil peers whose peer IDs have a small distance from the content ID, thus hijacking the content resolution process.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2023-26248">https://nvd.nist.gov/vuln/detail/CVE-2023-26248</a></li>
<li><a href="https://arxiv.org/abs/2307.12212">https://arxiv.org/abs/2307.12212</a></li>
<li><a href="https://github.com/libp2p/go-libp2p-kad-dht">https://github.com/libp2p/go-libp2p-kad-dht</a></li>
<li><a href="https://github.com/advisories/GHSA-mqr9-hjr8-2m9w">https://github.com/advisories/GHSA-mqr9-hjr8-2m9w</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-mqr9-hjr8-2m9w</uri>
        </author>
        <category label="severity" term="MODERATE"/>
        <published>2024-10-25T18:30:49.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[github.com/crossplane/crossplane] github.com/crossplane/crossplane: Unexpected behavior from Is methods for IPv4-mapped IPv6 addresses]]></title>
        <id>https://github.com/advisories/GHSA-7h65-4p22-39j6</id>
        <link href="https://github.com/advisories/GHSA-7h65-4p22-39j6"/>
        <updated>2024-10-25T19:42:31.000Z</updated>
        <content type="html"><![CDATA[<p>A critical vulnerability was reported in the versions of golang that Crossplane depends on. Details of the golang vulnerability are included below. Crossplane does not directly use the vulnerable functions from the <code>net/netip</code> package, but the version of golang libraries, runtime, and build tools have still been updated as part of this security advisory nonetheless.</p>
<p><strong>Critical Vulnerabilities</strong>
Vulnerability: <a href="https://nvd.nist.gov/vuln/detail/CVE-2024-24790">CVE-2024-24790</a>, <code>golang: net/netip: Unexpected behavior from Is methods for IPv4-mapped IPv6 addresses</code>
Description: The various Is methods (IsPrivate, IsLoopback, etc) did not work as expected for IPv4-mapped IPv6 addresses, returning false for addresses which would return true in their traditional IPv4 forms.</p>
<p>Affected versions: 1.17.1,1.16.2,1.15.5</p>
<p>See screenshot for more details
<img alt="Screenshot from 2024-09-18 17-36-37" src="https://github.com/user-attachments/assets/2e7ad31f-228a-4534-a4aa-b63d4911351d"></p>
<p>Fixed versions: 1.17.2,1.16.3,1.15.6</p>
<p>Release notes:</p>
<ul>
<li><a href="https://github.com/crossplane/crossplane/releases/tag/v1.17.2">https://github.com/crossplane/crossplane/releases/tag/v1.17.2</a></li>
<li><a href="https://github.com/crossplane/crossplane/releases/tag/v1.16.3">https://github.com/crossplane/crossplane/releases/tag/v1.16.3</a></li>
<li><a href="https://github.com/crossplane/crossplane/releases/tag/v1.15.6">https://github.com/crossplane/crossplane/releases/tag/v1.15.6</a></li>
</ul>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/crossplane/crossplane/security/advisories/GHSA-7h65-4p22-39j6">https://github.com/crossplane/crossplane/security/advisories/GHSA-7h65-4p22-39j6</a></li>
<li><a href="https://github.com/advisories/GHSA-7h65-4p22-39j6">https://github.com/advisories/GHSA-7h65-4p22-39j6</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-7h65-4p22-39j6</uri>
        </author>
        <category label="severity" term="CRITICAL"/>
        <published>2024-10-25T19:42:31.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[github.com/crossplane/crossplane] github.com/crossplane/crossplane: Unexpected behavior from Is methods for IPv4-mapped IPv6 addresses]]></title>
        <id>https://github.com/advisories/GHSA-7h65-4p22-39j6</id>
        <link href="https://github.com/advisories/GHSA-7h65-4p22-39j6"/>
        <updated>2024-10-25T19:42:31.000Z</updated>
        <content type="html"><![CDATA[<p>A critical vulnerability was reported in the versions of golang that Crossplane depends on. Details of the golang vulnerability are included below. Crossplane does not directly use the vulnerable functions from the <code>net/netip</code> package, but the version of golang libraries, runtime, and build tools have still been updated as part of this security advisory nonetheless.</p>
<p><strong>Critical Vulnerabilities</strong>
Vulnerability: <a href="https://nvd.nist.gov/vuln/detail/CVE-2024-24790">CVE-2024-24790</a>, <code>golang: net/netip: Unexpected behavior from Is methods for IPv4-mapped IPv6 addresses</code>
Description: The various Is methods (IsPrivate, IsLoopback, etc) did not work as expected for IPv4-mapped IPv6 addresses, returning false for addresses which would return true in their traditional IPv4 forms.</p>
<p>Affected versions: 1.17.1,1.16.2,1.15.5</p>
<p>See screenshot for more details
<img alt="Screenshot from 2024-09-18 17-36-37" src="https://github.com/user-attachments/assets/2e7ad31f-228a-4534-a4aa-b63d4911351d"></p>
<p>Fixed versions: 1.17.2,1.16.3,1.15.6</p>
<p>Release notes:</p>
<ul>
<li><a href="https://github.com/crossplane/crossplane/releases/tag/v1.17.2">https://github.com/crossplane/crossplane/releases/tag/v1.17.2</a></li>
<li><a href="https://github.com/crossplane/crossplane/releases/tag/v1.16.3">https://github.com/crossplane/crossplane/releases/tag/v1.16.3</a></li>
<li><a href="https://github.com/crossplane/crossplane/releases/tag/v1.15.6">https://github.com/crossplane/crossplane/releases/tag/v1.15.6</a></li>
</ul>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/crossplane/crossplane/security/advisories/GHSA-7h65-4p22-39j6">https://github.com/crossplane/crossplane/security/advisories/GHSA-7h65-4p22-39j6</a></li>
<li><a href="https://github.com/advisories/GHSA-7h65-4p22-39j6">https://github.com/advisories/GHSA-7h65-4p22-39j6</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-7h65-4p22-39j6</uri>
        </author>
        <category label="severity" term="CRITICAL"/>
        <published>2024-10-25T19:42:31.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[github.com/crossplane/crossplane] github.com/crossplane/crossplane: Unexpected behavior from Is methods for IPv4-mapped IPv6 addresses]]></title>
        <id>https://github.com/advisories/GHSA-7h65-4p22-39j6</id>
        <link href="https://github.com/advisories/GHSA-7h65-4p22-39j6"/>
        <updated>2024-10-25T19:42:31.000Z</updated>
        <content type="html"><![CDATA[<p>A critical vulnerability was reported in the versions of golang that Crossplane depends on. Details of the golang vulnerability are included below. Crossplane does not directly use the vulnerable functions from the <code>net/netip</code> package, but the version of golang libraries, runtime, and build tools have still been updated as part of this security advisory nonetheless.</p>
<p><strong>Critical Vulnerabilities</strong>
Vulnerability: <a href="https://nvd.nist.gov/vuln/detail/CVE-2024-24790">CVE-2024-24790</a>, <code>golang: net/netip: Unexpected behavior from Is methods for IPv4-mapped IPv6 addresses</code>
Description: The various Is methods (IsPrivate, IsLoopback, etc) did not work as expected for IPv4-mapped IPv6 addresses, returning false for addresses which would return true in their traditional IPv4 forms.</p>
<p>Affected versions: 1.17.1,1.16.2,1.15.5</p>
<p>See screenshot for more details
<img alt="Screenshot from 2024-09-18 17-36-37" src="https://github.com/user-attachments/assets/2e7ad31f-228a-4534-a4aa-b63d4911351d"></p>
<p>Fixed versions: 1.17.2,1.16.3,1.15.6</p>
<p>Release notes:</p>
<ul>
<li><a href="https://github.com/crossplane/crossplane/releases/tag/v1.17.2">https://github.com/crossplane/crossplane/releases/tag/v1.17.2</a></li>
<li><a href="https://github.com/crossplane/crossplane/releases/tag/v1.16.3">https://github.com/crossplane/crossplane/releases/tag/v1.16.3</a></li>
<li><a href="https://github.com/crossplane/crossplane/releases/tag/v1.15.6">https://github.com/crossplane/crossplane/releases/tag/v1.15.6</a></li>
</ul>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/crossplane/crossplane/security/advisories/GHSA-7h65-4p22-39j6">https://github.com/crossplane/crossplane/security/advisories/GHSA-7h65-4p22-39j6</a></li>
<li><a href="https://github.com/advisories/GHSA-7h65-4p22-39j6">https://github.com/advisories/GHSA-7h65-4p22-39j6</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-7h65-4p22-39j6</uri>
        </author>
        <category label="severity" term="CRITICAL"/>
        <published>2024-10-25T19:42:31.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[github.com/rancher/rke2] RKE2 allows privilege escalation in Windows nodes due to Insecure Access Control Lists]]></title>
        <id>https://github.com/advisories/GHSA-x7xj-jvwp-97rv</id>
        <link href="https://github.com/advisories/GHSA-x7xj-jvwp-97rv"/>
        <updated>2024-10-25T19:39:08.000Z</updated>
        <content type="html"><![CDATA[<h3 id="impact">Impact</h3>
<p>A vulnerability has been identified whereby RKE2 deployments in Windows nodes have weak Access Control Lists (ACL), allowing <code>BUILTIN\Users</code> or <code>NT AUTHORITY\Authenticated Users</code> to view or edit sensitive files which could lead to privilege escalation.</p>
<p>The affected files include binaries, scripts, configuration and log files:</p>
<pre><code>C:\etc\rancher\node\password
C:\var\lib\rancher\rke2\agent\logs\kubelet.log
C:\var\lib\rancher\rke2\data\v1.**.**-rke2r*-windows-amd64-*\bin\*
C:\var\lib\rancher\rke2\bin\*
</code></pre>
<p><strong>This vulnerability is exclusive to RKE2 in Windows environments. Linux environments are not affected by it.</strong></p>
<p>Please consult the associated <a href="https://attack.mitre.org/techniques/T1068/">MITRE ATT&amp;CK - Technique - Exploitation for Privilege Escalation</a> for further information about this category of attack.</p>
<h3 id="patches">Patches</h3>
<p>Patched versions include RKE2 <code>1.31.0</code>, <code>1.30.2</code>, <code>1.29.6</code>, <code>1.28.11</code> and <code>1.27.15</code>.</p>
<h3 id="workarounds">Workarounds</h3>
<p>Users are advised to do a fresh install of their RKE2 Windows nodes using a patched RKE2 version. 
When that is not possible, users can enforce stricter ACLs for all sensitive files affected by this Security Advisory running <a href="https://github.com/rancherlabs/support-tools/blob/master/windows-access-control-lists/README.md">this</a> PowerShell script as an Administrator on each node.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-32197">CVE-2023-32197</a></li>
<li><a href="https://github.com/rancher/rancher/security/advisories/GHSA-7h8m-pvw3-5gh4">Rancher Manager’s GHSA-7h8m-pvw3-5gh4</a></li>
</ul>
<h3 id="for-more-information">For more information</h3>
<p>If you have any questions or comments about this advisory:</p>
<ul>
<li>Reach out to the <a href="https://github.com/rancher/rancher/security/policy">SUSE Rancher Security team</a> for security related inquiries.</li>
<li>Open an issue in the <a href="https://github.com/rancher/rancher/issues/new/choose">Rancher</a> repository.</li>
<li>Verify with our <a href="https://www.suse.com/suse-rancher/support-matrix/all-supported-versions/">support matrix</a> and <a href="https://www.suse.com/lifecycle/">product support lifecycle</a>.</li>
</ul>
<h3 id="references-1">References</h3>
<ul>
<li><a href="https://github.com/rancher/rancher/security/advisories/GHSA-7h8m-pvw3-5gh4">https://github.com/rancher/rancher/security/advisories/GHSA-7h8m-pvw3-5gh4</a></li>
<li><a href="https://github.com/rancher/rke2/security/advisories/GHSA-x7xj-jvwp-97rv">https://github.com/rancher/rke2/security/advisories/GHSA-x7xj-jvwp-97rv</a></li>
<li><a href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-32197">https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-32197</a></li>
<li><a href="https://github.com/advisories/GHSA-x7xj-jvwp-97rv">https://github.com/advisories/GHSA-x7xj-jvwp-97rv</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-x7xj-jvwp-97rv</uri>
        </author>
        <category label="severity" term="CRITICAL"/>
        <published>2024-10-25T19:39:07.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[github.com/rancher/rke2] RKE2 allows privilege escalation in Windows nodes due to Insecure Access Control Lists]]></title>
        <id>https://github.com/advisories/GHSA-x7xj-jvwp-97rv</id>
        <link href="https://github.com/advisories/GHSA-x7xj-jvwp-97rv"/>
        <updated>2024-10-25T19:39:08.000Z</updated>
        <content type="html"><![CDATA[<h3 id="impact">Impact</h3>
<p>A vulnerability has been identified whereby RKE2 deployments in Windows nodes have weak Access Control Lists (ACL), allowing <code>BUILTIN\Users</code> or <code>NT AUTHORITY\Authenticated Users</code> to view or edit sensitive files which could lead to privilege escalation.</p>
<p>The affected files include binaries, scripts, configuration and log files:</p>
<pre><code>C:\etc\rancher\node\password
C:\var\lib\rancher\rke2\agent\logs\kubelet.log
C:\var\lib\rancher\rke2\data\v1.**.**-rke2r*-windows-amd64-*\bin\*
C:\var\lib\rancher\rke2\bin\*
</code></pre>
<p><strong>This vulnerability is exclusive to RKE2 in Windows environments. Linux environments are not affected by it.</strong></p>
<p>Please consult the associated <a href="https://attack.mitre.org/techniques/T1068/">MITRE ATT&amp;CK - Technique - Exploitation for Privilege Escalation</a> for further information about this category of attack.</p>
<h3 id="patches">Patches</h3>
<p>Patched versions include RKE2 <code>1.31.0</code>, <code>1.30.2</code>, <code>1.29.6</code>, <code>1.28.11</code> and <code>1.27.15</code>.</p>
<h3 id="workarounds">Workarounds</h3>
<p>Users are advised to do a fresh install of their RKE2 Windows nodes using a patched RKE2 version. 
When that is not possible, users can enforce stricter ACLs for all sensitive files affected by this Security Advisory running <a href="https://github.com/rancherlabs/support-tools/blob/master/windows-access-control-lists/README.md">this</a> PowerShell script as an Administrator on each node.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-32197">CVE-2023-32197</a></li>
<li><a href="https://github.com/rancher/rancher/security/advisories/GHSA-7h8m-pvw3-5gh4">Rancher Manager’s GHSA-7h8m-pvw3-5gh4</a></li>
</ul>
<h3 id="for-more-information">For more information</h3>
<p>If you have any questions or comments about this advisory:</p>
<ul>
<li>Reach out to the <a href="https://github.com/rancher/rancher/security/policy">SUSE Rancher Security team</a> for security related inquiries.</li>
<li>Open an issue in the <a href="https://github.com/rancher/rancher/issues/new/choose">Rancher</a> repository.</li>
<li>Verify with our <a href="https://www.suse.com/suse-rancher/support-matrix/all-supported-versions/">support matrix</a> and <a href="https://www.suse.com/lifecycle/">product support lifecycle</a>.</li>
</ul>
<h3 id="references-1">References</h3>
<ul>
<li><a href="https://github.com/rancher/rancher/security/advisories/GHSA-7h8m-pvw3-5gh4">https://github.com/rancher/rancher/security/advisories/GHSA-7h8m-pvw3-5gh4</a></li>
<li><a href="https://github.com/rancher/rke2/security/advisories/GHSA-x7xj-jvwp-97rv">https://github.com/rancher/rke2/security/advisories/GHSA-x7xj-jvwp-97rv</a></li>
<li><a href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-32197">https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-32197</a></li>
<li><a href="https://github.com/advisories/GHSA-x7xj-jvwp-97rv">https://github.com/advisories/GHSA-x7xj-jvwp-97rv</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-x7xj-jvwp-97rv</uri>
        </author>
        <category label="severity" term="CRITICAL"/>
        <published>2024-10-25T19:39:07.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[github.com/rancher/rke2] RKE2 allows privilege escalation in Windows nodes due to Insecure Access Control Lists]]></title>
        <id>https://github.com/advisories/GHSA-x7xj-jvwp-97rv</id>
        <link href="https://github.com/advisories/GHSA-x7xj-jvwp-97rv"/>
        <updated>2024-10-25T19:39:08.000Z</updated>
        <content type="html"><![CDATA[<h3 id="impact">Impact</h3>
<p>A vulnerability has been identified whereby RKE2 deployments in Windows nodes have weak Access Control Lists (ACL), allowing <code>BUILTIN\Users</code> or <code>NT AUTHORITY\Authenticated Users</code> to view or edit sensitive files which could lead to privilege escalation.</p>
<p>The affected files include binaries, scripts, configuration and log files:</p>
<pre><code>C:\etc\rancher\node\password
C:\var\lib\rancher\rke2\agent\logs\kubelet.log
C:\var\lib\rancher\rke2\data\v1.**.**-rke2r*-windows-amd64-*\bin\*
C:\var\lib\rancher\rke2\bin\*
</code></pre>
<p><strong>This vulnerability is exclusive to RKE2 in Windows environments. Linux environments are not affected by it.</strong></p>
<p>Please consult the associated <a href="https://attack.mitre.org/techniques/T1068/">MITRE ATT&amp;CK - Technique - Exploitation for Privilege Escalation</a> for further information about this category of attack.</p>
<h3 id="patches">Patches</h3>
<p>Patched versions include RKE2 <code>1.31.0</code>, <code>1.30.2</code>, <code>1.29.6</code>, <code>1.28.11</code> and <code>1.27.15</code>.</p>
<h3 id="workarounds">Workarounds</h3>
<p>Users are advised to do a fresh install of their RKE2 Windows nodes using a patched RKE2 version. 
When that is not possible, users can enforce stricter ACLs for all sensitive files affected by this Security Advisory running <a href="https://github.com/rancherlabs/support-tools/blob/master/windows-access-control-lists/README.md">this</a> PowerShell script as an Administrator on each node.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-32197">CVE-2023-32197</a></li>
<li><a href="https://github.com/rancher/rancher/security/advisories/GHSA-7h8m-pvw3-5gh4">Rancher Manager’s GHSA-7h8m-pvw3-5gh4</a></li>
</ul>
<h3 id="for-more-information">For more information</h3>
<p>If you have any questions or comments about this advisory:</p>
<ul>
<li>Reach out to the <a href="https://github.com/rancher/rancher/security/policy">SUSE Rancher Security team</a> for security related inquiries.</li>
<li>Open an issue in the <a href="https://github.com/rancher/rancher/issues/new/choose">Rancher</a> repository.</li>
<li>Verify with our <a href="https://www.suse.com/suse-rancher/support-matrix/all-supported-versions/">support matrix</a> and <a href="https://www.suse.com/lifecycle/">product support lifecycle</a>.</li>
</ul>
<h3 id="references-1">References</h3>
<ul>
<li><a href="https://github.com/rancher/rancher/security/advisories/GHSA-7h8m-pvw3-5gh4">https://github.com/rancher/rancher/security/advisories/GHSA-7h8m-pvw3-5gh4</a></li>
<li><a href="https://github.com/rancher/rke2/security/advisories/GHSA-x7xj-jvwp-97rv">https://github.com/rancher/rke2/security/advisories/GHSA-x7xj-jvwp-97rv</a></li>
<li><a href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-32197">https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-32197</a></li>
<li><a href="https://github.com/advisories/GHSA-x7xj-jvwp-97rv">https://github.com/advisories/GHSA-x7xj-jvwp-97rv</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-x7xj-jvwp-97rv</uri>
        </author>
        <category label="severity" term="CRITICAL"/>
        <published>2024-10-25T19:39:07.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[github.com/rancher/rke2] RKE2 allows privilege escalation in Windows nodes due to Insecure Access Control Lists]]></title>
        <id>https://github.com/advisories/GHSA-x7xj-jvwp-97rv</id>
        <link href="https://github.com/advisories/GHSA-x7xj-jvwp-97rv"/>
        <updated>2024-10-25T19:39:08.000Z</updated>
        <content type="html"><![CDATA[<h3 id="impact">Impact</h3>
<p>A vulnerability has been identified whereby RKE2 deployments in Windows nodes have weak Access Control Lists (ACL), allowing <code>BUILTIN\Users</code> or <code>NT AUTHORITY\Authenticated Users</code> to view or edit sensitive files which could lead to privilege escalation.</p>
<p>The affected files include binaries, scripts, configuration and log files:</p>
<pre><code>C:\etc\rancher\node\password
C:\var\lib\rancher\rke2\agent\logs\kubelet.log
C:\var\lib\rancher\rke2\data\v1.**.**-rke2r*-windows-amd64-*\bin\*
C:\var\lib\rancher\rke2\bin\*
</code></pre>
<p><strong>This vulnerability is exclusive to RKE2 in Windows environments. Linux environments are not affected by it.</strong></p>
<p>Please consult the associated <a href="https://attack.mitre.org/techniques/T1068/">MITRE ATT&amp;CK - Technique - Exploitation for Privilege Escalation</a> for further information about this category of attack.</p>
<h3 id="patches">Patches</h3>
<p>Patched versions include RKE2 <code>1.31.0</code>, <code>1.30.2</code>, <code>1.29.6</code>, <code>1.28.11</code> and <code>1.27.15</code>.</p>
<h3 id="workarounds">Workarounds</h3>
<p>Users are advised to do a fresh install of their RKE2 Windows nodes using a patched RKE2 version. 
When that is not possible, users can enforce stricter ACLs for all sensitive files affected by this Security Advisory running <a href="https://github.com/rancherlabs/support-tools/blob/master/windows-access-control-lists/README.md">this</a> PowerShell script as an Administrator on each node.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-32197">CVE-2023-32197</a></li>
<li><a href="https://github.com/rancher/rancher/security/advisories/GHSA-7h8m-pvw3-5gh4">Rancher Manager’s GHSA-7h8m-pvw3-5gh4</a></li>
</ul>
<h3 id="for-more-information">For more information</h3>
<p>If you have any questions or comments about this advisory:</p>
<ul>
<li>Reach out to the <a href="https://github.com/rancher/rancher/security/policy">SUSE Rancher Security team</a> for security related inquiries.</li>
<li>Open an issue in the <a href="https://github.com/rancher/rancher/issues/new/choose">Rancher</a> repository.</li>
<li>Verify with our <a href="https://www.suse.com/suse-rancher/support-matrix/all-supported-versions/">support matrix</a> and <a href="https://www.suse.com/lifecycle/">product support lifecycle</a>.</li>
</ul>
<h3 id="references-1">References</h3>
<ul>
<li><a href="https://github.com/rancher/rancher/security/advisories/GHSA-7h8m-pvw3-5gh4">https://github.com/rancher/rancher/security/advisories/GHSA-7h8m-pvw3-5gh4</a></li>
<li><a href="https://github.com/rancher/rke2/security/advisories/GHSA-x7xj-jvwp-97rv">https://github.com/rancher/rke2/security/advisories/GHSA-x7xj-jvwp-97rv</a></li>
<li><a href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-32197">https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-32197</a></li>
<li><a href="https://github.com/advisories/GHSA-x7xj-jvwp-97rv">https://github.com/advisories/GHSA-x7xj-jvwp-97rv</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-x7xj-jvwp-97rv</uri>
        </author>
        <category label="severity" term="CRITICAL"/>
        <published>2024-10-25T19:39:07.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[github.com/rancher/rancher] Rancher Remote Code Execution via Cluster/Node Drivers]]></title>
        <id>https://github.com/advisories/GHSA-h99m-6755-rgwc</id>
        <link href="https://github.com/advisories/GHSA-h99m-6755-rgwc"/>
        <updated>2024-10-25T19:37:22.000Z</updated>
        <content type="html"><![CDATA[<h3 id="impact">Impact</h3>
<p>A vulnerability has been identified within Rancher where a cluster or node driver can be used to escape the <code>chroot</code> jail and gain root access to the Rancher container itself. In production environments, further privilege escalation is possible based on living off the land within the Rancher container itself. For the test and development environments, based on a –privileged Docker container, it is possible to escape the Docker container and gain execution access on the host system. </p>
<p>This happens because:</p>
<ul>
<li>During startup, Rancher appends the <code>/opt/drivers/management-state/bin</code> directory to the <code>PATH</code> environment variable.</li>
<li>In Rancher, the binaries <code>/usr/bin/rancher-machine</code>, <code>/usr/bin/helm_v3</code>, and <code>/usr/bin/kustomize</code> are assigned a UID of 1001 and a GID of 127 instead of being owned by the root user.</li>
<li>Rancher employs a jail mechanism to isolate the execution of node drivers from the main process. However, the drivers are executed with excessive permissions.</li>
<li>During the registration of new node drivers, its binary is executed with the same user as the parent process, which could enable an attacker to gain elevated privileges by registering a malicious driver.</li>
<li>Lack of validation on the driver file type, which allows symbolic links to be used.</li>
</ul>
<p>Please consult the associated  <a href="https://attack.mitre.org/tactics/TA0004/">MITRE ATT&amp;CK - Technique - Privilege Escalation</a> and <a href="https://attack.mitre.org/tactics/TA0002/">MITRE ATT&amp;CK - Technique - Execution</a> for further information about this category of attack.</p>
<p><strong>Since they run at a privileged level, it is recommended to use trusted drivers only.</strong></p>
<h3 id="patches">Patches</h3>
<p>The fix involves some key areas with the following changes:</p>
<p>Fixing the <code>PATH</code> environment variable:</p>
<ul>
<li>Remove the step that appends <code>/opt/drivers/management-state/bin</code> to the <code>PATH</code> environment variable.</li>
</ul>
<p>Binaries permissions:</p>
<ul>
<li>Correct the permission of the binaries <code>/usr/bin/rancher-machine</code>, <code>/usr/bin/helm_v3</code>, and <code>/usr/bin/kustomize</code> so that they are owned by the root user.</li>
</ul>
<p>Improving Rancher jail security mechanism:</p>
<ul>
<li>A new group <code>jail-accessors</code> has been created, and the rancher user has been added to this group.</li>
<li>The <code>jail-accessors</code> group is granted read and execute permissions for the directories <code>/var/lib/rancher</code>, <code>/var/lib/cattle</code>, and <code>/usr/local/bin</code>.</li>
<li>The jail mechanism has been enhanced to execute commands using the non-root <code>rancher</code> user and the <code>jail-accessors</code> group. Additionally, a new setting, <code>UnprivilegedJailUser</code>, has been introduced to manage this behavior, allowing users to opt-out if they need to run drivers in a more privileged context.</li>
<li>Limit the devices copied to the jail directory to a minimal set.</li>
</ul>
<p>Fixing node driver registration:</p>
<ul>
<li>The <code>NewPlugin(driver)</code> function in the <code>rancher/machine</code> module has been updated to allow setting the UID and GID for starting the plugin server. If the environment variables <code>MACHINE_PLUGIN_UID</code> and <code>MACHINE_PLUGIN_GID</code> are set, their values will be used to configure the user credentials for launching the plugin server. </li>
<li>Rancher now sets these environment variables with a non-root UID and GID before invoking the <code>NewPlugin(driver)</code> function and then unsets them after retrieving the creation flags.</li>
</ul>
<p>Improvements on driver package:</p>
<ul>
<li>The <code>driver</code> package has been revised to verify that the downloaded driver binary is a regular file.</li>
<li>The <code>driver</code> package has been revised to verify that the target file in the downloaded tar file is a regular file.</li>
<li>The <code>driver</code> package now executes the downloaded driver binary within a jail, with a default timeout of 5 seconds.</li>
</ul>
<p>Other improvements:</p>
<ul>
<li>The helm package has been updated to ensure appropriate permissions are set on the generated kubeconfig file.</li>
<li>The <code>nodeConfig</code> package has been updated to ensure proper permissions are applied when extracting the node configuration.</li>
</ul>
<p>Patched versions include releases <code>2.7.16</code>, <code>2.8.9</code> and <code>2.9.3</code>.</p>
<h3 id="workarounds">Workarounds</h3>
<p>If you can't upgrade to a fixed version, please make sure that:</p>
<ol>
<li>Drivers are only executed from trusted sources.</li>
<li>The use of Admins/Restricted Admins is limited to trusted users.</li>
</ol>
<h3 id="references">References</h3>
<p>If you have any questions or comments about this advisory:</p>
<ul>
<li>Reach out to the <a href="https://github.com/rancher/rancher/security/policy">SUSE Rancher Security team</a> for security related inquiries.</li>
<li>Open an issue in the <a href="https://github.com/rancher/rancher/issues/new/choose">Rancher</a> repository.</li>
<li>Verify with our <a href="https://www.suse.com/suse-rancher/support-matrix/all-supported-versions/">support matrix</a> and <a href="https://www.suse.com/lifecycle/">product support lifecycle</a>.</li>
</ul>
<h3 id="references-1">References</h3>
<ul>
<li><a href="https://github.com/rancher/rancher/security/advisories/GHSA-h99m-6755-rgwc">https://github.com/rancher/rancher/security/advisories/GHSA-h99m-6755-rgwc</a></li>
<li><a href="https://github.com/advisories/GHSA-h99m-6755-rgwc">https://github.com/advisories/GHSA-h99m-6755-rgwc</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-h99m-6755-rgwc</uri>
        </author>
        <category label="severity" term="CRITICAL"/>
        <published>2024-10-25T19:37:22.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[github.com/rancher/rancher] Rancher Remote Code Execution via Cluster/Node Drivers]]></title>
        <id>https://github.com/advisories/GHSA-h99m-6755-rgwc</id>
        <link href="https://github.com/advisories/GHSA-h99m-6755-rgwc"/>
        <updated>2024-10-25T19:37:22.000Z</updated>
        <content type="html"><![CDATA[<h3 id="impact">Impact</h3>
<p>A vulnerability has been identified within Rancher where a cluster or node driver can be used to escape the <code>chroot</code> jail and gain root access to the Rancher container itself. In production environments, further privilege escalation is possible based on living off the land within the Rancher container itself. For the test and development environments, based on a –privileged Docker container, it is possible to escape the Docker container and gain execution access on the host system. </p>
<p>This happens because:</p>
<ul>
<li>During startup, Rancher appends the <code>/opt/drivers/management-state/bin</code> directory to the <code>PATH</code> environment variable.</li>
<li>In Rancher, the binaries <code>/usr/bin/rancher-machine</code>, <code>/usr/bin/helm_v3</code>, and <code>/usr/bin/kustomize</code> are assigned a UID of 1001 and a GID of 127 instead of being owned by the root user.</li>
<li>Rancher employs a jail mechanism to isolate the execution of node drivers from the main process. However, the drivers are executed with excessive permissions.</li>
<li>During the registration of new node drivers, its binary is executed with the same user as the parent process, which could enable an attacker to gain elevated privileges by registering a malicious driver.</li>
<li>Lack of validation on the driver file type, which allows symbolic links to be used.</li>
</ul>
<p>Please consult the associated  <a href="https://attack.mitre.org/tactics/TA0004/">MITRE ATT&amp;CK - Technique - Privilege Escalation</a> and <a href="https://attack.mitre.org/tactics/TA0002/">MITRE ATT&amp;CK - Technique - Execution</a> for further information about this category of attack.</p>
<p><strong>Since they run at a privileged level, it is recommended to use trusted drivers only.</strong></p>
<h3 id="patches">Patches</h3>
<p>The fix involves some key areas with the following changes:</p>
<p>Fixing the <code>PATH</code> environment variable:</p>
<ul>
<li>Remove the step that appends <code>/opt/drivers/management-state/bin</code> to the <code>PATH</code> environment variable.</li>
</ul>
<p>Binaries permissions:</p>
<ul>
<li>Correct the permission of the binaries <code>/usr/bin/rancher-machine</code>, <code>/usr/bin/helm_v3</code>, and <code>/usr/bin/kustomize</code> so that they are owned by the root user.</li>
</ul>
<p>Improving Rancher jail security mechanism:</p>
<ul>
<li>A new group <code>jail-accessors</code> has been created, and the rancher user has been added to this group.</li>
<li>The <code>jail-accessors</code> group is granted read and execute permissions for the directories <code>/var/lib/rancher</code>, <code>/var/lib/cattle</code>, and <code>/usr/local/bin</code>.</li>
<li>The jail mechanism has been enhanced to execute commands using the non-root <code>rancher</code> user and the <code>jail-accessors</code> group. Additionally, a new setting, <code>UnprivilegedJailUser</code>, has been introduced to manage this behavior, allowing users to opt-out if they need to run drivers in a more privileged context.</li>
<li>Limit the devices copied to the jail directory to a minimal set.</li>
</ul>
<p>Fixing node driver registration:</p>
<ul>
<li>The <code>NewPlugin(driver)</code> function in the <code>rancher/machine</code> module has been updated to allow setting the UID and GID for starting the plugin server. If the environment variables <code>MACHINE_PLUGIN_UID</code> and <code>MACHINE_PLUGIN_GID</code> are set, their values will be used to configure the user credentials for launching the plugin server. </li>
<li>Rancher now sets these environment variables with a non-root UID and GID before invoking the <code>NewPlugin(driver)</code> function and then unsets them after retrieving the creation flags.</li>
</ul>
<p>Improvements on driver package:</p>
<ul>
<li>The <code>driver</code> package has been revised to verify that the downloaded driver binary is a regular file.</li>
<li>The <code>driver</code> package has been revised to verify that the target file in the downloaded tar file is a regular file.</li>
<li>The <code>driver</code> package now executes the downloaded driver binary within a jail, with a default timeout of 5 seconds.</li>
</ul>
<p>Other improvements:</p>
<ul>
<li>The helm package has been updated to ensure appropriate permissions are set on the generated kubeconfig file.</li>
<li>The <code>nodeConfig</code> package has been updated to ensure proper permissions are applied when extracting the node configuration.</li>
</ul>
<p>Patched versions include releases <code>2.7.16</code>, <code>2.8.9</code> and <code>2.9.3</code>.</p>
<h3 id="workarounds">Workarounds</h3>
<p>If you can't upgrade to a fixed version, please make sure that:</p>
<ol>
<li>Drivers are only executed from trusted sources.</li>
<li>The use of Admins/Restricted Admins is limited to trusted users.</li>
</ol>
<h3 id="references">References</h3>
<p>If you have any questions or comments about this advisory:</p>
<ul>
<li>Reach out to the <a href="https://github.com/rancher/rancher/security/policy">SUSE Rancher Security team</a> for security related inquiries.</li>
<li>Open an issue in the <a href="https://github.com/rancher/rancher/issues/new/choose">Rancher</a> repository.</li>
<li>Verify with our <a href="https://www.suse.com/suse-rancher/support-matrix/all-supported-versions/">support matrix</a> and <a href="https://www.suse.com/lifecycle/">product support lifecycle</a>.</li>
</ul>
<h3 id="references-1">References</h3>
<ul>
<li><a href="https://github.com/rancher/rancher/security/advisories/GHSA-h99m-6755-rgwc">https://github.com/rancher/rancher/security/advisories/GHSA-h99m-6755-rgwc</a></li>
<li><a href="https://github.com/advisories/GHSA-h99m-6755-rgwc">https://github.com/advisories/GHSA-h99m-6755-rgwc</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-h99m-6755-rgwc</uri>
        </author>
        <category label="severity" term="CRITICAL"/>
        <published>2024-10-25T19:37:22.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[github.com/rancher/rancher] Rancher Remote Code Execution via Cluster/Node Drivers]]></title>
        <id>https://github.com/advisories/GHSA-h99m-6755-rgwc</id>
        <link href="https://github.com/advisories/GHSA-h99m-6755-rgwc"/>
        <updated>2024-10-25T19:37:22.000Z</updated>
        <content type="html"><![CDATA[<h3 id="impact">Impact</h3>
<p>A vulnerability has been identified within Rancher where a cluster or node driver can be used to escape the <code>chroot</code> jail and gain root access to the Rancher container itself. In production environments, further privilege escalation is possible based on living off the land within the Rancher container itself. For the test and development environments, based on a –privileged Docker container, it is possible to escape the Docker container and gain execution access on the host system. </p>
<p>This happens because:</p>
<ul>
<li>During startup, Rancher appends the <code>/opt/drivers/management-state/bin</code> directory to the <code>PATH</code> environment variable.</li>
<li>In Rancher, the binaries <code>/usr/bin/rancher-machine</code>, <code>/usr/bin/helm_v3</code>, and <code>/usr/bin/kustomize</code> are assigned a UID of 1001 and a GID of 127 instead of being owned by the root user.</li>
<li>Rancher employs a jail mechanism to isolate the execution of node drivers from the main process. However, the drivers are executed with excessive permissions.</li>
<li>During the registration of new node drivers, its binary is executed with the same user as the parent process, which could enable an attacker to gain elevated privileges by registering a malicious driver.</li>
<li>Lack of validation on the driver file type, which allows symbolic links to be used.</li>
</ul>
<p>Please consult the associated  <a href="https://attack.mitre.org/tactics/TA0004/">MITRE ATT&amp;CK - Technique - Privilege Escalation</a> and <a href="https://attack.mitre.org/tactics/TA0002/">MITRE ATT&amp;CK - Technique - Execution</a> for further information about this category of attack.</p>
<p><strong>Since they run at a privileged level, it is recommended to use trusted drivers only.</strong></p>
<h3 id="patches">Patches</h3>
<p>The fix involves some key areas with the following changes:</p>
<p>Fixing the <code>PATH</code> environment variable:</p>
<ul>
<li>Remove the step that appends <code>/opt/drivers/management-state/bin</code> to the <code>PATH</code> environment variable.</li>
</ul>
<p>Binaries permissions:</p>
<ul>
<li>Correct the permission of the binaries <code>/usr/bin/rancher-machine</code>, <code>/usr/bin/helm_v3</code>, and <code>/usr/bin/kustomize</code> so that they are owned by the root user.</li>
</ul>
<p>Improving Rancher jail security mechanism:</p>
<ul>
<li>A new group <code>jail-accessors</code> has been created, and the rancher user has been added to this group.</li>
<li>The <code>jail-accessors</code> group is granted read and execute permissions for the directories <code>/var/lib/rancher</code>, <code>/var/lib/cattle</code>, and <code>/usr/local/bin</code>.</li>
<li>The jail mechanism has been enhanced to execute commands using the non-root <code>rancher</code> user and the <code>jail-accessors</code> group. Additionally, a new setting, <code>UnprivilegedJailUser</code>, has been introduced to manage this behavior, allowing users to opt-out if they need to run drivers in a more privileged context.</li>
<li>Limit the devices copied to the jail directory to a minimal set.</li>
</ul>
<p>Fixing node driver registration:</p>
<ul>
<li>The <code>NewPlugin(driver)</code> function in the <code>rancher/machine</code> module has been updated to allow setting the UID and GID for starting the plugin server. If the environment variables <code>MACHINE_PLUGIN_UID</code> and <code>MACHINE_PLUGIN_GID</code> are set, their values will be used to configure the user credentials for launching the plugin server. </li>
<li>Rancher now sets these environment variables with a non-root UID and GID before invoking the <code>NewPlugin(driver)</code> function and then unsets them after retrieving the creation flags.</li>
</ul>
<p>Improvements on driver package:</p>
<ul>
<li>The <code>driver</code> package has been revised to verify that the downloaded driver binary is a regular file.</li>
<li>The <code>driver</code> package has been revised to verify that the target file in the downloaded tar file is a regular file.</li>
<li>The <code>driver</code> package now executes the downloaded driver binary within a jail, with a default timeout of 5 seconds.</li>
</ul>
<p>Other improvements:</p>
<ul>
<li>The helm package has been updated to ensure appropriate permissions are set on the generated kubeconfig file.</li>
<li>The <code>nodeConfig</code> package has been updated to ensure proper permissions are applied when extracting the node configuration.</li>
</ul>
<p>Patched versions include releases <code>2.7.16</code>, <code>2.8.9</code> and <code>2.9.3</code>.</p>
<h3 id="workarounds">Workarounds</h3>
<p>If you can't upgrade to a fixed version, please make sure that:</p>
<ol>
<li>Drivers are only executed from trusted sources.</li>
<li>The use of Admins/Restricted Admins is limited to trusted users.</li>
</ol>
<h3 id="references">References</h3>
<p>If you have any questions or comments about this advisory:</p>
<ul>
<li>Reach out to the <a href="https://github.com/rancher/rancher/security/policy">SUSE Rancher Security team</a> for security related inquiries.</li>
<li>Open an issue in the <a href="https://github.com/rancher/rancher/issues/new/choose">Rancher</a> repository.</li>
<li>Verify with our <a href="https://www.suse.com/suse-rancher/support-matrix/all-supported-versions/">support matrix</a> and <a href="https://www.suse.com/lifecycle/">product support lifecycle</a>.</li>
</ul>
<h3 id="references-1">References</h3>
<ul>
<li><a href="https://github.com/rancher/rancher/security/advisories/GHSA-h99m-6755-rgwc">https://github.com/rancher/rancher/security/advisories/GHSA-h99m-6755-rgwc</a></li>
<li><a href="https://github.com/advisories/GHSA-h99m-6755-rgwc">https://github.com/advisories/GHSA-h99m-6755-rgwc</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-h99m-6755-rgwc</uri>
        </author>
        <category label="severity" term="CRITICAL"/>
        <published>2024-10-25T19:37:22.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[github.com/rancher/rancher] Exposure of vSphere's CPI and CSI credentials in Rancher]]></title>
        <id>https://github.com/advisories/GHSA-xj7w-r753-vj8v</id>
        <link href="https://github.com/advisories/GHSA-xj7w-r753-vj8v"/>
        <updated>2024-10-25T19:35:56.000Z</updated>
        <content type="html"><![CDATA[<h3 id="impact">Impact</h3>
<p>A vulnerability has been identified in the way that Rancher stores vSphere's CPI (Cloud Provider Interface) and CSI (Container Storage Interface) credentials used to deploy clusters through the vSphere cloud provider. This issue leads to the vSphere CPI and CSI passwords being stored in a plaintext object inside Rancher. This vulnerability is only applicable to users that deploy clusters in vSphere environments.</p>
<p>The exposed passwords were accessible in the following objects:</p>
<ul>
<li>Can be accessed by users that are cluster members of the provisioned clusters:<ul>
<li>When provisioning a new cluster with the vSphere cloud provider through Rancher's UI (user interface), Cluster Templates and Terraform on the object <code>provisioning.cattle.io</code> in <code>spec.rkeConfig.chartValues.rancher-vsphere-cpi</code> and <code>spec.rkeConfig.chartValues.rancher-vsphere-csi</code>.</li>
<li>On the object <code>rke.cattle.io.rkecontrolplane</code> in <code>spec.chartValues.rancher-vsphere-cpi</code> and <code>spec.chartValues.rancher-vsphere-csi</code>.</li>
</ul>
</li>
<li>Can be accessed by users with privileged access to the clusters' infrastructure (host OS):<ul>
<li>Inside the <code>plan</code> files in the provisioned downstream clusters' filesystems.</li>
</ul>
</li>
</ul>
<p><strong>Note:</strong> if you believe that the vSphere credentials might have been accessed by unauthorized users, it's highly recommended to change them, after updating Rancher to a patched version.</p>
<p>Please consult the associated  <a href="https://attack.mitre.org/tactics/TA0006/">MITRE ATT&amp;CK - Technique -  Credential Access</a> for further information about this category of attack.</p>
<h3 id="patches">Patches</h3>
<p>Patched versions include Rancher releases <strong>2.8.9 and 2.9.3</strong>.</p>
<p>After updating your environment to one of the patched Rancher's versions, it's mandatory to execute <a href="https://github.com/rancherlabs/support-tools/tree/master/migrate-vsphere-clusters">this script</a> that provides an automated way to mitigate any vulnerable leftover vSphere clusters' credentials within Rancher's local cluster. This script doesn't need to be executed in case you are installing a fresh and new environment.</p>
<p>The script will fetch all objects in Rancher's local cluster,  loops through them, if the affected vSphere charts are present, then it extracts the <code>username</code> and <code>password</code> parameters into a secret in the <code>fleet-default</code> namespace for both with the appropriate annotation to synchronize them to the downstream clusters. Finally, it updates the cluster's <code>chartValues</code> to reference those secrets rather than existing plaintext values.</p>
<p>The script confirms on write operations, as well as backs up configurations of the cluster objects before operating so rolling back is simple.</p>
<p>To run the script, fetch the <code>kubeconfig</code> for your local cluster and run with <code>KUBECONFIG=/path/to/kubeconfig.yml bash migrate.sh</code>. The script is idempotent and can be run multiple times safely if you want to validate just one at a time.</p>
<p><strong>Notes:</strong></p>
<ul>
<li>The <a href="https://ranchermanager.docs.rancher.com/getting-started/installation-and-upgrade/installation-references/feature-flags">feature flag</a> <code>provisioningprebootstrap</code> must be enabled after updating to one of the patched versions. This feature flag is also mandatory when installing a new cluster.</li>
<li><strong>Rancher 2.7 release line is not receiving a backport security patch for this vulnerability.</strong> For users running Rancher 2.7 with vSphere provisioning and that are concerned with this security issue, the recommendation is to update Rancher to one of the patched versions by following the standard update procedure based on the 2.7 version that is being used. Refer to the release notes for the proper update process for <a href="https://github.com/rancher/rancher/releases/tag/v2.8.9">2.8.9</a> and <a href="https://github.com/rancher/rancher/releases/tag/v2.9.3">2.9.3</a>.</li>
</ul>
<h3 id="workarounds">Workarounds</h3>
<p>Besides only granting access to Rancher to trusted users and not allowing direct access to untrusted users to the clusters' infrastructure, there is no direct workaround for this security issue, except updating Rancher to one of the patched versions.</p>
<h3 id="references">References</h3>
<p>If you have any questions or comments about this advisory:</p>
<ul>
<li>Reach out to the <a href="https://github.com/rancher/rancher/security/policy">SUSE Rancher Security team</a> for security related inquiries.</li>
<li>Open an issue in the <a href="https://github.com/rancher/rancher/issues/new/choose">Rancher</a> repository.</li>
<li>Verify with our <a href="https://www.suse.com/suse-rancher/support-matrix/all-supported-versions/">support matrix</a> and <a href="https://www.suse.com/lifecycle/">product support lifecycle</a>.</li>
</ul>
<h3 id="references-1">References</h3>
<ul>
<li><a href="https://github.com/rancher/rancher/security/advisories/GHSA-xj7w-r753-vj8v">https://github.com/rancher/rancher/security/advisories/GHSA-xj7w-r753-vj8v</a></li>
<li><a href="https://github.com/advisories/GHSA-xj7w-r753-vj8v">https://github.com/advisories/GHSA-xj7w-r753-vj8v</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-xj7w-r753-vj8v</uri>
        </author>
        <category label="severity" term="CRITICAL"/>
        <published>2024-10-25T19:35:55.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[github.com/rancher/rancher] Exposure of vSphere's CPI and CSI credentials in Rancher]]></title>
        <id>https://github.com/advisories/GHSA-xj7w-r753-vj8v</id>
        <link href="https://github.com/advisories/GHSA-xj7w-r753-vj8v"/>
        <updated>2024-10-25T19:35:56.000Z</updated>
        <content type="html"><![CDATA[<h3 id="impact">Impact</h3>
<p>A vulnerability has been identified in the way that Rancher stores vSphere's CPI (Cloud Provider Interface) and CSI (Container Storage Interface) credentials used to deploy clusters through the vSphere cloud provider. This issue leads to the vSphere CPI and CSI passwords being stored in a plaintext object inside Rancher. This vulnerability is only applicable to users that deploy clusters in vSphere environments.</p>
<p>The exposed passwords were accessible in the following objects:</p>
<ul>
<li>Can be accessed by users that are cluster members of the provisioned clusters:<ul>
<li>When provisioning a new cluster with the vSphere cloud provider through Rancher's UI (user interface), Cluster Templates and Terraform on the object <code>provisioning.cattle.io</code> in <code>spec.rkeConfig.chartValues.rancher-vsphere-cpi</code> and <code>spec.rkeConfig.chartValues.rancher-vsphere-csi</code>.</li>
<li>On the object <code>rke.cattle.io.rkecontrolplane</code> in <code>spec.chartValues.rancher-vsphere-cpi</code> and <code>spec.chartValues.rancher-vsphere-csi</code>.</li>
</ul>
</li>
<li>Can be accessed by users with privileged access to the clusters' infrastructure (host OS):<ul>
<li>Inside the <code>plan</code> files in the provisioned downstream clusters' filesystems.</li>
</ul>
</li>
</ul>
<p><strong>Note:</strong> if you believe that the vSphere credentials might have been accessed by unauthorized users, it's highly recommended to change them, after updating Rancher to a patched version.</p>
<p>Please consult the associated  <a href="https://attack.mitre.org/tactics/TA0006/">MITRE ATT&amp;CK - Technique -  Credential Access</a> for further information about this category of attack.</p>
<h3 id="patches">Patches</h3>
<p>Patched versions include Rancher releases <strong>2.8.9 and 2.9.3</strong>.</p>
<p>After updating your environment to one of the patched Rancher's versions, it's mandatory to execute <a href="https://github.com/rancherlabs/support-tools/tree/master/migrate-vsphere-clusters">this script</a> that provides an automated way to mitigate any vulnerable leftover vSphere clusters' credentials within Rancher's local cluster. This script doesn't need to be executed in case you are installing a fresh and new environment.</p>
<p>The script will fetch all objects in Rancher's local cluster,  loops through them, if the affected vSphere charts are present, then it extracts the <code>username</code> and <code>password</code> parameters into a secret in the <code>fleet-default</code> namespace for both with the appropriate annotation to synchronize them to the downstream clusters. Finally, it updates the cluster's <code>chartValues</code> to reference those secrets rather than existing plaintext values.</p>
<p>The script confirms on write operations, as well as backs up configurations of the cluster objects before operating so rolling back is simple.</p>
<p>To run the script, fetch the <code>kubeconfig</code> for your local cluster and run with <code>KUBECONFIG=/path/to/kubeconfig.yml bash migrate.sh</code>. The script is idempotent and can be run multiple times safely if you want to validate just one at a time.</p>
<p><strong>Notes:</strong></p>
<ul>
<li>The <a href="https://ranchermanager.docs.rancher.com/getting-started/installation-and-upgrade/installation-references/feature-flags">feature flag</a> <code>provisioningprebootstrap</code> must be enabled after updating to one of the patched versions. This feature flag is also mandatory when installing a new cluster.</li>
<li><strong>Rancher 2.7 release line is not receiving a backport security patch for this vulnerability.</strong> For users running Rancher 2.7 with vSphere provisioning and that are concerned with this security issue, the recommendation is to update Rancher to one of the patched versions by following the standard update procedure based on the 2.7 version that is being used. Refer to the release notes for the proper update process for <a href="https://github.com/rancher/rancher/releases/tag/v2.8.9">2.8.9</a> and <a href="https://github.com/rancher/rancher/releases/tag/v2.9.3">2.9.3</a>.</li>
</ul>
<h3 id="workarounds">Workarounds</h3>
<p>Besides only granting access to Rancher to trusted users and not allowing direct access to untrusted users to the clusters' infrastructure, there is no direct workaround for this security issue, except updating Rancher to one of the patched versions.</p>
<h3 id="references">References</h3>
<p>If you have any questions or comments about this advisory:</p>
<ul>
<li>Reach out to the <a href="https://github.com/rancher/rancher/security/policy">SUSE Rancher Security team</a> for security related inquiries.</li>
<li>Open an issue in the <a href="https://github.com/rancher/rancher/issues/new/choose">Rancher</a> repository.</li>
<li>Verify with our <a href="https://www.suse.com/suse-rancher/support-matrix/all-supported-versions/">support matrix</a> and <a href="https://www.suse.com/lifecycle/">product support lifecycle</a>.</li>
</ul>
<h3 id="references-1">References</h3>
<ul>
<li><a href="https://github.com/rancher/rancher/security/advisories/GHSA-xj7w-r753-vj8v">https://github.com/rancher/rancher/security/advisories/GHSA-xj7w-r753-vj8v</a></li>
<li><a href="https://github.com/advisories/GHSA-xj7w-r753-vj8v">https://github.com/advisories/GHSA-xj7w-r753-vj8v</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-xj7w-r753-vj8v</uri>
        </author>
        <category label="severity" term="CRITICAL"/>
        <published>2024-10-25T19:35:55.000Z</published>
    </entry>
</feed>