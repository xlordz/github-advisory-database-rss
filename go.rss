<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
    <id>https://azu.github.io/github-advisory-database-rss/go.rss</id>
    <title>Security Advisory for Go modules</title>
    <updated>2024-12-11T10:01:29.319Z</updated>
    <generator>github-advisory-database-rss</generator>
    <link rel="alternate" href="https://github.com/advisories?query=type%3Areviewed+ecosystem%3Ago"/>
    <subtitle>Security Advisory for Go modules on GitHub</subtitle>
    <rights>github-advisory-database-rss</rights>
    <category term="CRITICAL"/>
    <category term="HIGH"/>
    <category term="MODERATE"/>
    <category term="LOW"/>
    <entry>
        <title type="html"><![CDATA[[github.com/CosmWasm/wasmvm] CosmWasm VM Incorrect metering]]></title>
        <id>https://github.com/advisories/GHSA-2q97-m5rc-p3gp</id>
        <link href="https://github.com/advisories/GHSA-2q97-m5rc-p3gp"/>
        <updated>2024-12-10T16:55:41.000Z</updated>
        <content type="html"><![CDATA[<h1 id="cwa-2024-007">CWA-2024-007</h1>
<p><strong>Severity</strong></p>
<p>Medium (Moderate + Likely)[^1]</p>
<p><strong>Affected versions:</strong></p>
<ul>
<li>wasmvm &gt;= 2.1.0, &lt; 2.1.3</li>
<li>wasmvm &gt;= 2.0.0, &lt; 2.0.4</li>
<li>wasmvm &lt; 1.5.5</li>
<li>cosmwasm-vm &gt;= 2.1.0, &lt; 2.1.4</li>
<li>cosmwasm-vm &gt;= 2.0.0, &lt; 2.0.7</li>
<li>cosmwasm-vm &lt; 1.5.8</li>
</ul>
<p><strong>Patched versions:</strong></p>
<ul>
<li>wasmvm 1.5.5, 2.0.4, 2.1.3</li>
<li>cosmwasm-vm 1.5.8, 2.0.7, 2.1.4</li>
</ul>
<h2 id="description-of-the-bug">Description of the bug</h2>
<p>(Blank for now. We'll add more detail once chains had a chance to upgrade.)</p>
<h2 id="patch">Patch</h2>
<ul>
<li>1.5: <a href="https://github.com/CosmWasm/cosmwasm/commit/16eabd681790508b13dac8e67f9e6e61045240ea">https://github.com/CosmWasm/cosmwasm/commit/16eabd681790508b13dac8e67f9e6e61045240ea</a></li>
<li>2.0: <a href="https://github.com/CosmWasm/cosmwasm/commit/0e70bd83119b02f99a2c0397f0913e0803750fd9">https://github.com/CosmWasm/cosmwasm/commit/0e70bd83119b02f99a2c0397f0913e0803750fd9</a></li>
<li>2.1: <a href="https://github.com/CosmWasm/cosmwasm/commit/f5bf24f3acadca2892afd58cc3ce5fdeb932d492">https://github.com/CosmWasm/cosmwasm/commit/f5bf24f3acadca2892afd58cc3ce5fdeb932d492</a></li>
</ul>
<h2 id="applying-the-patch">Applying the patch</h2>
<p>The patch will be shipped in releases of wasmvm. You can update more or less as follows:</p>
<ol>
<li>Check the current wasmvm version: <code>go list -m github.com/CosmWasm/wasmvm</code></li>
<li>Bump the <code>github.com/CosmWasm/wasmvm</code> dependency in your go.mod to 1.5.5, 2.0.4, 2.1.3 depending on which minor version you are; <code>go mod tidy</code>; commit.</li>
<li>If you use the static libraries <code>libwasmvm_muslc.aarch64.a</code>/<code>libwasmvm_muslc.x86_64.a</code>, update them accordingly.</li>
<li>Check the updated wasmvm version: <code>go list -m github.com/CosmWasm/wasmvm</code> and ensure you see 1.5.5, 2.0.4, 2.1.3.</li>
<li>Follow your regular practices to deploy chain upgrades.</li>
</ol>
<p>To double check if the correct library version is loaded at runtime, use this query:
<code>&lt;appd&gt; query wasm libwasmvm-version</code>. It must show 1.5.5, 2.0.4 or 2.1.3.</p>
<p>The patch is consensus breaking and requires a coordinated upgrade.</p>
<h2 id="acknowledgement">Acknowledgement</h2>
<p>This issue was found by meadow101 who reported it to the Cosmos Bug Bounty Program on HackerOne.</p>
<p>If you believe you have found a bug in the Interchain Stack or would like to contribute to the
program by reporting a bug, please see <a href="https://hackerone.com/cosmos">https://hackerone.com/cosmos</a>.</p>
<h2 id="timeline">Timeline</h2>
<ul>
<li>2024-08-28: Confio receives a report through the Cosmos bug bounty program maintained by Amulet.</li>
<li>2024-08-30: Confio security contributors confirm the report.</li>
<li>2024-09-02: Confio developed the patch internally.</li>
<li>2024-09-23: Patch is released.</li>
</ul>
<p>[^1]: following Amulet's Severity Classification Framework ACMv1: <a href="https://github.com/interchainio/security/blob/e0227a1fb4059144aab4f6003eeee7f09912db3a/resources/CLASSIFICATION_MATRIX.md">https://github.com/interchainio/security/blob/e0227a1fb4059144aab4f6003eeee7f09912db3a/resources/CLASSIFICATION_MATRIX.md</a></p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/CosmWasm/wasmvm/security/advisories/GHSA-2q97-m5rc-p3gp">https://github.com/CosmWasm/wasmvm/security/advisories/GHSA-2q97-m5rc-p3gp</a></li>
<li><a href="https://github.com/CosmWasm/cosmwasm/commit/0e70bd83119b02f99a2c0397f0913e0803750fd9">https://github.com/CosmWasm/cosmwasm/commit/0e70bd83119b02f99a2c0397f0913e0803750fd9</a></li>
<li><a href="https://github.com/CosmWasm/cosmwasm/commit/16eabd681790508b13dac8e67f9e6e61045240ea">https://github.com/CosmWasm/cosmwasm/commit/16eabd681790508b13dac8e67f9e6e61045240ea</a></li>
<li><a href="https://github.com/CosmWasm/cosmwasm/commit/f5bf24f3acadca2892afd58cc3ce5fdeb932d492">https://github.com/CosmWasm/cosmwasm/commit/f5bf24f3acadca2892afd58cc3ce5fdeb932d492</a></li>
<li><a href="https://github.com/CosmWasm/advisories/blob/main/CWAs/CWA-2024-007.md">https://github.com/CosmWasm/advisories/blob/main/CWAs/CWA-2024-007.md</a></li>
<li><a href="https://github.com/advisories/GHSA-2q97-m5rc-p3gp">https://github.com/advisories/GHSA-2q97-m5rc-p3gp</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-2q97-m5rc-p3gp</uri>
        </author>
        <category label="severity" term="MODERATE"/>
        <published>2024-12-10T16:55:39.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[github.com/CosmWasm/wasmvm/v2] CosmWasm VM Incorrect metering]]></title>
        <id>https://github.com/advisories/GHSA-2q97-m5rc-p3gp</id>
        <link href="https://github.com/advisories/GHSA-2q97-m5rc-p3gp"/>
        <updated>2024-12-10T16:55:41.000Z</updated>
        <content type="html"><![CDATA[<h1 id="cwa-2024-007">CWA-2024-007</h1>
<p><strong>Severity</strong></p>
<p>Medium (Moderate + Likely)[^1]</p>
<p><strong>Affected versions:</strong></p>
<ul>
<li>wasmvm &gt;= 2.1.0, &lt; 2.1.3</li>
<li>wasmvm &gt;= 2.0.0, &lt; 2.0.4</li>
<li>wasmvm &lt; 1.5.5</li>
<li>cosmwasm-vm &gt;= 2.1.0, &lt; 2.1.4</li>
<li>cosmwasm-vm &gt;= 2.0.0, &lt; 2.0.7</li>
<li>cosmwasm-vm &lt; 1.5.8</li>
</ul>
<p><strong>Patched versions:</strong></p>
<ul>
<li>wasmvm 1.5.5, 2.0.4, 2.1.3</li>
<li>cosmwasm-vm 1.5.8, 2.0.7, 2.1.4</li>
</ul>
<h2 id="description-of-the-bug">Description of the bug</h2>
<p>(Blank for now. We'll add more detail once chains had a chance to upgrade.)</p>
<h2 id="patch">Patch</h2>
<ul>
<li>1.5: <a href="https://github.com/CosmWasm/cosmwasm/commit/16eabd681790508b13dac8e67f9e6e61045240ea">https://github.com/CosmWasm/cosmwasm/commit/16eabd681790508b13dac8e67f9e6e61045240ea</a></li>
<li>2.0: <a href="https://github.com/CosmWasm/cosmwasm/commit/0e70bd83119b02f99a2c0397f0913e0803750fd9">https://github.com/CosmWasm/cosmwasm/commit/0e70bd83119b02f99a2c0397f0913e0803750fd9</a></li>
<li>2.1: <a href="https://github.com/CosmWasm/cosmwasm/commit/f5bf24f3acadca2892afd58cc3ce5fdeb932d492">https://github.com/CosmWasm/cosmwasm/commit/f5bf24f3acadca2892afd58cc3ce5fdeb932d492</a></li>
</ul>
<h2 id="applying-the-patch">Applying the patch</h2>
<p>The patch will be shipped in releases of wasmvm. You can update more or less as follows:</p>
<ol>
<li>Check the current wasmvm version: <code>go list -m github.com/CosmWasm/wasmvm</code></li>
<li>Bump the <code>github.com/CosmWasm/wasmvm</code> dependency in your go.mod to 1.5.5, 2.0.4, 2.1.3 depending on which minor version you are; <code>go mod tidy</code>; commit.</li>
<li>If you use the static libraries <code>libwasmvm_muslc.aarch64.a</code>/<code>libwasmvm_muslc.x86_64.a</code>, update them accordingly.</li>
<li>Check the updated wasmvm version: <code>go list -m github.com/CosmWasm/wasmvm</code> and ensure you see 1.5.5, 2.0.4, 2.1.3.</li>
<li>Follow your regular practices to deploy chain upgrades.</li>
</ol>
<p>To double check if the correct library version is loaded at runtime, use this query:
<code>&lt;appd&gt; query wasm libwasmvm-version</code>. It must show 1.5.5, 2.0.4 or 2.1.3.</p>
<p>The patch is consensus breaking and requires a coordinated upgrade.</p>
<h2 id="acknowledgement">Acknowledgement</h2>
<p>This issue was found by meadow101 who reported it to the Cosmos Bug Bounty Program on HackerOne.</p>
<p>If you believe you have found a bug in the Interchain Stack or would like to contribute to the
program by reporting a bug, please see <a href="https://hackerone.com/cosmos">https://hackerone.com/cosmos</a>.</p>
<h2 id="timeline">Timeline</h2>
<ul>
<li>2024-08-28: Confio receives a report through the Cosmos bug bounty program maintained by Amulet.</li>
<li>2024-08-30: Confio security contributors confirm the report.</li>
<li>2024-09-02: Confio developed the patch internally.</li>
<li>2024-09-23: Patch is released.</li>
</ul>
<p>[^1]: following Amulet's Severity Classification Framework ACMv1: <a href="https://github.com/interchainio/security/blob/e0227a1fb4059144aab4f6003eeee7f09912db3a/resources/CLASSIFICATION_MATRIX.md">https://github.com/interchainio/security/blob/e0227a1fb4059144aab4f6003eeee7f09912db3a/resources/CLASSIFICATION_MATRIX.md</a></p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/CosmWasm/wasmvm/security/advisories/GHSA-2q97-m5rc-p3gp">https://github.com/CosmWasm/wasmvm/security/advisories/GHSA-2q97-m5rc-p3gp</a></li>
<li><a href="https://github.com/CosmWasm/cosmwasm/commit/0e70bd83119b02f99a2c0397f0913e0803750fd9">https://github.com/CosmWasm/cosmwasm/commit/0e70bd83119b02f99a2c0397f0913e0803750fd9</a></li>
<li><a href="https://github.com/CosmWasm/cosmwasm/commit/16eabd681790508b13dac8e67f9e6e61045240ea">https://github.com/CosmWasm/cosmwasm/commit/16eabd681790508b13dac8e67f9e6e61045240ea</a></li>
<li><a href="https://github.com/CosmWasm/cosmwasm/commit/f5bf24f3acadca2892afd58cc3ce5fdeb932d492">https://github.com/CosmWasm/cosmwasm/commit/f5bf24f3acadca2892afd58cc3ce5fdeb932d492</a></li>
<li><a href="https://github.com/CosmWasm/advisories/blob/main/CWAs/CWA-2024-007.md">https://github.com/CosmWasm/advisories/blob/main/CWAs/CWA-2024-007.md</a></li>
<li><a href="https://github.com/advisories/GHSA-2q97-m5rc-p3gp">https://github.com/advisories/GHSA-2q97-m5rc-p3gp</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-2q97-m5rc-p3gp</uri>
        </author>
        <category label="severity" term="MODERATE"/>
        <published>2024-12-10T16:55:39.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[github.com/CosmWasm/wasmvm/v2] CosmWasm VM Incorrect metering]]></title>
        <id>https://github.com/advisories/GHSA-2q97-m5rc-p3gp</id>
        <link href="https://github.com/advisories/GHSA-2q97-m5rc-p3gp"/>
        <updated>2024-12-10T16:55:41.000Z</updated>
        <content type="html"><![CDATA[<h1 id="cwa-2024-007">CWA-2024-007</h1>
<p><strong>Severity</strong></p>
<p>Medium (Moderate + Likely)[^1]</p>
<p><strong>Affected versions:</strong></p>
<ul>
<li>wasmvm &gt;= 2.1.0, &lt; 2.1.3</li>
<li>wasmvm &gt;= 2.0.0, &lt; 2.0.4</li>
<li>wasmvm &lt; 1.5.5</li>
<li>cosmwasm-vm &gt;= 2.1.0, &lt; 2.1.4</li>
<li>cosmwasm-vm &gt;= 2.0.0, &lt; 2.0.7</li>
<li>cosmwasm-vm &lt; 1.5.8</li>
</ul>
<p><strong>Patched versions:</strong></p>
<ul>
<li>wasmvm 1.5.5, 2.0.4, 2.1.3</li>
<li>cosmwasm-vm 1.5.8, 2.0.7, 2.1.4</li>
</ul>
<h2 id="description-of-the-bug">Description of the bug</h2>
<p>(Blank for now. We'll add more detail once chains had a chance to upgrade.)</p>
<h2 id="patch">Patch</h2>
<ul>
<li>1.5: <a href="https://github.com/CosmWasm/cosmwasm/commit/16eabd681790508b13dac8e67f9e6e61045240ea">https://github.com/CosmWasm/cosmwasm/commit/16eabd681790508b13dac8e67f9e6e61045240ea</a></li>
<li>2.0: <a href="https://github.com/CosmWasm/cosmwasm/commit/0e70bd83119b02f99a2c0397f0913e0803750fd9">https://github.com/CosmWasm/cosmwasm/commit/0e70bd83119b02f99a2c0397f0913e0803750fd9</a></li>
<li>2.1: <a href="https://github.com/CosmWasm/cosmwasm/commit/f5bf24f3acadca2892afd58cc3ce5fdeb932d492">https://github.com/CosmWasm/cosmwasm/commit/f5bf24f3acadca2892afd58cc3ce5fdeb932d492</a></li>
</ul>
<h2 id="applying-the-patch">Applying the patch</h2>
<p>The patch will be shipped in releases of wasmvm. You can update more or less as follows:</p>
<ol>
<li>Check the current wasmvm version: <code>go list -m github.com/CosmWasm/wasmvm</code></li>
<li>Bump the <code>github.com/CosmWasm/wasmvm</code> dependency in your go.mod to 1.5.5, 2.0.4, 2.1.3 depending on which minor version you are; <code>go mod tidy</code>; commit.</li>
<li>If you use the static libraries <code>libwasmvm_muslc.aarch64.a</code>/<code>libwasmvm_muslc.x86_64.a</code>, update them accordingly.</li>
<li>Check the updated wasmvm version: <code>go list -m github.com/CosmWasm/wasmvm</code> and ensure you see 1.5.5, 2.0.4, 2.1.3.</li>
<li>Follow your regular practices to deploy chain upgrades.</li>
</ol>
<p>To double check if the correct library version is loaded at runtime, use this query:
<code>&lt;appd&gt; query wasm libwasmvm-version</code>. It must show 1.5.5, 2.0.4 or 2.1.3.</p>
<p>The patch is consensus breaking and requires a coordinated upgrade.</p>
<h2 id="acknowledgement">Acknowledgement</h2>
<p>This issue was found by meadow101 who reported it to the Cosmos Bug Bounty Program on HackerOne.</p>
<p>If you believe you have found a bug in the Interchain Stack or would like to contribute to the
program by reporting a bug, please see <a href="https://hackerone.com/cosmos">https://hackerone.com/cosmos</a>.</p>
<h2 id="timeline">Timeline</h2>
<ul>
<li>2024-08-28: Confio receives a report through the Cosmos bug bounty program maintained by Amulet.</li>
<li>2024-08-30: Confio security contributors confirm the report.</li>
<li>2024-09-02: Confio developed the patch internally.</li>
<li>2024-09-23: Patch is released.</li>
</ul>
<p>[^1]: following Amulet's Severity Classification Framework ACMv1: <a href="https://github.com/interchainio/security/blob/e0227a1fb4059144aab4f6003eeee7f09912db3a/resources/CLASSIFICATION_MATRIX.md">https://github.com/interchainio/security/blob/e0227a1fb4059144aab4f6003eeee7f09912db3a/resources/CLASSIFICATION_MATRIX.md</a></p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/CosmWasm/wasmvm/security/advisories/GHSA-2q97-m5rc-p3gp">https://github.com/CosmWasm/wasmvm/security/advisories/GHSA-2q97-m5rc-p3gp</a></li>
<li><a href="https://github.com/CosmWasm/cosmwasm/commit/0e70bd83119b02f99a2c0397f0913e0803750fd9">https://github.com/CosmWasm/cosmwasm/commit/0e70bd83119b02f99a2c0397f0913e0803750fd9</a></li>
<li><a href="https://github.com/CosmWasm/cosmwasm/commit/16eabd681790508b13dac8e67f9e6e61045240ea">https://github.com/CosmWasm/cosmwasm/commit/16eabd681790508b13dac8e67f9e6e61045240ea</a></li>
<li><a href="https://github.com/CosmWasm/cosmwasm/commit/f5bf24f3acadca2892afd58cc3ce5fdeb932d492">https://github.com/CosmWasm/cosmwasm/commit/f5bf24f3acadca2892afd58cc3ce5fdeb932d492</a></li>
<li><a href="https://github.com/CosmWasm/advisories/blob/main/CWAs/CWA-2024-007.md">https://github.com/CosmWasm/advisories/blob/main/CWAs/CWA-2024-007.md</a></li>
<li><a href="https://github.com/advisories/GHSA-2q97-m5rc-p3gp">https://github.com/advisories/GHSA-2q97-m5rc-p3gp</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-2q97-m5rc-p3gp</uri>
        </author>
        <category label="severity" term="MODERATE"/>
        <published>2024-12-10T16:55:39.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[github.com/CosmWasm/wasmvm] Panic in wasmvm can slow down block production]]></title>
        <id>https://github.com/advisories/GHSA-vmqh-5232-v43r</id>
        <link href="https://github.com/advisories/GHSA-vmqh-5232-v43r"/>
        <updated>2024-12-10T16:55:38.000Z</updated>
        <content type="html"><![CDATA[<h1 id="cwa-2024-008">CWA-2024-008</h1>
<p><strong>Severity</strong></p>
<p>Medium (Moderate + Likely)[^1]</p>
<p><strong>Affected versions:</strong></p>
<ul>
<li>wasmvm &gt;= 2.1.0, &lt; 2.1.3</li>
<li>wasmvm &gt;= 2.0.0, &lt; 2.0.4</li>
<li>wasmvm &lt; 1.5.5</li>
<li>cosmwasm-vm &gt;= 2.1.0, &lt; 2.1.4</li>
<li>cosmwasm-vm &gt;= 2.0.0, &lt; 2.0.7</li>
<li>cosmwasm-vm &lt; 1.5.8</li>
</ul>
<p><strong>Patched versions:</strong></p>
<ul>
<li>wasmvm 1.5.5, 2.0.4, 2.1.3</li>
<li>cosmwasm-vm 1.5.8, 2.0.7, 2.1.4</li>
</ul>
<h2 id="description-of-the-bug">Description of the bug</h2>
<p>(Blank for now. We'll add more detail once chains had a chance to upgrade.)</p>
<h2 id="patch">Patch</h2>
<ul>
<li>1.5: <a href="https://github.com/CosmWasm/cosmwasm/commit/edcdbc520d4f5521eed42de6e2869658278e91fd">https://github.com/CosmWasm/cosmwasm/commit/edcdbc520d4f5521eed42de6e2869658278e91fd</a></li>
<li>2.0: <a href="https://github.com/CosmWasm/cosmwasm/commit/f63429ca59eb44dd5d780c1572016581337091e4">https://github.com/CosmWasm/cosmwasm/commit/f63429ca59eb44dd5d780c1572016581337091e4</a></li>
<li>2.1: <a href="https://github.com/CosmWasm/cosmwasm/commit/108e7dcbf9c21df0fa83f355ad3a7355d7f220cb">https://github.com/CosmWasm/cosmwasm/commit/108e7dcbf9c21df0fa83f355ad3a7355d7f220cb</a></li>
</ul>
<h2 id="applying-the-patch">Applying the patch</h2>
<p>The patch will be shipped in releases of wasmvm. You can update more or less as follows:</p>
<ol>
<li>Check the current wasmvm version: <code>go list -m github.com/CosmWasm/wasmvm</code></li>
<li>Bump the <code>github.com/CosmWasm/wasmvm</code> dependency in your go.mod to 1.5.5, 2.0.4, 2.1.3 depending on which minor version you are; <code>go mod tidy</code>; commit.</li>
<li>If you use the static libraries <code>libwasmvm_muslc.aarch64.a</code>/<code>libwasmvm_muslc.x86_64.a</code>, update them accordingly.</li>
<li>Check the updated wasmvm version: <code>go list -m github.com/CosmWasm/wasmvm</code> and ensure you see 1.5.5, 2.0.4, 2.1.3.</li>
<li>Follow your regular practices to deploy chain upgrades.</li>
</ol>
<p>To double check if the correct library version is loaded at runtime, use this query:
<code>&lt;appd&gt; query wasm libwasmvm-version</code>. It must show 1.5.5, 2.0.4 or 2.1.3.</p>
<p>The patch is consensus breaking and requires a coordinated upgrade.</p>
<h2 id="acknowledgement">Acknowledgement</h2>
<p>This issue was found by meadow101 who reported it to the Cosmos Bug Bounty Program on HackerOne.</p>
<p>If you believe you have found a bug in the Interchain Stack or would like to contribute to the
program by reporting a bug, please see <a href="https://hackerone.com/cosmos">https://hackerone.com/cosmos</a>.</p>
<h2 id="timeline">Timeline</h2>
<ul>
<li>2024-08-22: Confio receives a report through the Cosmos bug bounty program maintained by Amulet.</li>
<li>2024-08-23: Confio security contributors confirm the report.</li>
<li>2024-09-09: Confio developed the patch internally.</li>
<li>2024-09-23: Patch is released.</li>
</ul>
<p>[^1]: following Amulet's Severity Classification Framework ACMv1: <a href="https://github.com/interchainio/security/blob/e0227a1fb4059144aab4f6003eeee7f09912db3a/resources/CLASSIFICATION_MATRIX.md">https://github.com/interchainio/security/blob/e0227a1fb4059144aab4f6003eeee7f09912db3a/resources/CLASSIFICATION_MATRIX.md</a></p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/CosmWasm/wasmvm/security/advisories/GHSA-vmqh-5232-v43r">https://github.com/CosmWasm/wasmvm/security/advisories/GHSA-vmqh-5232-v43r</a></li>
<li><a href="https://github.com/CosmWasm/cosmwasm/commit/108e7dcbf9c21df0fa83f355ad3a7355d7f220cb">https://github.com/CosmWasm/cosmwasm/commit/108e7dcbf9c21df0fa83f355ad3a7355d7f220cb</a></li>
<li><a href="https://github.com/CosmWasm/cosmwasm/commit/edcdbc520d4f5521eed42de6e2869658278e91fd">https://github.com/CosmWasm/cosmwasm/commit/edcdbc520d4f5521eed42de6e2869658278e91fd</a></li>
<li><a href="https://github.com/CosmWasm/cosmwasm/commit/f63429ca59eb44dd5d780c1572016581337091e4">https://github.com/CosmWasm/cosmwasm/commit/f63429ca59eb44dd5d780c1572016581337091e4</a></li>
<li><a href="https://github.com/CosmWasm/advisories/blob/main/CWAs/CWA-2024-008.md">https://github.com/CosmWasm/advisories/blob/main/CWAs/CWA-2024-008.md</a></li>
<li><a href="https://github.com/advisories/GHSA-vmqh-5232-v43r">https://github.com/advisories/GHSA-vmqh-5232-v43r</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-vmqh-5232-v43r</uri>
        </author>
        <category label="severity" term="MODERATE"/>
        <published>2024-12-10T16:55:37.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[github.com/CosmWasm/wasmvm/v2] Panic in wasmvm can slow down block production]]></title>
        <id>https://github.com/advisories/GHSA-vmqh-5232-v43r</id>
        <link href="https://github.com/advisories/GHSA-vmqh-5232-v43r"/>
        <updated>2024-12-10T16:55:38.000Z</updated>
        <content type="html"><![CDATA[<h1 id="cwa-2024-008">CWA-2024-008</h1>
<p><strong>Severity</strong></p>
<p>Medium (Moderate + Likely)[^1]</p>
<p><strong>Affected versions:</strong></p>
<ul>
<li>wasmvm &gt;= 2.1.0, &lt; 2.1.3</li>
<li>wasmvm &gt;= 2.0.0, &lt; 2.0.4</li>
<li>wasmvm &lt; 1.5.5</li>
<li>cosmwasm-vm &gt;= 2.1.0, &lt; 2.1.4</li>
<li>cosmwasm-vm &gt;= 2.0.0, &lt; 2.0.7</li>
<li>cosmwasm-vm &lt; 1.5.8</li>
</ul>
<p><strong>Patched versions:</strong></p>
<ul>
<li>wasmvm 1.5.5, 2.0.4, 2.1.3</li>
<li>cosmwasm-vm 1.5.8, 2.0.7, 2.1.4</li>
</ul>
<h2 id="description-of-the-bug">Description of the bug</h2>
<p>(Blank for now. We'll add more detail once chains had a chance to upgrade.)</p>
<h2 id="patch">Patch</h2>
<ul>
<li>1.5: <a href="https://github.com/CosmWasm/cosmwasm/commit/edcdbc520d4f5521eed42de6e2869658278e91fd">https://github.com/CosmWasm/cosmwasm/commit/edcdbc520d4f5521eed42de6e2869658278e91fd</a></li>
<li>2.0: <a href="https://github.com/CosmWasm/cosmwasm/commit/f63429ca59eb44dd5d780c1572016581337091e4">https://github.com/CosmWasm/cosmwasm/commit/f63429ca59eb44dd5d780c1572016581337091e4</a></li>
<li>2.1: <a href="https://github.com/CosmWasm/cosmwasm/commit/108e7dcbf9c21df0fa83f355ad3a7355d7f220cb">https://github.com/CosmWasm/cosmwasm/commit/108e7dcbf9c21df0fa83f355ad3a7355d7f220cb</a></li>
</ul>
<h2 id="applying-the-patch">Applying the patch</h2>
<p>The patch will be shipped in releases of wasmvm. You can update more or less as follows:</p>
<ol>
<li>Check the current wasmvm version: <code>go list -m github.com/CosmWasm/wasmvm</code></li>
<li>Bump the <code>github.com/CosmWasm/wasmvm</code> dependency in your go.mod to 1.5.5, 2.0.4, 2.1.3 depending on which minor version you are; <code>go mod tidy</code>; commit.</li>
<li>If you use the static libraries <code>libwasmvm_muslc.aarch64.a</code>/<code>libwasmvm_muslc.x86_64.a</code>, update them accordingly.</li>
<li>Check the updated wasmvm version: <code>go list -m github.com/CosmWasm/wasmvm</code> and ensure you see 1.5.5, 2.0.4, 2.1.3.</li>
<li>Follow your regular practices to deploy chain upgrades.</li>
</ol>
<p>To double check if the correct library version is loaded at runtime, use this query:
<code>&lt;appd&gt; query wasm libwasmvm-version</code>. It must show 1.5.5, 2.0.4 or 2.1.3.</p>
<p>The patch is consensus breaking and requires a coordinated upgrade.</p>
<h2 id="acknowledgement">Acknowledgement</h2>
<p>This issue was found by meadow101 who reported it to the Cosmos Bug Bounty Program on HackerOne.</p>
<p>If you believe you have found a bug in the Interchain Stack or would like to contribute to the
program by reporting a bug, please see <a href="https://hackerone.com/cosmos">https://hackerone.com/cosmos</a>.</p>
<h2 id="timeline">Timeline</h2>
<ul>
<li>2024-08-22: Confio receives a report through the Cosmos bug bounty program maintained by Amulet.</li>
<li>2024-08-23: Confio security contributors confirm the report.</li>
<li>2024-09-09: Confio developed the patch internally.</li>
<li>2024-09-23: Patch is released.</li>
</ul>
<p>[^1]: following Amulet's Severity Classification Framework ACMv1: <a href="https://github.com/interchainio/security/blob/e0227a1fb4059144aab4f6003eeee7f09912db3a/resources/CLASSIFICATION_MATRIX.md">https://github.com/interchainio/security/blob/e0227a1fb4059144aab4f6003eeee7f09912db3a/resources/CLASSIFICATION_MATRIX.md</a></p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/CosmWasm/wasmvm/security/advisories/GHSA-vmqh-5232-v43r">https://github.com/CosmWasm/wasmvm/security/advisories/GHSA-vmqh-5232-v43r</a></li>
<li><a href="https://github.com/CosmWasm/cosmwasm/commit/108e7dcbf9c21df0fa83f355ad3a7355d7f220cb">https://github.com/CosmWasm/cosmwasm/commit/108e7dcbf9c21df0fa83f355ad3a7355d7f220cb</a></li>
<li><a href="https://github.com/CosmWasm/cosmwasm/commit/edcdbc520d4f5521eed42de6e2869658278e91fd">https://github.com/CosmWasm/cosmwasm/commit/edcdbc520d4f5521eed42de6e2869658278e91fd</a></li>
<li><a href="https://github.com/CosmWasm/cosmwasm/commit/f63429ca59eb44dd5d780c1572016581337091e4">https://github.com/CosmWasm/cosmwasm/commit/f63429ca59eb44dd5d780c1572016581337091e4</a></li>
<li><a href="https://github.com/CosmWasm/advisories/blob/main/CWAs/CWA-2024-008.md">https://github.com/CosmWasm/advisories/blob/main/CWAs/CWA-2024-008.md</a></li>
<li><a href="https://github.com/advisories/GHSA-vmqh-5232-v43r">https://github.com/advisories/GHSA-vmqh-5232-v43r</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-vmqh-5232-v43r</uri>
        </author>
        <category label="severity" term="MODERATE"/>
        <published>2024-12-10T16:55:37.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[github.com/CosmWasm/wasmvm/v2] Panic in wasmvm can slow down block production]]></title>
        <id>https://github.com/advisories/GHSA-vmqh-5232-v43r</id>
        <link href="https://github.com/advisories/GHSA-vmqh-5232-v43r"/>
        <updated>2024-12-10T16:55:38.000Z</updated>
        <content type="html"><![CDATA[<h1 id="cwa-2024-008">CWA-2024-008</h1>
<p><strong>Severity</strong></p>
<p>Medium (Moderate + Likely)[^1]</p>
<p><strong>Affected versions:</strong></p>
<ul>
<li>wasmvm &gt;= 2.1.0, &lt; 2.1.3</li>
<li>wasmvm &gt;= 2.0.0, &lt; 2.0.4</li>
<li>wasmvm &lt; 1.5.5</li>
<li>cosmwasm-vm &gt;= 2.1.0, &lt; 2.1.4</li>
<li>cosmwasm-vm &gt;= 2.0.0, &lt; 2.0.7</li>
<li>cosmwasm-vm &lt; 1.5.8</li>
</ul>
<p><strong>Patched versions:</strong></p>
<ul>
<li>wasmvm 1.5.5, 2.0.4, 2.1.3</li>
<li>cosmwasm-vm 1.5.8, 2.0.7, 2.1.4</li>
</ul>
<h2 id="description-of-the-bug">Description of the bug</h2>
<p>(Blank for now. We'll add more detail once chains had a chance to upgrade.)</p>
<h2 id="patch">Patch</h2>
<ul>
<li>1.5: <a href="https://github.com/CosmWasm/cosmwasm/commit/edcdbc520d4f5521eed42de6e2869658278e91fd">https://github.com/CosmWasm/cosmwasm/commit/edcdbc520d4f5521eed42de6e2869658278e91fd</a></li>
<li>2.0: <a href="https://github.com/CosmWasm/cosmwasm/commit/f63429ca59eb44dd5d780c1572016581337091e4">https://github.com/CosmWasm/cosmwasm/commit/f63429ca59eb44dd5d780c1572016581337091e4</a></li>
<li>2.1: <a href="https://github.com/CosmWasm/cosmwasm/commit/108e7dcbf9c21df0fa83f355ad3a7355d7f220cb">https://github.com/CosmWasm/cosmwasm/commit/108e7dcbf9c21df0fa83f355ad3a7355d7f220cb</a></li>
</ul>
<h2 id="applying-the-patch">Applying the patch</h2>
<p>The patch will be shipped in releases of wasmvm. You can update more or less as follows:</p>
<ol>
<li>Check the current wasmvm version: <code>go list -m github.com/CosmWasm/wasmvm</code></li>
<li>Bump the <code>github.com/CosmWasm/wasmvm</code> dependency in your go.mod to 1.5.5, 2.0.4, 2.1.3 depending on which minor version you are; <code>go mod tidy</code>; commit.</li>
<li>If you use the static libraries <code>libwasmvm_muslc.aarch64.a</code>/<code>libwasmvm_muslc.x86_64.a</code>, update them accordingly.</li>
<li>Check the updated wasmvm version: <code>go list -m github.com/CosmWasm/wasmvm</code> and ensure you see 1.5.5, 2.0.4, 2.1.3.</li>
<li>Follow your regular practices to deploy chain upgrades.</li>
</ol>
<p>To double check if the correct library version is loaded at runtime, use this query:
<code>&lt;appd&gt; query wasm libwasmvm-version</code>. It must show 1.5.5, 2.0.4 or 2.1.3.</p>
<p>The patch is consensus breaking and requires a coordinated upgrade.</p>
<h2 id="acknowledgement">Acknowledgement</h2>
<p>This issue was found by meadow101 who reported it to the Cosmos Bug Bounty Program on HackerOne.</p>
<p>If you believe you have found a bug in the Interchain Stack or would like to contribute to the
program by reporting a bug, please see <a href="https://hackerone.com/cosmos">https://hackerone.com/cosmos</a>.</p>
<h2 id="timeline">Timeline</h2>
<ul>
<li>2024-08-22: Confio receives a report through the Cosmos bug bounty program maintained by Amulet.</li>
<li>2024-08-23: Confio security contributors confirm the report.</li>
<li>2024-09-09: Confio developed the patch internally.</li>
<li>2024-09-23: Patch is released.</li>
</ul>
<p>[^1]: following Amulet's Severity Classification Framework ACMv1: <a href="https://github.com/interchainio/security/blob/e0227a1fb4059144aab4f6003eeee7f09912db3a/resources/CLASSIFICATION_MATRIX.md">https://github.com/interchainio/security/blob/e0227a1fb4059144aab4f6003eeee7f09912db3a/resources/CLASSIFICATION_MATRIX.md</a></p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/CosmWasm/wasmvm/security/advisories/GHSA-vmqh-5232-v43r">https://github.com/CosmWasm/wasmvm/security/advisories/GHSA-vmqh-5232-v43r</a></li>
<li><a href="https://github.com/CosmWasm/cosmwasm/commit/108e7dcbf9c21df0fa83f355ad3a7355d7f220cb">https://github.com/CosmWasm/cosmwasm/commit/108e7dcbf9c21df0fa83f355ad3a7355d7f220cb</a></li>
<li><a href="https://github.com/CosmWasm/cosmwasm/commit/edcdbc520d4f5521eed42de6e2869658278e91fd">https://github.com/CosmWasm/cosmwasm/commit/edcdbc520d4f5521eed42de6e2869658278e91fd</a></li>
<li><a href="https://github.com/CosmWasm/cosmwasm/commit/f63429ca59eb44dd5d780c1572016581337091e4">https://github.com/CosmWasm/cosmwasm/commit/f63429ca59eb44dd5d780c1572016581337091e4</a></li>
<li><a href="https://github.com/CosmWasm/advisories/blob/main/CWAs/CWA-2024-008.md">https://github.com/CosmWasm/advisories/blob/main/CWAs/CWA-2024-008.md</a></li>
<li><a href="https://github.com/advisories/GHSA-vmqh-5232-v43r">https://github.com/advisories/GHSA-vmqh-5232-v43r</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-vmqh-5232-v43r</uri>
        </author>
        <category label="severity" term="MODERATE"/>
        <published>2024-12-10T16:55:37.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[github.com/CosmWasm/wasmd] Simulation of Wasmd message can cause crashing]]></title>
        <id>https://github.com/advisories/GHSA-vmg2-r3xv-r3xf</id>
        <link href="https://github.com/advisories/GHSA-vmg2-r3xv-r3xf"/>
        <updated>2024-12-10T16:55:36.000Z</updated>
        <content type="html"><![CDATA[<h1 id="cwa-2024-009">CWA-2024-009</h1>
<p><strong>Severity</strong></p>
<p>Low (Marginal + Likely)[^1]</p>
<p><strong>Affected versions:</strong></p>
<ul>
<li>wasmd &lt; 0.53.1</li>
</ul>
<p><strong>Patched versions:</strong></p>
<ul>
<li>wasmd 0.53.2 (please note that wasmd 0.53.1 is broken and must not be used)</li>
</ul>
<h2 id="description-of-the-bug">Description of the bug</h2>
<p>(Blank for now. We'll add more detail once chains had a chance to upgrade.)</p>
<h2 id="mitigations">Mitigations</h2>
<p>Apart from upgrading, it is recommended to <strong>not</strong> open the gRPC and REST APIs of <em>validator</em> nodes to the public internet. Use isolated and resource-constrained environments for running separate public RPC nodes instead.
These can then easily be thrown away and replaced with new instances in case of problems.</p>
<h2 id="applying-the-patch">Applying the patch</h2>
<h3 id="official-wasmd-patch">Official Wasmd patch</h3>
<p>The patch will be shipped in a wasmd release. You will also have to update <code>libwasmvm</code> if you build statically.
If you already use the latest / close to latest wasmd, you can update more or less as follows:</p>
<ol>
<li>Check the current wasmd version: <code>go list -m github.com/CosmWasm/wasmd</code></li>
<li>Bump the <code>github.com/CosmWasm/wasmd</code> dependency in your go.mod to 0.53.2 (Cosmos SDK 0.50 compatible); <code>go mod tidy</code>; commit.</li>
<li>If you use the static libraries <code>libwasmvm_muslc.aarch64.a</code>/<code>libwasmvm_muslc.x86_64.a</code>, make sure that you use the same version as your wasmvm version.</li>
<li>Check the updated wasmd version: <code>go list -m github.com/CosmWasm/wasmd</code> and ensure you see 0.53.2.</li>
<li>Follow your regular practices to deploy chain upgrades.</li>
</ol>
<p>To double check if the correct library version is loaded at runtime, use this query:
<code>&lt;appd&gt; query wasm libwasmvm-version</code>. It must show 2.1.4.</p>
<p>The patch is not consensus breaking <em>if you are already using wasmvm 2.1.3</em>.
If you are instead using wasmvm 2.1.2, then upgrading to 2.1.4 includes the consensus breaking changes of 2.1.3.</p>
<h3 id="diy-patch">DIY Patch</h3>
<p>If you are unable to upgrade to the latest version, you can backport the wasmd patch to your version. The patch is available at <a href="https://github.com/CosmWasm/wasmd/compare/v0.53.0...v0.53.2">Wasmd 0.53.2</a>.
However, if you are on an older version of wasmd, you will also be using a different version of wasmvm. We provide the required patches for wasmvm in versions 2.1.4, 2.0.5, 1.5.6.
To upgrade using this method:</p>
<ol>
<li>Check the current wasmvm version: <code>go list -m github.com/CosmWasm/wasmvm</code> and upgrade
to the closest patched version.</li>
<li>Bump the github.com/CosmWasm/wasmvm dependency in your go.mod to the closest compatible patched version (either 2.1.4, 2.0.5 or 1.5.6); go mod tidy; commit.</li>
<li>Apply the patch linked above to your version of wasmd.</li>
<li>If you use the static libraries <code>libwasmvm_muslc.aarch64.a</code>/<code>libwasmvm_muslc.x86_64.a</code>, make sure that you use the same version as your wasmvm version.</li>
<li>Follow your regular practices to deploy chain upgrades.</li>
</ol>
<p>To double check if the correct library version is loaded at runtime, use this query:
<code>&lt;appd&gt; query wasm libwasmvm-version</code>. It must show 2.1.4, 2.0.5 or 1.5.6 and must be the same as the wasmvm version in your go.sum.</p>
<p>The patch is not consensus breaking as long as you were using the previous patch version of wasmvm before.</p>
<h2 id="acknowledgement">Acknowledgement</h2>
<p>This issue was found by meadow101 who reported it to the Cosmos Bug Bounty Program on HackerOne.</p>
<p>If you believe you have found a bug in the Interchain Stack or would like to contribute to the
program by reporting a bug, please see <a href="https://hackerone.com/cosmos">https://hackerone.com/cosmos</a>.</p>
<h2 id="timeline">Timeline</h2>
<ul>
<li>2024-09-25: Confio receives a report through the Cosmos bug bounty program maintained by Amulet.</li>
<li>2024-09-30: Confio security contributors confirm the report.</li>
<li>2024-11-21: Confio developed the patch internally.</li>
<li>2024-12-06: Patch release is pre-announced through notification lists.</li>
<li>2024-12-10: Patch released.</li>
</ul>
<p>[^1]: following Amulet's Severity Classification Framework ACMv1: <a href="https://github.com/interchainio/security/blob/e0227a1fb4059144aab4f6003eeee7f09912db3a/resources/CLASSIFICATION_MATRIX.md">https://github.com/interchainio/security/blob/e0227a1fb4059144aab4f6003eeee7f09912db3a/resources/CLASSIFICATION_MATRIX.md</a></p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/CosmWasm/wasmd/security/advisories/GHSA-vmg2-r3xv-r3xf">https://github.com/CosmWasm/wasmd/security/advisories/GHSA-vmg2-r3xv-r3xf</a></li>
<li><a href="https://github.com/advisories/GHSA-vmg2-r3xv-r3xf">https://github.com/advisories/GHSA-vmg2-r3xv-r3xf</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-vmg2-r3xv-r3xf</uri>
        </author>
        <category label="severity" term="LOW"/>
        <published>2024-12-10T16:55:35.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[github.com/canonical/lxd] lxd CA certificate sign check bypass]]></title>
        <id>https://github.com/advisories/GHSA-4c49-9fpc-hc3v</id>
        <link href="https://github.com/advisories/GHSA-4c49-9fpc-hc3v"/>
        <updated>2024-12-09T23:26:17.000Z</updated>
        <content type="html"><![CDATA[<h3 id="summary">Summary</h3>
<p>If a <code>server.ca</code> file is present in <code>LXD_DIR</code> at LXD start up, LXD is in "PKI mode". In this mode, only TLS clients that have a CA-signed certificate should be able to authenticate with LXD.</p>
<p>We have discovered that if a client that sends a non-CA signed certificate during the TLS handshake, that client is able to authenticate with LXD if their certificate is present in the trust store.
    - The LXD Go client (and by extension <code>lxc</code>) does not send non-CA signed certificates during the handshake.
    - A manual client (e.g. <code>cURL</code>) might send a non-CA signed certificate during the handshake.</p>
<h4 id="versions-affected">Versions affected</h4>
<p>LXD 4.0 and above.</p>
<h3 id="details">Details</h3>
<p>When PKI mode was added to LXD it was intended that all client and server certificates <em>must</em> be signed by the certificate authority (see <a href="https://github.com/canonical/lxd/pull/2070/commits/84d917bdcca6fe1e3191ce47f1597c7d094e1909">https://github.com/canonical/lxd/pull/2070/commits/84d917bdcca6fe1e3191ce47f1597c7d094e1909</a>). </p>
<p>In PKI mode, the TLS listener configuration is altered to add the CA certificate but the <code>ClientAuth</code> field of <code>tls.Config</code> is not changed. The <code>ClientAuth</code> field is set to <code>tls.RequestClientCert</code>, which configures the TLS connection to request a certificate from the client, but not require one. This is necessary because untrusted requests are allowed for some endpoints.</p>
<p>If a client certificate is present in the trust store before PKI mode is enabled, calls to LXD using that certificate fail <em>when using the Go client for LXD</em>. I believe that what is happening is as follows:</p>
<ul>
<li>During the TLS handshake, the server requests a certificate from the client. The server includes in it's request a list of acceptable CAs.</li>
<li>The go client receives the request from the server, but does not have any certificates that match what the server requires, and so does not send any.</li>
<li>The server considers the handshake complete because it does not absolutely require the client certificate (see above).</li>
<li>In the <code>(*Daemon).Authenticate</code> method, when checking for TLS clients, there are no <code>PeerCertificates</code> in the request. So <code>util.CheckTrustState</code> is never called and the request is denied.</li>
</ul>
<p>Importantly, the above does not apply if the client sends a certificate during the handshake anyway. If this occurs and the certificate is present in the trust store, the request is trusted and is allowed to continue. It is possible to do this using cURL*.</p>
<h3 id="poc">PoC</h3>
<p>The follow snippet demonstrates the vulnerability:</p>
<pre><code># Install/initialize LXD
$ snap install lxd --channel 5.21/stable
$ lxd init --auto
$ lxc config set core.https_address=127.0.0.1:8443

# Add a certificate to the trust store before enabling PKI.
$ token="$(lxc config trust add --name ca-test --quiet)"
$ lxc remote add tls "${token}"

# Use easyrsa for configuring CA: https://github.com/OpenVPN/easy-rsa
$ cp -R /usr/share/easy-rsa "/tmp/pki"
$ export EASYRSA_KEY_SIZE=4096
$ cd /tmp/pki
$ ./easyrsa init-pki
$ echo "lxd" | ./easyrsa build-ca nopass
$ cp pki/ca.crt /var/snap/lxd/common/lxd/server.ca

# Restart daemon.
$ systemctl reload snap.lxd.daemon

# Using curl with the client certificate we expect a 403 Forbidden response.
# Instead we get a 200 OK and we are able to view the response body.
$ cat ~/snap/lxd/common/config/client.crt ~/snap/lxd/common/config/client.key &gt; ~/snap/lxd/common/config/client.pem
$ curl -s --cert ~/snap/lxd/common/config/client.pem --cacert /var/snap/lxd/common/lxd/server.crt https://127.0.0.1:8443/1.0" | jq '.metadata.config."core.https_address"'
</code></pre>
<h3 id="impact">Impact</h3>
<p>I believe this has a low impact for the following reasons:</p>
<ul>
<li>PKI mode is unlikely to have a large user base.</li>
<li>PKI is likely to be configured at start up without any previous certificates in the trust store.</li>
<li>Authentication is not bypassed entirely, the client certificate must already be trusted.</li>
</ul>
<h3 id="notes">Notes</h3>
<ul>
<li>I am not certain why cURL sends the certificate during the handshake but we can see it in the logs:</li>
</ul>
<pre><code>*   Trying 127.0.0.1:8443...
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0* Connected to 127.0.0.1 (127.0.0.1) port 8443 (#0)
* ALPN, offering h2
* ALPN, offering http/1.1
*  CAfile: /var/lib/lxd/server.crt
*  CApath: /etc/ssl/certs
* TLSv1.0 (OUT), TLS header, Certificate Status (22):
} [5 bytes data]
* TLSv1.3 (OUT), TLS handshake, Client hello (1):
} [512 bytes data]
  0     0    0     0    0     0      0      0 --:--:--  0:00:03 --:--:--     0* TLSv1.2 (IN), TLS header, Certificate Status (22):
{ [5 bytes data]
* TLSv1.3 (IN), TLS handshake, Server hello (2):
{ [122 bytes data]
* TLSv1.2 (IN), TLS header, Finished (20):
{ [5 bytes data]
* TLSv1.2 (IN), TLS header, Supplemental data (23):
{ [5 bytes data]
* TLSv1.3 (IN), TLS handshake, Encrypted Extensions (8):
{ [15 bytes data]
* TLSv1.2 (IN), TLS header, Supplemental data (23):
{ [5 bytes data]
* TLSv1.3 (IN), TLS handshake, Request CERT (13):
{ [69 bytes data]
* TLSv1.2 (IN), TLS header, Supplemental data (23):
{ [5 bytes data]
* TLSv1.3 (IN), TLS handshake, Certificate (11):
{ [496 bytes data]
* TLSv1.2 (IN), TLS header, Supplemental data (23):
{ [5 bytes data]
* TLSv1.3 (IN), TLS handshake, CERT verify (15):
{ [111 bytes data]
* TLSv1.2 (IN), TLS header, Supplemental data (23):
{ [5 bytes data]
* TLSv1.3 (IN), TLS handshake, Finished (20):
{ [36 bytes data]
* TLSv1.2 (OUT), TLS header, Finished (20):
} [5 bytes data]
* TLSv1.3 (OUT), TLS change cipher, Change cipher spec (1):
} [1 bytes data]
* TLSv1.2 (OUT), TLS header, Supplemental data (23):
} [5 bytes data]
* TLSv1.3 (OUT), TLS handshake, Certificate (11):         &lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt; HERE
} [455 bytes data]
* TLSv1.2 (OUT), TLS header, Supplemental data (23):
} [5 bytes data]
* TLSv1.3 (OUT), TLS handshake, CERT verify (15):
} [111 bytes data]
* TLSv1.2 (OUT), TLS header, Supplemental data (23):
} [5 bytes data]
* TLSv1.3 (OUT), TLS handshake, Finished (20):
} [36 bytes data]
* SSL connection using TLSv1.3 / TLS_AES_128_GCM_SHA256
* ALPN, server accepted to use h2
* Server certificate:
*  subject: O=LXD; CN=root@RUBIX
*  start date: Apr  2 15:27:39 2024 GMT
*  expire date: Mar 31 15:27:39 2034 GMT
*  subjectAltName: host "127.0.0.1" matched cert's IP address!
*  issuer: O=LXD; CN=root@RUBIX
*  SSL certificate verify ok.
* Using HTTP2, server supports multiplexing
* Connection state changed (HTTP/2 confirmed)
* Copying HTTP/2 data in stream buffer to connection buffer after upgrade: len=0
* TLSv1.2 (OUT), TLS header, Supplemental data (23):
} [5 bytes data]
* TLSv1.2 (OUT), TLS header, Supplemental data (23):
} [5 bytes data]
* TLSv1.2 (OUT), TLS header, Supplemental data (23):
} [5 bytes data]
* Using Stream ID: 1 (easy handle 0x601ce9c4feb0)
* TLSv1.2 (OUT), TLS header, Supplemental data (23):
} [5 bytes data]
&gt; GET /1.0 HTTP/2
&gt; Host: 127.0.0.1:8443
&gt; user-agent: curl/7.81.0
&gt; accept: */*
&gt; 
* TLSv1.2 (IN), TLS header, Supplemental data (23):
{ [5 bytes data]
* TLSv1.3 (IN), TLS handshake, Newsession Ticket (4):
{ [569 bytes data]
* TLSv1.2 (IN), TLS header, Supplemental data (23):
{ [5 bytes data]
* Connection state changed (MAX_CONCURRENT_STREAMS == 250)!
* TLSv1.2 (OUT), TLS header, Supplemental data (23):
} [5 bytes data]
* TLSv1.2 (IN), TLS header, Supplemental data (23):
{ [5 bytes data]
* TLSv1.2 (IN), TLS header, Supplemental data (23):
{ [5 bytes data]
* TLSv1.2 (IN), TLS header, Supplemental data (23):
{ [5 bytes data]
&lt; HTTP/2 200 
&lt; content-type: application/json
&lt; etag: "a1147bd1cd26e0b98e4c4400be3c17d5de3d865a045b6e609c6a8ee1aba8c1a1"
&lt; date: Mon, 17 Jun 2024 21:25:46 GMT
&lt; 
* TLSv1.2 (IN), TLS header, Supplemental data (23):
{ [5 bytes data]
* TLSv1.2 (IN), TLS header, Supplemental data (23):
{ [5 bytes data]
* TLSv1.2 (IN), TLS header, Supplemental data (23):
{ [5 bytes data]
100 11659    0 11659    0     0   3401      0 --:--:--  0:00:03 --:--:--  3402
* Connection #0 to host 127.0.0.1 left intact
</code></pre>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/canonical/lxd/security/advisories/GHSA-4c49-9fpc-hc3v">https://github.com/canonical/lxd/security/advisories/GHSA-4c49-9fpc-hc3v</a></li>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2024-6156">https://nvd.nist.gov/vuln/detail/CVE-2024-6156</a></li>
<li><a href="https://github.com/canonical/lxd/commit/92468bb60f4f1edf38ff0434414bea4f28afa711">https://github.com/canonical/lxd/commit/92468bb60f4f1edf38ff0434414bea4f28afa711</a></li>
<li><a href="https://www.cve.org/CVERecord?id=CVE-2024-6156">https://www.cve.org/CVERecord?id=CVE-2024-6156</a></li>
<li><a href="https://github.com/advisories/GHSA-4c49-9fpc-hc3v">https://github.com/advisories/GHSA-4c49-9fpc-hc3v</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-4c49-9fpc-hc3v</uri>
        </author>
        <category label="severity" term="LOW"/>
        <published>2024-12-09T23:26:16.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[github.com/canonical/lxd] lxd has a restricted TLS certificate privilege escalation when in PKI mode]]></title>
        <id>https://github.com/advisories/GHSA-jpmc-7p9c-4rxf</id>
        <link href="https://github.com/advisories/GHSA-jpmc-7p9c-4rxf"/>
        <updated>2024-12-09T22:43:15.000Z</updated>
        <content type="html"><![CDATA[<h3 id="summary">Summary</h3>
<p>If a <code>server.ca</code> file is present in <code>LXD_DIR</code> at LXD start up, LXD is in "PKI mode". In this mode, all clients must have certificates that have been signed by the CA. </p>
<p>The LXD configuration option <code>core.trust_ca_certificates</code> defaults to <code>false</code>. This means that although the client certificate has been signed by the CA, LXD will additionally add the certificate to the trust store and verify it via mTLS.</p>
<p>When a restricted certificate is added to the trust store in this mode, it's restrictions are not honoured, and the client has full access to LXD.</p>
<h3 id="details">Details</h3>
<p>When authorization was refactored to allow for generalisation (at the time for TLS, RBAC, and OpenFGA, see <a href="https://github.com/canonical/lxd/pull/12313">https://github.com/canonical/lxd/pull/12313</a>), PKI mode did not account for the <code>core.trust_ca_certificates</code> configuration option. When this option is enabled, all CA-signed client certificates are given full access to LXD. <a href="https://github.com/canonical/lxd/pull/12513/commits/5cdc9a35b9c51e981b1e70330bde0413ccacc7fd">This cherry-pick from Incus</a> was added to LXD to fix the issue. </p>
<p>The cherry-pick fixed the immediate issue and allowed full access to LXD for CA-signed client certificates when <code>core.trust_ca_certificates</code> is enabled, but did not consider the behaviour of LXD when <code>core.trust_ca_certificates</code> is disabled. </p>
<p>When <code>core.trust_ca_certificates</code> is false, restrictions that are applied to a certificate should be honoured. Instead, they are being ignored due to the presence of a <code>server.ca</code> file in <code>LXD_DIR</code>.</p>
<h3 id="poc">PoC</h3>
<pre><code># Install/initialize LXD
$ snap install lxd --channel 5.21/stable
$ lxd init --auto
$ lxc config set core.https_address=127.0.0.1:8443

# Use easyrsa for configuring CA: https://github.com/OpenVPN/easy-rsa
$ cp -R /usr/share/easy-rsa "/tmp/pki"
$ export EASYRSA_KEY_SIZE=4096
$ cd /tmp/pki
$ ./easyrsa init-pki
$ echo "lxd" | ./easyrsa build-ca nopass
$ ./easyrsa build-client-full lxd-client nopass
$ cp pki/ca.crt /var/snap/lxd/common/lxd/server.ca
$ cp pki/issued/lxd-client.crt ~/snap/lxd/common/config/client.crt
$ cp pki/private/lxd-client.key ~/snap/lxd/common/config/client.key

# Restart daemon.
$ systemctl reload snap.lxd.daemon

# Add a restricted certificate to the trust store.
$ token="$(lxc config trust add --name ca-test --quiet --restricted)"
$ lxc remote add tls "${token}"

# Our client has a CA-signed certificate, but it is restricted, so the client should not be able to view server config.
$ lxc config get tls: core.https_address
127.0.0.1:8443
</code></pre>
<h3 id="impact">Impact</h3>
<p>I believe this vulnerability is low impact because PKI mode is:</p>
<ol>
<li>Not the standard or recommended mode of operation for LXD.</li>
<li>While <code>core.trust_ca_certificates</code> defaults to false, we believe that users who enable PKI mode will generally have <code>core.trust_ca_certificates</code> enabled to allow for passwordless PKI with CRL revocation (see <a href="https://github.com/canonical/lxd/issues/3832">https://github.com/canonical/lxd/issues/3832</a>). When this mode is enabled, all clients with CA-signed certificates have root access* anyway.</li>
</ol>
<p>*Note: If a restricted certificate is added before <code>core.trust_ca_certificates</code> is enabled, the certificate becomes unrestricted. We believe this was the original intention of the PR, but this should be changed to disallow any unintended permission change.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/canonical/lxd/security/advisories/GHSA-jpmc-7p9c-4rxf">https://github.com/canonical/lxd/security/advisories/GHSA-jpmc-7p9c-4rxf</a></li>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2024-6219">https://nvd.nist.gov/vuln/detail/CVE-2024-6219</a></li>
<li><a href="https://github.com/canonical/lxd/pull/12313">https://github.com/canonical/lxd/pull/12313</a></li>
<li><a href="https://pkg.go.dev/vuln/GO-2024-3313">https://pkg.go.dev/vuln/GO-2024-3313</a></li>
<li><a href="https://www.cve.org/CVERecord?id=CVE-2024-6219">https://www.cve.org/CVERecord?id=CVE-2024-6219</a></li>
<li><a href="https://github.com/advisories/GHSA-jpmc-7p9c-4rxf">https://github.com/advisories/GHSA-jpmc-7p9c-4rxf</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-jpmc-7p9c-4rxf</uri>
        </author>
        <category label="severity" term="LOW"/>
        <published>2024-12-09T22:43:13.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[github.com/gohugoio/hugo] Hugo does not escape some attributes in internal templates]]></title>
        <id>https://github.com/advisories/GHSA-c2xf-9v2r-r2rx</id>
        <link href="https://github.com/advisories/GHSA-c2xf-9v2r-r2rx"/>
        <updated>2024-12-10T15:33:25.000Z</updated>
        <content type="html"><![CDATA[<h2 id="impact">Impact</h2>
<p>Some HTML attributes in Markdown in the internal templates listed below not escaped. Impacted are Hugo users who do not trust their Markdown content files and are using one or more of these templates.</p>
<ul>
<li><code>_default/_markup/render-link.html</code> from <code>v0.123.0</code></li>
<li><code>_default/_markup/render-image.html</code> from <code>v0.123.0</code></li>
<li><code>_default/_markup/render-table.html</code> from <code>v0.134.0</code></li>
<li><code>shortcodes/youtube.html</code> from <code>v0.125.0</code></li>
</ul>
<h2 id="patches">Patches</h2>
<p>Patched in v0.139.4.</p>
<h2 id="workarounds">Workarounds</h2>
<p>Replace with user defined templates or disable the internal templates: <a href="https://gohugo.io/getting-started/configuration-markup/#renderhooksimageenabledefault">https://gohugo.io/getting-started/configuration-markup/#renderhooksimageenabledefault</a></p>
<h2 id="references">References</h2>
<ul>
<li><a href="https://github.com/gohugoio/hugo/releases/tag/v0.139.4">https://github.com/gohugoio/hugo/releases/tag/v0.139.4</a></li>
<li><a href="https://gohugo.io/about/security/">https://gohugo.io/about/security/</a></li>
</ul>
<h3 id="references-1">References</h3>
<ul>
<li><a href="https://github.com/gohugoio/hugo/security/advisories/GHSA-c2xf-9v2r-r2rx">https://github.com/gohugoio/hugo/security/advisories/GHSA-c2xf-9v2r-r2rx</a></li>
<li><a href="https://github.com/gohugoio/hugo/commit/54398f8d572c689f9785d59e907fd910a23401b0">https://github.com/gohugoio/hugo/commit/54398f8d572c689f9785d59e907fd910a23401b0</a></li>
<li><a href="https://github.com/gohugoio/hugo/releases/tag/v0.139.4">https://github.com/gohugoio/hugo/releases/tag/v0.139.4</a></li>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2024-55601">https://nvd.nist.gov/vuln/detail/CVE-2024-55601</a></li>
<li><a href="https://gohugo.io/getting-started/configuration-markup/#renderhooksimageenabledefault">https://gohugo.io/getting-started/configuration-markup/#renderhooksimageenabledefault</a></li>
<li><a href="https://github.com/advisories/GHSA-c2xf-9v2r-r2rx">https://github.com/advisories/GHSA-c2xf-9v2r-r2rx</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-c2xf-9v2r-r2rx</uri>
        </author>
        <category label="severity" term="MODERATE"/>
        <published>2024-12-09T20:44:50.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[github.com/moby/moby] NULL Pointer Dereference on moby image history]]></title>
        <id>https://github.com/advisories/GHSA-q59j-vv4j-v33c</id>
        <link href="https://github.com/advisories/GHSA-q59j-vv4j-v33c"/>
        <updated>2024-12-09T21:53:38.000Z</updated>
        <content type="html"><![CDATA[<p>moby v25.0.0 - v26.0.2 is vulnerable to NULL Pointer Dereference via daemon/images/image_history.go.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2024-36620">https://nvd.nist.gov/vuln/detail/CVE-2024-36620</a></li>
<li><a href="https://github.com/moby/moby/commit/ab570ab3d62038b3d26f96a9bb585d0b6095b9b4">https://github.com/moby/moby/commit/ab570ab3d62038b3d26f96a9bb585d0b6095b9b4</a></li>
<li><a href="https://gist.github.com/1047524396/f08816669701ab478a265a811d2c89b2">https://gist.github.com/1047524396/f08816669701ab478a265a811d2c89b2</a></li>
<li><a href="https://github.com/moby/moby/blob/v26.0.2/daemon/images/image_history.go#L48">https://github.com/moby/moby/blob/v26.0.2/daemon/images/image_history.go#L48</a></li>
<li><a href="https://pkg.go.dev/vuln/GO-2024-3311">https://pkg.go.dev/vuln/GO-2024-3311</a></li>
<li><a href="https://github.com/advisories/GHSA-q59j-vv4j-v33c">https://github.com/advisories/GHSA-q59j-vv4j-v33c</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-q59j-vv4j-v33c</uri>
        </author>
        <category label="severity" term="MODERATE"/>
        <published>2024-11-29T18:34:03.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[github.com/cli/cli] Downloading malicious GitHub Actions workflow artifact results in path traversal vulnerability]]></title>
        <id>https://github.com/advisories/GHSA-2m9h-r57g-45pj</id>
        <link href="https://github.com/advisories/GHSA-2m9h-r57g-45pj"/>
        <updated>2024-12-04T22:17:32.000Z</updated>
        <content type="html"><![CDATA[<h3 id="summary">Summary</h3>
<p>A security vulnerability has been identified in GitHub CLI that could create or overwrite files in unintended directories when users download a malicious GitHub Actions workflow artifact through <code>gh run download</code>. </p>
<h3 id="details">Details</h3>
<p>This vulnerability stems from a GitHub Actions workflow artifact named <code>..</code> when downloaded using <code>gh run download</code>.  The artifact name and <code>--dir</code> flag are used to determine the artifacts download path.  When the artifact is named <code>..</code>, the resulting files within the artifact are extracted exactly 1 directory higher than the specified <code>--dir</code> flag value.</p>
<p>In <code>2.63.1</code>, <code>gh run download</code> will not download artifacts named <code>..</code> and <code>.</code> and instead exit with the following error message:</p>
<pre><code>error downloading ..: would result in path traversal
</code></pre>
<h3 id="impact">Impact</h3>
<p>Successful exploitation heightens the risk of local path traversal attack vectors exactly 1 directory higher than intended.</p>
<h3 id="remediation-and-mitigation">Remediation and Mitigation</h3>
<ol>
<li>Upgrade <code>gh</code> to <code>2.63.1</code></li>
<li>Implement additional validation to ensure artifact filenames do not contain potentially dangerous patterns, such as <code>..</code>, to prevent path traversal risks.</li>
</ol>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/cli/cli/security/advisories/GHSA-2m9h-r57g-45pj">https://github.com/cli/cli/security/advisories/GHSA-2m9h-r57g-45pj</a></li>
<li><a href="https://github.com/cli/cli/commit/1136764c369aaf0cae4ec2ee09dc35d871076932">https://github.com/cli/cli/commit/1136764c369aaf0cae4ec2ee09dc35d871076932</a></li>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2024-54132">https://nvd.nist.gov/vuln/detail/CVE-2024-54132</a></li>
<li><a href="https://github.com/advisories/GHSA-2m9h-r57g-45pj">https://github.com/advisories/GHSA-2m9h-r57g-45pj</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-2m9h-r57g-45pj</uri>
        </author>
        <category label="severity" term="MODERATE"/>
        <published>2024-12-04T15:32:45.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[github.com/cli/cli/v2] Downloading malicious GitHub Actions workflow artifact results in path traversal vulnerability]]></title>
        <id>https://github.com/advisories/GHSA-2m9h-r57g-45pj</id>
        <link href="https://github.com/advisories/GHSA-2m9h-r57g-45pj"/>
        <updated>2024-12-04T22:17:32.000Z</updated>
        <content type="html"><![CDATA[<h3 id="summary">Summary</h3>
<p>A security vulnerability has been identified in GitHub CLI that could create or overwrite files in unintended directories when users download a malicious GitHub Actions workflow artifact through <code>gh run download</code>. </p>
<h3 id="details">Details</h3>
<p>This vulnerability stems from a GitHub Actions workflow artifact named <code>..</code> when downloaded using <code>gh run download</code>.  The artifact name and <code>--dir</code> flag are used to determine the artifacts download path.  When the artifact is named <code>..</code>, the resulting files within the artifact are extracted exactly 1 directory higher than the specified <code>--dir</code> flag value.</p>
<p>In <code>2.63.1</code>, <code>gh run download</code> will not download artifacts named <code>..</code> and <code>.</code> and instead exit with the following error message:</p>
<pre><code>error downloading ..: would result in path traversal
</code></pre>
<h3 id="impact">Impact</h3>
<p>Successful exploitation heightens the risk of local path traversal attack vectors exactly 1 directory higher than intended.</p>
<h3 id="remediation-and-mitigation">Remediation and Mitigation</h3>
<ol>
<li>Upgrade <code>gh</code> to <code>2.63.1</code></li>
<li>Implement additional validation to ensure artifact filenames do not contain potentially dangerous patterns, such as <code>..</code>, to prevent path traversal risks.</li>
</ol>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/cli/cli/security/advisories/GHSA-2m9h-r57g-45pj">https://github.com/cli/cli/security/advisories/GHSA-2m9h-r57g-45pj</a></li>
<li><a href="https://github.com/cli/cli/commit/1136764c369aaf0cae4ec2ee09dc35d871076932">https://github.com/cli/cli/commit/1136764c369aaf0cae4ec2ee09dc35d871076932</a></li>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2024-54132">https://nvd.nist.gov/vuln/detail/CVE-2024-54132</a></li>
<li><a href="https://github.com/advisories/GHSA-2m9h-r57g-45pj">https://github.com/advisories/GHSA-2m9h-r57g-45pj</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-2m9h-r57g-45pj</uri>
        </author>
        <category label="severity" term="MODERATE"/>
        <published>2024-12-04T15:32:45.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[github.com/kolide/launcher] Kolide Agent Privilege Escalation (Windows, Versions >= 1.5.3, < 1.12.3)]]></title>
        <id>https://github.com/advisories/GHSA-66q9-2rvx-qfj5</id>
        <link href="https://github.com/advisories/GHSA-66q9-2rvx-qfj5"/>
        <updated>2024-12-03T20:56:59.000Z</updated>
        <content type="html"><![CDATA[<p>An implementation bug in the Kolide Agent (known as <code>launcher</code>) allows for local privilege escalation to the SYSTEM user on Windows 10 and 11. Impacted versions include versions &gt;= 1.5.3 and the fix has been released in 1.12.3. </p>
<p>The bug was introduced in version 1.5.3 when launcher started storing upgraded binaries in the ProgramData directory (#1510). This move to the new directory meant the launcher root directory inherited default permissions that are not as strict as the previous location. These incorrect default permissions in conjunction with an omitted SystemDrive environmental variable (when launcher starts osqueryd), allows a malicious actor with access to the local Windows device to successfully place an arbitrary DLL into the osqueryd process's search path. Under some circumstances, this DLL will be executed when osqueryd performs a WMI query. This combination of events could then allow the attacker to escalate their privileges to SYSTEM.</p>
<p>This issue was found by Bryan Alexander of Atredis Partners and responsibly reported through the Kolide bug bounty program. Kolide made the appropriate changes and released a fix in version 1.12.3 of the <code>launcher</code> package.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/kolide/launcher/security/advisories/GHSA-66q9-2rvx-qfj5">https://github.com/kolide/launcher/security/advisories/GHSA-66q9-2rvx-qfj5</a></li>
<li><a href="https://github.com/kolide/launcher/pull/1510">https://github.com/kolide/launcher/pull/1510</a></li>
<li><a href="https://github.com/advisories/GHSA-66q9-2rvx-qfj5">https://github.com/advisories/GHSA-66q9-2rvx-qfj5</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-66q9-2rvx-qfj5</uri>
        </author>
        <category label="severity" term="HIGH"/>
        <published>2024-12-03T20:56:58.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[vitess.io/vitess] Vitess allows HTML injection in /debug/querylogz & /debug/env]]></title>
        <id>https://github.com/advisories/GHSA-7mwh-q3xm-qh6p</id>
        <link href="https://github.com/advisories/GHSA-7mwh-q3xm-qh6p"/>
        <updated>2024-12-03T18:43:35.000Z</updated>
        <content type="html"><![CDATA[<h3 id="summary">Summary</h3>
<p>The <code>/debug/querylogz</code> and <code>/debug/env</code> pages for <code>vtgate</code> and <code>vttablet</code> do not properly escape user input. The result is that queries executed by Vitess can write HTML into the monitoring page at will.</p>
<h3 id="details">Details</h3>
<p>These pages are rendered using <code>text/template</code> instead of rendering with a proper HTML templating engine.</p>
<h3 id="poc">PoC</h3>
<p>Execute any query where part of it is HTML markup, for example as part of a string. To make it easier to observe you might want to make sure the query takes a few seconds to complete, giving you time to refresh the status page. </p>
<p>Example query that can trigger the issue:</p>
<pre><code class="language-sql">UPDATE users
SET
    email = CONCAT("&lt;img src=https://cataas.com/cat/says/oops&gt;", users.idUser, "@xxx")
WHERE
    email NOT LIKE '%xxx%' AND email != "demo@xxx.com"
</code></pre>
<p>Result: </p>
<p><img alt="image" src="https://github.com/user-attachments/assets/c583816b-157c-474e-bbed-152b3dc0372f"></p>
<h3 id="impact">Impact</h3>
<p>Anyone looking at the Vitess status page is affected. This would normally be owners / administrators of the Vitess cluster.</p>
<p>Anyone that can influence what text show up in queries can trigger it. This would normally be pretty much everybody interacting with a system that uses Vitess as a backend.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/vitessio/vitess/security/advisories/GHSA-7mwh-q3xm-qh6p">https://github.com/vitessio/vitess/security/advisories/GHSA-7mwh-q3xm-qh6p</a></li>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2024-53257">https://nvd.nist.gov/vuln/detail/CVE-2024-53257</a></li>
<li><a href="https://github.com/vitessio/vitess/commit/2b71d1b5f8ca676beeab2875525003cd45096217">https://github.com/vitessio/vitess/commit/2b71d1b5f8ca676beeab2875525003cd45096217</a></li>
<li><a href="https://github.com/advisories/GHSA-7mwh-q3xm-qh6p">https://github.com/advisories/GHSA-7mwh-q3xm-qh6p</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-7mwh-q3xm-qh6p</uri>
        </author>
        <category label="severity" term="MODERATE"/>
        <published>2024-12-03T18:43:33.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[vitess.io/vitess] Vitess allows HTML injection in /debug/querylogz & /debug/env]]></title>
        <id>https://github.com/advisories/GHSA-7mwh-q3xm-qh6p</id>
        <link href="https://github.com/advisories/GHSA-7mwh-q3xm-qh6p"/>
        <updated>2024-12-03T18:43:35.000Z</updated>
        <content type="html"><![CDATA[<h3 id="summary">Summary</h3>
<p>The <code>/debug/querylogz</code> and <code>/debug/env</code> pages for <code>vtgate</code> and <code>vttablet</code> do not properly escape user input. The result is that queries executed by Vitess can write HTML into the monitoring page at will.</p>
<h3 id="details">Details</h3>
<p>These pages are rendered using <code>text/template</code> instead of rendering with a proper HTML templating engine.</p>
<h3 id="poc">PoC</h3>
<p>Execute any query where part of it is HTML markup, for example as part of a string. To make it easier to observe you might want to make sure the query takes a few seconds to complete, giving you time to refresh the status page. </p>
<p>Example query that can trigger the issue:</p>
<pre><code class="language-sql">UPDATE users
SET
    email = CONCAT("&lt;img src=https://cataas.com/cat/says/oops&gt;", users.idUser, "@xxx")
WHERE
    email NOT LIKE '%xxx%' AND email != "demo@xxx.com"
</code></pre>
<p>Result: </p>
<p><img alt="image" src="https://github.com/user-attachments/assets/c583816b-157c-474e-bbed-152b3dc0372f"></p>
<h3 id="impact">Impact</h3>
<p>Anyone looking at the Vitess status page is affected. This would normally be owners / administrators of the Vitess cluster.</p>
<p>Anyone that can influence what text show up in queries can trigger it. This would normally be pretty much everybody interacting with a system that uses Vitess as a backend.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/vitessio/vitess/security/advisories/GHSA-7mwh-q3xm-qh6p">https://github.com/vitessio/vitess/security/advisories/GHSA-7mwh-q3xm-qh6p</a></li>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2024-53257">https://nvd.nist.gov/vuln/detail/CVE-2024-53257</a></li>
<li><a href="https://github.com/vitessio/vitess/commit/2b71d1b5f8ca676beeab2875525003cd45096217">https://github.com/vitessio/vitess/commit/2b71d1b5f8ca676beeab2875525003cd45096217</a></li>
<li><a href="https://github.com/advisories/GHSA-7mwh-q3xm-qh6p">https://github.com/advisories/GHSA-7mwh-q3xm-qh6p</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-7mwh-q3xm-qh6p</uri>
        </author>
        <category label="severity" term="MODERATE"/>
        <published>2024-12-03T18:43:33.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[vitess.io/vitess] Vitess allows HTML injection in /debug/querylogz & /debug/env]]></title>
        <id>https://github.com/advisories/GHSA-7mwh-q3xm-qh6p</id>
        <link href="https://github.com/advisories/GHSA-7mwh-q3xm-qh6p"/>
        <updated>2024-12-03T18:43:35.000Z</updated>
        <content type="html"><![CDATA[<h3 id="summary">Summary</h3>
<p>The <code>/debug/querylogz</code> and <code>/debug/env</code> pages for <code>vtgate</code> and <code>vttablet</code> do not properly escape user input. The result is that queries executed by Vitess can write HTML into the monitoring page at will.</p>
<h3 id="details">Details</h3>
<p>These pages are rendered using <code>text/template</code> instead of rendering with a proper HTML templating engine.</p>
<h3 id="poc">PoC</h3>
<p>Execute any query where part of it is HTML markup, for example as part of a string. To make it easier to observe you might want to make sure the query takes a few seconds to complete, giving you time to refresh the status page. </p>
<p>Example query that can trigger the issue:</p>
<pre><code class="language-sql">UPDATE users
SET
    email = CONCAT("&lt;img src=https://cataas.com/cat/says/oops&gt;", users.idUser, "@xxx")
WHERE
    email NOT LIKE '%xxx%' AND email != "demo@xxx.com"
</code></pre>
<p>Result: </p>
<p><img alt="image" src="https://github.com/user-attachments/assets/c583816b-157c-474e-bbed-152b3dc0372f"></p>
<h3 id="impact">Impact</h3>
<p>Anyone looking at the Vitess status page is affected. This would normally be owners / administrators of the Vitess cluster.</p>
<p>Anyone that can influence what text show up in queries can trigger it. This would normally be pretty much everybody interacting with a system that uses Vitess as a backend.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/vitessio/vitess/security/advisories/GHSA-7mwh-q3xm-qh6p">https://github.com/vitessio/vitess/security/advisories/GHSA-7mwh-q3xm-qh6p</a></li>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2024-53257">https://nvd.nist.gov/vuln/detail/CVE-2024-53257</a></li>
<li><a href="https://github.com/vitessio/vitess/commit/2b71d1b5f8ca676beeab2875525003cd45096217">https://github.com/vitessio/vitess/commit/2b71d1b5f8ca676beeab2875525003cd45096217</a></li>
<li><a href="https://github.com/advisories/GHSA-7mwh-q3xm-qh6p">https://github.com/advisories/GHSA-7mwh-q3xm-qh6p</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-7mwh-q3xm-qh6p</uri>
        </author>
        <category label="severity" term="MODERATE"/>
        <published>2024-12-03T18:43:33.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[github.com/argoproj/argo-workflows/v3] Access to Archived Argo Workflows with Fake Token in `client` mode]]></title>
        <id>https://github.com/advisories/GHSA-h36c-m3rf-34h9</id>
        <link href="https://github.com/advisories/GHSA-h36c-m3rf-34h9"/>
        <updated>2024-12-02T22:17:56.000Z</updated>
        <content type="html"><![CDATA[<h3 id="summary">Summary</h3>
<p>When using <code>--auth-mode=client</code>, Archived Workflows can be retrieved with a fake or spoofed token via the GET Workflow endpoint: <code>/api/v1/workflows/{namespace}/{name}</code></p>
<p>When using <code>--auth-mode=sso</code>,  all Archived Workflows can be retrieved with a valid token via the GET Workflow endpoint: <code>/api/v1/workflows/{namespace}/{name}</code></p>
<h3 id="details">Details</h3>
<p>No authentication is performed by the Server itself on <code>client</code> tokens[^1]. Authentication &amp; authorization is instead delegated to the k8s API server.
However, the <a href="https://github.com/argoproj/argo-workflows/blob/52cca7e079a4f6d76db303ac550b1876e51b3865/server/workflowarchive/archived_workflow_server.go">Workflow Archive</a> does not interact with k8s, and so any token that <a href="https://github.com/argoproj/argo-workflows/blob/52cca7e079a4f6d76db303ac550b1876e51b3865/server/auth/mode.go#L37"><em>looks</em></a> <a href="https://github.com/argoproj/argo-workflows/blob/52cca7e079a4f6d76db303ac550b1876e51b3865/server/auth/gatekeeper.go#L185">valid</a> will be considered authenticated, even if it is not a k8s token or even if the token has no RBAC for Argo. To handle the lack of pass-through k8s authN/authZ, the Workflow Archive specifically does <a href="https://github.com/argoproj/argo-workflows/blob/52cca7e079a4f6d76db303ac550b1876e51b3865/server/workflowarchive/archived_workflow_server.go#L50">the equivalent of a <code>kubectl auth can-i</code></a> check for respective methods.</p>
<p>In #12736 / v3.5.7 and #13021 / v3.5.8, the auth check was accidentally removed on the GET Workflow endpoint's fallback to archived workflows on <a href="https://github.com/argoproj/argo-workflows/pull/13021/files#diff-a5b255abaceddc9cc20bf6da6ae92c3a5d3605d94366af503ed754c079a1171aL668-R715">these lines</a>, allowing archived workflows to be retrieved with a fake token.</p>
<h3 id="poc">PoC</h3>
<h4 id="configuration">Configuration</h4>
<p>Controller <code>ConfigMap</code>:</p>
<pre><code class="language-yaml">  config: |
    persistence:
      archive: true
      postgresql:
        database: argoworkflows
        host: db-host
        passwordSecret:
          key: postgresPassword
          name: argo-wf-postgres-credentials
        port: 5432
        tableName: argo_workflows
        userNameSecret:
          key: username
          name: argo-wf-postgres-credentials
</code></pre>
<p>Server: <code>--auth-mode=client</code></p>
<h4 id="reproduction">Reproduction</h4>
<p>Visit a completed, archived workflow URL with an invalid authorization token, this results in the workflow being displayed.</p>
<p>For example, directly query the API and retrieve the workflow data (where <code>Bearer thisisatest</code> is not a valid token):</p>
<pre><code class="language-sh">curl -H 'Authorization: Bearer thisisatest' -v http://localhost:8000/api/v1/workflows/argo/hello-world-7tv5g
</code></pre>
<details><summary>Results in a returned workflow:</summary>

<pre><code>* Host localhost:8000 was resolved.
* IPv6: ::1
* IPv4: 127.0.0.1
*   Trying [::1]:8000...
* Connected to localhost (::1) port 8000
&gt; GET /api/v1/workflows/argo/hello-world-7tv5g HTTP/1.1
&gt; Host: localhost:8000
&gt; User-Agent: curl/8.7.1
&gt; Accept: */*
&gt; Authorization: Bearer thisisatest
&gt;
* Request completely sent off
&lt; HTTP/1.1 200 OK
&lt; Content-Type: application/json
&lt; Grpc-Metadata-Content-Type: application/grpc
&lt; X-Ratelimit-Limit: 1000
&lt; X-Ratelimit-Remaining: 999
&lt; X-Ratelimit-Reset: Mon, 19 Aug 2024 20:44:27 UTC
&lt; Date: Mon, 19 Aug 2024 20:44:26 GMT
&lt; Transfer-Encoding: chunked
&lt;
* Connection #0 to host localhost left intact
{
    "metadata": {
        "name": "hello-world-7tv5g",
        "generateName": "hello-world-",
        "namespace": "argo",
        "uid": "e5868ab1-f820-4a9e-9407-162346a4ccb4",
        "resourceVersion": "9982",
        "generation": 3,
        "creationTimestamp": "2024-08-13T23:59:20Z",
        "labels": {
            "workflows.argoproj.io/archive-strategy": "false",
            "workflows.argoproj.io/completed": "true",
            "workflows.argoproj.io/phase": "Succeeded",
            "workflows.argoproj.io/workflow-archiving-status": "Persisted"
        },
        "annotations": {
            "workflows.argoproj.io/description": "This is a simple hello world example.\n",
            "workflows.argoproj.io/pod-name-format": "v2"
        },
        "managedFields": [
            {
                "manager": "argo",
                "operation": "Update",
                "apiVersion": "argoproj.io/v1alpha1",
                "time": "2024-08-13T23:59:20Z",
                "fieldsType": "FieldsV1",
                "fieldsV1": {
                    "f:metadata": {
                        "f:annotations": {
                            ".": {},
                            "f:workflows.argoproj.io/description": {}
                        },
                        "f:generateName": {},
                        "f:labels": {
                            ".": {},
                            "f:workflows.argoproj.io/archive-strategy": {}
                        }
                    },
                    "f:spec": {}
                }
            },
            {
                "manager": "workflow-controller",
                "operation": "Update",
                "apiVersion": "argoproj.io/v1alpha1",
                "time": "2024-08-13T23:59:30Z",
                "fieldsType": "FieldsV1",
                "fieldsV1": {
                    "f:metadata": {
                        "f:annotations": {
                            "f:workflows.argoproj.io/pod-name-format": {}
                        },
                        "f:labels": {
                            "f:workflows.argoproj.io/completed": {},
                            "f:workflows.argoproj.io/phase": {},
                            "f:workflows.argoproj.io/workflow-archiving-status": {}
                        }
                    },
                    "f:status": {}
                }
            }
        ]
    },
    "spec": {
        "templates": [
            {
                "name": "hello-world",
                "inputs": {},
                "outputs": {},
                "metadata": {},
                "container": {
                    "name": "",
                    "image": "busybox",
                    "command": [
                        "echo"
                    ],
                    "args": [
                        "hello world"
                    ],
                    "resources": {}
                }
            }
        ],
        "entrypoint": "hello-world",
        "arguments": {},
        "serviceAccountName": "argo-workflow"
    },
    "status": {
        "phase": "Succeeded",
        "startedAt": "2024-08-13T23:59:20Z",
        "finishedAt": "2024-08-13T23:59:30Z",
        "progress": "1/1",
        "nodes": {
            "hello-world-7tv5g": {
                "id": "hello-world-7tv5g",
                "name": "hello-world-7tv5g",
                "displayName": "hello-world-7tv5g",
                "type": "Pod",
                "templateName": "hello-world",
                "templateScope": "local/hello-world-7tv5g",
                "phase": "Succeeded",
                "startedAt": "2024-08-13T23:59:20Z",
                "finishedAt": "2024-08-13T23:59:24Z",
                "progress": "1/1",
                "resourcesDuration": {
                    "cpu": 0,
                    "memory": 3
                },
                "outputs": {
                    "exitCode": "0"
                },
                "hostNodeName": "kind-control-plane"
            }
        },
        "conditions": [
            {
                "type": "PodRunning",
                "status": "False"
            },
            {
                "type": "Completed",
                "status": "True"
            }
        ],
        "resourcesDuration": {
            "cpu": 0,
            "memory": 3
        },
        "artifactRepositoryRef": {
            "default": true,
            "artifactRepository": {}
        },
        "artifactGCStatus": {
            "notSpecified": true
        },
        "taskResultsCompletionStatus": {
            "hello-world-7tv5g": true
        }
    }
}%
</code></pre>
</details>


<h3 id="impact">Impact</h3>
<p>Users of the Server with <code>--auth-mode=client</code> and with <code>persistence.archive: true</code> are vulnerable to having Archived Workflows retrieved with a fake or spoofed token.</p>
<p>Users of the Server with <code>--auth-mode=sso</code> and with <code>persistence.archive: true</code> are vulnerable to users being able to access workflows they could not access before archiving.</p>
<p>[^1]: <code>sso</code> tokens, on the other hand, are <a href="https://github.com/argoproj/argo-workflows/blob/52cca7e079a4f6d76db303ac550b1876e51b3865/server/auth/gatekeeper.go#L207">immediately "authorized"</a>. The naming in the codebase is a bit confusing; it would be more appropriate to say "authenticated" in this case, as authorization is via SSO RBAC / SA matching / k8s API server. In this same section of the codebase, the <code>client</code> tokens are not authenticated, they are only validated. Authentication and authorization is done simultaneously for <code>client</code> tokens via the k8s API server.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/argoproj/argo-workflows/security/advisories/GHSA-h36c-m3rf-34h9">https://github.com/argoproj/argo-workflows/security/advisories/GHSA-h36c-m3rf-34h9</a></li>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2024-53862">https://nvd.nist.gov/vuln/detail/CVE-2024-53862</a></li>
<li><a href="https://github.com/argoproj/argo-workflows/pull/13021/files#diff-a5b255abaceddc9cc20bf6da6ae92c3a5d3605d94366af503ed754c079a1171aL668-R715">https://github.com/argoproj/argo-workflows/pull/13021/files#diff-a5b255abaceddc9cc20bf6da6ae92c3a5d3605d94366af503ed754c079a1171aL668-R715</a></li>
<li><a href="https://github.com/advisories/GHSA-h36c-m3rf-34h9">https://github.com/advisories/GHSA-h36c-m3rf-34h9</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-h36c-m3rf-34h9</uri>
        </author>
        <category label="severity" term="MODERATE"/>
        <published>2024-12-02T22:17:55.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[github.com/argoproj/argo-workflows/v3] Access to Archived Argo Workflows with Fake Token in `client` mode]]></title>
        <id>https://github.com/advisories/GHSA-h36c-m3rf-34h9</id>
        <link href="https://github.com/advisories/GHSA-h36c-m3rf-34h9"/>
        <updated>2024-12-02T22:17:56.000Z</updated>
        <content type="html"><![CDATA[<h3 id="summary">Summary</h3>
<p>When using <code>--auth-mode=client</code>, Archived Workflows can be retrieved with a fake or spoofed token via the GET Workflow endpoint: <code>/api/v1/workflows/{namespace}/{name}</code></p>
<p>When using <code>--auth-mode=sso</code>,  all Archived Workflows can be retrieved with a valid token via the GET Workflow endpoint: <code>/api/v1/workflows/{namespace}/{name}</code></p>
<h3 id="details">Details</h3>
<p>No authentication is performed by the Server itself on <code>client</code> tokens[^1]. Authentication &amp; authorization is instead delegated to the k8s API server.
However, the <a href="https://github.com/argoproj/argo-workflows/blob/52cca7e079a4f6d76db303ac550b1876e51b3865/server/workflowarchive/archived_workflow_server.go">Workflow Archive</a> does not interact with k8s, and so any token that <a href="https://github.com/argoproj/argo-workflows/blob/52cca7e079a4f6d76db303ac550b1876e51b3865/server/auth/mode.go#L37"><em>looks</em></a> <a href="https://github.com/argoproj/argo-workflows/blob/52cca7e079a4f6d76db303ac550b1876e51b3865/server/auth/gatekeeper.go#L185">valid</a> will be considered authenticated, even if it is not a k8s token or even if the token has no RBAC for Argo. To handle the lack of pass-through k8s authN/authZ, the Workflow Archive specifically does <a href="https://github.com/argoproj/argo-workflows/blob/52cca7e079a4f6d76db303ac550b1876e51b3865/server/workflowarchive/archived_workflow_server.go#L50">the equivalent of a <code>kubectl auth can-i</code></a> check for respective methods.</p>
<p>In #12736 / v3.5.7 and #13021 / v3.5.8, the auth check was accidentally removed on the GET Workflow endpoint's fallback to archived workflows on <a href="https://github.com/argoproj/argo-workflows/pull/13021/files#diff-a5b255abaceddc9cc20bf6da6ae92c3a5d3605d94366af503ed754c079a1171aL668-R715">these lines</a>, allowing archived workflows to be retrieved with a fake token.</p>
<h3 id="poc">PoC</h3>
<h4 id="configuration">Configuration</h4>
<p>Controller <code>ConfigMap</code>:</p>
<pre><code class="language-yaml">  config: |
    persistence:
      archive: true
      postgresql:
        database: argoworkflows
        host: db-host
        passwordSecret:
          key: postgresPassword
          name: argo-wf-postgres-credentials
        port: 5432
        tableName: argo_workflows
        userNameSecret:
          key: username
          name: argo-wf-postgres-credentials
</code></pre>
<p>Server: <code>--auth-mode=client</code></p>
<h4 id="reproduction">Reproduction</h4>
<p>Visit a completed, archived workflow URL with an invalid authorization token, this results in the workflow being displayed.</p>
<p>For example, directly query the API and retrieve the workflow data (where <code>Bearer thisisatest</code> is not a valid token):</p>
<pre><code class="language-sh">curl -H 'Authorization: Bearer thisisatest' -v http://localhost:8000/api/v1/workflows/argo/hello-world-7tv5g
</code></pre>
<details><summary>Results in a returned workflow:</summary>

<pre><code>* Host localhost:8000 was resolved.
* IPv6: ::1
* IPv4: 127.0.0.1
*   Trying [::1]:8000...
* Connected to localhost (::1) port 8000
&gt; GET /api/v1/workflows/argo/hello-world-7tv5g HTTP/1.1
&gt; Host: localhost:8000
&gt; User-Agent: curl/8.7.1
&gt; Accept: */*
&gt; Authorization: Bearer thisisatest
&gt;
* Request completely sent off
&lt; HTTP/1.1 200 OK
&lt; Content-Type: application/json
&lt; Grpc-Metadata-Content-Type: application/grpc
&lt; X-Ratelimit-Limit: 1000
&lt; X-Ratelimit-Remaining: 999
&lt; X-Ratelimit-Reset: Mon, 19 Aug 2024 20:44:27 UTC
&lt; Date: Mon, 19 Aug 2024 20:44:26 GMT
&lt; Transfer-Encoding: chunked
&lt;
* Connection #0 to host localhost left intact
{
    "metadata": {
        "name": "hello-world-7tv5g",
        "generateName": "hello-world-",
        "namespace": "argo",
        "uid": "e5868ab1-f820-4a9e-9407-162346a4ccb4",
        "resourceVersion": "9982",
        "generation": 3,
        "creationTimestamp": "2024-08-13T23:59:20Z",
        "labels": {
            "workflows.argoproj.io/archive-strategy": "false",
            "workflows.argoproj.io/completed": "true",
            "workflows.argoproj.io/phase": "Succeeded",
            "workflows.argoproj.io/workflow-archiving-status": "Persisted"
        },
        "annotations": {
            "workflows.argoproj.io/description": "This is a simple hello world example.\n",
            "workflows.argoproj.io/pod-name-format": "v2"
        },
        "managedFields": [
            {
                "manager": "argo",
                "operation": "Update",
                "apiVersion": "argoproj.io/v1alpha1",
                "time": "2024-08-13T23:59:20Z",
                "fieldsType": "FieldsV1",
                "fieldsV1": {
                    "f:metadata": {
                        "f:annotations": {
                            ".": {},
                            "f:workflows.argoproj.io/description": {}
                        },
                        "f:generateName": {},
                        "f:labels": {
                            ".": {},
                            "f:workflows.argoproj.io/archive-strategy": {}
                        }
                    },
                    "f:spec": {}
                }
            },
            {
                "manager": "workflow-controller",
                "operation": "Update",
                "apiVersion": "argoproj.io/v1alpha1",
                "time": "2024-08-13T23:59:30Z",
                "fieldsType": "FieldsV1",
                "fieldsV1": {
                    "f:metadata": {
                        "f:annotations": {
                            "f:workflows.argoproj.io/pod-name-format": {}
                        },
                        "f:labels": {
                            "f:workflows.argoproj.io/completed": {},
                            "f:workflows.argoproj.io/phase": {},
                            "f:workflows.argoproj.io/workflow-archiving-status": {}
                        }
                    },
                    "f:status": {}
                }
            }
        ]
    },
    "spec": {
        "templates": [
            {
                "name": "hello-world",
                "inputs": {},
                "outputs": {},
                "metadata": {},
                "container": {
                    "name": "",
                    "image": "busybox",
                    "command": [
                        "echo"
                    ],
                    "args": [
                        "hello world"
                    ],
                    "resources": {}
                }
            }
        ],
        "entrypoint": "hello-world",
        "arguments": {},
        "serviceAccountName": "argo-workflow"
    },
    "status": {
        "phase": "Succeeded",
        "startedAt": "2024-08-13T23:59:20Z",
        "finishedAt": "2024-08-13T23:59:30Z",
        "progress": "1/1",
        "nodes": {
            "hello-world-7tv5g": {
                "id": "hello-world-7tv5g",
                "name": "hello-world-7tv5g",
                "displayName": "hello-world-7tv5g",
                "type": "Pod",
                "templateName": "hello-world",
                "templateScope": "local/hello-world-7tv5g",
                "phase": "Succeeded",
                "startedAt": "2024-08-13T23:59:20Z",
                "finishedAt": "2024-08-13T23:59:24Z",
                "progress": "1/1",
                "resourcesDuration": {
                    "cpu": 0,
                    "memory": 3
                },
                "outputs": {
                    "exitCode": "0"
                },
                "hostNodeName": "kind-control-plane"
            }
        },
        "conditions": [
            {
                "type": "PodRunning",
                "status": "False"
            },
            {
                "type": "Completed",
                "status": "True"
            }
        ],
        "resourcesDuration": {
            "cpu": 0,
            "memory": 3
        },
        "artifactRepositoryRef": {
            "default": true,
            "artifactRepository": {}
        },
        "artifactGCStatus": {
            "notSpecified": true
        },
        "taskResultsCompletionStatus": {
            "hello-world-7tv5g": true
        }
    }
}%
</code></pre>
</details>


<h3 id="impact">Impact</h3>
<p>Users of the Server with <code>--auth-mode=client</code> and with <code>persistence.archive: true</code> are vulnerable to having Archived Workflows retrieved with a fake or spoofed token.</p>
<p>Users of the Server with <code>--auth-mode=sso</code> and with <code>persistence.archive: true</code> are vulnerable to users being able to access workflows they could not access before archiving.</p>
<p>[^1]: <code>sso</code> tokens, on the other hand, are <a href="https://github.com/argoproj/argo-workflows/blob/52cca7e079a4f6d76db303ac550b1876e51b3865/server/auth/gatekeeper.go#L207">immediately "authorized"</a>. The naming in the codebase is a bit confusing; it would be more appropriate to say "authenticated" in this case, as authorization is via SSO RBAC / SA matching / k8s API server. In this same section of the codebase, the <code>client</code> tokens are not authenticated, they are only validated. Authentication and authorization is done simultaneously for <code>client</code> tokens via the k8s API server.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/argoproj/argo-workflows/security/advisories/GHSA-h36c-m3rf-34h9">https://github.com/argoproj/argo-workflows/security/advisories/GHSA-h36c-m3rf-34h9</a></li>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2024-53862">https://nvd.nist.gov/vuln/detail/CVE-2024-53862</a></li>
<li><a href="https://github.com/argoproj/argo-workflows/pull/13021/files#diff-a5b255abaceddc9cc20bf6da6ae92c3a5d3605d94366af503ed754c079a1171aL668-R715">https://github.com/argoproj/argo-workflows/pull/13021/files#diff-a5b255abaceddc9cc20bf6da6ae92c3a5d3605d94366af503ed754c079a1171aL668-R715</a></li>
<li><a href="https://github.com/advisories/GHSA-h36c-m3rf-34h9">https://github.com/advisories/GHSA-h36c-m3rf-34h9</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-h36c-m3rf-34h9</uri>
        </author>
        <category label="severity" term="MODERATE"/>
        <published>2024-12-02T22:17:55.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[github.com/bunkerity/bunkerweb] BunkerWeb has Open Redirect Vulnerability in Loading Page]]></title>
        <id>https://github.com/advisories/GHSA-q9rr-h3hx-m87g</id>
        <link href="https://github.com/advisories/GHSA-q9rr-h3hx-m87g"/>
        <updated>2024-12-02T22:17:20.000Z</updated>
        <content type="html"><![CDATA[<h3 id="summary">Summary:</h3>
<p>A open redirect vulnerability exists in the loading endpoint, allowing attackers to redirect authenticated users to arbitrary external URLs via the "next" parameter.</p>
<h3 id="details">Details:</h3>
<p>The loading endpoint accepts and uses an unvalidated "next" parameter for redirects:</p>
<h3 id="poc">PoC:</h3>
<p>Visit: <code>/loading?next=https://google.com</code> while authenticated. The page will redirect to google.com.</p>
<h3 id="impact">Impact:</h3>
<p>This vulnerability could be used in phishing attacks by redirecting users from a legitimate application URL to malicious sites.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/bunkerity/bunkerweb/security/advisories/GHSA-q9rr-h3hx-m87g">https://github.com/bunkerity/bunkerweb/security/advisories/GHSA-q9rr-h3hx-m87g</a></li>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2024-53264">https://nvd.nist.gov/vuln/detail/CVE-2024-53264</a></li>
<li><a href="https://github.com/advisories/GHSA-q9rr-h3hx-m87g">https://github.com/advisories/GHSA-q9rr-h3hx-m87g</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-q9rr-h3hx-m87g</uri>
        </author>
        <category label="severity" term="MODERATE"/>
        <published>2024-12-02T22:17:18.000Z</published>
    </entry>
</feed>