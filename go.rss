<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
    <id>https://azu.github.io/github-advisory-database-rss/go.rss</id>
    <title>Security Advisory for Go modules</title>
    <updated>2024-12-03T03:15:52.351Z</updated>
    <generator>github-advisory-database-rss</generator>
    <link rel="alternate" href="https://github.com/advisories?query=type%3Areviewed+ecosystem%3Ago"/>
    <subtitle>Security Advisory for Go modules on GitHub</subtitle>
    <rights>github-advisory-database-rss</rights>
    <category term="CRITICAL"/>
    <category term="HIGH"/>
    <category term="MODERATE"/>
    <category term="LOW"/>
    <entry>
        <title type="html"><![CDATA[[github.com/argoproj/argo-workflows/v3] Access to Archived Argo Workflows with Fake Token in `client` mode]]></title>
        <id>https://github.com/advisories/GHSA-h36c-m3rf-34h9</id>
        <link href="https://github.com/advisories/GHSA-h36c-m3rf-34h9"/>
        <updated>2024-12-02T22:17:56.000Z</updated>
        <content type="html"><![CDATA[<h3 id="summary">Summary</h3>
<p>When using <code>--auth-mode=client</code>, Archived Workflows can be retrieved with a fake or spoofed token via the GET Workflow endpoint: <code>/api/v1/workflows/{namespace}/{name}</code></p>
<p>When using <code>--auth-mode=sso</code>,  all Archived Workflows can be retrieved with a valid token via the GET Workflow endpoint: <code>/api/v1/workflows/{namespace}/{name}</code></p>
<h3 id="details">Details</h3>
<p>No authentication is performed by the Server itself on <code>client</code> tokens[^1]. Authentication &amp; authorization is instead delegated to the k8s API server.
However, the <a href="https://github.com/argoproj/argo-workflows/blob/52cca7e079a4f6d76db303ac550b1876e51b3865/server/workflowarchive/archived_workflow_server.go">Workflow Archive</a> does not interact with k8s, and so any token that <a href="https://github.com/argoproj/argo-workflows/blob/52cca7e079a4f6d76db303ac550b1876e51b3865/server/auth/mode.go#L37"><em>looks</em></a> <a href="https://github.com/argoproj/argo-workflows/blob/52cca7e079a4f6d76db303ac550b1876e51b3865/server/auth/gatekeeper.go#L185">valid</a> will be considered authenticated, even if it is not a k8s token or even if the token has no RBAC for Argo. To handle the lack of pass-through k8s authN/authZ, the Workflow Archive specifically does <a href="https://github.com/argoproj/argo-workflows/blob/52cca7e079a4f6d76db303ac550b1876e51b3865/server/workflowarchive/archived_workflow_server.go#L50">the equivalent of a <code>kubectl auth can-i</code></a> check for respective methods.</p>
<p>In #12736 / v3.5.7 and #13021 / v3.5.8, the auth check was accidentally removed on the GET Workflow endpoint's fallback to archived workflows on <a href="https://github.com/argoproj/argo-workflows/pull/13021/files#diff-a5b255abaceddc9cc20bf6da6ae92c3a5d3605d94366af503ed754c079a1171aL668-R715">these lines</a>, allowing archived workflows to be retrieved with a fake token.</p>
<h3 id="poc">PoC</h3>
<h4 id="configuration">Configuration</h4>
<p>Controller <code>ConfigMap</code>:</p>
<pre><code class="language-yaml">  config: |
    persistence:
      archive: true
      postgresql:
        database: argoworkflows
        host: db-host
        passwordSecret:
          key: postgresPassword
          name: argo-wf-postgres-credentials
        port: 5432
        tableName: argo_workflows
        userNameSecret:
          key: username
          name: argo-wf-postgres-credentials
</code></pre>
<p>Server: <code>--auth-mode=client</code></p>
<h4 id="reproduction">Reproduction</h4>
<p>Visit a completed, archived workflow URL with an invalid authorization token, this results in the workflow being displayed.</p>
<p>For example, directly query the API and retrieve the workflow data (where <code>Bearer thisisatest</code> is not a valid token):</p>
<pre><code class="language-sh">curl -H 'Authorization: Bearer thisisatest' -v http://localhost:8000/api/v1/workflows/argo/hello-world-7tv5g
</code></pre>
<details><summary>Results in a returned workflow:</summary>

<pre><code>* Host localhost:8000 was resolved.
* IPv6: ::1
* IPv4: 127.0.0.1
*   Trying [::1]:8000...
* Connected to localhost (::1) port 8000
&gt; GET /api/v1/workflows/argo/hello-world-7tv5g HTTP/1.1
&gt; Host: localhost:8000
&gt; User-Agent: curl/8.7.1
&gt; Accept: */*
&gt; Authorization: Bearer thisisatest
&gt;
* Request completely sent off
&lt; HTTP/1.1 200 OK
&lt; Content-Type: application/json
&lt; Grpc-Metadata-Content-Type: application/grpc
&lt; X-Ratelimit-Limit: 1000
&lt; X-Ratelimit-Remaining: 999
&lt; X-Ratelimit-Reset: Mon, 19 Aug 2024 20:44:27 UTC
&lt; Date: Mon, 19 Aug 2024 20:44:26 GMT
&lt; Transfer-Encoding: chunked
&lt;
* Connection #0 to host localhost left intact
{
    "metadata": {
        "name": "hello-world-7tv5g",
        "generateName": "hello-world-",
        "namespace": "argo",
        "uid": "e5868ab1-f820-4a9e-9407-162346a4ccb4",
        "resourceVersion": "9982",
        "generation": 3,
        "creationTimestamp": "2024-08-13T23:59:20Z",
        "labels": {
            "workflows.argoproj.io/archive-strategy": "false",
            "workflows.argoproj.io/completed": "true",
            "workflows.argoproj.io/phase": "Succeeded",
            "workflows.argoproj.io/workflow-archiving-status": "Persisted"
        },
        "annotations": {
            "workflows.argoproj.io/description": "This is a simple hello world example.\n",
            "workflows.argoproj.io/pod-name-format": "v2"
        },
        "managedFields": [
            {
                "manager": "argo",
                "operation": "Update",
                "apiVersion": "argoproj.io/v1alpha1",
                "time": "2024-08-13T23:59:20Z",
                "fieldsType": "FieldsV1",
                "fieldsV1": {
                    "f:metadata": {
                        "f:annotations": {
                            ".": {},
                            "f:workflows.argoproj.io/description": {}
                        },
                        "f:generateName": {},
                        "f:labels": {
                            ".": {},
                            "f:workflows.argoproj.io/archive-strategy": {}
                        }
                    },
                    "f:spec": {}
                }
            },
            {
                "manager": "workflow-controller",
                "operation": "Update",
                "apiVersion": "argoproj.io/v1alpha1",
                "time": "2024-08-13T23:59:30Z",
                "fieldsType": "FieldsV1",
                "fieldsV1": {
                    "f:metadata": {
                        "f:annotations": {
                            "f:workflows.argoproj.io/pod-name-format": {}
                        },
                        "f:labels": {
                            "f:workflows.argoproj.io/completed": {},
                            "f:workflows.argoproj.io/phase": {},
                            "f:workflows.argoproj.io/workflow-archiving-status": {}
                        }
                    },
                    "f:status": {}
                }
            }
        ]
    },
    "spec": {
        "templates": [
            {
                "name": "hello-world",
                "inputs": {},
                "outputs": {},
                "metadata": {},
                "container": {
                    "name": "",
                    "image": "busybox",
                    "command": [
                        "echo"
                    ],
                    "args": [
                        "hello world"
                    ],
                    "resources": {}
                }
            }
        ],
        "entrypoint": "hello-world",
        "arguments": {},
        "serviceAccountName": "argo-workflow"
    },
    "status": {
        "phase": "Succeeded",
        "startedAt": "2024-08-13T23:59:20Z",
        "finishedAt": "2024-08-13T23:59:30Z",
        "progress": "1/1",
        "nodes": {
            "hello-world-7tv5g": {
                "id": "hello-world-7tv5g",
                "name": "hello-world-7tv5g",
                "displayName": "hello-world-7tv5g",
                "type": "Pod",
                "templateName": "hello-world",
                "templateScope": "local/hello-world-7tv5g",
                "phase": "Succeeded",
                "startedAt": "2024-08-13T23:59:20Z",
                "finishedAt": "2024-08-13T23:59:24Z",
                "progress": "1/1",
                "resourcesDuration": {
                    "cpu": 0,
                    "memory": 3
                },
                "outputs": {
                    "exitCode": "0"
                },
                "hostNodeName": "kind-control-plane"
            }
        },
        "conditions": [
            {
                "type": "PodRunning",
                "status": "False"
            },
            {
                "type": "Completed",
                "status": "True"
            }
        ],
        "resourcesDuration": {
            "cpu": 0,
            "memory": 3
        },
        "artifactRepositoryRef": {
            "default": true,
            "artifactRepository": {}
        },
        "artifactGCStatus": {
            "notSpecified": true
        },
        "taskResultsCompletionStatus": {
            "hello-world-7tv5g": true
        }
    }
}%
</code></pre>
</details>


<h3 id="impact">Impact</h3>
<p>Users of the Server with <code>--auth-mode=client</code> and with <code>persistence.archive: true</code> are vulnerable to having Archived Workflows retrieved with a fake or spoofed token.</p>
<p>Users of the Server with <code>--auth-mode=sso</code> and with <code>persistence.archive: true</code> are vulnerable to users being able to access workflows they could not access before archiving.</p>
<p>[^1]: <code>sso</code> tokens, on the other hand, are <a href="https://github.com/argoproj/argo-workflows/blob/52cca7e079a4f6d76db303ac550b1876e51b3865/server/auth/gatekeeper.go#L207">immediately "authorized"</a>. The naming in the codebase is a bit confusing; it would be more appropriate to say "authenticated" in this case, as authorization is via SSO RBAC / SA matching / k8s API server. In this same section of the codebase, the <code>client</code> tokens are not authenticated, they are only validated. Authentication and authorization is done simultaneously for <code>client</code> tokens via the k8s API server.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/argoproj/argo-workflows/security/advisories/GHSA-h36c-m3rf-34h9">https://github.com/argoproj/argo-workflows/security/advisories/GHSA-h36c-m3rf-34h9</a></li>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2024-53862">https://nvd.nist.gov/vuln/detail/CVE-2024-53862</a></li>
<li><a href="https://github.com/argoproj/argo-workflows/pull/13021/files#diff-a5b255abaceddc9cc20bf6da6ae92c3a5d3605d94366af503ed754c079a1171aL668-R715">https://github.com/argoproj/argo-workflows/pull/13021/files#diff-a5b255abaceddc9cc20bf6da6ae92c3a5d3605d94366af503ed754c079a1171aL668-R715</a></li>
<li><a href="https://github.com/advisories/GHSA-h36c-m3rf-34h9">https://github.com/advisories/GHSA-h36c-m3rf-34h9</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-h36c-m3rf-34h9</uri>
        </author>
        <category label="severity" term="MODERATE"/>
        <published>2024-12-02T22:17:55.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[github.com/argoproj/argo-workflows/v3] Access to Archived Argo Workflows with Fake Token in `client` mode]]></title>
        <id>https://github.com/advisories/GHSA-h36c-m3rf-34h9</id>
        <link href="https://github.com/advisories/GHSA-h36c-m3rf-34h9"/>
        <updated>2024-12-02T22:17:56.000Z</updated>
        <content type="html"><![CDATA[<h3 id="summary">Summary</h3>
<p>When using <code>--auth-mode=client</code>, Archived Workflows can be retrieved with a fake or spoofed token via the GET Workflow endpoint: <code>/api/v1/workflows/{namespace}/{name}</code></p>
<p>When using <code>--auth-mode=sso</code>,  all Archived Workflows can be retrieved with a valid token via the GET Workflow endpoint: <code>/api/v1/workflows/{namespace}/{name}</code></p>
<h3 id="details">Details</h3>
<p>No authentication is performed by the Server itself on <code>client</code> tokens[^1]. Authentication &amp; authorization is instead delegated to the k8s API server.
However, the <a href="https://github.com/argoproj/argo-workflows/blob/52cca7e079a4f6d76db303ac550b1876e51b3865/server/workflowarchive/archived_workflow_server.go">Workflow Archive</a> does not interact with k8s, and so any token that <a href="https://github.com/argoproj/argo-workflows/blob/52cca7e079a4f6d76db303ac550b1876e51b3865/server/auth/mode.go#L37"><em>looks</em></a> <a href="https://github.com/argoproj/argo-workflows/blob/52cca7e079a4f6d76db303ac550b1876e51b3865/server/auth/gatekeeper.go#L185">valid</a> will be considered authenticated, even if it is not a k8s token or even if the token has no RBAC for Argo. To handle the lack of pass-through k8s authN/authZ, the Workflow Archive specifically does <a href="https://github.com/argoproj/argo-workflows/blob/52cca7e079a4f6d76db303ac550b1876e51b3865/server/workflowarchive/archived_workflow_server.go#L50">the equivalent of a <code>kubectl auth can-i</code></a> check for respective methods.</p>
<p>In #12736 / v3.5.7 and #13021 / v3.5.8, the auth check was accidentally removed on the GET Workflow endpoint's fallback to archived workflows on <a href="https://github.com/argoproj/argo-workflows/pull/13021/files#diff-a5b255abaceddc9cc20bf6da6ae92c3a5d3605d94366af503ed754c079a1171aL668-R715">these lines</a>, allowing archived workflows to be retrieved with a fake token.</p>
<h3 id="poc">PoC</h3>
<h4 id="configuration">Configuration</h4>
<p>Controller <code>ConfigMap</code>:</p>
<pre><code class="language-yaml">  config: |
    persistence:
      archive: true
      postgresql:
        database: argoworkflows
        host: db-host
        passwordSecret:
          key: postgresPassword
          name: argo-wf-postgres-credentials
        port: 5432
        tableName: argo_workflows
        userNameSecret:
          key: username
          name: argo-wf-postgres-credentials
</code></pre>
<p>Server: <code>--auth-mode=client</code></p>
<h4 id="reproduction">Reproduction</h4>
<p>Visit a completed, archived workflow URL with an invalid authorization token, this results in the workflow being displayed.</p>
<p>For example, directly query the API and retrieve the workflow data (where <code>Bearer thisisatest</code> is not a valid token):</p>
<pre><code class="language-sh">curl -H 'Authorization: Bearer thisisatest' -v http://localhost:8000/api/v1/workflows/argo/hello-world-7tv5g
</code></pre>
<details><summary>Results in a returned workflow:</summary>

<pre><code>* Host localhost:8000 was resolved.
* IPv6: ::1
* IPv4: 127.0.0.1
*   Trying [::1]:8000...
* Connected to localhost (::1) port 8000
&gt; GET /api/v1/workflows/argo/hello-world-7tv5g HTTP/1.1
&gt; Host: localhost:8000
&gt; User-Agent: curl/8.7.1
&gt; Accept: */*
&gt; Authorization: Bearer thisisatest
&gt;
* Request completely sent off
&lt; HTTP/1.1 200 OK
&lt; Content-Type: application/json
&lt; Grpc-Metadata-Content-Type: application/grpc
&lt; X-Ratelimit-Limit: 1000
&lt; X-Ratelimit-Remaining: 999
&lt; X-Ratelimit-Reset: Mon, 19 Aug 2024 20:44:27 UTC
&lt; Date: Mon, 19 Aug 2024 20:44:26 GMT
&lt; Transfer-Encoding: chunked
&lt;
* Connection #0 to host localhost left intact
{
    "metadata": {
        "name": "hello-world-7tv5g",
        "generateName": "hello-world-",
        "namespace": "argo",
        "uid": "e5868ab1-f820-4a9e-9407-162346a4ccb4",
        "resourceVersion": "9982",
        "generation": 3,
        "creationTimestamp": "2024-08-13T23:59:20Z",
        "labels": {
            "workflows.argoproj.io/archive-strategy": "false",
            "workflows.argoproj.io/completed": "true",
            "workflows.argoproj.io/phase": "Succeeded",
            "workflows.argoproj.io/workflow-archiving-status": "Persisted"
        },
        "annotations": {
            "workflows.argoproj.io/description": "This is a simple hello world example.\n",
            "workflows.argoproj.io/pod-name-format": "v2"
        },
        "managedFields": [
            {
                "manager": "argo",
                "operation": "Update",
                "apiVersion": "argoproj.io/v1alpha1",
                "time": "2024-08-13T23:59:20Z",
                "fieldsType": "FieldsV1",
                "fieldsV1": {
                    "f:metadata": {
                        "f:annotations": {
                            ".": {},
                            "f:workflows.argoproj.io/description": {}
                        },
                        "f:generateName": {},
                        "f:labels": {
                            ".": {},
                            "f:workflows.argoproj.io/archive-strategy": {}
                        }
                    },
                    "f:spec": {}
                }
            },
            {
                "manager": "workflow-controller",
                "operation": "Update",
                "apiVersion": "argoproj.io/v1alpha1",
                "time": "2024-08-13T23:59:30Z",
                "fieldsType": "FieldsV1",
                "fieldsV1": {
                    "f:metadata": {
                        "f:annotations": {
                            "f:workflows.argoproj.io/pod-name-format": {}
                        },
                        "f:labels": {
                            "f:workflows.argoproj.io/completed": {},
                            "f:workflows.argoproj.io/phase": {},
                            "f:workflows.argoproj.io/workflow-archiving-status": {}
                        }
                    },
                    "f:status": {}
                }
            }
        ]
    },
    "spec": {
        "templates": [
            {
                "name": "hello-world",
                "inputs": {},
                "outputs": {},
                "metadata": {},
                "container": {
                    "name": "",
                    "image": "busybox",
                    "command": [
                        "echo"
                    ],
                    "args": [
                        "hello world"
                    ],
                    "resources": {}
                }
            }
        ],
        "entrypoint": "hello-world",
        "arguments": {},
        "serviceAccountName": "argo-workflow"
    },
    "status": {
        "phase": "Succeeded",
        "startedAt": "2024-08-13T23:59:20Z",
        "finishedAt": "2024-08-13T23:59:30Z",
        "progress": "1/1",
        "nodes": {
            "hello-world-7tv5g": {
                "id": "hello-world-7tv5g",
                "name": "hello-world-7tv5g",
                "displayName": "hello-world-7tv5g",
                "type": "Pod",
                "templateName": "hello-world",
                "templateScope": "local/hello-world-7tv5g",
                "phase": "Succeeded",
                "startedAt": "2024-08-13T23:59:20Z",
                "finishedAt": "2024-08-13T23:59:24Z",
                "progress": "1/1",
                "resourcesDuration": {
                    "cpu": 0,
                    "memory": 3
                },
                "outputs": {
                    "exitCode": "0"
                },
                "hostNodeName": "kind-control-plane"
            }
        },
        "conditions": [
            {
                "type": "PodRunning",
                "status": "False"
            },
            {
                "type": "Completed",
                "status": "True"
            }
        ],
        "resourcesDuration": {
            "cpu": 0,
            "memory": 3
        },
        "artifactRepositoryRef": {
            "default": true,
            "artifactRepository": {}
        },
        "artifactGCStatus": {
            "notSpecified": true
        },
        "taskResultsCompletionStatus": {
            "hello-world-7tv5g": true
        }
    }
}%
</code></pre>
</details>


<h3 id="impact">Impact</h3>
<p>Users of the Server with <code>--auth-mode=client</code> and with <code>persistence.archive: true</code> are vulnerable to having Archived Workflows retrieved with a fake or spoofed token.</p>
<p>Users of the Server with <code>--auth-mode=sso</code> and with <code>persistence.archive: true</code> are vulnerable to users being able to access workflows they could not access before archiving.</p>
<p>[^1]: <code>sso</code> tokens, on the other hand, are <a href="https://github.com/argoproj/argo-workflows/blob/52cca7e079a4f6d76db303ac550b1876e51b3865/server/auth/gatekeeper.go#L207">immediately "authorized"</a>. The naming in the codebase is a bit confusing; it would be more appropriate to say "authenticated" in this case, as authorization is via SSO RBAC / SA matching / k8s API server. In this same section of the codebase, the <code>client</code> tokens are not authenticated, they are only validated. Authentication and authorization is done simultaneously for <code>client</code> tokens via the k8s API server.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/argoproj/argo-workflows/security/advisories/GHSA-h36c-m3rf-34h9">https://github.com/argoproj/argo-workflows/security/advisories/GHSA-h36c-m3rf-34h9</a></li>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2024-53862">https://nvd.nist.gov/vuln/detail/CVE-2024-53862</a></li>
<li><a href="https://github.com/argoproj/argo-workflows/pull/13021/files#diff-a5b255abaceddc9cc20bf6da6ae92c3a5d3605d94366af503ed754c079a1171aL668-R715">https://github.com/argoproj/argo-workflows/pull/13021/files#diff-a5b255abaceddc9cc20bf6da6ae92c3a5d3605d94366af503ed754c079a1171aL668-R715</a></li>
<li><a href="https://github.com/advisories/GHSA-h36c-m3rf-34h9">https://github.com/advisories/GHSA-h36c-m3rf-34h9</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-h36c-m3rf-34h9</uri>
        </author>
        <category label="severity" term="MODERATE"/>
        <published>2024-12-02T22:17:55.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[github.com/bunkerity/bunkerweb] BunkerWeb has Open Redirect Vulnerability in Loading Page]]></title>
        <id>https://github.com/advisories/GHSA-q9rr-h3hx-m87g</id>
        <link href="https://github.com/advisories/GHSA-q9rr-h3hx-m87g"/>
        <updated>2024-12-02T22:17:20.000Z</updated>
        <content type="html"><![CDATA[<h3 id="summary">Summary:</h3>
<p>A open redirect vulnerability exists in the loading endpoint, allowing attackers to redirect authenticated users to arbitrary external URLs via the "next" parameter.</p>
<h3 id="details">Details:</h3>
<p>The loading endpoint accepts and uses an unvalidated "next" parameter for redirects:</p>
<h3 id="poc">PoC:</h3>
<p>Visit: <code>/loading?next=https://google.com</code> while authenticated. The page will redirect to google.com.</p>
<h3 id="impact">Impact:</h3>
<p>This vulnerability could be used in phishing attacks by redirecting users from a legitimate application URL to malicious sites.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/bunkerity/bunkerweb/security/advisories/GHSA-q9rr-h3hx-m87g">https://github.com/bunkerity/bunkerweb/security/advisories/GHSA-q9rr-h3hx-m87g</a></li>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2024-53264">https://nvd.nist.gov/vuln/detail/CVE-2024-53264</a></li>
<li><a href="https://github.com/advisories/GHSA-q9rr-h3hx-m87g">https://github.com/advisories/GHSA-q9rr-h3hx-m87g</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-q9rr-h3hx-m87g</uri>
        </author>
        <category label="severity" term="MODERATE"/>
        <published>2024-12-02T22:17:18.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[github.com/moby/moby] Moby Race Condition vulnerability]]></title>
        <id>https://github.com/advisories/GHSA-gh5c-3h97-2f3q</id>
        <link href="https://github.com/advisories/GHSA-gh5c-3h97-2f3q"/>
        <updated>2024-12-02T21:38:27.000Z</updated>
        <content type="html"><![CDATA[<p>moby v25.0.3 has a Race Condition vulnerability in the streamformatter package which can be used to trigger multiple concurrent write operations resulting in data corruption or application crashes.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2024-36623">https://nvd.nist.gov/vuln/detail/CVE-2024-36623</a></li>
<li><a href="https://github.com/moby/moby/commit/5689dabfb357b673abdb4391eef426f297d7d1bb">https://github.com/moby/moby/commit/5689dabfb357b673abdb4391eef426f297d7d1bb</a></li>
<li><a href="https://gist.github.com/1047524396/c192c0159a19bf58a4373b696467dc29">https://gist.github.com/1047524396/c192c0159a19bf58a4373b696467dc29</a></li>
<li><a href="https://github.com/moby/moby/blob/v25.0.3/pkg/streamformatter/streamformatter.go#L115">https://github.com/moby/moby/blob/v25.0.3/pkg/streamformatter/streamformatter.go#L115</a></li>
<li><a href="https://github.com/advisories/GHSA-gh5c-3h97-2f3q">https://github.com/advisories/GHSA-gh5c-3h97-2f3q</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-gh5c-3h97-2f3q</uri>
        </author>
        <category label="severity" term="HIGH"/>
        <published>2024-11-29T18:34:03.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[github.com/moby/moby] Moby Race Condition vulnerability]]></title>
        <id>https://github.com/advisories/GHSA-2mj3-vfvx-fc43</id>
        <link href="https://github.com/advisories/GHSA-2mj3-vfvx-fc43"/>
        <updated>2024-12-02T21:38:02.000Z</updated>
        <content type="html"><![CDATA[<p>moby v25.0.5 is affected by a Race Condition in builder/builder-next/adapters/snapshot/layer.go. The vulnerability could be used to trigger concurrent builds that call the EnsureLayer function resulting in resource leaks/exhaustion.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2024-36621">https://nvd.nist.gov/vuln/detail/CVE-2024-36621</a></li>
<li><a href="https://github.com/moby/moby/commit/37545cc644344dcb576cba67eb7b6f51a463d31e">https://github.com/moby/moby/commit/37545cc644344dcb576cba67eb7b6f51a463d31e</a></li>
<li><a href="https://gist.github.com/1047524396/5d44459edab5fafcdf86b43909b81135">https://gist.github.com/1047524396/5d44459edab5fafcdf86b43909b81135</a></li>
<li><a href="https://github.com/moby/moby/blob/v25.0.5/builder/builder-next/adapters/snapshot/layer.go#L24">https://github.com/moby/moby/blob/v25.0.5/builder/builder-next/adapters/snapshot/layer.go#L24</a></li>
<li><a href="https://github.com/advisories/GHSA-2mj3-vfvx-fc43">https://github.com/advisories/GHSA-2mj3-vfvx-fc43</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-2mj3-vfvx-fc43</uri>
        </author>
        <category label="severity" term="HIGH"/>
        <published>2024-11-29T18:34:03.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[sftpgo] SFTPGo allows administrators to restrict command execution from the EventManager]]></title>
        <id>https://github.com/advisories/GHSA-49cc-xrjf-9qf7</id>
        <link href="https://github.com/advisories/GHSA-49cc-xrjf-9qf7"/>
        <updated>2024-12-02T18:04:01.000Z</updated>
        <content type="html"><![CDATA[<h3 id="impact">Impact</h3>
<p>One powerful feature of SFTPGo is the ability to have the EventManager execute scripts or run applications in response to certain events.
This feature is very common in all software similar to SFTPGo and is generally unrestricted. </p>
<p>However, any SFTPGo administrator with permission to run a script has access to the underlying OS/container with the same permissions as the user running SFTPGo, so they can access the database and server configurations.</p>
<p>This is unexpected for some SFTPGo administrators who think that there is a clear distinction between accessing the system shell and accessing the SFTPGo WebAdmin UI.</p>
<h3 id="patches">Patches</h3>
<p>To avoid this confusion, running system commands is now disabled by default, and an allow list has been added so that system administrators configuring SFTPGo must explicitly define which commands are allowed to be configured from the WebAdmin UI.</p>
<p><a href="https://github.com/drakkan/sftpgo/commit/88b1850b5806eee81150873d4e565144b21021fb">https://github.com/drakkan/sftpgo/commit/88b1850b5806eee81150873d4e565144b21021fb</a>
<a href="https://github.com/drakkan/sftpgo/commit/b524da11e9466d05fe03304713ee1c61bb276ec4">https://github.com/drakkan/sftpgo/commit/b524da11e9466d05fe03304713ee1c61bb276ec4</a></p>
<h3 id="workarounds">Workarounds</h3>
<p>Allow EventManager to be used only by SFTPGo administrators who also have shell access.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/drakkan/sftpgo/security/advisories/GHSA-49cc-xrjf-9qf7">https://github.com/drakkan/sftpgo/security/advisories/GHSA-49cc-xrjf-9qf7</a></li>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2024-52309">https://nvd.nist.gov/vuln/detail/CVE-2024-52309</a></li>
<li><a href="https://github.com/drakkan/sftpgo/commit/88b1850b5806eee81150873d4e565144b21021fb">https://github.com/drakkan/sftpgo/commit/88b1850b5806eee81150873d4e565144b21021fb</a></li>
<li><a href="https://github.com/drakkan/sftpgo/commit/b524da11e9466d05fe03304713ee1c61bb276ec4">https://github.com/drakkan/sftpgo/commit/b524da11e9466d05fe03304713ee1c61bb276ec4</a></li>
<li><a href="https://pkg.go.dev/vuln/GO-2024-3283">https://pkg.go.dev/vuln/GO-2024-3283</a></li>
<li><a href="https://github.com/advisories/GHSA-49cc-xrjf-9qf7">https://github.com/advisories/GHSA-49cc-xrjf-9qf7</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-49cc-xrjf-9qf7</uri>
        </author>
        <category label="severity" term="MODERATE"/>
        <published>2024-11-21T23:19:07.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[github.com/quic-go/quic-go] quic-go affected by an ICMP Packet Too Large Injection Attack on Linux]]></title>
        <id>https://github.com/advisories/GHSA-px8v-pp82-rcvr</id>
        <link href="https://github.com/advisories/GHSA-px8v-pp82-rcvr"/>
        <updated>2024-12-02T19:46:13.000Z</updated>
        <content type="html"><![CDATA[<h3 id="impact">Impact</h3>
<p>An off-path attacker can inject an ICMP Packet Too Large packet. Since affected quic-go versions used <code>IP_PMTUDISC_DO</code>, the kernel would then return a "message too large" error on <code>sendmsg</code>, i.e. when quic-go attempts to send a packet that exceeds the MTU claimed in that ICMP packet.</p>
<p>By setting this value to smaller than 1200 bytes (the minimum MTU for QUIC), the attacker can disrupt a QUIC connection. Crucially, this can be done after completion of the handshake, thereby circumventing any TCP fallback that might be implemented on the application layer (for example, many browsers fall back to HTTP over TCP if they're unable to establish a QUIC connection).</p>
<p>As far as I understand, the kernel tracks the MTU per 4-tuple, so the attacker needs to at least know the client's IP and port tuple to mount an attack (assuming that it knows the server's IP and port).</p>
<h3 id="patches">Patches</h3>
<p>The fix is easy: Use <code>IP_PMTUDISC_PROBE</code> instead of <code>IP_PMTUDISC_DO</code>. This socket option only sets the DF bit, but disables the kernel's MTU tracking.</p>
<p><em>Has the problem been patched? What versions should users upgrade to?</em></p>
<p>Fixed in <a href="https://github.com/quic-go/quic-go/pull/4729">https://github.com/quic-go/quic-go/pull/4729</a>
Released in <a href="https://github.com/quic-go/quic-go/releases/tag/v0.48.2">https://github.com/quic-go/quic-go/releases/tag/v0.48.2</a></p>
<h3 id="workarounds">Workarounds</h3>
<p><em>Is there a way for users to fix or remediate the vulnerability without upgrading?</em></p>
<p>Use iptables to drop ICMP Unreachable packets.</p>
<h3 id="references">References</h3>
<p><em>Are there any links users can visit to find out more?</em></p>
<p>This bug was discovered while doing research for my new IETF draft on IP fragmentation: <a href="https://datatracker.ietf.org/doc/draft-seemann-tsvwg-udp-fragmentation/">https://datatracker.ietf.org/doc/draft-seemann-tsvwg-udp-fragmentation/</a></p>
<h3 id="references-1">References</h3>
<ul>
<li><a href="https://github.com/quic-go/quic-go/security/advisories/GHSA-px8v-pp82-rcvr">https://github.com/quic-go/quic-go/security/advisories/GHSA-px8v-pp82-rcvr</a></li>
<li><a href="https://github.com/quic-go/quic-go/pull/4729">https://github.com/quic-go/quic-go/pull/4729</a></li>
<li><a href="https://github.com/quic-go/quic-go/commit/ca31dd355cbe5fc6c5807992d9d1149c66c96a50">https://github.com/quic-go/quic-go/commit/ca31dd355cbe5fc6c5807992d9d1149c66c96a50</a></li>
<li><a href="https://github.com/quic-go/quic-go/releases/tag/v0.48.2">https://github.com/quic-go/quic-go/releases/tag/v0.48.2</a></li>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2024-53259">https://nvd.nist.gov/vuln/detail/CVE-2024-53259</a></li>
<li><a href="https://github.com/advisories/GHSA-px8v-pp82-rcvr">https://github.com/advisories/GHSA-px8v-pp82-rcvr</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-px8v-pp82-rcvr</uri>
        </author>
        <category label="severity" term="MODERATE"/>
        <published>2024-12-02T17:28:14.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[github.com/drakkan/sftpgo/v2] sftpgo vulnerable to brute force takeover of OpenID Connect session cookies]]></title>
        <id>https://github.com/advisories/GHSA-6943-qr24-82vx</id>
        <link href="https://github.com/advisories/GHSA-6943-qr24-82vx"/>
        <updated>2024-12-02T17:16:35.000Z</updated>
        <content type="html"><![CDATA[<h3 id="impact">Impact</h3>
<p>The OpenID Connect implementation, in the affected SFTPGo versions, allows authenticated users to brute force session cookies and thereby gain access to other users' data, since the cookies are generated predictably using the <a href="https://github.com/rs/xid">xid</a> library and are therefore unique but not cryptographically secure.</p>
<h3 id="patches">Patches</h3>
<p>This issue was fixed in version v2.6.4, where cookies are opaque and cryptographically secure strings.</p>
<h3 id="references">References</h3>
<p><a href="https://github.com/drakkan/sftpgo/commit/f30a9a2095bf90c0661b04fe038e3b7efc788bc6">https://github.com/drakkan/sftpgo/commit/f30a9a2095bf90c0661b04fe038e3b7efc788bc6</a></p>
<h3 id="references-1">References</h3>
<ul>
<li><a href="https://github.com/drakkan/sftpgo/security/advisories/GHSA-6943-qr24-82vx">https://github.com/drakkan/sftpgo/security/advisories/GHSA-6943-qr24-82vx</a></li>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2024-52801">https://nvd.nist.gov/vuln/detail/CVE-2024-52801</a></li>
<li><a href="https://github.com/drakkan/sftpgo/commit/f30a9a2095bf90c0661b04fe038e3b7efc788bc6">https://github.com/drakkan/sftpgo/commit/f30a9a2095bf90c0661b04fe038e3b7efc788bc6</a></li>
<li><a href="https://github.com/rs/xid">https://github.com/rs/xid</a></li>
<li><a href="https://github.com/advisories/GHSA-6943-qr24-82vx">https://github.com/advisories/GHSA-6943-qr24-82vx</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-6943-qr24-82vx</uri>
        </author>
        <category label="severity" term="MODERATE"/>
        <published>2024-12-02T17:16:34.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[github.com/traefik/traefik/v3] Traefik's X-Forwarded-Prefix Header still allows for Open Redirect]]></title>
        <id>https://github.com/advisories/GHSA-h924-8g65-j9wg</id>
        <link href="https://github.com/advisories/GHSA-h924-8g65-j9wg"/>
        <updated>2024-12-02T17:12:38.000Z</updated>
        <content type="html"><![CDATA[<h3 id="impact">Impact</h3>
<p>There is a vulnerability in Traefik that allows the client to provide the <code>X-Forwarded-Prefix</code> header from an untrusted source.</p>
<h3 id="patches">Patches</h3>
<ul>
<li><a href="https://github.com/traefik/traefik/releases/tag/v2.11.14">https://github.com/traefik/traefik/releases/tag/v2.11.14</a></li>
<li><a href="https://github.com/traefik/traefik/releases/tag/v3.2.1">https://github.com/traefik/traefik/releases/tag/v3.2.1</a></li>
</ul>
<h3 id="workarounds">Workarounds</h3>
<p>No workaround.</p>
<h3 id="for-more-information">For more information</h3>
<p>If you have any questions or comments about this advisory, please <a href="https://github.com/traefik/traefik/issues">open an issue</a>.</p>
<details>
<summary>Original Description</summary>
### Summary
The previously reported open redirect ([GHSA-6qq8-5wq3-86rp](https://github.com/traefik/traefik/security/advisories/GHSA-6qq8-5wq3-86rp)) is not fixed correctly. The safePrefix function can be tricked to return an absolute URL.



<h3 id="details">Details</h3>
<p>The Traefik API <a href="https://github.com/traefik/traefik/blob/master/pkg/api/dashboard/dashboard.go">dashboard component</a> tries to validate that the value of the header X-Forwarded-Prefix is a site relative path:</p>
<pre><code class="language-go">http.Redirect(resp, req, safePrefix(req)+"/dashboard/", http.StatusFound)
</code></pre>
<pre><code class="language-go">func safePrefix(req *http.Request) string {
    prefix := req.Header.Get("X-Forwarded-Prefix")
    if prefix == "" {
        return ""
    }

    parse, err := url.Parse(prefix)
    if err != nil {
        return ""
    }

    return parse.Path
}
</code></pre>
<h3 id="poc">PoC</h3>
<p>An attacker can bypass this by sending the following payload:</p>
<pre><code class="language-bash">curl -v 'http://traefik.localhost' -H 'X-Forwarded-Prefix: %0d//a.com'
[...]
&gt; HTTP/1.1 302 Found
&gt; Location: //a.com/dashboard/
</code></pre>
<p>or similar:</p>
<pre><code class="language-bash">curl -v 'http://traefik.localhost' -H 'X-Forwarded-Prefix: %2f%2fa.com'
[...]
&gt; HTTP/1.1 302 Found
&gt; Location: //a.com/dashboard/
</code></pre>
<h3 id="impact-1">Impact</h3>
<p>Similar to the previously reported bug. In cache poisoning scenarios this may be exploitable.</p>
</details>
### References

<ul>
<li><a href="https://github.com/traefik/traefik/security/advisories/GHSA-h924-8g65-j9wg">https://github.com/traefik/traefik/security/advisories/GHSA-h924-8g65-j9wg</a></li>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2024-52003">https://nvd.nist.gov/vuln/detail/CVE-2024-52003</a></li>
<li><a href="https://github.com/traefik/traefik/pull/11253">https://github.com/traefik/traefik/pull/11253</a></li>
<li><a href="https://github.com/traefik/traefik/releases/tag/v2.11.14">https://github.com/traefik/traefik/releases/tag/v2.11.14</a></li>
<li><a href="https://github.com/traefik/traefik/releases/tag/v3.2.1">https://github.com/traefik/traefik/releases/tag/v3.2.1</a></li>
<li><a href="https://github.com/advisories/GHSA-h924-8g65-j9wg">https://github.com/advisories/GHSA-h924-8g65-j9wg</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-h924-8g65-j9wg</uri>
        </author>
        <category label="severity" term="MODERATE"/>
        <published>2024-12-02T17:12:38.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[github.com/traefik/traefik/v2] Traefik's X-Forwarded-Prefix Header still allows for Open Redirect]]></title>
        <id>https://github.com/advisories/GHSA-h924-8g65-j9wg</id>
        <link href="https://github.com/advisories/GHSA-h924-8g65-j9wg"/>
        <updated>2024-12-02T17:12:38.000Z</updated>
        <content type="html"><![CDATA[<h3 id="impact">Impact</h3>
<p>There is a vulnerability in Traefik that allows the client to provide the <code>X-Forwarded-Prefix</code> header from an untrusted source.</p>
<h3 id="patches">Patches</h3>
<ul>
<li><a href="https://github.com/traefik/traefik/releases/tag/v2.11.14">https://github.com/traefik/traefik/releases/tag/v2.11.14</a></li>
<li><a href="https://github.com/traefik/traefik/releases/tag/v3.2.1">https://github.com/traefik/traefik/releases/tag/v3.2.1</a></li>
</ul>
<h3 id="workarounds">Workarounds</h3>
<p>No workaround.</p>
<h3 id="for-more-information">For more information</h3>
<p>If you have any questions or comments about this advisory, please <a href="https://github.com/traefik/traefik/issues">open an issue</a>.</p>
<details>
<summary>Original Description</summary>
### Summary
The previously reported open redirect ([GHSA-6qq8-5wq3-86rp](https://github.com/traefik/traefik/security/advisories/GHSA-6qq8-5wq3-86rp)) is not fixed correctly. The safePrefix function can be tricked to return an absolute URL.



<h3 id="details">Details</h3>
<p>The Traefik API <a href="https://github.com/traefik/traefik/blob/master/pkg/api/dashboard/dashboard.go">dashboard component</a> tries to validate that the value of the header X-Forwarded-Prefix is a site relative path:</p>
<pre><code class="language-go">http.Redirect(resp, req, safePrefix(req)+"/dashboard/", http.StatusFound)
</code></pre>
<pre><code class="language-go">func safePrefix(req *http.Request) string {
    prefix := req.Header.Get("X-Forwarded-Prefix")
    if prefix == "" {
        return ""
    }

    parse, err := url.Parse(prefix)
    if err != nil {
        return ""
    }

    return parse.Path
}
</code></pre>
<h3 id="poc">PoC</h3>
<p>An attacker can bypass this by sending the following payload:</p>
<pre><code class="language-bash">curl -v 'http://traefik.localhost' -H 'X-Forwarded-Prefix: %0d//a.com'
[...]
&gt; HTTP/1.1 302 Found
&gt; Location: //a.com/dashboard/
</code></pre>
<p>or similar:</p>
<pre><code class="language-bash">curl -v 'http://traefik.localhost' -H 'X-Forwarded-Prefix: %2f%2fa.com'
[...]
&gt; HTTP/1.1 302 Found
&gt; Location: //a.com/dashboard/
</code></pre>
<h3 id="impact-1">Impact</h3>
<p>Similar to the previously reported bug. In cache poisoning scenarios this may be exploitable.</p>
</details>
### References

<ul>
<li><a href="https://github.com/traefik/traefik/security/advisories/GHSA-h924-8g65-j9wg">https://github.com/traefik/traefik/security/advisories/GHSA-h924-8g65-j9wg</a></li>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2024-52003">https://nvd.nist.gov/vuln/detail/CVE-2024-52003</a></li>
<li><a href="https://github.com/traefik/traefik/pull/11253">https://github.com/traefik/traefik/pull/11253</a></li>
<li><a href="https://github.com/traefik/traefik/releases/tag/v2.11.14">https://github.com/traefik/traefik/releases/tag/v2.11.14</a></li>
<li><a href="https://github.com/traefik/traefik/releases/tag/v3.2.1">https://github.com/traefik/traefik/releases/tag/v3.2.1</a></li>
<li><a href="https://github.com/advisories/GHSA-h924-8g65-j9wg">https://github.com/advisories/GHSA-h924-8g65-j9wg</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-h924-8g65-j9wg</uri>
        </author>
        <category label="severity" term="MODERATE"/>
        <published>2024-12-02T17:12:38.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[github.com/cli/cli/v2] Recursive repository cloning can leak authentication tokens to non-GitHub submodule hosts]]></title>
        <id>https://github.com/advisories/GHSA-jwcm-9g39-pmcw</id>
        <link href="https://github.com/advisories/GHSA-jwcm-9g39-pmcw"/>
        <updated>2024-12-02T19:11:07.000Z</updated>
        <content type="html"><![CDATA[<h3 id="summary">Summary</h3>
<p>A security vulnerability has been identified in the GitHub CLI that could leak authentication tokens when cloning repositories containing <code>git</code> submodules hosted outside of GitHub.com and ghe.com.</p>
<h3 id="details">Details</h3>
<p>This vulnerability stems from several <code>gh</code> commands used to clone a repository with submodules from a non-GitHub host including <code>gh repo clone</code>, <code>gh repo fork</code>, <code>gh pr checkout</code>. These GitHub CLI commands invoke <code>git</code> with instructions to retrieve authentication tokens using the <a href="https://git-scm.com/docs/gitcredentials"><code>credential.helper</code></a> configuration variable for any host encountered.</p>
<p>Prior to <code>2.63.0</code>, hosts other than GitHub.com and ghe.com are treated as GitHub Enterprise Server hosts and have tokens sourced from the following environment variables before falling back to host-specific tokens stored within system-specific secured storage:</p>
<ul>
<li><code>GITHUB_ENTERPRISE_TOKEN</code></li>
<li><code>GH_ENTERPRISE_TOKEN</code></li>
<li><code>GITHUB_TOKEN</code> <em>when <code>CODESPACES</code> environment variable is set</em></li>
</ul>
<p>The result being <code>git</code> sending authentication tokens when cloning submodules.</p>
<p>In <code>2.63.0</code>, these GitHub CLI commands will limit the hosts for which <code>gh</code> acts as a credential helper to source authentication tokens. Additionally, <code>GITHUB_TOKEN</code> will only be used for GitHub.com and ghe.com.</p>
<h3 id="impact">Impact</h3>
<p>Successful exploitation could lead to a third-party using leaked authentication tokens to access privileged resources.</p>
<h3 id="remediation-and-mitigation">Remediation and mitigation</h3>
<ol>
<li>Upgrade <code>gh</code> to <code>2.63.0</code></li>
<li>Revoke authentication tokens used with the GitHub CLI: <ul>
<li><a href="https://docs.github.com/en/enterprise-cloud@latest/authentication/keeping-your-account-and-data-secure/managing-your-personal-access-tokens">Personal access tokens</a></li>
<li><a href="https://docs.github.com/en/apps/using-github-apps/reviewing-and-revoking-authorization-of-github-apps#reviewing-your-authorized-github-apps">GitHub CLI OAuth app</a></li>
</ul>
</li>
<li>Review your personal <a href="https://docs.github.com/en/authentication/keeping-your-account-and-data-secure/reviewing-your-security-log">security log</a> and any relevant <a href="https://docs.github.com/en/enterprise-cloud@latest/admin/monitoring-activity-in-your-enterprise/reviewing-audit-logs-for-your-enterprise/identifying-audit-log-events-performed-by-an-access-token">audit logs</a> for actions associated with your account or enterprise</li>
</ol>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/cli/cli/security/advisories/GHSA-jwcm-9g39-pmcw">https://github.com/cli/cli/security/advisories/GHSA-jwcm-9g39-pmcw</a></li>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2024-53858">https://nvd.nist.gov/vuln/detail/CVE-2024-53858</a></li>
<li><a href="https://git-scm.com/docs/gitcredentials">https://git-scm.com/docs/gitcredentials</a></li>
<li><a href="https://github.com/advisories/GHSA-jwcm-9g39-pmcw">https://github.com/advisories/GHSA-jwcm-9g39-pmcw</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-jwcm-9g39-pmcw</uri>
        </author>
        <category label="severity" term="MODERATE"/>
        <published>2024-11-27T21:43:05.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[github.com/cli/go-gh/v2] `auth.TokenForHost` violates GitHub host security boundary when sourcing authentication token within a codespace]]></title>
        <id>https://github.com/advisories/GHSA-55v3-xh23-96gh</id>
        <link href="https://github.com/advisories/GHSA-55v3-xh23-96gh"/>
        <updated>2024-12-02T19:10:22.000Z</updated>
        <content type="html"><![CDATA[<h3 id="summary">Summary</h3>
<p>A security vulnerability has been identified in <code>go-gh</code> that could leak authentication tokens intended for GitHub hosts to non-GitHub hosts when within a codespace.</p>
<h3 id="details">Details</h3>
<p><code>go-gh</code> sources authentication tokens from different environment variables depending on the host involved:</p>
<ul>
<li><code>GITHUB_TOKEN</code>, <code>GH_TOKEN</code> for GitHub.com and ghe.com</li>
<li><code>GITHUB_ENTERPRISE_TOKEN</code>, <code>GH_ENTERPRISE_TOKEN</code> for GitHub Enterprise Server</li>
</ul>
<p>Prior to <code>2.11.1</code>, <code>auth.TokenForHost</code> could source a token from the <code>GITHUB_TOKEN</code> environment variable for a host other than GitHub.com or ghe.com when <a href="https://github.com/cli/go-gh/blob/71770357e0cb12867d3e3e288854c0aa09d440b7/pkg/auth/auth.go#L73-L77">within a codespace</a>.</p>
<p>In <code>2.11.1</code>, <code>auth.TokenForHost</code> will only source a token from the <code>GITHUB_TOKEN</code> environment variable for GitHub.com or ghe.com hosts.</p>
<h3 id="impact">Impact</h3>
<p>Successful exploitation could send authentication token to an unintended host. </p>
<h3 id="remediation-and-mitigation">Remediation and mitigation</h3>
<ol>
<li>Upgrade <code>go-gh</code> to <code>2.11.1</code></li>
<li>Advise extension users to regenerate authentication tokens:<ul>
<li><a href="https://docs.github.com/en/enterprise-cloud@latest/authentication/keeping-your-account-and-data-secure/managing-your-personal-access-tokens">Personal access tokens</a></li>
<li><a href="https://docs.github.com/en/apps/using-github-apps/reviewing-and-revoking-authorization-of-github-apps#reviewing-your-authorized-github-apps">GitHub CLI OAuth app</a></li>
</ul>
</li>
<li>Advise extension users to review their personal <a href="https://docs.github.com/en/authentication/keeping-your-account-and-data-secure/reviewing-your-security-log">security log</a> and any relevant <a href="https://docs.github.com/en/enterprise-cloud@latest/admin/monitoring-activity-in-your-enterprise/reviewing-audit-logs-for-your-enterprise/identifying-audit-log-events-performed-by-an-access-token">audit logs</a> for actions associated with their account or enterprise</li>
</ol>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/cli/go-gh/security/advisories/GHSA-55v3-xh23-96gh">https://github.com/cli/go-gh/security/advisories/GHSA-55v3-xh23-96gh</a></li>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2024-53859">https://nvd.nist.gov/vuln/detail/CVE-2024-53859</a></li>
<li><a href="https://docs.github.com/en/apps/using-github-apps/reviewing-and-revoking-authorization-of-github-apps#reviewing-your-authorized-github-apps">https://docs.github.com/en/apps/using-github-apps/reviewing-and-revoking-authorization-of-github-apps#reviewing-your-authorized-github-apps</a></li>
<li><a href="https://docs.github.com/en/authentication/keeping-your-account-and-data-secure/reviewing-your-security-log">https://docs.github.com/en/authentication/keeping-your-account-and-data-secure/reviewing-your-security-log</a></li>
<li><a href="https://docs.github.com/en/enterprise-cloud@latest/admin/monitoring-activity-in-your-enterprise/reviewing-audit-logs-for-your-enterprise/identifying-audit-log-events-performed-by-an-access-token">https://docs.github.com/en/enterprise-cloud@latest/admin/monitoring-activity-in-your-enterprise/reviewing-audit-logs-for-your-enterprise/identifying-audit-log-events-performed-by-an-access-token</a></li>
<li><a href="https://docs.github.com/en/enterprise-cloud@latest/authentication/keeping-your-account-and-data-secure/managing-your-personal-access-tokens">https://docs.github.com/en/enterprise-cloud@latest/authentication/keeping-your-account-and-data-secure/managing-your-personal-access-tokens</a></li>
<li><a href="https://github.com/cli/go-gh/blob/71770357e0cb12867d3e3e288854c0aa09d440b7/pkg/auth/auth.go#L73-L77">https://github.com/cli/go-gh/blob/71770357e0cb12867d3e3e288854c0aa09d440b7/pkg/auth/auth.go#L73-L77</a></li>
<li><a href="https://github.com/advisories/GHSA-55v3-xh23-96gh">https://github.com/advisories/GHSA-55v3-xh23-96gh</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-55v3-xh23-96gh</uri>
        </author>
        <category label="severity" term="MODERATE"/>
        <published>2024-11-27T21:43:03.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[github.com/cri-o/cri-o] CRI-O: Maliciously structured checkpoint file can gain arbitrary node access]]></title>
        <id>https://github.com/advisories/GHSA-7p9f-6x8j-gxxp</id>
        <link href="https://github.com/advisories/GHSA-7p9f-6x8j-gxxp"/>
        <updated>2024-11-26T21:50:33.000Z</updated>
        <content type="html"><![CDATA[<h3 id="impact">Impact</h3>
<h3 id="patches">Patches</h3>
<p>1.31.1, 1.30.6, 1.29.8</p>
<h3 id="workarounds">Workarounds</h3>
<p>set <code>enable_criu_support = false</code> </p>
<h3 id="references">References</h3>
<p><em>Are there any links users can visit to find out more?</em></p>
<h3 id="references-1">References</h3>
<ul>
<li><a href="https://github.com/cri-o/cri-o/security/advisories/GHSA-7p9f-6x8j-gxxp">https://github.com/cri-o/cri-o/security/advisories/GHSA-7p9f-6x8j-gxxp</a></li>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2024-8676">https://nvd.nist.gov/vuln/detail/CVE-2024-8676</a></li>
<li><a href="https://github.com/cri-o/cri-o/commit/e8e7dcb7838d11b5157976bf3e31a5840bb77de7">https://github.com/cri-o/cri-o/commit/e8e7dcb7838d11b5157976bf3e31a5840bb77de7</a></li>
<li><a href="https://access.redhat.com/security/cve/CVE-2024-8676">https://access.redhat.com/security/cve/CVE-2024-8676</a></li>
<li><a href="https://bugzilla.redhat.com/show_bug.cgi?id=2313842">https://bugzilla.redhat.com/show_bug.cgi?id=2313842</a></li>
<li><a href="https://github.com/advisories/GHSA-7p9f-6x8j-gxxp">https://github.com/advisories/GHSA-7p9f-6x8j-gxxp</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-7p9f-6x8j-gxxp</uri>
        </author>
        <category label="severity" term="MODERATE"/>
        <published>2024-11-26T21:50:30.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[github.com/cri-o/cri-o] CRI-O: Maliciously structured checkpoint file can gain arbitrary node access]]></title>
        <id>https://github.com/advisories/GHSA-7p9f-6x8j-gxxp</id>
        <link href="https://github.com/advisories/GHSA-7p9f-6x8j-gxxp"/>
        <updated>2024-11-26T21:50:33.000Z</updated>
        <content type="html"><![CDATA[<h3 id="impact">Impact</h3>
<h3 id="patches">Patches</h3>
<p>1.31.1, 1.30.6, 1.29.8</p>
<h3 id="workarounds">Workarounds</h3>
<p>set <code>enable_criu_support = false</code> </p>
<h3 id="references">References</h3>
<p><em>Are there any links users can visit to find out more?</em></p>
<h3 id="references-1">References</h3>
<ul>
<li><a href="https://github.com/cri-o/cri-o/security/advisories/GHSA-7p9f-6x8j-gxxp">https://github.com/cri-o/cri-o/security/advisories/GHSA-7p9f-6x8j-gxxp</a></li>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2024-8676">https://nvd.nist.gov/vuln/detail/CVE-2024-8676</a></li>
<li><a href="https://github.com/cri-o/cri-o/commit/e8e7dcb7838d11b5157976bf3e31a5840bb77de7">https://github.com/cri-o/cri-o/commit/e8e7dcb7838d11b5157976bf3e31a5840bb77de7</a></li>
<li><a href="https://access.redhat.com/security/cve/CVE-2024-8676">https://access.redhat.com/security/cve/CVE-2024-8676</a></li>
<li><a href="https://bugzilla.redhat.com/show_bug.cgi?id=2313842">https://bugzilla.redhat.com/show_bug.cgi?id=2313842</a></li>
<li><a href="https://github.com/advisories/GHSA-7p9f-6x8j-gxxp">https://github.com/advisories/GHSA-7p9f-6x8j-gxxp</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-7p9f-6x8j-gxxp</uri>
        </author>
        <category label="severity" term="MODERATE"/>
        <published>2024-11-26T21:50:30.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[github.com/cri-o/cri-o] CRI-O: Maliciously structured checkpoint file can gain arbitrary node access]]></title>
        <id>https://github.com/advisories/GHSA-7p9f-6x8j-gxxp</id>
        <link href="https://github.com/advisories/GHSA-7p9f-6x8j-gxxp"/>
        <updated>2024-11-26T21:50:33.000Z</updated>
        <content type="html"><![CDATA[<h3 id="impact">Impact</h3>
<h3 id="patches">Patches</h3>
<p>1.31.1, 1.30.6, 1.29.8</p>
<h3 id="workarounds">Workarounds</h3>
<p>set <code>enable_criu_support = false</code> </p>
<h3 id="references">References</h3>
<p><em>Are there any links users can visit to find out more?</em></p>
<h3 id="references-1">References</h3>
<ul>
<li><a href="https://github.com/cri-o/cri-o/security/advisories/GHSA-7p9f-6x8j-gxxp">https://github.com/cri-o/cri-o/security/advisories/GHSA-7p9f-6x8j-gxxp</a></li>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2024-8676">https://nvd.nist.gov/vuln/detail/CVE-2024-8676</a></li>
<li><a href="https://github.com/cri-o/cri-o/commit/e8e7dcb7838d11b5157976bf3e31a5840bb77de7">https://github.com/cri-o/cri-o/commit/e8e7dcb7838d11b5157976bf3e31a5840bb77de7</a></li>
<li><a href="https://access.redhat.com/security/cve/CVE-2024-8676">https://access.redhat.com/security/cve/CVE-2024-8676</a></li>
<li><a href="https://bugzilla.redhat.com/show_bug.cgi?id=2313842">https://bugzilla.redhat.com/show_bug.cgi?id=2313842</a></li>
<li><a href="https://github.com/advisories/GHSA-7p9f-6x8j-gxxp">https://github.com/advisories/GHSA-7p9f-6x8j-gxxp</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-7p9f-6x8j-gxxp</uri>
        </author>
        <category label="severity" term="MODERATE"/>
        <published>2024-11-26T21:50:30.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[github.com/treeverse/lakefs] Re-creating a deleted user in lakeFS will re-enable previous user credentials that existed prior to its deletion]]></title>
        <id>https://github.com/advisories/GHSA-hh33-46q4-hwm2</id>
        <link href="https://github.com/advisories/GHSA-hh33-46q4-hwm2"/>
        <updated>2024-11-26T21:43:47.000Z</updated>
        <content type="html"><![CDATA[<h3 id="impact">Impact</h3>
<p>Existing lakeFS users who have issued credentials to users who have been deleted.
Creating a new user with the same username, that user will inherit all of the previous user's credentials lakeFS needs to delete user credentials upon user deletion.</p>
<h3 id="patches">Patches</h3>
<p><em>Has the problem been patched? What versions should users upgrade to?</em></p>
<h3 id="workarounds">Workarounds</h3>
<p>A possible workaround will be not to reuse usernames that were previously deleted</p>
<h3 id="references">References</h3>
<p><em>Are there any links users can visit to find out more?</em></p>
<h3 id="references-1">References</h3>
<ul>
<li><a href="https://github.com/treeverse/lakeFS/security/advisories/GHSA-hh33-46q4-hwm2">https://github.com/treeverse/lakeFS/security/advisories/GHSA-hh33-46q4-hwm2</a></li>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2024-43784">https://nvd.nist.gov/vuln/detail/CVE-2024-43784</a></li>
<li><a href="https://github.com/treeverse/lakeFS/releases/tag/v1.33.0">https://github.com/treeverse/lakeFS/releases/tag/v1.33.0</a></li>
<li><a href="https://github.com/advisories/GHSA-hh33-46q4-hwm2">https://github.com/advisories/GHSA-hh33-46q4-hwm2</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-hh33-46q4-hwm2</uri>
        </author>
        <category label="severity" term="MODERATE"/>
        <published>2024-11-26T19:58:20.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[github.com/cilium/cilium] Cilium's Layer 7 policy enforcement may not occur in policies with wildcarded port ranges]]></title>
        <id>https://github.com/advisories/GHSA-xg58-75qf-9r67</id>
        <link href="https://github.com/advisories/GHSA-xg58-75qf-9r67"/>
        <updated>2024-11-25T21:46:56.000Z</updated>
        <content type="html"><![CDATA[<h3 id="impact">Impact</h3>
<p>For users with the following configuration:</p>
<ul>
<li>An allow policy that selects a <a href="https://docs.cilium.io/en/v1.14/security/policy/language/#layer-3-examples">Layer 3 destination</a> and a <a href="https://docs.cilium.io/en/stable/security/policy/language/#example-port-ranges">port range</a> <strong>AND</strong></li>
<li>A <a href="https://docs.cilium.io/en/latest/security/policy/language/#layer-7-examples">Layer 7 allow policy</a> that selects a specific port within the first policy's range</li>
</ul>
<p>then Layer 7 enforcement would not occur for the traffic selected by the Layer 7 policy.</p>
<p>This issue only affects users who use Cilium's port range functionality, which was introduced in Cilium v1.16.</p>
<p>For reference, an example of a pair of policies that would trigger this issue is:</p>
<pre><code>apiVersion: "cilium.io/v2"
kind: CiliumNetworkPolicy
metadata:
  name: "l3-port-range-rule"
spec:
  endpointSelector:
    matchLabels:
      app: service
  ingress:
    - fromCIDR:
      - 192.168.60.0/24
      toPorts:
      - ports:
        - port: "80"
          endPort: 444
          protocol: TCP
</code></pre>
<p>and</p>
<pre><code>apiVersion: "cilium.io/v2"
kind: CiliumNetworkPolicy
metadata:
  name: "l7-port-range-rule"
spec:
  endpointSelector:
    matchLabels:
      app: service
  ingress:
    toPorts:
    - ports:
      - port: "80"
        protocol: TCP
      rules:
        http:
        - method: "GET"
          path: "/public"
</code></pre>
<p>In the above example, requests would be permitted to all HTTP paths on matching endpoints, rather than just <code>GET</code> requests to the <code>/public</code> path as intentded by the <code>l7-port-range-rule</code> policy. In patched versions of Cilium, the <code>l7-port-range-rule</code> would take precedence over the <code>l3-port-range-rule</code>.</p>
<h3 id="patches">Patches</h3>
<p>This issue is patched in <a href="https://github.com/cilium/cilium/pull/35150">https://github.com/cilium/cilium/pull/35150</a>.</p>
<p>This issue affects Cilium v1.16 between v1.16.0 and v1.16.3 inclusive.</p>
<p>This issue is patched in Cilium v1.16.4.</p>
<h3 id="workarounds">Workarounds</h3>
<p>Users with network policies that match the pattern described above can work around the issue by rewriting any policies that use port ranges to individually specify the ports permitted for traffic.</p>
<h3 id="acknowledgements">Acknowledgements</h3>
<p>The Cilium community has worked together with members of Isovalent to prepare these mitigations. Special thanks to @jrajahalme for resolving this issue.</p>
<h3 id="for-more-information">For more information</h3>
<p>If you have any questions or comments about this advisory, please reach out on <a href="https://docs.cilium.io/en/latest/community/community/#slack">Slack</a>.</p>
<p>If you think you have found a vulnerability affecting Cilium, we strongly encourage you to report it to our security mailing list at <a href="mailto:security@cilium.io">security@cilium.io</a>. This is a private mailing list for the Cilium security team, and your report will be treated as top priority.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/cilium/cilium/security/advisories/GHSA-xg58-75qf-9r67">https://github.com/cilium/cilium/security/advisories/GHSA-xg58-75qf-9r67</a></li>
<li><a href="https://github.com/cilium/cilium/pull/35150">https://github.com/cilium/cilium/pull/35150</a></li>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2024-52529">https://nvd.nist.gov/vuln/detail/CVE-2024-52529</a></li>
<li><a href="https://github.com/advisories/GHSA-xg58-75qf-9r67">https://github.com/advisories/GHSA-xg58-75qf-9r67</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-xg58-75qf-9r67</uri>
        </author>
        <category label="severity" term="MODERATE"/>
        <published>2024-11-25T19:35:10.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[github.com/openshift/console] OpenShift Console Server Side Request Forgery vulnerability]]></title>
        <id>https://github.com/advisories/GHSA-v3w7-g6p2-mpx7</id>
        <link href="https://github.com/advisories/GHSA-v3w7-g6p2-mpx7"/>
        <updated>2024-11-25T17:25:20.000Z</updated>
        <content type="html"><![CDATA[<p>A flaw was found in OpenShift Console. A Server Side Request Forgery (SSRF) attack can happen if an attacker supplies all or part of a URL to the server to query. The server is considered to be in a privileged network position and can often reach exposed services that aren't readily available to clients due to network filtering. Leveraging such an attack vector, the attacker can have an impact on other services and potentially disclose information or have other nefarious effects on the system.
The /api/dev-console/proxy/internet endpoint on the OpenShit Console allows authenticated users to have the console's pod perform arbitrary and fully controlled HTTP(s) requests. The full response to these requests is returned by the endpoint.
While the name of this endpoint suggests the requests are only bound to the internet, no such checks are in place. An authenticated user can therefore ask the console to perform arbitrary HTTP requests from outside the cluster to a service inside the cluster.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2024-6538">https://nvd.nist.gov/vuln/detail/CVE-2024-6538</a></li>
<li><a href="https://access.redhat.com/security/cve/CVE-2024-6538">https://access.redhat.com/security/cve/CVE-2024-6538</a></li>
<li><a href="https://bugzilla.redhat.com/show_bug.cgi?id=2296057">https://bugzilla.redhat.com/show_bug.cgi?id=2296057</a></li>
<li><a href="https://github.com/advisories/GHSA-v3w7-g6p2-mpx7">https://github.com/advisories/GHSA-v3w7-g6p2-mpx7</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-v3w7-g6p2-mpx7</uri>
        </author>
        <category label="severity" term="MODERATE"/>
        <published>2024-11-25T09:30:58.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[github.com/taurusgroup/multi-party-sig] Taurus multi-party-sig has OT-based ECDSA protocol implementation flaws]]></title>
        <id>https://github.com/advisories/GHSA-7f6p-phw2-8253</id>
        <link href="https://github.com/advisories/GHSA-7f6p-phw2-8253"/>
        <updated>2024-11-25T15:11:12.000Z</updated>
        <content type="html"><![CDATA[<p>Coinbase researchers reported 2 security issues in our implementation of the oblivious transfer (OT) based protocol <a href="https://eprint.iacr.org/2018/499.pdf">DKLS</a>:</p>
<h3 id="1-secret-share-recovery-attack">1. Secret share recovery attack</h3>
<p>If the base OT setup of the protocol is reused for another execution of the OT extension, then a malicious participant can extract a bit of the secret of another participant. By repeating the execution they can eventually recover the whole secret.</p>
<p>Therefore, unlike our comments suggested, you <strong>must not reuse an OT setup</strong> for multiple protocol executions. </p>
<p>We're adding a warning in the code:</p>
<p><a href="https://github.com/taurushq-io/multi-party-sig/blob/9e4400fccee89be6195d0a12dd0ed052288d5040/internal/ot/extended.go#L114">https://github.com/taurushq-io/multi-party-sig/blob/9e4400fccee89be6195d0a12dd0ed052288d5040/internal/ot/extended.go#L114</a></p>
<h3 id="2-invalid-security-proof-due-to-incorrect-operator">2. Invalid security proof due to incorrect operator</h3>
<p>The original 2018 version of the DKLS had a typo in the OT extension protocol when computing the check value in the OT extension: the paper noted a XOR whereas it should be a field multiplication. This erroneous behavior was implemented <a href="https://github.com/taurushq-io/multi-party-sig/blob/4d84aafb57b437da1b933db9a265fb7ce4e7c138/internal/ot/extended.go#L188">in our code</a>. </p>
<p>The proof of security fails in this case. No concrete attack is known, however.</p>
<p>The <a href="https://eprint.iacr.org/2018/499.pdf">2023 update</a> of the DKLS paper reported that typo and updated the protocol definition.</p>
<p>As of 20241124, patching is in progress (branch <a href="https://github.com/taurushq-io/multi-party-sig/tree/otfix">otfix</a>), but not merged to the main branch yes as the tests fail to pass. We're troubleshooting the issue and will merge into the main branch when it's resolved.</p>
<h3 id="workarounds">Workarounds</h3>
<p>Do not reuse an OT setup, to eliminate the secret recovery attack.</p>
<p>Avoid using our implementation of the DKLS protocol until we patch it, and maybe avoid DKLS altogether.</p>
<h3 id="credits">Credits</h3>
<p>Thank you to the Coinbase researchers Yi-Hsiu Chen and Samuel Ranellucci for discovering these issues and providing a comprehensive write-up. Thank you to Yehuda Lindell for coordinating the disclosure.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/taurushq-io/multi-party-sig/security/advisories/GHSA-7f6p-phw2-8253">https://github.com/taurushq-io/multi-party-sig/security/advisories/GHSA-7f6p-phw2-8253</a></li>
<li><a href="https://eprint.iacr.org/2018/499.pdf">https://eprint.iacr.org/2018/499.pdf</a></li>
<li><a href="https://github.com/taurushq-io/multi-party-sig/blob/4d84aafb57b437da1b933db9a265fb7ce4e7c138/internal/ot/extended.go#L188">https://github.com/taurushq-io/multi-party-sig/blob/4d84aafb57b437da1b933db9a265fb7ce4e7c138/internal/ot/extended.go#L188</a></li>
<li><a href="https://github.com/taurushq-io/multi-party-sig/blob/9e4400fccee89be6195d0a12dd0ed052288d5040/internal/ot/extended.go#L114">https://github.com/taurushq-io/multi-party-sig/blob/9e4400fccee89be6195d0a12dd0ed052288d5040/internal/ot/extended.go#L114</a></li>
<li><a href="https://github.com/taurushq-io/multi-party-sig/tree/otfix">https://github.com/taurushq-io/multi-party-sig/tree/otfix</a></li>
<li><a href="https://github.com/advisories/GHSA-7f6p-phw2-8253">https://github.com/advisories/GHSA-7f6p-phw2-8253</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-7f6p-phw2-8253</uri>
        </author>
        <category label="severity" term="HIGH"/>
        <published>2024-11-25T15:11:11.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[github.com/kanisterio/kanister] Withdrawn Advisory: Kanister vulnerable to cluster-level privilege escalation]]></title>
        <id>https://github.com/advisories/GHSA-h27c-6xm3-mcqp</id>
        <link href="https://github.com/advisories/GHSA-h27c-6xm3-mcqp"/>
        <updated>2024-11-25T20:50:12.000Z</updated>
        <content type="html"><![CDATA[<h1 id="withdrawn-advisory">Withdrawn Advisory</h1>
<p>This advisory has been withdrawn because the vulnerability does not affect a released Go package. For more information, see github/advisory-database/issues/5029.</p>
<h1 id="original-advisory">Original Advisory</h1>
<h3 id="summary">Summary</h3>
<p>This advisory affects the Kanister helm charts and not the go package</p>
<h3 id="details">Details</h3>
<p>The kanister has a deployment called default-kanister-operator, which is bound with a ClusterRole called edit via ClusterRoleBinding(<a href="https://github.com/kanisterio/kanister/blob/master/helm/kanister-operator/templates/rbac.yaml#L49">https://github.com/kanisterio/kanister/blob/master/helm/kanister-operator/templates/rbac.yaml#L49</a>). The "edit" ClusterRole is one of Kubernetes default-created ClusterRole, and it have create/patch/udpate verbs of daemonset resources, create verb of serviceaccount/token resources, and impersonate verb of serviceaccounts resources. If a malicious user can access the worker node which has this component, he/she can:</p>
<p>For the create/patch/update verbs of daemonset resources, the malicious user can abuse it to create or modify a set of Pods to mount a high-privilege service account (e.g., the cluster-admin service account). After that, he/she can abuse the high-privilege SA token of created Pod to take over the whole cluster.</p>
<p>For the create verb of serviceaccount/token resources, a malicious user can abuse this permission to generate new Service Account tokens and use them to operate with high-privilege roles, such as cluster administrators. These tokens can be used to access and manipulate any resources within the cluster.</p>
<p>For the impersonate verb of serviceaccounts resources, a malicious user can impersonate high-privilege Service Accounts, thereby gaining access to roles such as cluster administrators. This enables the attacker to perform all actions that the high-privilege account can, including creating, modifying, and deleting critical resources within the cluster.</p>
<h3 id="poc">PoC</h3>
<p>We have discussed in the "Details" section</p>
<h3 id="impact">Impact</h3>
<p>Privilege escalation</p>
<h3 id="mitigation">Mitigation</h3>
<p>Currently kanister helm chart provides rbac.create flag (true by default), which controls whether the rbac rules for kanister service account will be created <a href="https://github.com/kanisterio/kanister/blob/master/helm/kanister-operator/values.yaml#L17">https://github.com/kanisterio/kanister/blob/master/helm/kanister-operator/values.yaml#L17</a>
If this value set to false, the user needs to create rbac rules themselves and they can limit the role bindings for kanister service account, for example scope it to specific namespace.
Service account can also be configured via helm <a href="https://github.com/kanisterio/kanister/blob/master/helm/kanister-operator/values.yaml#L19">https://github.com/kanisterio/kanister/blob/master/helm/kanister-operator/values.yaml#L19</a></p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/kanisterio/kanister/security/advisories/GHSA-h27c-6xm3-mcqp">https://github.com/kanisterio/kanister/security/advisories/GHSA-h27c-6xm3-mcqp</a></li>
<li><a href="https://github.com/kanisterio/kanister/blob/master/helm/kanister-operator/templates/rbac.yaml#L49">https://github.com/kanisterio/kanister/blob/master/helm/kanister-operator/templates/rbac.yaml#L49</a></li>
<li><a href="https://github.com/kanisterio/kanister/wiki/2023%E2%80%9024-Community-Meeting-Notes">https://github.com/kanisterio/kanister/wiki/2023%E2%80%9024-Community-Meeting-Notes</a></li>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2024-43403">https://nvd.nist.gov/vuln/detail/CVE-2024-43403</a></li>
<li><a href="https://github.com/advisories/GHSA-h27c-6xm3-mcqp">https://github.com/advisories/GHSA-h27c-6xm3-mcqp</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-h27c-6xm3-mcqp</uri>
        </author>
        <category label="severity" term="MODERATE"/>
        <published>2024-08-20T22:13:02.000Z</published>
    </entry>
</feed>