<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
    <id>https://azu.github.io/github-advisory-database-rss/composer.rss</id>
    <title>Security Advisory for PHP packages hosted at packagist.org</title>
    <updated>2025-01-10T10:01:34.190Z</updated>
    <generator>github-advisory-database-rss</generator>
    <link rel="alternate" href="https://github.com/advisories?query=type%3Areviewed+ecosystem%3Acomposer"/>
    <subtitle>Security Advisory for PHP packages hosted at packagist.org on GitHub</subtitle>
    <rights>github-advisory-database-rss</rights>
    <category term="CRITICAL"/>
    <category term="HIGH"/>
    <category term="MODERATE"/>
    <category term="LOW"/>
    <entry>
        <title type="html"><![CDATA[[nesbot/carbon] Carbon has an arbitrary file include via unvalidated input passed to Carbon::setLocale]]></title>
        <id>https://github.com/advisories/GHSA-j3f9-p6hm-5w6q</id>
        <link href="https://github.com/advisories/GHSA-j3f9-p6hm-5w6q"/>
        <updated>2025-01-08T21:51:38.000Z</updated>
        <content type="html"><![CDATA[<h3 id="impact">Impact</h3>
<p>Application passing unsanitized user input to <code>Carbon::setLocale</code> are at risk of arbitrary file include, if the application allows users to upload files with <code>.php</code> extension in an folder that allows <code>include</code> or <code>require</code> to read it, then they are at risk of arbitrary code ran on their servers.</p>
<h3 id="patches">Patches</h3>
<ul>
<li><a href="https://github.com/briannesbitt/Carbon/releases/tag/3.8.4">3.8.4</a></li>
<li><a href="https://github.com/briannesbitt/Carbon/releases/tag/2.72.6">2.72.6</a></li>
</ul>
<h3 id="workarounds">Workarounds</h3>
<p>Any of the below actions can be taken to prevent the issue:</p>
<ul>
<li>Validate input before calling <code>setLocale()</code>, for instance by forbidding or removing <code>/</code> and <code>\</code></li>
<li>Call <code>setLocale()</code> only with a locale from a whitelist of supported locales</li>
<li>When uploading files, rename them so they cannot have a <code>.php</code> extension (this is recommended even if you're not affected by this issue)</li>
<li>Prefer storage system that are not local to the application (remote service, or local service ran by another user so the uploaded files actually live outside of the application basedir)</li>
</ul>
<h3 id="references">References</h3>
<p><a href="https://en.wikipedia.org/wiki/File_inclusion_vulnerability">https://en.wikipedia.org/wiki/File_inclusion_vulnerability</a></p>
<h3 id="credits">Credits</h3>
<p>Thanks to <strong>Szczepan Hołyszewski</strong> who reported the issue and to Tidelift to coordinate the resolution</p>
<h3 id="references-1">References</h3>
<ul>
<li><a href="https://github.com/CarbonPHP/carbon/security/advisories/GHSA-j3f9-p6hm-5w6q">https://github.com/CarbonPHP/carbon/security/advisories/GHSA-j3f9-p6hm-5w6q</a></li>
<li><a href="https://github.com/briannesbitt/Carbon/commit/129700ed449b1f02d70272d2ac802357c8c30c58">https://github.com/briannesbitt/Carbon/commit/129700ed449b1f02d70272d2ac802357c8c30c58</a></li>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2025-22145">https://nvd.nist.gov/vuln/detail/CVE-2025-22145</a></li>
<li><a href="https://github.com/advisories/GHSA-j3f9-p6hm-5w6q">https://github.com/advisories/GHSA-j3f9-p6hm-5w6q</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-j3f9-p6hm-5w6q</uri>
        </author>
        <category label="severity" term="MODERATE"/>
        <published>2025-01-08T21:03:28.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[nesbot/carbon] Carbon has an arbitrary file include via unvalidated input passed to Carbon::setLocale]]></title>
        <id>https://github.com/advisories/GHSA-j3f9-p6hm-5w6q</id>
        <link href="https://github.com/advisories/GHSA-j3f9-p6hm-5w6q"/>
        <updated>2025-01-08T21:51:38.000Z</updated>
        <content type="html"><![CDATA[<h3 id="impact">Impact</h3>
<p>Application passing unsanitized user input to <code>Carbon::setLocale</code> are at risk of arbitrary file include, if the application allows users to upload files with <code>.php</code> extension in an folder that allows <code>include</code> or <code>require</code> to read it, then they are at risk of arbitrary code ran on their servers.</p>
<h3 id="patches">Patches</h3>
<ul>
<li><a href="https://github.com/briannesbitt/Carbon/releases/tag/3.8.4">3.8.4</a></li>
<li><a href="https://github.com/briannesbitt/Carbon/releases/tag/2.72.6">2.72.6</a></li>
</ul>
<h3 id="workarounds">Workarounds</h3>
<p>Any of the below actions can be taken to prevent the issue:</p>
<ul>
<li>Validate input before calling <code>setLocale()</code>, for instance by forbidding or removing <code>/</code> and <code>\</code></li>
<li>Call <code>setLocale()</code> only with a locale from a whitelist of supported locales</li>
<li>When uploading files, rename them so they cannot have a <code>.php</code> extension (this is recommended even if you're not affected by this issue)</li>
<li>Prefer storage system that are not local to the application (remote service, or local service ran by another user so the uploaded files actually live outside of the application basedir)</li>
</ul>
<h3 id="references">References</h3>
<p><a href="https://en.wikipedia.org/wiki/File_inclusion_vulnerability">https://en.wikipedia.org/wiki/File_inclusion_vulnerability</a></p>
<h3 id="credits">Credits</h3>
<p>Thanks to <strong>Szczepan Hołyszewski</strong> who reported the issue and to Tidelift to coordinate the resolution</p>
<h3 id="references-1">References</h3>
<ul>
<li><a href="https://github.com/CarbonPHP/carbon/security/advisories/GHSA-j3f9-p6hm-5w6q">https://github.com/CarbonPHP/carbon/security/advisories/GHSA-j3f9-p6hm-5w6q</a></li>
<li><a href="https://github.com/briannesbitt/Carbon/commit/129700ed449b1f02d70272d2ac802357c8c30c58">https://github.com/briannesbitt/Carbon/commit/129700ed449b1f02d70272d2ac802357c8c30c58</a></li>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2025-22145">https://nvd.nist.gov/vuln/detail/CVE-2025-22145</a></li>
<li><a href="https://github.com/advisories/GHSA-j3f9-p6hm-5w6q">https://github.com/advisories/GHSA-j3f9-p6hm-5w6q</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-j3f9-p6hm-5w6q</uri>
        </author>
        <category label="severity" term="MODERATE"/>
        <published>2025-01-08T21:03:28.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[netcarver/textile] PHP-Textile has persistent XSS vulnerability in image link handling]]></title>
        <id>https://github.com/advisories/GHSA-95m2-chm4-mq7m</id>
        <link href="https://github.com/advisories/GHSA-95m2-chm4-mq7m"/>
        <updated>2025-01-07T17:11:04.000Z</updated>
        <content type="html"><![CDATA[<h3 id="details">Details</h3>
<p>Persistent XSS vulnerability in image link handling of PHP-Textile versions 4.1.2 and older, when running the parser in restricted mode. In restricted mode it is expected that the input would be sanitized, allowing user-input (such as user comments) to be parsed and handled safely by the PHP-Textile library.</p>
<p>In restricted mode, the version 4.1.2 of the library does not sanitize or validate user-controllable href input in image links, but allows any link protocol or JavaScriptt links to be used. The vulnerability allows an attacker to add malicious JavaScript code to the page which is then executed when an unexpecting user clicks the link.</p>
<p>In non-restricted mode, the library allows mixed HTML input, and any link protocol by design. In restricted mode, text links were already handled correctly and the vulnerability only affects image links.</p>
<h3 id="resolution">Resolution</h3>
<p>This issue was fixed in PHP-Textile version 4.1.3. Version 4.1.3 disallows use of JavaScript in image links when the parser is ran in restricted mode. Restricted mode can be enabled with <code>Parser::setRestricted()</code> method prior to calling the <code>parse</code> method. For more information, see <strong>Parsing unstructed input</strong> in the project's <a href="https://github.com/textile/php-textile?tab=readme-ov-file#parsing-untrusted-input">README</a>.</p>
<h3 id="poc">PoC</h3>
<p>The following Textile input:</p>
<pre><code>!securing.pl(Click Tu)!:javascript:document.innerHTML='&lt;script&gt;alert(1);&lt;/script&gt;'+document.cookie)
</code></pre>
<p>Would render as the following HTML even in restricted mode:</p>
<p><code>&lt;p&gt;&lt;a href="javascript:document.innerHTML=&amp;#39;&amp;lt;script&amp;gt;alert(1);&amp;lt;/script&amp;gt;&amp;#39;+document.cookie"&gt;&lt;img alt="Click Tu" src="securing.pl" title="Click Tu"&gt;&lt;/a&gt;)&lt;/p&gt;</code></p>
<h3 id="impact">Impact</h3>
<p>The attacker can perform any operation in the application with user’s privileges or remotely control user’s browser with automated tools.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/textile/php-textile/security/advisories/GHSA-95m2-chm4-mq7m">https://github.com/textile/php-textile/security/advisories/GHSA-95m2-chm4-mq7m</a></li>
<li><a href="https://github.com/textile/php-textile/commit/ab18ae9703bee8b15f1b9d889d40e1881728bae6">https://github.com/textile/php-textile/commit/ab18ae9703bee8b15f1b9d889d40e1881728bae6</a></li>
<li><a href="https://github.com/advisories/GHSA-95m2-chm4-mq7m">https://github.com/advisories/GHSA-95m2-chm4-mq7m</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-95m2-chm4-mq7m</uri>
        </author>
        <category label="severity" term="HIGH"/>
        <published>2025-01-07T17:11:02.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[redaxo/source] REDAXO CMS Cross-site Scripting vulnerability]]></title>
        <id>https://github.com/advisories/GHSA-2p95-8xvm-2pjx</id>
        <link href="https://github.com/advisories/GHSA-2p95-8xvm-2pjx"/>
        <updated>2025-01-07T18:40:46.000Z</updated>
        <content type="html"><![CDATA[<p>A stored cross-site scripting (XSS) vulnerability in the component /media/test.html of REDAXO CMS v5.17.1 allows attackers to execute arbitrary web scripts or HTML via injecting a crafted payload into the password parameter.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2024-46209">https://nvd.nist.gov/vuln/detail/CVE-2024-46209</a></li>
<li><a href="https://github.com/h4ckr4v3n/CVE-2024-46209/blob/main/REDAXO%20Stored%20XSS%20%2B%20RCE.pdf">https://github.com/h4ckr4v3n/CVE-2024-46209/blob/main/REDAXO%20Stored%20XSS%20%2B%20RCE.pdf</a></li>
<li><a href="https://github.com/h4ckr4v3n/research_redaxo_5_17_1.git">https://github.com/h4ckr4v3n/research_redaxo_5_17_1.git</a></li>
<li><a href="https://github.com/advisories/GHSA-2p95-8xvm-2pjx">https://github.com/advisories/GHSA-2p95-8xvm-2pjx</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-2p95-8xvm-2pjx</uri>
        </author>
        <category label="severity" term="LOW"/>
        <published>2025-01-06T21:30:51.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[getgrav/grav] Grav Cross-site Scripting vulnerability]]></title>
        <id>https://github.com/advisories/GHSA-m78c-qx99-mvw9</id>
        <link href="https://github.com/advisories/GHSA-m78c-qx99-mvw9"/>
        <updated>2025-01-07T18:40:56.000Z</updated>
        <content type="html"><![CDATA[<p>A cross-site scripting (XSS) vulnerability in Grav v1.7.45 allows attackers to execute arbitrary web scripts or HTML via a crafted payload.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2024-35498">https://nvd.nist.gov/vuln/detail/CVE-2024-35498</a></li>
<li><a href="https://github.com/r4vanan/Stored-xss-Grav-v1.7.45">https://github.com/r4vanan/Stored-xss-Grav-v1.7.45</a></li>
<li><a href="https://r4vanan.medium.com/a-quick-dive-into-xss-vulnerability-in-grav-cms-v1-7-45-cve-2024-35498-fc236b7d74a0">https://r4vanan.medium.com/a-quick-dive-into-xss-vulnerability-in-grav-cms-v1-7-45-cve-2024-35498-fc236b7d74a0</a></li>
<li><a href="https://github.com/advisories/GHSA-m78c-qx99-mvw9">https://github.com/advisories/GHSA-m78c-qx99-mvw9</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-m78c-qx99-mvw9</uri>
        </author>
        <category label="severity" term="LOW"/>
        <published>2025-01-06T21:30:51.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[guzzlehttp/oauth-subscriber] Guzzle OAuth Subscriber has insufficient nonce entropy]]></title>
        <id>https://github.com/advisories/GHSA-237r-r8m4-4q88</id>
        <link href="https://github.com/advisories/GHSA-237r-r8m4-4q88"/>
        <updated>2025-01-06T22:15:07.000Z</updated>
        <content type="html"><![CDATA[<h3 id="impact">Impact</h3>
<p>Nonce generation does not use sufficient entropy nor a cryptographically secure pseudorandom source (<a href="https://github.com/guzzle/oauth-subscriber/blob/0.8.0/src/Oauth1.php#L192">https://github.com/guzzle/oauth-subscriber/blob/0.8.0/src/Oauth1.php#L192</a>). This can leave servers vulnerable to replay attacks when TLS is not used.</p>
<h3 id="patches">Patches</h3>
<p>Upgrade to version 0.8.1 or higher.</p>
<h3 id="workarounds">Workarounds</h3>
<p>No.</p>
<h3 id="references">References</h3>
<p>Issue is similar to <a href="https://nvd.nist.gov/vuln/detail/CVE-2025-22376">https://nvd.nist.gov/vuln/detail/CVE-2025-22376</a>.</p>
<h3 id="references-1">References</h3>
<ul>
<li><a href="https://github.com/guzzle/oauth-subscriber/security/advisories/GHSA-237r-r8m4-4q88">https://github.com/guzzle/oauth-subscriber/security/advisories/GHSA-237r-r8m4-4q88</a></li>
<li><a href="https://github.com/guzzle/oauth-subscriber/commit/92b619b03bd21396e51c62e6bce83467d2ce8f53">https://github.com/guzzle/oauth-subscriber/commit/92b619b03bd21396e51c62e6bce83467d2ce8f53</a></li>
<li><a href="https://github.com/guzzle/oauth-subscriber/blob/0.8.0/src/Oauth1.php#L192">https://github.com/guzzle/oauth-subscriber/blob/0.8.0/src/Oauth1.php#L192</a></li>
<li><a href="https://github.com/guzzle/oauth-subscriber/releases/tag/0.8.1">https://github.com/guzzle/oauth-subscriber/releases/tag/0.8.1</a></li>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2025-21617">https://nvd.nist.gov/vuln/detail/CVE-2025-21617</a></li>
<li><a href="https://github.com/advisories/GHSA-237r-r8m4-4q88">https://github.com/advisories/GHSA-237r-r8m4-4q88</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-237r-r8m4-4q88</uri>
        </author>
        <category label="severity" term="MODERATE"/>
        <published>2025-01-06T19:23:26.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[yetiforce/yetiforce-crm] YetiForceCRM Directory Traversal vulnerability]]></title>
        <id>https://github.com/advisories/GHSA-394m-vxwj-363j</id>
        <link href="https://github.com/advisories/GHSA-394m-vxwj-363j"/>
        <updated>2025-01-06T18:10:34.000Z</updated>
        <content type="html"><![CDATA[<p>Directory Traversal vulnerability in YetiForceCompany YetiForceCRM versions 6.4.0 and before allows a remote authenticated attacker to obtain sensitive information via the license parameter in the LibraryLicense.php component.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2023-49508">https://nvd.nist.gov/vuln/detail/CVE-2023-49508</a></li>
<li><a href="https://github.com/YetiForceCompany/YetiForceCRM/commit/ba3a348aa6ecdf0a1d8b289cbb679bebcda7a132">https://github.com/YetiForceCompany/YetiForceCRM/commit/ba3a348aa6ecdf0a1d8b289cbb679bebcda7a132</a></li>
<li><a href="https://github.com/c4v4r0n/Research/tree/main/CVE-2023-49508">https://github.com/c4v4r0n/Research/tree/main/CVE-2023-49508</a></li>
<li><a href="https://huntr.com/bounties/29ed641d-eb03-4532-aed4-f96e11f78983">https://huntr.com/bounties/29ed641d-eb03-4532-aed4-f96e11f78983</a></li>
<li><a href="https://github.com/advisories/GHSA-394m-vxwj-363j">https://github.com/advisories/GHSA-394m-vxwj-363j</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-394m-vxwj-363j</uri>
        </author>
        <category label="severity" term="MODERATE"/>
        <published>2024-02-16T09:30:25.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[starcitizentools/tabber-neue] Extension:TabberNeue vulnerable to Cross-site Scripting]]></title>
        <id>https://github.com/advisories/GHSA-4x6x-8rm8-c37j</id>
        <link href="https://github.com/advisories/GHSA-4x6x-8rm8-c37j"/>
        <updated>2025-01-06T18:42:32.000Z</updated>
        <content type="html"><![CDATA[<h3 id="summary">Summary</h3>
<p>There are several sources of arbitrary, unescaped user input being used to construct HTML, which allows any user that can edit pages or otherwise render wikitext to XSS other users.</p>
<blockquote>
<p>Edit: Only the first XSS can be reproduced in production.</p>
</blockquote>
<h3 id="details">Details</h3>
<blockquote>
<p>✅ Verified and patched in f229cab099c69006e25d4bad3579954e481dc566</p>
</blockquote>
<p><a href="https://github.com/StarCitizenTools/mediawiki-extensions-TabberNeue/blob/2526daa9f8cfdd616c861c8439755cb74a6c8c6e/includes/TabberTransclude.php#L154">https://github.com/StarCitizenTools/mediawiki-extensions-TabberNeue/blob/2526daa9f8cfdd616c861c8439755cb74a6c8c6e/includes/TabberTransclude.php#L154</a>
This doesn't escape the user-supplied page name when outputting, so an XSS payload as the page name can be used here.</p>
<p>This was caused by d8c3db4e5935476e496d979fb01f775d3d3282e6.</p>
<hr>
<blockquote>
<p>❌ Invalid as MediaWiki parser sanitizes dangerous HTML</p>
</blockquote>
<p><a href="https://github.com/StarCitizenTools/mediawiki-extensions-TabberNeue/blob/2526daa9f8cfdd616c861c8439755cb74a6c8c6e/includes/Tabber.php#L160">https://github.com/StarCitizenTools/mediawiki-extensions-TabberNeue/blob/2526daa9f8cfdd616c861c8439755cb74a6c8c6e/includes/Tabber.php#L160</a>
The documentation for <a href="https://doc.wikimedia.org/mediawiki-core/REL1_42/php/classMediaWiki_1_1Parser_1_1Parser.html#ae450036ec9abb417f142bfdaede02783"><code>Parser::recursiveTagParse()</code></a> states that it returns unsafe HTML, and the <code>$content</code> being supplied is from user input.</p>
<p>This was caused by 95351812613e04717f3ad7844cfcc67e4ede4d11.</p>
<hr>
<blockquote>
<p>❌ Invalid as TabberParsoid is not being used</p>
</blockquote>
<p><a href="https://github.com/StarCitizenTools/mediawiki-extensions-TabberNeue/blob/2526daa9f8cfdd616c861c8439755cb74a6c8c6e/includes/TabberParsoid.php#L96">https://github.com/StarCitizenTools/mediawiki-extensions-TabberNeue/blob/2526daa9f8cfdd616c861c8439755cb74a6c8c6e/includes/TabberParsoid.php#L96</a>
This uses unescaped user input as the attribute of an element, thus allowing the user to break out of the attribute or element and injecting arbitrary attributes to the element, or inserting new ones (such as a script tag).</p>
<p>This was caused by 8278e665480f08da635aee383c6b5caaeca26ba3.</p>
<h3 id="poc">PoC</h3>
<p>For the first XSS, render the following wikitext (whether it be through saving it to a page and viewing it, or via Special:ExpandTemplates):</p>
<pre><code class="language-wikitext">&lt;tabbertransclude&gt;
&lt;script&gt;alert(1)&lt;/script&gt; | hehe
&lt;/tabbertransclude&gt;
</code></pre>
<p><img alt="" src="https://github.com/user-attachments/assets/079365a9-203d-4758-a5a4-2166f9a32e62"></p>
<p>For the second XSS, I have given up attempting to reproduce it after over twenty minutes of "surfing through the internals of the MediaWiki parser fishing for an XSS out of this giant contraption as I bring myself deeper and deeper into the cogs of the machine that no one knows how to maintain or fully operate ever since its conception".</p>
<p>For the third XSS, this is unreachable as the class is never used, though it should be fixed anyway (or the file removed).</p>
<h3 id="impact">Impact</h3>
<p>Any user with the ability to cause another user to render wikitext (such as viewing a page that the user can edit, or an attacker tricking the victim to click on a link to Special:ExpandTemplates with the malicious wikitext in the <code>wpInput</code> parameter) can XSS said user.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/StarCitizenTools/mediawiki-extensions-TabberNeue/security/advisories/GHSA-4x6x-8rm8-c37j">https://github.com/StarCitizenTools/mediawiki-extensions-TabberNeue/security/advisories/GHSA-4x6x-8rm8-c37j</a></li>
<li><a href="https://github.com/StarCitizenTools/mediawiki-extensions-TabberNeue/commit/d8c3db4e5935476e496d979fb01f775d3d3282e6">https://github.com/StarCitizenTools/mediawiki-extensions-TabberNeue/commit/d8c3db4e5935476e496d979fb01f775d3d3282e6</a></li>
<li><a href="https://github.com/StarCitizenTools/mediawiki-extensions-TabberNeue/commit/f229cab099c69006e25d4bad3579954e481dc566">https://github.com/StarCitizenTools/mediawiki-extensions-TabberNeue/commit/f229cab099c69006e25d4bad3579954e481dc566</a></li>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2025-21612">https://nvd.nist.gov/vuln/detail/CVE-2025-21612</a></li>
<li><a href="https://github.com/advisories/GHSA-4x6x-8rm8-c37j">https://github.com/advisories/GHSA-4x6x-8rm8-c37j</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-4x6x-8rm8-c37j</uri>
        </author>
        <category label="severity" term="HIGH"/>
        <published>2025-01-06T15:47:49.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[phpoffice/phpspreadsheet] PhpSpreadsheet allows bypass XSS sanitizer using the javascript protocol and special characters]]></title>
        <id>https://github.com/advisories/GHSA-q9jv-mm3r-j47r</id>
        <link href="https://github.com/advisories/GHSA-q9jv-mm3r-j47r"/>
        <updated>2025-01-03T19:25:07.000Z</updated>
        <content type="html"><![CDATA[<h1 id="bypass-xss-sanitizer-using-the-javascript-protocol-and-special-characters">Bypass XSS sanitizer using the javascript protocol and special characters</h1>
<p><strong>Product</strong>: Phpspreadsheet
<strong>Version</strong>: version 3.6.0
<strong>CWE-ID</strong>: CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')
<strong>CVSS vector v.3.1</strong>: 5.4 (AV:N/AC:L/PR:L/UI:R/S:C/C:L/I:L/A:N)
<strong>CVSS vector v.4.0</strong>: 4.8 (AV:N/AC:L/AT:N/PR:L/UI:A/VC:L/VI:L/VA:N/SC:L/SI:L/SA:N)
<strong>Description</strong>: an attacker can use special characters, so that the library processes the javascript protocol with special characters and generates an HTML link
<strong>Impact</strong>: executing arbitrary JavaScript code in the browser
<strong>Vulnerable component</strong>: class <code>PhpOffice\PhpSpreadsheet\Writer\Html</code>, method <code>generateRow</code>
<strong>Exploitation conditions</strong>: a user viewing a specially generated Excel file
<strong>Mitigation</strong>: additional sanitization of special characters in a string
<strong>Researcher</strong>: Aleksey Solovev (Positive Technologies)</p>
<h1 id="research">Research</h1>
<p>The researcher discovered zero-day vulnerability Bypass XSS sanitizer using the javascript protocol and special characters in Phpspreadsheet.</p>
<p>The following code is written on the server, which translates the XLSX file into a HTML representation and displays it in the response.</p>
<p><em>Listing 6. Source code on the server</em></p>
<pre><code>&lt;?php

require __DIR__ . '/vendor/autoload.php';

$inputFileName = './doc/Book1.xlsx';
$spreadsheet = \PhpOffice\PhpSpreadsheet\IOFactory::load($inputFileName);
$writer = new \PhpOffice\PhpSpreadsheet\Writer\Html($spreadsheet);
print($writer-&gt;generateHTMLAll());
</code></pre>
<p>An attacker can use special characters so that this library processes the javascript protocol with special characters and generates a HTML link.
The Excel file is unpacked and a hyperlink in the file is inserted into the <code>xl/worksheets/sheet1.xml</code> file.</p>
<p><img alt="fig11" src="https://github.com/user-attachments/assets/b9d53f7a-6f36-4853-95f9-8aa22f81eccd"></p>
<p><em>Figure 11. Using the javascript protocol with special characters</em></p>
<p>Some payloads help bypass the security system and carry out a XSS attack.</p>
<p><em>Listing 7. HTML form that demonstrates the exploitation of the XSS vulnerability</em></p>
<pre><code>jav&amp;#x09;ascript:alert()
jav&amp;#x0D;ascript:alert()
jav&amp;#x0A;ascript:alert()
</code></pre>
<p>It's clear that the javascript protocol with special characters is used. </p>
<p><img alt="fig12" src="https://github.com/user-attachments/assets/7595e88b-9848-4251-845c-2c2d8032e479"></p>
<p><em>Figure 12. Using the javascript protocol with special characters</em></p>
<p>Due to the special characters, the execution stream ends up on line 1543, and the link is built in HTML form with the javascript protocol.</p>
<img src="https://github.com/user-attachments/assets/3ca0c3c6-daa9-4502-ad9e-b803f308fd26" alt="fig13" width="373">

<p><em>Figure 13. Executing arbitrary JavaScript code</em></p>
<h1 id="credit">Credit</h1>
<p>This vulnerability was discovered by <strong>Aleksey Solovev (Positive Technologies)</strong></p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/PHPOffice/PhpSpreadsheet/security/advisories/GHSA-q9jv-mm3r-j47r">https://github.com/PHPOffice/PhpSpreadsheet/security/advisories/GHSA-q9jv-mm3r-j47r</a></li>
<li><a href="https://github.com/PHPOffice/PhpSpreadsheet/commit/45052f88e04c735d56457a8ffcdc40b2635a028e">https://github.com/PHPOffice/PhpSpreadsheet/commit/45052f88e04c735d56457a8ffcdc40b2635a028e</a></li>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2024-56412">https://nvd.nist.gov/vuln/detail/CVE-2024-56412</a></li>
<li><a href="https://github.com/advisories/GHSA-q9jv-mm3r-j47r">https://github.com/advisories/GHSA-q9jv-mm3r-j47r</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-q9jv-mm3r-j47r</uri>
        </author>
        <category label="severity" term="MODERATE"/>
        <published>2025-01-03T17:29:10.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[phpoffice/phpspreadsheet] PhpSpreadsheet allows bypass XSS sanitizer using the javascript protocol and special characters]]></title>
        <id>https://github.com/advisories/GHSA-q9jv-mm3r-j47r</id>
        <link href="https://github.com/advisories/GHSA-q9jv-mm3r-j47r"/>
        <updated>2025-01-03T19:25:07.000Z</updated>
        <content type="html"><![CDATA[<h1 id="bypass-xss-sanitizer-using-the-javascript-protocol-and-special-characters">Bypass XSS sanitizer using the javascript protocol and special characters</h1>
<p><strong>Product</strong>: Phpspreadsheet
<strong>Version</strong>: version 3.6.0
<strong>CWE-ID</strong>: CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')
<strong>CVSS vector v.3.1</strong>: 5.4 (AV:N/AC:L/PR:L/UI:R/S:C/C:L/I:L/A:N)
<strong>CVSS vector v.4.0</strong>: 4.8 (AV:N/AC:L/AT:N/PR:L/UI:A/VC:L/VI:L/VA:N/SC:L/SI:L/SA:N)
<strong>Description</strong>: an attacker can use special characters, so that the library processes the javascript protocol with special characters and generates an HTML link
<strong>Impact</strong>: executing arbitrary JavaScript code in the browser
<strong>Vulnerable component</strong>: class <code>PhpOffice\PhpSpreadsheet\Writer\Html</code>, method <code>generateRow</code>
<strong>Exploitation conditions</strong>: a user viewing a specially generated Excel file
<strong>Mitigation</strong>: additional sanitization of special characters in a string
<strong>Researcher</strong>: Aleksey Solovev (Positive Technologies)</p>
<h1 id="research">Research</h1>
<p>The researcher discovered zero-day vulnerability Bypass XSS sanitizer using the javascript protocol and special characters in Phpspreadsheet.</p>
<p>The following code is written on the server, which translates the XLSX file into a HTML representation and displays it in the response.</p>
<p><em>Listing 6. Source code on the server</em></p>
<pre><code>&lt;?php

require __DIR__ . '/vendor/autoload.php';

$inputFileName = './doc/Book1.xlsx';
$spreadsheet = \PhpOffice\PhpSpreadsheet\IOFactory::load($inputFileName);
$writer = new \PhpOffice\PhpSpreadsheet\Writer\Html($spreadsheet);
print($writer-&gt;generateHTMLAll());
</code></pre>
<p>An attacker can use special characters so that this library processes the javascript protocol with special characters and generates a HTML link.
The Excel file is unpacked and a hyperlink in the file is inserted into the <code>xl/worksheets/sheet1.xml</code> file.</p>
<p><img alt="fig11" src="https://github.com/user-attachments/assets/b9d53f7a-6f36-4853-95f9-8aa22f81eccd"></p>
<p><em>Figure 11. Using the javascript protocol with special characters</em></p>
<p>Some payloads help bypass the security system and carry out a XSS attack.</p>
<p><em>Listing 7. HTML form that demonstrates the exploitation of the XSS vulnerability</em></p>
<pre><code>jav&amp;#x09;ascript:alert()
jav&amp;#x0D;ascript:alert()
jav&amp;#x0A;ascript:alert()
</code></pre>
<p>It's clear that the javascript protocol with special characters is used. </p>
<p><img alt="fig12" src="https://github.com/user-attachments/assets/7595e88b-9848-4251-845c-2c2d8032e479"></p>
<p><em>Figure 12. Using the javascript protocol with special characters</em></p>
<p>Due to the special characters, the execution stream ends up on line 1543, and the link is built in HTML form with the javascript protocol.</p>
<img src="https://github.com/user-attachments/assets/3ca0c3c6-daa9-4502-ad9e-b803f308fd26" alt="fig13" width="373">

<p><em>Figure 13. Executing arbitrary JavaScript code</em></p>
<h1 id="credit">Credit</h1>
<p>This vulnerability was discovered by <strong>Aleksey Solovev (Positive Technologies)</strong></p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/PHPOffice/PhpSpreadsheet/security/advisories/GHSA-q9jv-mm3r-j47r">https://github.com/PHPOffice/PhpSpreadsheet/security/advisories/GHSA-q9jv-mm3r-j47r</a></li>
<li><a href="https://github.com/PHPOffice/PhpSpreadsheet/commit/45052f88e04c735d56457a8ffcdc40b2635a028e">https://github.com/PHPOffice/PhpSpreadsheet/commit/45052f88e04c735d56457a8ffcdc40b2635a028e</a></li>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2024-56412">https://nvd.nist.gov/vuln/detail/CVE-2024-56412</a></li>
<li><a href="https://github.com/advisories/GHSA-q9jv-mm3r-j47r">https://github.com/advisories/GHSA-q9jv-mm3r-j47r</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-q9jv-mm3r-j47r</uri>
        </author>
        <category label="severity" term="MODERATE"/>
        <published>2025-01-03T17:29:10.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[phpoffice/phpspreadsheet] PhpSpreadsheet allows bypass XSS sanitizer using the javascript protocol and special characters]]></title>
        <id>https://github.com/advisories/GHSA-q9jv-mm3r-j47r</id>
        <link href="https://github.com/advisories/GHSA-q9jv-mm3r-j47r"/>
        <updated>2025-01-03T19:25:07.000Z</updated>
        <content type="html"><![CDATA[<h1 id="bypass-xss-sanitizer-using-the-javascript-protocol-and-special-characters">Bypass XSS sanitizer using the javascript protocol and special characters</h1>
<p><strong>Product</strong>: Phpspreadsheet
<strong>Version</strong>: version 3.6.0
<strong>CWE-ID</strong>: CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')
<strong>CVSS vector v.3.1</strong>: 5.4 (AV:N/AC:L/PR:L/UI:R/S:C/C:L/I:L/A:N)
<strong>CVSS vector v.4.0</strong>: 4.8 (AV:N/AC:L/AT:N/PR:L/UI:A/VC:L/VI:L/VA:N/SC:L/SI:L/SA:N)
<strong>Description</strong>: an attacker can use special characters, so that the library processes the javascript protocol with special characters and generates an HTML link
<strong>Impact</strong>: executing arbitrary JavaScript code in the browser
<strong>Vulnerable component</strong>: class <code>PhpOffice\PhpSpreadsheet\Writer\Html</code>, method <code>generateRow</code>
<strong>Exploitation conditions</strong>: a user viewing a specially generated Excel file
<strong>Mitigation</strong>: additional sanitization of special characters in a string
<strong>Researcher</strong>: Aleksey Solovev (Positive Technologies)</p>
<h1 id="research">Research</h1>
<p>The researcher discovered zero-day vulnerability Bypass XSS sanitizer using the javascript protocol and special characters in Phpspreadsheet.</p>
<p>The following code is written on the server, which translates the XLSX file into a HTML representation and displays it in the response.</p>
<p><em>Listing 6. Source code on the server</em></p>
<pre><code>&lt;?php

require __DIR__ . '/vendor/autoload.php';

$inputFileName = './doc/Book1.xlsx';
$spreadsheet = \PhpOffice\PhpSpreadsheet\IOFactory::load($inputFileName);
$writer = new \PhpOffice\PhpSpreadsheet\Writer\Html($spreadsheet);
print($writer-&gt;generateHTMLAll());
</code></pre>
<p>An attacker can use special characters so that this library processes the javascript protocol with special characters and generates a HTML link.
The Excel file is unpacked and a hyperlink in the file is inserted into the <code>xl/worksheets/sheet1.xml</code> file.</p>
<p><img alt="fig11" src="https://github.com/user-attachments/assets/b9d53f7a-6f36-4853-95f9-8aa22f81eccd"></p>
<p><em>Figure 11. Using the javascript protocol with special characters</em></p>
<p>Some payloads help bypass the security system and carry out a XSS attack.</p>
<p><em>Listing 7. HTML form that demonstrates the exploitation of the XSS vulnerability</em></p>
<pre><code>jav&amp;#x09;ascript:alert()
jav&amp;#x0D;ascript:alert()
jav&amp;#x0A;ascript:alert()
</code></pre>
<p>It's clear that the javascript protocol with special characters is used. </p>
<p><img alt="fig12" src="https://github.com/user-attachments/assets/7595e88b-9848-4251-845c-2c2d8032e479"></p>
<p><em>Figure 12. Using the javascript protocol with special characters</em></p>
<p>Due to the special characters, the execution stream ends up on line 1543, and the link is built in HTML form with the javascript protocol.</p>
<img src="https://github.com/user-attachments/assets/3ca0c3c6-daa9-4502-ad9e-b803f308fd26" alt="fig13" width="373">

<p><em>Figure 13. Executing arbitrary JavaScript code</em></p>
<h1 id="credit">Credit</h1>
<p>This vulnerability was discovered by <strong>Aleksey Solovev (Positive Technologies)</strong></p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/PHPOffice/PhpSpreadsheet/security/advisories/GHSA-q9jv-mm3r-j47r">https://github.com/PHPOffice/PhpSpreadsheet/security/advisories/GHSA-q9jv-mm3r-j47r</a></li>
<li><a href="https://github.com/PHPOffice/PhpSpreadsheet/commit/45052f88e04c735d56457a8ffcdc40b2635a028e">https://github.com/PHPOffice/PhpSpreadsheet/commit/45052f88e04c735d56457a8ffcdc40b2635a028e</a></li>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2024-56412">https://nvd.nist.gov/vuln/detail/CVE-2024-56412</a></li>
<li><a href="https://github.com/advisories/GHSA-q9jv-mm3r-j47r">https://github.com/advisories/GHSA-q9jv-mm3r-j47r</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-q9jv-mm3r-j47r</uri>
        </author>
        <category label="severity" term="MODERATE"/>
        <published>2025-01-03T17:29:10.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[phpoffice/phpspreadsheet] PhpSpreadsheet allows bypass XSS sanitizer using the javascript protocol and special characters]]></title>
        <id>https://github.com/advisories/GHSA-q9jv-mm3r-j47r</id>
        <link href="https://github.com/advisories/GHSA-q9jv-mm3r-j47r"/>
        <updated>2025-01-03T19:25:07.000Z</updated>
        <content type="html"><![CDATA[<h1 id="bypass-xss-sanitizer-using-the-javascript-protocol-and-special-characters">Bypass XSS sanitizer using the javascript protocol and special characters</h1>
<p><strong>Product</strong>: Phpspreadsheet
<strong>Version</strong>: version 3.6.0
<strong>CWE-ID</strong>: CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')
<strong>CVSS vector v.3.1</strong>: 5.4 (AV:N/AC:L/PR:L/UI:R/S:C/C:L/I:L/A:N)
<strong>CVSS vector v.4.0</strong>: 4.8 (AV:N/AC:L/AT:N/PR:L/UI:A/VC:L/VI:L/VA:N/SC:L/SI:L/SA:N)
<strong>Description</strong>: an attacker can use special characters, so that the library processes the javascript protocol with special characters and generates an HTML link
<strong>Impact</strong>: executing arbitrary JavaScript code in the browser
<strong>Vulnerable component</strong>: class <code>PhpOffice\PhpSpreadsheet\Writer\Html</code>, method <code>generateRow</code>
<strong>Exploitation conditions</strong>: a user viewing a specially generated Excel file
<strong>Mitigation</strong>: additional sanitization of special characters in a string
<strong>Researcher</strong>: Aleksey Solovev (Positive Technologies)</p>
<h1 id="research">Research</h1>
<p>The researcher discovered zero-day vulnerability Bypass XSS sanitizer using the javascript protocol and special characters in Phpspreadsheet.</p>
<p>The following code is written on the server, which translates the XLSX file into a HTML representation and displays it in the response.</p>
<p><em>Listing 6. Source code on the server</em></p>
<pre><code>&lt;?php

require __DIR__ . '/vendor/autoload.php';

$inputFileName = './doc/Book1.xlsx';
$spreadsheet = \PhpOffice\PhpSpreadsheet\IOFactory::load($inputFileName);
$writer = new \PhpOffice\PhpSpreadsheet\Writer\Html($spreadsheet);
print($writer-&gt;generateHTMLAll());
</code></pre>
<p>An attacker can use special characters so that this library processes the javascript protocol with special characters and generates a HTML link.
The Excel file is unpacked and a hyperlink in the file is inserted into the <code>xl/worksheets/sheet1.xml</code> file.</p>
<p><img alt="fig11" src="https://github.com/user-attachments/assets/b9d53f7a-6f36-4853-95f9-8aa22f81eccd"></p>
<p><em>Figure 11. Using the javascript protocol with special characters</em></p>
<p>Some payloads help bypass the security system and carry out a XSS attack.</p>
<p><em>Listing 7. HTML form that demonstrates the exploitation of the XSS vulnerability</em></p>
<pre><code>jav&amp;#x09;ascript:alert()
jav&amp;#x0D;ascript:alert()
jav&amp;#x0A;ascript:alert()
</code></pre>
<p>It's clear that the javascript protocol with special characters is used. </p>
<p><img alt="fig12" src="https://github.com/user-attachments/assets/7595e88b-9848-4251-845c-2c2d8032e479"></p>
<p><em>Figure 12. Using the javascript protocol with special characters</em></p>
<p>Due to the special characters, the execution stream ends up on line 1543, and the link is built in HTML form with the javascript protocol.</p>
<img src="https://github.com/user-attachments/assets/3ca0c3c6-daa9-4502-ad9e-b803f308fd26" alt="fig13" width="373">

<p><em>Figure 13. Executing arbitrary JavaScript code</em></p>
<h1 id="credit">Credit</h1>
<p>This vulnerability was discovered by <strong>Aleksey Solovev (Positive Technologies)</strong></p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/PHPOffice/PhpSpreadsheet/security/advisories/GHSA-q9jv-mm3r-j47r">https://github.com/PHPOffice/PhpSpreadsheet/security/advisories/GHSA-q9jv-mm3r-j47r</a></li>
<li><a href="https://github.com/PHPOffice/PhpSpreadsheet/commit/45052f88e04c735d56457a8ffcdc40b2635a028e">https://github.com/PHPOffice/PhpSpreadsheet/commit/45052f88e04c735d56457a8ffcdc40b2635a028e</a></li>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2024-56412">https://nvd.nist.gov/vuln/detail/CVE-2024-56412</a></li>
<li><a href="https://github.com/advisories/GHSA-q9jv-mm3r-j47r">https://github.com/advisories/GHSA-q9jv-mm3r-j47r</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-q9jv-mm3r-j47r</uri>
        </author>
        <category label="severity" term="MODERATE"/>
        <published>2025-01-03T17:29:10.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[phpoffice/phpspreadsheet] PhpSpreadsheet has a Cross-Site Scripting (XSS) vulnerability of the hyperlink base in the HTML page header]]></title>
        <id>https://github.com/advisories/GHSA-hwcp-2h35-p66w</id>
        <link href="https://github.com/advisories/GHSA-hwcp-2h35-p66w"/>
        <updated>2025-01-03T19:24:57.000Z</updated>
        <content type="html"><![CDATA[<h1 id="cross-site-scripting-xss-vulnerability-of-the-hyperlink-base-in-the-html-page-header">Cross-Site Scripting (XSS) vulnerability of the hyperlink base in the HTML page header</h1>
<p><strong>Product</strong>: Phpspreadsheet
<strong>Version</strong>: version 3.6.0
<strong>CWE-ID</strong>: CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')
<strong>CVSS vector v.3.1</strong>: 5.4 (AV:N/AC:L/PR:L/UI:R/S:C/C:L/I:L/A:N)
<strong>CVSS vector v.4.0</strong>: 4.8 (AV:N/AC:L/AT:N/PR:L/UI:A/VC:L/VI:L/VA:N/SC:L/SI:L/SA:N)
<strong>Description</strong>: the HTML page is formed without sanitizing the hyperlink base
<strong>Impact</strong>: executing arbitrary JavaScript code in the browser
<strong>Vulnerable component</strong>: class <code>PhpOffice\PhpSpreadsheet\Writer\Html</code>, method <code>generateHTMLHeader</code>
<strong>Exploitation conditions</strong>: a user viewing a specially generated Excel file
<strong>Mitigation</strong>: additional sanitization of special characters in a string
<strong>Researcher</strong>: Aleksey Solovev (Positive Technologies)</p>
<h1 id="research">Research</h1>
<p>The researcher discovered zero-day vulnerability Cross-Site Scripting (XSS) vulnerability of the hyperlink base in the HTML page header in Phpspreadsheet.
The following code is written on the server, which translates the XLSX file into a HTML representation and displays it in the response.</p>
<p><em>Listing 8. Source code on the server</em></p>
<pre><code>&lt;?php

require __DIR__ . '/vendor/autoload.php';

$inputFileName = './doc/Book1.xlsx';
$spreadsheet = \PhpOffice\PhpSpreadsheet\IOFactory::load($inputFileName);
$writer = new \PhpOffice\PhpSpreadsheet\Writer\Html($spreadsheet);
print($writer-&gt;generateHTMLAll());
</code></pre>
<p>An attacker can embed a payload in a file property that will result in the execution of arbitrary JavaScript code.
The Excel file is unpacked and a HyperlinkBase in the file is inserted into the <code>docProps/app.xml</code> file.</p>
<p><img alt="fig14" src="https://github.com/user-attachments/assets/f68ef7fc-e78e-4424-8753-4318b6ff51c3"></p>
<p><em>Figure 14. Embedding the payload</em> </p>
<p>After the changes were made, a new archive with the xlsx extension was created. At the moment of converting the xlsx file into the HTML representation, a property is obtained that participates in the formation of a string without sanitization.</p>
<p><img alt="fig15" src="https://github.com/user-attachments/assets/0aa7398c-ddd9-4c5a-ab04-41af0236dcba"></p>
<p><em>Figure 15. Generating the HTML page header using the HyperlinkBase property</em> </p>
<p>After generating and displaying the HTML representation of the XLSX file, arbitrary JavaScript code will be executed.
<img src="https://github.com/user-attachments/assets/c3694661-31e3-4be8-9a86-6eb4dd4647b5" alt="fig16" width="356"></p>
<p><em>Figure 16. Executing arbitrary JavaScript code</em> </p>
<h1 id="credit">Credit</h1>
<p>This vulnerability was discovered by <strong>Aleksey Solovev (Positive Technologies)</strong></p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/PHPOffice/PhpSpreadsheet/security/advisories/GHSA-hwcp-2h35-p66w">https://github.com/PHPOffice/PhpSpreadsheet/security/advisories/GHSA-hwcp-2h35-p66w</a></li>
<li><a href="https://github.com/PHPOffice/PhpSpreadsheet/commit/45052f88e04c735d56457a8ffcdc40b2635a028e">https://github.com/PHPOffice/PhpSpreadsheet/commit/45052f88e04c735d56457a8ffcdc40b2635a028e</a></li>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2024-56411">https://nvd.nist.gov/vuln/detail/CVE-2024-56411</a></li>
<li><a href="https://github.com/advisories/GHSA-hwcp-2h35-p66w">https://github.com/advisories/GHSA-hwcp-2h35-p66w</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-hwcp-2h35-p66w</uri>
        </author>
        <category label="severity" term="MODERATE"/>
        <published>2025-01-03T17:28:50.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[phpoffice/phpspreadsheet] PhpSpreadsheet has a Cross-Site Scripting (XSS) vulnerability of the hyperlink base in the HTML page header]]></title>
        <id>https://github.com/advisories/GHSA-hwcp-2h35-p66w</id>
        <link href="https://github.com/advisories/GHSA-hwcp-2h35-p66w"/>
        <updated>2025-01-03T19:24:57.000Z</updated>
        <content type="html"><![CDATA[<h1 id="cross-site-scripting-xss-vulnerability-of-the-hyperlink-base-in-the-html-page-header">Cross-Site Scripting (XSS) vulnerability of the hyperlink base in the HTML page header</h1>
<p><strong>Product</strong>: Phpspreadsheet
<strong>Version</strong>: version 3.6.0
<strong>CWE-ID</strong>: CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')
<strong>CVSS vector v.3.1</strong>: 5.4 (AV:N/AC:L/PR:L/UI:R/S:C/C:L/I:L/A:N)
<strong>CVSS vector v.4.0</strong>: 4.8 (AV:N/AC:L/AT:N/PR:L/UI:A/VC:L/VI:L/VA:N/SC:L/SI:L/SA:N)
<strong>Description</strong>: the HTML page is formed without sanitizing the hyperlink base
<strong>Impact</strong>: executing arbitrary JavaScript code in the browser
<strong>Vulnerable component</strong>: class <code>PhpOffice\PhpSpreadsheet\Writer\Html</code>, method <code>generateHTMLHeader</code>
<strong>Exploitation conditions</strong>: a user viewing a specially generated Excel file
<strong>Mitigation</strong>: additional sanitization of special characters in a string
<strong>Researcher</strong>: Aleksey Solovev (Positive Technologies)</p>
<h1 id="research">Research</h1>
<p>The researcher discovered zero-day vulnerability Cross-Site Scripting (XSS) vulnerability of the hyperlink base in the HTML page header in Phpspreadsheet.
The following code is written on the server, which translates the XLSX file into a HTML representation and displays it in the response.</p>
<p><em>Listing 8. Source code on the server</em></p>
<pre><code>&lt;?php

require __DIR__ . '/vendor/autoload.php';

$inputFileName = './doc/Book1.xlsx';
$spreadsheet = \PhpOffice\PhpSpreadsheet\IOFactory::load($inputFileName);
$writer = new \PhpOffice\PhpSpreadsheet\Writer\Html($spreadsheet);
print($writer-&gt;generateHTMLAll());
</code></pre>
<p>An attacker can embed a payload in a file property that will result in the execution of arbitrary JavaScript code.
The Excel file is unpacked and a HyperlinkBase in the file is inserted into the <code>docProps/app.xml</code> file.</p>
<p><img alt="fig14" src="https://github.com/user-attachments/assets/f68ef7fc-e78e-4424-8753-4318b6ff51c3"></p>
<p><em>Figure 14. Embedding the payload</em> </p>
<p>After the changes were made, a new archive with the xlsx extension was created. At the moment of converting the xlsx file into the HTML representation, a property is obtained that participates in the formation of a string without sanitization.</p>
<p><img alt="fig15" src="https://github.com/user-attachments/assets/0aa7398c-ddd9-4c5a-ab04-41af0236dcba"></p>
<p><em>Figure 15. Generating the HTML page header using the HyperlinkBase property</em> </p>
<p>After generating and displaying the HTML representation of the XLSX file, arbitrary JavaScript code will be executed.
<img src="https://github.com/user-attachments/assets/c3694661-31e3-4be8-9a86-6eb4dd4647b5" alt="fig16" width="356"></p>
<p><em>Figure 16. Executing arbitrary JavaScript code</em> </p>
<h1 id="credit">Credit</h1>
<p>This vulnerability was discovered by <strong>Aleksey Solovev (Positive Technologies)</strong></p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/PHPOffice/PhpSpreadsheet/security/advisories/GHSA-hwcp-2h35-p66w">https://github.com/PHPOffice/PhpSpreadsheet/security/advisories/GHSA-hwcp-2h35-p66w</a></li>
<li><a href="https://github.com/PHPOffice/PhpSpreadsheet/commit/45052f88e04c735d56457a8ffcdc40b2635a028e">https://github.com/PHPOffice/PhpSpreadsheet/commit/45052f88e04c735d56457a8ffcdc40b2635a028e</a></li>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2024-56411">https://nvd.nist.gov/vuln/detail/CVE-2024-56411</a></li>
<li><a href="https://github.com/advisories/GHSA-hwcp-2h35-p66w">https://github.com/advisories/GHSA-hwcp-2h35-p66w</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-hwcp-2h35-p66w</uri>
        </author>
        <category label="severity" term="MODERATE"/>
        <published>2025-01-03T17:28:50.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[phpoffice/phpspreadsheet] PhpSpreadsheet has a Cross-Site Scripting (XSS) vulnerability of the hyperlink base in the HTML page header]]></title>
        <id>https://github.com/advisories/GHSA-hwcp-2h35-p66w</id>
        <link href="https://github.com/advisories/GHSA-hwcp-2h35-p66w"/>
        <updated>2025-01-03T19:24:57.000Z</updated>
        <content type="html"><![CDATA[<h1 id="cross-site-scripting-xss-vulnerability-of-the-hyperlink-base-in-the-html-page-header">Cross-Site Scripting (XSS) vulnerability of the hyperlink base in the HTML page header</h1>
<p><strong>Product</strong>: Phpspreadsheet
<strong>Version</strong>: version 3.6.0
<strong>CWE-ID</strong>: CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')
<strong>CVSS vector v.3.1</strong>: 5.4 (AV:N/AC:L/PR:L/UI:R/S:C/C:L/I:L/A:N)
<strong>CVSS vector v.4.0</strong>: 4.8 (AV:N/AC:L/AT:N/PR:L/UI:A/VC:L/VI:L/VA:N/SC:L/SI:L/SA:N)
<strong>Description</strong>: the HTML page is formed without sanitizing the hyperlink base
<strong>Impact</strong>: executing arbitrary JavaScript code in the browser
<strong>Vulnerable component</strong>: class <code>PhpOffice\PhpSpreadsheet\Writer\Html</code>, method <code>generateHTMLHeader</code>
<strong>Exploitation conditions</strong>: a user viewing a specially generated Excel file
<strong>Mitigation</strong>: additional sanitization of special characters in a string
<strong>Researcher</strong>: Aleksey Solovev (Positive Technologies)</p>
<h1 id="research">Research</h1>
<p>The researcher discovered zero-day vulnerability Cross-Site Scripting (XSS) vulnerability of the hyperlink base in the HTML page header in Phpspreadsheet.
The following code is written on the server, which translates the XLSX file into a HTML representation and displays it in the response.</p>
<p><em>Listing 8. Source code on the server</em></p>
<pre><code>&lt;?php

require __DIR__ . '/vendor/autoload.php';

$inputFileName = './doc/Book1.xlsx';
$spreadsheet = \PhpOffice\PhpSpreadsheet\IOFactory::load($inputFileName);
$writer = new \PhpOffice\PhpSpreadsheet\Writer\Html($spreadsheet);
print($writer-&gt;generateHTMLAll());
</code></pre>
<p>An attacker can embed a payload in a file property that will result in the execution of arbitrary JavaScript code.
The Excel file is unpacked and a HyperlinkBase in the file is inserted into the <code>docProps/app.xml</code> file.</p>
<p><img alt="fig14" src="https://github.com/user-attachments/assets/f68ef7fc-e78e-4424-8753-4318b6ff51c3"></p>
<p><em>Figure 14. Embedding the payload</em> </p>
<p>After the changes were made, a new archive with the xlsx extension was created. At the moment of converting the xlsx file into the HTML representation, a property is obtained that participates in the formation of a string without sanitization.</p>
<p><img alt="fig15" src="https://github.com/user-attachments/assets/0aa7398c-ddd9-4c5a-ab04-41af0236dcba"></p>
<p><em>Figure 15. Generating the HTML page header using the HyperlinkBase property</em> </p>
<p>After generating and displaying the HTML representation of the XLSX file, arbitrary JavaScript code will be executed.
<img src="https://github.com/user-attachments/assets/c3694661-31e3-4be8-9a86-6eb4dd4647b5" alt="fig16" width="356"></p>
<p><em>Figure 16. Executing arbitrary JavaScript code</em> </p>
<h1 id="credit">Credit</h1>
<p>This vulnerability was discovered by <strong>Aleksey Solovev (Positive Technologies)</strong></p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/PHPOffice/PhpSpreadsheet/security/advisories/GHSA-hwcp-2h35-p66w">https://github.com/PHPOffice/PhpSpreadsheet/security/advisories/GHSA-hwcp-2h35-p66w</a></li>
<li><a href="https://github.com/PHPOffice/PhpSpreadsheet/commit/45052f88e04c735d56457a8ffcdc40b2635a028e">https://github.com/PHPOffice/PhpSpreadsheet/commit/45052f88e04c735d56457a8ffcdc40b2635a028e</a></li>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2024-56411">https://nvd.nist.gov/vuln/detail/CVE-2024-56411</a></li>
<li><a href="https://github.com/advisories/GHSA-hwcp-2h35-p66w">https://github.com/advisories/GHSA-hwcp-2h35-p66w</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-hwcp-2h35-p66w</uri>
        </author>
        <category label="severity" term="MODERATE"/>
        <published>2025-01-03T17:28:50.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[phpoffice/phpspreadsheet] PhpSpreadsheet has a Cross-Site Scripting (XSS) vulnerability of the hyperlink base in the HTML page header]]></title>
        <id>https://github.com/advisories/GHSA-hwcp-2h35-p66w</id>
        <link href="https://github.com/advisories/GHSA-hwcp-2h35-p66w"/>
        <updated>2025-01-03T19:24:57.000Z</updated>
        <content type="html"><![CDATA[<h1 id="cross-site-scripting-xss-vulnerability-of-the-hyperlink-base-in-the-html-page-header">Cross-Site Scripting (XSS) vulnerability of the hyperlink base in the HTML page header</h1>
<p><strong>Product</strong>: Phpspreadsheet
<strong>Version</strong>: version 3.6.0
<strong>CWE-ID</strong>: CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')
<strong>CVSS vector v.3.1</strong>: 5.4 (AV:N/AC:L/PR:L/UI:R/S:C/C:L/I:L/A:N)
<strong>CVSS vector v.4.0</strong>: 4.8 (AV:N/AC:L/AT:N/PR:L/UI:A/VC:L/VI:L/VA:N/SC:L/SI:L/SA:N)
<strong>Description</strong>: the HTML page is formed without sanitizing the hyperlink base
<strong>Impact</strong>: executing arbitrary JavaScript code in the browser
<strong>Vulnerable component</strong>: class <code>PhpOffice\PhpSpreadsheet\Writer\Html</code>, method <code>generateHTMLHeader</code>
<strong>Exploitation conditions</strong>: a user viewing a specially generated Excel file
<strong>Mitigation</strong>: additional sanitization of special characters in a string
<strong>Researcher</strong>: Aleksey Solovev (Positive Technologies)</p>
<h1 id="research">Research</h1>
<p>The researcher discovered zero-day vulnerability Cross-Site Scripting (XSS) vulnerability of the hyperlink base in the HTML page header in Phpspreadsheet.
The following code is written on the server, which translates the XLSX file into a HTML representation and displays it in the response.</p>
<p><em>Listing 8. Source code on the server</em></p>
<pre><code>&lt;?php

require __DIR__ . '/vendor/autoload.php';

$inputFileName = './doc/Book1.xlsx';
$spreadsheet = \PhpOffice\PhpSpreadsheet\IOFactory::load($inputFileName);
$writer = new \PhpOffice\PhpSpreadsheet\Writer\Html($spreadsheet);
print($writer-&gt;generateHTMLAll());
</code></pre>
<p>An attacker can embed a payload in a file property that will result in the execution of arbitrary JavaScript code.
The Excel file is unpacked and a HyperlinkBase in the file is inserted into the <code>docProps/app.xml</code> file.</p>
<p><img alt="fig14" src="https://github.com/user-attachments/assets/f68ef7fc-e78e-4424-8753-4318b6ff51c3"></p>
<p><em>Figure 14. Embedding the payload</em> </p>
<p>After the changes were made, a new archive with the xlsx extension was created. At the moment of converting the xlsx file into the HTML representation, a property is obtained that participates in the formation of a string without sanitization.</p>
<p><img alt="fig15" src="https://github.com/user-attachments/assets/0aa7398c-ddd9-4c5a-ab04-41af0236dcba"></p>
<p><em>Figure 15. Generating the HTML page header using the HyperlinkBase property</em> </p>
<p>After generating and displaying the HTML representation of the XLSX file, arbitrary JavaScript code will be executed.
<img src="https://github.com/user-attachments/assets/c3694661-31e3-4be8-9a86-6eb4dd4647b5" alt="fig16" width="356"></p>
<p><em>Figure 16. Executing arbitrary JavaScript code</em> </p>
<h1 id="credit">Credit</h1>
<p>This vulnerability was discovered by <strong>Aleksey Solovev (Positive Technologies)</strong></p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/PHPOffice/PhpSpreadsheet/security/advisories/GHSA-hwcp-2h35-p66w">https://github.com/PHPOffice/PhpSpreadsheet/security/advisories/GHSA-hwcp-2h35-p66w</a></li>
<li><a href="https://github.com/PHPOffice/PhpSpreadsheet/commit/45052f88e04c735d56457a8ffcdc40b2635a028e">https://github.com/PHPOffice/PhpSpreadsheet/commit/45052f88e04c735d56457a8ffcdc40b2635a028e</a></li>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2024-56411">https://nvd.nist.gov/vuln/detail/CVE-2024-56411</a></li>
<li><a href="https://github.com/advisories/GHSA-hwcp-2h35-p66w">https://github.com/advisories/GHSA-hwcp-2h35-p66w</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-hwcp-2h35-p66w</uri>
        </author>
        <category label="severity" term="MODERATE"/>
        <published>2025-01-03T17:28:50.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[phpoffice/phpspreadsheet] PhpSpreadsheet has a Cross-Site Scripting (XSS) vulnerability in custom properties]]></title>
        <id>https://github.com/advisories/GHSA-wv23-996v-q229</id>
        <link href="https://github.com/advisories/GHSA-wv23-996v-q229"/>
        <updated>2025-01-03T20:12:10.000Z</updated>
        <content type="html"><![CDATA[<h1 id="cross-site-scripting-xss-vulnerability-in-custom-properties">Cross-Site Scripting (XSS) vulnerability in custom properties</h1>
<p><strong>Product</strong>: Phpspreadsheet
<strong>Version</strong>: version 3.6.0
<strong>CWE-ID</strong>: CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')
<strong>CVSS vector v.3.1</strong>: 5.4 (AV:N/AC:L/PR:L/UI:R/S:C/C:L/I:L/A:N)
<strong>CVSS vector v.4.0</strong>: 4.8 (AV:N/AC:L/AT:N/PR:L/UI:A/VC:L/VI:L/VA:N/SC:L/SI:L/SA:N)
<strong>Description</strong>: the HTML page is generated without clearing custom properties
<strong>Impact</strong>: executing arbitrary JavaScript code in the browser
<strong>Vulnerable component</strong>: class <code>PhpOffice\PhpSpreadsheet\Writer\Html</code>, method <code>generateMeta</code>
<strong>Exploitation conditions</strong>: a user viewing a specially generated Excel file
<strong>Mitigation</strong>: additional sanitization of special characters in a string
<strong>Researcher</strong>: Aleksey Solovev (Positive Technologies)</p>
<h1 id="research">Research</h1>
<p>The researcher discovered zero-day vulnerability Cross-Site Scripting (XSS) vulnerability in custom properties in Phpspreadsheet.
The following code is written on the server, which translates the XLSX file into a HTML representation and displays it in the response.</p>
<p><em>Listing 9. Source code on the server</em></p>
<pre><code>&lt;?php

require __DIR__ . '/vendor/autoload.php';

$inputFileName = './doc/Book1.xlsx';
$spreadsheet = \PhpOffice\PhpSpreadsheet\IOFactory::load($inputFileName);
$writer = new \PhpOffice\PhpSpreadsheet\Writer\Html($spreadsheet);
print($writer-&gt;generateHTMLAll());
</code></pre>
<p>An attacker can embed a payload in a file property that will result in the execution of arbitrary JavaScript code.
The Excel file is unpacked and a custom property in the file is inserted into the <code>docProps/custom.xml</code> file.</p>
<p><img alt="fig17" src="https://github.com/user-attachments/assets/65453b48-bca5-4f5c-a683-315a7bb1ab1f"></p>
<p><em>Figure 17. Embedding the payload</em></p>
<p>After making the changes, a new archive with the xlsx extension was created. At the moment of converting the xlsx file into an HTML representation, a property is obtained that participates in the formation of a string without sanitization.</p>
<p><img alt="fig18" src="https://github.com/user-attachments/assets/e0f63bfb-d9e1-4c9d-a2a9-8a0a20406cdc"></p>
<p><em>Figure 18. Getting a custom property</em></p>
<p>When calling the static <code>generateMeta</code> method, you can see that the key of the custom property is displayed without sanitization.</p>
<p><img alt="fig19" src="https://github.com/user-attachments/assets/8c74e264-af68-4f62-8ac7-437e65884e86"></p>
<p><em>Figure 19. Getting a custom property</em></p>
<p>As a result, when viewing the excel file as the HTML representation, arbitrary JavaScript code will be executed.</p>
<img src="https://github.com/user-attachments/assets/a6ed21e3-685c-415c-b2dc-453bc0652bef" alt="fig20" width="356">

<p><em>Figure 20. Executing arbitrary JavaScript code</em></p>
<h1 id="credit">Credit</h1>
<p>This vulnerability was discovered by <strong>Aleksey Solovev (Positive Technologies)</strong></p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/PHPOffice/PhpSpreadsheet/security/advisories/GHSA-wv23-996v-q229">https://github.com/PHPOffice/PhpSpreadsheet/security/advisories/GHSA-wv23-996v-q229</a></li>
<li><a href="https://github.com/PHPOffice/PhpSpreadsheet/commit/45052f88e04c735d56457a8ffcdc40b2635a028e">https://github.com/PHPOffice/PhpSpreadsheet/commit/45052f88e04c735d56457a8ffcdc40b2635a028e</a></li>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2024-56410">https://nvd.nist.gov/vuln/detail/CVE-2024-56410</a></li>
<li><a href="https://github.com/advisories/GHSA-wv23-996v-q229">https://github.com/advisories/GHSA-wv23-996v-q229</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-wv23-996v-q229</uri>
        </author>
        <category label="severity" term="MODERATE"/>
        <published>2025-01-03T17:25:45.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[phpoffice/phpspreadsheet] PhpSpreadsheet has a Cross-Site Scripting (XSS) vulnerability in custom properties]]></title>
        <id>https://github.com/advisories/GHSA-wv23-996v-q229</id>
        <link href="https://github.com/advisories/GHSA-wv23-996v-q229"/>
        <updated>2025-01-03T20:12:10.000Z</updated>
        <content type="html"><![CDATA[<h1 id="cross-site-scripting-xss-vulnerability-in-custom-properties">Cross-Site Scripting (XSS) vulnerability in custom properties</h1>
<p><strong>Product</strong>: Phpspreadsheet
<strong>Version</strong>: version 3.6.0
<strong>CWE-ID</strong>: CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')
<strong>CVSS vector v.3.1</strong>: 5.4 (AV:N/AC:L/PR:L/UI:R/S:C/C:L/I:L/A:N)
<strong>CVSS vector v.4.0</strong>: 4.8 (AV:N/AC:L/AT:N/PR:L/UI:A/VC:L/VI:L/VA:N/SC:L/SI:L/SA:N)
<strong>Description</strong>: the HTML page is generated without clearing custom properties
<strong>Impact</strong>: executing arbitrary JavaScript code in the browser
<strong>Vulnerable component</strong>: class <code>PhpOffice\PhpSpreadsheet\Writer\Html</code>, method <code>generateMeta</code>
<strong>Exploitation conditions</strong>: a user viewing a specially generated Excel file
<strong>Mitigation</strong>: additional sanitization of special characters in a string
<strong>Researcher</strong>: Aleksey Solovev (Positive Technologies)</p>
<h1 id="research">Research</h1>
<p>The researcher discovered zero-day vulnerability Cross-Site Scripting (XSS) vulnerability in custom properties in Phpspreadsheet.
The following code is written on the server, which translates the XLSX file into a HTML representation and displays it in the response.</p>
<p><em>Listing 9. Source code on the server</em></p>
<pre><code>&lt;?php

require __DIR__ . '/vendor/autoload.php';

$inputFileName = './doc/Book1.xlsx';
$spreadsheet = \PhpOffice\PhpSpreadsheet\IOFactory::load($inputFileName);
$writer = new \PhpOffice\PhpSpreadsheet\Writer\Html($spreadsheet);
print($writer-&gt;generateHTMLAll());
</code></pre>
<p>An attacker can embed a payload in a file property that will result in the execution of arbitrary JavaScript code.
The Excel file is unpacked and a custom property in the file is inserted into the <code>docProps/custom.xml</code> file.</p>
<p><img alt="fig17" src="https://github.com/user-attachments/assets/65453b48-bca5-4f5c-a683-315a7bb1ab1f"></p>
<p><em>Figure 17. Embedding the payload</em></p>
<p>After making the changes, a new archive with the xlsx extension was created. At the moment of converting the xlsx file into an HTML representation, a property is obtained that participates in the formation of a string without sanitization.</p>
<p><img alt="fig18" src="https://github.com/user-attachments/assets/e0f63bfb-d9e1-4c9d-a2a9-8a0a20406cdc"></p>
<p><em>Figure 18. Getting a custom property</em></p>
<p>When calling the static <code>generateMeta</code> method, you can see that the key of the custom property is displayed without sanitization.</p>
<p><img alt="fig19" src="https://github.com/user-attachments/assets/8c74e264-af68-4f62-8ac7-437e65884e86"></p>
<p><em>Figure 19. Getting a custom property</em></p>
<p>As a result, when viewing the excel file as the HTML representation, arbitrary JavaScript code will be executed.</p>
<img src="https://github.com/user-attachments/assets/a6ed21e3-685c-415c-b2dc-453bc0652bef" alt="fig20" width="356">

<p><em>Figure 20. Executing arbitrary JavaScript code</em></p>
<h1 id="credit">Credit</h1>
<p>This vulnerability was discovered by <strong>Aleksey Solovev (Positive Technologies)</strong></p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/PHPOffice/PhpSpreadsheet/security/advisories/GHSA-wv23-996v-q229">https://github.com/PHPOffice/PhpSpreadsheet/security/advisories/GHSA-wv23-996v-q229</a></li>
<li><a href="https://github.com/PHPOffice/PhpSpreadsheet/commit/45052f88e04c735d56457a8ffcdc40b2635a028e">https://github.com/PHPOffice/PhpSpreadsheet/commit/45052f88e04c735d56457a8ffcdc40b2635a028e</a></li>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2024-56410">https://nvd.nist.gov/vuln/detail/CVE-2024-56410</a></li>
<li><a href="https://github.com/advisories/GHSA-wv23-996v-q229">https://github.com/advisories/GHSA-wv23-996v-q229</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-wv23-996v-q229</uri>
        </author>
        <category label="severity" term="MODERATE"/>
        <published>2025-01-03T17:25:45.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[phpoffice/phpspreadsheet] PhpSpreadsheet has a Cross-Site Scripting (XSS) vulnerability in custom properties]]></title>
        <id>https://github.com/advisories/GHSA-wv23-996v-q229</id>
        <link href="https://github.com/advisories/GHSA-wv23-996v-q229"/>
        <updated>2025-01-03T20:12:10.000Z</updated>
        <content type="html"><![CDATA[<h1 id="cross-site-scripting-xss-vulnerability-in-custom-properties">Cross-Site Scripting (XSS) vulnerability in custom properties</h1>
<p><strong>Product</strong>: Phpspreadsheet
<strong>Version</strong>: version 3.6.0
<strong>CWE-ID</strong>: CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')
<strong>CVSS vector v.3.1</strong>: 5.4 (AV:N/AC:L/PR:L/UI:R/S:C/C:L/I:L/A:N)
<strong>CVSS vector v.4.0</strong>: 4.8 (AV:N/AC:L/AT:N/PR:L/UI:A/VC:L/VI:L/VA:N/SC:L/SI:L/SA:N)
<strong>Description</strong>: the HTML page is generated without clearing custom properties
<strong>Impact</strong>: executing arbitrary JavaScript code in the browser
<strong>Vulnerable component</strong>: class <code>PhpOffice\PhpSpreadsheet\Writer\Html</code>, method <code>generateMeta</code>
<strong>Exploitation conditions</strong>: a user viewing a specially generated Excel file
<strong>Mitigation</strong>: additional sanitization of special characters in a string
<strong>Researcher</strong>: Aleksey Solovev (Positive Technologies)</p>
<h1 id="research">Research</h1>
<p>The researcher discovered zero-day vulnerability Cross-Site Scripting (XSS) vulnerability in custom properties in Phpspreadsheet.
The following code is written on the server, which translates the XLSX file into a HTML representation and displays it in the response.</p>
<p><em>Listing 9. Source code on the server</em></p>
<pre><code>&lt;?php

require __DIR__ . '/vendor/autoload.php';

$inputFileName = './doc/Book1.xlsx';
$spreadsheet = \PhpOffice\PhpSpreadsheet\IOFactory::load($inputFileName);
$writer = new \PhpOffice\PhpSpreadsheet\Writer\Html($spreadsheet);
print($writer-&gt;generateHTMLAll());
</code></pre>
<p>An attacker can embed a payload in a file property that will result in the execution of arbitrary JavaScript code.
The Excel file is unpacked and a custom property in the file is inserted into the <code>docProps/custom.xml</code> file.</p>
<p><img alt="fig17" src="https://github.com/user-attachments/assets/65453b48-bca5-4f5c-a683-315a7bb1ab1f"></p>
<p><em>Figure 17. Embedding the payload</em></p>
<p>After making the changes, a new archive with the xlsx extension was created. At the moment of converting the xlsx file into an HTML representation, a property is obtained that participates in the formation of a string without sanitization.</p>
<p><img alt="fig18" src="https://github.com/user-attachments/assets/e0f63bfb-d9e1-4c9d-a2a9-8a0a20406cdc"></p>
<p><em>Figure 18. Getting a custom property</em></p>
<p>When calling the static <code>generateMeta</code> method, you can see that the key of the custom property is displayed without sanitization.</p>
<p><img alt="fig19" src="https://github.com/user-attachments/assets/8c74e264-af68-4f62-8ac7-437e65884e86"></p>
<p><em>Figure 19. Getting a custom property</em></p>
<p>As a result, when viewing the excel file as the HTML representation, arbitrary JavaScript code will be executed.</p>
<img src="https://github.com/user-attachments/assets/a6ed21e3-685c-415c-b2dc-453bc0652bef" alt="fig20" width="356">

<p><em>Figure 20. Executing arbitrary JavaScript code</em></p>
<h1 id="credit">Credit</h1>
<p>This vulnerability was discovered by <strong>Aleksey Solovev (Positive Technologies)</strong></p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/PHPOffice/PhpSpreadsheet/security/advisories/GHSA-wv23-996v-q229">https://github.com/PHPOffice/PhpSpreadsheet/security/advisories/GHSA-wv23-996v-q229</a></li>
<li><a href="https://github.com/PHPOffice/PhpSpreadsheet/commit/45052f88e04c735d56457a8ffcdc40b2635a028e">https://github.com/PHPOffice/PhpSpreadsheet/commit/45052f88e04c735d56457a8ffcdc40b2635a028e</a></li>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2024-56410">https://nvd.nist.gov/vuln/detail/CVE-2024-56410</a></li>
<li><a href="https://github.com/advisories/GHSA-wv23-996v-q229">https://github.com/advisories/GHSA-wv23-996v-q229</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-wv23-996v-q229</uri>
        </author>
        <category label="severity" term="MODERATE"/>
        <published>2025-01-03T17:25:45.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[phpoffice/phpspreadsheet] PhpSpreadsheet has a Cross-Site Scripting (XSS) vulnerability in custom properties]]></title>
        <id>https://github.com/advisories/GHSA-wv23-996v-q229</id>
        <link href="https://github.com/advisories/GHSA-wv23-996v-q229"/>
        <updated>2025-01-03T20:12:10.000Z</updated>
        <content type="html"><![CDATA[<h1 id="cross-site-scripting-xss-vulnerability-in-custom-properties">Cross-Site Scripting (XSS) vulnerability in custom properties</h1>
<p><strong>Product</strong>: Phpspreadsheet
<strong>Version</strong>: version 3.6.0
<strong>CWE-ID</strong>: CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')
<strong>CVSS vector v.3.1</strong>: 5.4 (AV:N/AC:L/PR:L/UI:R/S:C/C:L/I:L/A:N)
<strong>CVSS vector v.4.0</strong>: 4.8 (AV:N/AC:L/AT:N/PR:L/UI:A/VC:L/VI:L/VA:N/SC:L/SI:L/SA:N)
<strong>Description</strong>: the HTML page is generated without clearing custom properties
<strong>Impact</strong>: executing arbitrary JavaScript code in the browser
<strong>Vulnerable component</strong>: class <code>PhpOffice\PhpSpreadsheet\Writer\Html</code>, method <code>generateMeta</code>
<strong>Exploitation conditions</strong>: a user viewing a specially generated Excel file
<strong>Mitigation</strong>: additional sanitization of special characters in a string
<strong>Researcher</strong>: Aleksey Solovev (Positive Technologies)</p>
<h1 id="research">Research</h1>
<p>The researcher discovered zero-day vulnerability Cross-Site Scripting (XSS) vulnerability in custom properties in Phpspreadsheet.
The following code is written on the server, which translates the XLSX file into a HTML representation and displays it in the response.</p>
<p><em>Listing 9. Source code on the server</em></p>
<pre><code>&lt;?php

require __DIR__ . '/vendor/autoload.php';

$inputFileName = './doc/Book1.xlsx';
$spreadsheet = \PhpOffice\PhpSpreadsheet\IOFactory::load($inputFileName);
$writer = new \PhpOffice\PhpSpreadsheet\Writer\Html($spreadsheet);
print($writer-&gt;generateHTMLAll());
</code></pre>
<p>An attacker can embed a payload in a file property that will result in the execution of arbitrary JavaScript code.
The Excel file is unpacked and a custom property in the file is inserted into the <code>docProps/custom.xml</code> file.</p>
<p><img alt="fig17" src="https://github.com/user-attachments/assets/65453b48-bca5-4f5c-a683-315a7bb1ab1f"></p>
<p><em>Figure 17. Embedding the payload</em></p>
<p>After making the changes, a new archive with the xlsx extension was created. At the moment of converting the xlsx file into an HTML representation, a property is obtained that participates in the formation of a string without sanitization.</p>
<p><img alt="fig18" src="https://github.com/user-attachments/assets/e0f63bfb-d9e1-4c9d-a2a9-8a0a20406cdc"></p>
<p><em>Figure 18. Getting a custom property</em></p>
<p>When calling the static <code>generateMeta</code> method, you can see that the key of the custom property is displayed without sanitization.</p>
<p><img alt="fig19" src="https://github.com/user-attachments/assets/8c74e264-af68-4f62-8ac7-437e65884e86"></p>
<p><em>Figure 19. Getting a custom property</em></p>
<p>As a result, when viewing the excel file as the HTML representation, arbitrary JavaScript code will be executed.</p>
<img src="https://github.com/user-attachments/assets/a6ed21e3-685c-415c-b2dc-453bc0652bef" alt="fig20" width="356">

<p><em>Figure 20. Executing arbitrary JavaScript code</em></p>
<h1 id="credit">Credit</h1>
<p>This vulnerability was discovered by <strong>Aleksey Solovev (Positive Technologies)</strong></p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/PHPOffice/PhpSpreadsheet/security/advisories/GHSA-wv23-996v-q229">https://github.com/PHPOffice/PhpSpreadsheet/security/advisories/GHSA-wv23-996v-q229</a></li>
<li><a href="https://github.com/PHPOffice/PhpSpreadsheet/commit/45052f88e04c735d56457a8ffcdc40b2635a028e">https://github.com/PHPOffice/PhpSpreadsheet/commit/45052f88e04c735d56457a8ffcdc40b2635a028e</a></li>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2024-56410">https://nvd.nist.gov/vuln/detail/CVE-2024-56410</a></li>
<li><a href="https://github.com/advisories/GHSA-wv23-996v-q229">https://github.com/advisories/GHSA-wv23-996v-q229</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-wv23-996v-q229</uri>
        </author>
        <category label="severity" term="MODERATE"/>
        <published>2025-01-03T17:25:45.000Z</published>
    </entry>
</feed>