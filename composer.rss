<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
    <id>https://azu.github.io/github-advisory-database-rss/composer.rss</id>
    <title>Security Advisory for PHP packages hosted at packagist.org</title>
    <updated>2025-04-01T16:01:27.878Z</updated>
    <generator>github-advisory-database-rss</generator>
    <link rel="alternate" href="https://github.com/advisories?query=type%3Areviewed+ecosystem%3Acomposer"/>
    <subtitle>Security Advisory for PHP packages hosted at packagist.org on GitHub</subtitle>
    <rights>github-advisory-database-rss</rights>
    <category term="CRITICAL"/>
    <category term="HIGH"/>
    <category term="MODERATE"/>
    <category term="LOW"/>
    <entry>
        <title type="html"><![CDATA[[shopxo/shopxo] ShopXO Vulnerable to Server-Side Request Forgery (SSRF) and Cross-Site Scripting (XSS)]]></title>
        <id>https://github.com/advisories/GHSA-24cf-848g-762c</id>
        <link href="https://github.com/advisories/GHSA-24cf-848g-762c"/>
        <updated>2025-04-01T14:20:28.000Z</updated>
        <content type="html"><![CDATA[<p>shopxo v6.4.0 has a ssrf/xss vulnerability in multiple places.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2025-28094">https://nvd.nist.gov/vuln/detail/CVE-2025-28094</a></li>
<li><a href="https://www.yuque.com/morysummer/vx41bz/echzollcdlmllgqo">https://www.yuque.com/morysummer/vx41bz/echzollcdlmllgqo</a></li>
<li><a href="https://github.com/advisories/GHSA-24cf-848g-762c">https://github.com/advisories/GHSA-24cf-848g-762c</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-24cf-848g-762c</uri>
        </author>
        <category label="severity" term="MODERATE"/>
        <published>2025-03-29T00:31:34.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[shopxo/shopxo] ShopXO Vulnerable to Server-Side Request Forgery (SSRF) via Email Settings]]></title>
        <id>https://github.com/advisories/GHSA-gfhv-5rqh-7qx3</id>
        <link href="https://github.com/advisories/GHSA-gfhv-5rqh-7qx3"/>
        <updated>2025-04-01T14:20:21.000Z</updated>
        <content type="html"><![CDATA[<p>ShopXO v6.4.0 is vulnerable to Server-Side Request Forgery (SSRF) in Email Settings.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2025-28093">https://nvd.nist.gov/vuln/detail/CVE-2025-28093</a></li>
<li><a href="https://www.yuque.com/morysummer/vx41bz/he2hb8ic8an8h07f">https://www.yuque.com/morysummer/vx41bz/he2hb8ic8an8h07f</a></li>
<li><a href="https://github.com/advisories/GHSA-gfhv-5rqh-7qx3">https://github.com/advisories/GHSA-gfhv-5rqh-7qx3</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-gfhv-5rqh-7qx3</uri>
        </author>
        <category label="severity" term="MODERATE"/>
        <published>2025-03-29T00:31:34.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[shopxo/shopxo] ShopXO Vulnerable to Server-Side Request Forgery (SSRF) via Image Upload]]></title>
        <id>https://github.com/advisories/GHSA-p736-g6pg-hjhw</id>
        <link href="https://github.com/advisories/GHSA-p736-g6pg-hjhw"/>
        <updated>2025-04-01T14:20:11.000Z</updated>
        <content type="html"><![CDATA[<p>ShopXO v6.4.0 is vulnerable to Server-Side Request Forgery (SSRF) via image upload function.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2025-28092">https://nvd.nist.gov/vuln/detail/CVE-2025-28092</a></li>
<li><a href="https://www.yuque.com/morysummer/vx41bz/stggvmlxs9ewqlvu">https://www.yuque.com/morysummer/vx41bz/stggvmlxs9ewqlvu</a></li>
<li><a href="https://github.com/advisories/GHSA-p736-g6pg-hjhw">https://github.com/advisories/GHSA-p736-g6pg-hjhw</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-p736-g6pg-hjhw</uri>
        </author>
        <category label="severity" term="MODERATE"/>
        <published>2025-03-29T00:31:34.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[concrete5/concrete5] ConcreteCMS Cross-Site Scripting (XSS) via HTML Block Text Field]]></title>
        <id>https://github.com/advisories/GHSA-xfqf-5rhg-5c73</id>
        <link href="https://github.com/advisories/GHSA-xfqf-5rhg-5c73"/>
        <updated>2025-03-31T16:55:47.000Z</updated>
        <content type="html"><![CDATA[<p>A vulnerability was found in ConcreteCMS up to 9.3.9. It has been classified as problematic. This affects the function Save of the component HTML Block Handler. The manipulation of the argument content leads to HTML injection. It is possible to initiate the attack remotely. The exploit has been disclosed to the public and may be used. The vendor was contacted early about this disclosure but did not respond in any way.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2025-2967">https://nvd.nist.gov/vuln/detail/CVE-2025-2967</a></li>
<li><a href="https://github.com/yaowenxiao721/Poc/blob/main/Concretecms/Concretecms-poc5.md">https://github.com/yaowenxiao721/Poc/blob/main/Concretecms/Concretecms-poc5.md</a></li>
<li><a href="https://vuldb.com/?ctiid.302019">https://vuldb.com/?ctiid.302019</a></li>
<li><a href="https://vuldb.com/?id.302019">https://vuldb.com/?id.302019</a></li>
<li><a href="https://vuldb.com/?submit.522417">https://vuldb.com/?submit.522417</a></li>
<li><a href="https://github.com/advisories/GHSA-xfqf-5rhg-5c73">https://github.com/advisories/GHSA-xfqf-5rhg-5c73</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-xfqf-5rhg-5c73</uri>
        </author>
        <category label="severity" term="MODERATE"/>
        <published>2025-03-31T03:30:24.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[leantime/leantime] Duplicate Advisory: Leantime affected by Improper Neutralization of HTML Tags]]></title>
        <id>https://github.com/advisories/GHSA-jf6p-4hgv-v6qh</id>
        <link href="https://github.com/advisories/GHSA-jf6p-4hgv-v6qh"/>
        <updated>2025-03-31T15:57:42.000Z</updated>
        <content type="html"><![CDATA[<h3 id="duplicate-advisory">Duplicate Advisory</h3>
<p>This advisory has been withdrawn because it is a duplicate of GHSA-95j3-435g-vjcp. This link is maintained to preserve external references.</p>
<h3 id="original-description">Original Description</h3>
<p>Cross Site Scripting vulnerability in Leantime v3.2.1 and before allows an authenticated attacker to execute arbitrary code and obtain sensitive information via the first name field in processMentions().</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/Leantime/leantime/security/advisories/GHSA-95j3-435g-vjcp">https://github.com/Leantime/leantime/security/advisories/GHSA-95j3-435g-vjcp</a></li>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2025-28254">https://nvd.nist.gov/vuln/detail/CVE-2025-28254</a></li>
<li><a href="https://github.com/Leantime/leantime/commit/ce1d2073e4601183e1bdd90f4b433d16aee46a50">https://github.com/Leantime/leantime/commit/ce1d2073e4601183e1bdd90f4b433d16aee46a50</a></li>
<li><a href="https://github.com/Leantime/leantime/blob/0e7ddbbe3d582f657a1dddfef7b3419ae588cbf7/app/Domain/Notifications/Services/Notifications.php#L128">https://github.com/Leantime/leantime/blob/0e7ddbbe3d582f657a1dddfef7b3419ae588cbf7/app/Domain/Notifications/Services/Notifications.php#L128</a></li>
<li><a href="https://github.com/advisories/GHSA-jf6p-4hgv-v6qh">https://github.com/advisories/GHSA-jf6p-4hgv-v6qh</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-jf6p-4hgv-v6qh</uri>
        </author>
        <category label="severity" term="MODERATE"/>
        <published>2025-03-28T21:30:47.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[pixelfed/pixelfed] Pixelfed may allow unauthorized actor to view private posts and private users]]></title>
        <id>https://github.com/advisories/GHSA-7287-grhx-542x</id>
        <link href="https://github.com/advisories/GHSA-7287-grhx-542x"/>
        <updated>2025-03-26T14:53:16.000Z</updated>
        <content type="html"><![CDATA[<p>Pixelfed before 0.12.5 allows anyone to follow private accounts and see private posts on other Fediverse servers. This affects users elsewhere in the Fediverse, if they otherwise have any followers from a Pixelfed instance.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2025-30741">https://nvd.nist.gov/vuln/detail/CVE-2025-30741</a></li>
<li><a href="https://fokus.cool/2025/03/25/pixelfed-vulnerability.html">https://fokus.cool/2025/03/25/pixelfed-vulnerability.html</a></li>
<li><a href="https://github.com/pixelfed/pixelfed/releases/tag/v0.12.5">https://github.com/pixelfed/pixelfed/releases/tag/v0.12.5</a></li>
<li><a href="https://mastodon.social/@pixelfed/114215925957179498">https://mastodon.social/@pixelfed/114215925957179498</a></li>
<li><a href="https://news.ycombinator.com/item?id=43474425">https://news.ycombinator.com/item?id=43474425</a></li>
<li><a href="https://github.com/advisories/GHSA-7287-grhx-542x">https://github.com/advisories/GHSA-7287-grhx-542x</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-7287-grhx-542x</uri>
        </author>
        <category label="severity" term="MODERATE"/>
        <published>2025-03-25T21:31:34.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[tastyigniter/tastyigniter] TastyIgniter Has an Incorrect Access Control Vulnerability via `invoice()` Function]]></title>
        <id>https://github.com/advisories/GHSA-gg2f-r4jh-vpmh</id>
        <link href="https://github.com/advisories/GHSA-gg2f-r4jh-vpmh"/>
        <updated>2025-03-26T14:41:44.000Z</updated>
        <content type="html"><![CDATA[<p>TastyIgniter 3.7.6 contains an Incorrect Access Control vulnerability in the invoice() function within Orders.php which allows unauthorized users to access and generate invoices due to missing permission checks.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2024-44313">https://nvd.nist.gov/vuln/detail/CVE-2024-44313</a></li>
<li><a href="https://github.com/tastyigniter/TastyIgniter/blob/3.x/app/admin/controllers/Orders.php">https://github.com/tastyigniter/TastyIgniter/blob/3.x/app/admin/controllers/Orders.php</a></li>
<li><a href="https://medium.com/@cnetsec/cve-2024-44313-incorrect-access-control-in-tastyigniter-3-7-6-01a73c548b74">https://medium.com/@cnetsec/cve-2024-44313-incorrect-access-control-in-tastyigniter-3-7-6-01a73c548b74</a></li>
<li><a href="https://github.com/advisories/GHSA-gg2f-r4jh-vpmh">https://github.com/advisories/GHSA-gg2f-r4jh-vpmh</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-gg2f-r4jh-vpmh</uri>
        </author>
        <category label="severity" term="HIGH"/>
        <published>2025-03-18T15:30:48.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[yiisoft/yii2-dev] yiisoft Yii2 Deserialization of Untrusted Data]]></title>
        <id>https://github.com/advisories/GHSA-88m2-j94x-v4fx</id>
        <link href="https://github.com/advisories/GHSA-88m2-j94x-v4fx"/>
        <updated>2025-03-24T21:31:20.000Z</updated>
        <content type="html"><![CDATA[<p>A vulnerability, which was classified as critical, has been found in yiisoft Yii2 up to 2.0.45. Affected by this issue is the function getIterator of the file symfony\finder\Iterator\SortableIterator.php. The manipulation leads to deserialization. The attack may be launched remotely. The exploit has been disclosed to the public and may be used.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2025-2689">https://nvd.nist.gov/vuln/detail/CVE-2025-2689</a></li>
<li><a href="https://github.com/gaorenyusi/gaorenyusi/blob/main/Yii2.md">https://github.com/gaorenyusi/gaorenyusi/blob/main/Yii2.md</a></li>
<li><a href="https://vuldb.com/?ctiid.300710">https://vuldb.com/?ctiid.300710</a></li>
<li><a href="https://vuldb.com/?id.300710">https://vuldb.com/?id.300710</a></li>
<li><a href="https://vuldb.com/?submit.521709">https://vuldb.com/?submit.521709</a></li>
<li><a href="https://github.com/advisories/GHSA-88m2-j94x-v4fx">https://github.com/advisories/GHSA-88m2-j94x-v4fx</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-88m2-j94x-v4fx</uri>
        </author>
        <category label="severity" term="MODERATE"/>
        <published>2025-03-24T09:34:03.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[api-platform/core] API Platform Core does not call GraphQl securityAfterResolver]]></title>
        <id>https://github.com/advisories/GHSA-7mxx-3cgm-xxv3</id>
        <link href="https://github.com/advisories/GHSA-7mxx-3cgm-xxv3"/>
        <updated>2025-03-24T18:41:26.000Z</updated>
        <content type="html"><![CDATA[<h3 id="summary">Summary</h3>
<p>A security check that gets called after GraphQl resolvers is always replaced by another one as there's no break in this clause: <a href="https://github.com/api-platform/core/pull/6444/files#diff-09e3c2cfe12a2ce65bd6c983c7ca6bfcf783f852b8d0554bb938e8ebf5e5fa65R56">https://github.com/api-platform/core/pull/6444/files#diff-09e3c2cfe12a2ce65bd6c983c7ca6bfcf783f852b8d0554bb938e8ebf5e5fa65R56</a></p>
<p><a href="https://github.com/soyuka/core/blob/7e2e8f9ff322ac5f6eb5f65baf432bffdca0fd51/src/Symfony/Security/State/AccessCheckerProvider.php#L49-L57">https://github.com/soyuka/core/blob/7e2e8f9ff322ac5f6eb5f65baf432bffdca0fd51/src/Symfony/Security/State/AccessCheckerProvider.php#L49-L57</a> </p>
<h3 id="poc">PoC</h3>
<p>Create a graphql endpoint with a security after resolver.</p>
<h3 id="impact">Impact</h3>
<p>As this fallsback to <code>security</code>, the impact is there only when there's only a security after resolver and none inside security. The test at <a href="https://github.com/api-platform/core/pull/6444">https://github.com/api-platform/core/pull/6444</a> is probably broken.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/api-platform/core/security/advisories/GHSA-7mxx-3cgm-xxv3">https://github.com/api-platform/core/security/advisories/GHSA-7mxx-3cgm-xxv3</a></li>
<li><a href="https://github.com/api-platform/core/pull/6444">https://github.com/api-platform/core/pull/6444</a></li>
<li><a href="https://github.com/api-platform/core/pull/6444/files#diff-09e3c2cfe12a2ce65bd6c983c7ca6bfcf783f852b8d0554bb938e8ebf5e5fa65R56">https://github.com/api-platform/core/pull/6444/files#diff-09e3c2cfe12a2ce65bd6c983c7ca6bfcf783f852b8d0554bb938e8ebf5e5fa65R56</a></li>
<li><a href="https://github.com/api-platform/core/commit/dc4fc84ba93e22b4f44a37e90a93c6d079c1c620">https://github.com/api-platform/core/commit/dc4fc84ba93e22b4f44a37e90a93c6d079c1c620</a></li>
<li><a href="https://github.com/soyuka/core/blob/7e2e8f9ff322ac5f6eb5f65baf432bffdca0fd51/src/Symfony/Security/State/AccessCheckerProvider.php#L49-L57">https://github.com/soyuka/core/blob/7e2e8f9ff322ac5f6eb5f65baf432bffdca0fd51/src/Symfony/Security/State/AccessCheckerProvider.php#L49-L57</a></li>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2025-23204">https://nvd.nist.gov/vuln/detail/CVE-2025-23204</a></li>
<li><a href="https://github.com/advisories/GHSA-7mxx-3cgm-xxv3">https://github.com/advisories/GHSA-7mxx-3cgm-xxv3</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-7mxx-3cgm-xxv3</uri>
        </author>
        <category label="severity" term="MODERATE"/>
        <published>2025-03-24T16:31:08.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[tastyigniter/tastyigniter] TastyIgniter Has an Incorrect Access Control Vulnerability]]></title>
        <id>https://github.com/advisories/GHSA-w5h7-mw56-4v7x</id>
        <link href="https://github.com/advisories/GHSA-w5h7-mw56-4v7x"/>
        <updated>2025-03-21T17:44:55.000Z</updated>
        <content type="html"><![CDATA[<p>TastyIgniter 3.7.6 contains an Incorrect Access Control vulnerability in the Orders Management System, allowing unauthorized users to update order statuses. The issue occurs in the index_onUpdateStatus() function within Orders.php, which fails to verify if the user has permission to modify an order's status. This flaw can be exploited remotely, leading to unauthorized order manipulation.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2024-44314">https://nvd.nist.gov/vuln/detail/CVE-2024-44314</a></li>
<li><a href="https://github.com/tastyigniter/TastyIgniter/blob/3.x/app/admin/controllers/Orders.php">https://github.com/tastyigniter/TastyIgniter/blob/3.x/app/admin/controllers/Orders.php</a></li>
<li><a href="https://medium.com/@cnetsec/cve-2024-44314-incorrect-access-control-in-function-updateorder-fc5f2b1b0467">https://medium.com/@cnetsec/cve-2024-44314-incorrect-access-control-in-function-updateorder-fc5f2b1b0467</a></li>
<li><a href="https://github.com/advisories/GHSA-w5h7-mw56-4v7x">https://github.com/advisories/GHSA-w5h7-mw56-4v7x</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-w5h7-mw56-4v7x</uri>
        </author>
        <category label="severity" term="MODERATE"/>
        <published>2025-03-18T15:30:48.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[sylius/paypal-plugin] Sylius PayPal Plugin has an Order Manipulation Vulnerability after PayPal Checkout]]></title>
        <id>https://github.com/advisories/GHSA-hxg4-65p5-9w37</id>
        <link href="https://github.com/advisories/GHSA-hxg4-65p5-9w37"/>
        <updated>2025-03-20T18:59:45.000Z</updated>
        <content type="html"><![CDATA[<p>A discovered vulnerability allows users to modify their shopping cart after completing the PayPal Checkout process and payment authorization. If a user initiates a PayPal transaction from a product page or the cart page and then returns to the order summary page, they can still manipulate the cart contents before finalizing the order. As a result, the order amount in Sylius may be higher than the amount actually captured by PayPal, leading to a scenario where merchants deliver products or services without full payment.</p>
<h3 id="impact">Impact</h3>
<ul>
<li>Users can exploit this flaw to receive products/services without paying the full amount.</li>
<li>Merchants may suffer financial losses due to underpaid orders.</li>
<li>Trust in the integrity of the payment process is compromised.</li>
</ul>
<h3 id="patches">Patches</h3>
<p>The issue is fixed in versions: 1.6.2, 1.7.2, 2.0.2 and above.</p>
<h3 id="workarounds">Workarounds</h3>
<p>To resolve the problem in the end application without updating to the newest patches, there is a need to overwrite <code>PayPalOrderCompleteProcessor</code> with modified logic:</p>
<pre><code class="language-php">&lt;?php

declare(strict_types=1);

namespace App\Processor;

use Sylius\Bundle\PayumBundle\Model\GatewayConfigInterface;
use Sylius\Component\Core\Model\OrderInterface;
use Sylius\Component\Core\Model\PaymentInterface;
use Sylius\Component\Core\Model\PaymentMethodInterface;
use Sylius\PayPalPlugin\Manager\PaymentStateManagerInterface;

final class PayPalOrderCompleteProcessor
{
    public function __construct(private readonly PaymentStateManagerInterface $paymentStateManager) {
    }

    public function completePayPalOrder(OrderInterface $order): void
    {
        $payment = $order-&gt;getLastPayment(PaymentInterface::STATE_PROCESSING);
        if ($payment === null) {
            return;
        }

        /** @var PaymentMethodInterface $paymentMethod */
        $paymentMethod = $payment-&gt;getMethod();
        /** @var GatewayConfigInterface $gatewayConfig */
        $gatewayConfig = $paymentMethod-&gt;getGatewayConfig();

        if ($gatewayConfig-&gt;getFactoryName() !== 'sylius.pay_pal') {
            return;
        }

        try {
            $this-&gt;verify($payment);
        } catch (\Exception) {
            $this-&gt;paymentStateManager-&gt;cancel($payment);

            return;
        }

        $this-&gt;paymentStateManager-&gt;complete($payment);
    }

    private function verify(PaymentInterface $payment): void
    {
        $totalAmount = $this-&gt;getTotalPaymentAmountFromPaypal($payment);

        if ($payment-&gt;getOrder()-&gt;getTotal() !== $totalAmount) {
            throw new \Exception();
        }
    }

    private function getTotalPaymentAmountFromPaypal(PaymentInterface $payment): int
    {
        $details = $payment-&gt;getDetails();

        return $details['payment_amount'] ?? 0;
    }
}
</code></pre>
<h3 id="important">IMPORTANT</h3>
<p>For <code>PayPalPlugin 2.x</code> change:</p>
<pre><code class="language-php">$gatewayConfig-&gt;getFactoryName() !== 'sylius.pay_pal'
</code></pre>
<p>to</p>
<pre><code class="language-php">$gatewayConfig-&gt;getFactoryName() !== SyliusPayPalExtension::PAYPAL_FACTORY_NAME
</code></pre>
<p>Also there is a need to overwrite <code>CompletePayPalOrderListener</code> with modified logic:</p>
<pre><code class="language-php">&lt;?php

declare(strict_types=1);

namespace App\EventListener\Workflow;

use App\Processor\PayPalOrderCompleteProcessor;
use Sylius\Component\Core\Model\OrderInterface;
use Symfony\Component\Workflow\Event\CompletedEvent;
use Webmozart\Assert\Assert;

final class CompletePayPalOrderListener
{
    public function __construct(private readonly PayPalOrderCompleteProcessor $completeProcessor)
    {
    }

    public function __invoke(CompletedEvent $event): void
    {
        /** @var OrderInterface $order */
        $order = $event-&gt;getSubject();
        Assert::isInstanceOf($order, OrderInterface::class);

        $this-&gt;completeProcessor-&gt;completePayPalOrder($order);
    }
}
</code></pre>
<p>And to overwrite <code>CaptureAction</code> with modified logic (if you didn't have it already):</p>
<pre><code class="language-php">&lt;?php

declare(strict_types=1);

namespace App\Payum\Action;

use Payum\Core\Action\ActionInterface;
use Payum\Core\Exception\RequestNotSupportedException;
use Payum\Core\Request\Capture;
use Sylius\Component\Core\Model\PaymentInterface;
use Sylius\Component\Core\Model\PaymentMethodInterface;
use Sylius\PayPalPlugin\Api\CacheAuthorizeClientApiInterface;
use Sylius\PayPalPlugin\Api\CreateOrderApiInterface;
use Sylius\PayPalPlugin\Payum\Action\StatusAction;
use Sylius\PayPalPlugin\Provider\UuidProviderInterface;

final class CaptureAction implements ActionInterface
{
    public function __construct(
        private CacheAuthorizeClientApiInterface $authorizeClientApi,
        private CreateOrderApiInterface $createOrderApi,
        private UuidProviderInterface $uuidProvider,
    ) {
    }

    /** @param Capture $request */
    public function execute($request): void
    {
        RequestNotSupportedException::assertSupports($this, $request);

        /** @var PaymentInterface $payment */
        $payment = $request-&gt;getModel();
        /** @var PaymentMethodInterface $paymentMethod */
        $paymentMethod = $payment-&gt;getMethod();

        $token = $this-&gt;authorizeClientApi-&gt;authorize($paymentMethod);

        $referenceId = $this-&gt;uuidProvider-&gt;provide();
        $content = $this-&gt;createOrderApi-&gt;create($token, $payment, $referenceId);

        if ($content['status'] === 'CREATED') {
            $payment-&gt;setDetails([
                'status' =&gt; StatusAction::STATUS_CAPTURED,
                'paypal_order_id' =&gt; $content['id'],
                'reference_id' =&gt; $referenceId,
                'payment_amount' =&gt; $payment-&gt;getAmount(),
            ]);
        }
    }

    public function supports($request): bool
    {
        return
            $request instanceof Capture &amp;&amp;
            $request-&gt;getModel() instanceof PaymentInterface
        ;
    }
}
</code></pre>
<p>After that, register services in the container when using PayPal 1.x:</p>
<pre><code class="language-yaml">Sylius\PayPalPlugin\EventListener\Workflow\CompletePayPalOrderListener:
    class: App\EventListener\Workflow\CompletePayPalOrderListener
    public: true
    arguments:
        - '@Sylius\PayPalPlugin\Processor\PayPalOrderCompleteProcessor'
    tags: 
        - { name: 'kernel.event_listener', event: 'workflow.sylius_order_checkout.completed.complete', priority: 100 }
    
Sylius\PayPalPlugin\Processor\PayPalOrderCompleteProcessor:
    class: App\Processor\PayPalOrderCompleteProcessor
    public: true
    arguments:
        - '@Sylius\PayPalPlugin\Manager\PaymentStateManagerInterface'

Sylius\PayPalPlugin\Payum\Action\CaptureAction:
    class: App\Payum\Action\CaptureAction
    public: true
    arguments:
        - '@Sylius\PayPalPlugin\Api\CacheAuthorizeClientApiInterface'
        - '@Sylius\PayPalPlugin\Api\CreateOrderApiInterface'
        - '@Sylius\PayPalPlugin\Provider\UuidProviderInterface'
    tags:
        - { name: 'payum.action', factory: 'sylius.pay_pal', alias: 'payum.action.capture' }
</code></pre>
<p>or when using PayPal 2.x:</p>
<pre><code class="language-yaml">sylius_paypal.listener.workflow.complete_paypal_order:
    class: App\EventListener\Workflow\CompletePayPalOrderListener
    public: true
    arguments:
        - '@sylius_paypal.processor.paypal_order_complete'
    tags: 
        - { name: 'kernel.event_listener', event: 'workflow.sylius_order_checkout.completed.complete', priority: 100 }
    
sylius_paypal.processor.paypal_order_complete:
    class: App\Processor\PayPalOrderCompleteProcessor
    public: true
    arguments:
        - '@sylius_paypal.manager.payment_state'

sylius_paypal.payum.action.capture:
    class: App\Payum\Action\CaptureAction
    public: true
    arguments:
        - '@sylius_paypal.api.cache_authorize_client'
        - '@sylius_paypal.api.create_order'
        - '@sylius_paypal.provider.uuid'
    tags:
        - { name: 'payum.action', factory: 'sylius.paypal', alias: 'payum.action.capture' }
</code></pre>
<h3 id="for-more-information">For more information</h3>
<p>If you have any questions or comments about this advisory:</p>
<ul>
<li>Open an issue in <a href="https://github.com/Sylius/Sylius/issues">Sylius issues</a></li>
<li>Email us at <a href="mailto:security@sylius.com">security@sylius.com</a></li>
</ul>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/Sylius/PayPalPlugin/security/advisories/GHSA-hxg4-65p5-9w37">https://github.com/Sylius/PayPalPlugin/security/advisories/GHSA-hxg4-65p5-9w37</a></li>
<li><a href="https://github.com/Sylius/PayPalPlugin/commit/5613df827a6d4fc50862229295976200a68e97aa">https://github.com/Sylius/PayPalPlugin/commit/5613df827a6d4fc50862229295976200a68e97aa</a></li>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2025-30152">https://nvd.nist.gov/vuln/detail/CVE-2025-30152</a></li>
<li><a href="https://github.com/advisories/GHSA-hxg4-65p5-9w37">https://github.com/advisories/GHSA-hxg4-65p5-9w37</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-hxg4-65p5-9w37</uri>
        </author>
        <category label="severity" term="MODERATE"/>
        <published>2025-03-19T16:46:30.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[sylius/paypal-plugin] Sylius PayPal Plugin has an Order Manipulation Vulnerability after PayPal Checkout]]></title>
        <id>https://github.com/advisories/GHSA-hxg4-65p5-9w37</id>
        <link href="https://github.com/advisories/GHSA-hxg4-65p5-9w37"/>
        <updated>2025-03-20T18:59:45.000Z</updated>
        <content type="html"><![CDATA[<p>A discovered vulnerability allows users to modify their shopping cart after completing the PayPal Checkout process and payment authorization. If a user initiates a PayPal transaction from a product page or the cart page and then returns to the order summary page, they can still manipulate the cart contents before finalizing the order. As a result, the order amount in Sylius may be higher than the amount actually captured by PayPal, leading to a scenario where merchants deliver products or services without full payment.</p>
<h3 id="impact">Impact</h3>
<ul>
<li>Users can exploit this flaw to receive products/services without paying the full amount.</li>
<li>Merchants may suffer financial losses due to underpaid orders.</li>
<li>Trust in the integrity of the payment process is compromised.</li>
</ul>
<h3 id="patches">Patches</h3>
<p>The issue is fixed in versions: 1.6.2, 1.7.2, 2.0.2 and above.</p>
<h3 id="workarounds">Workarounds</h3>
<p>To resolve the problem in the end application without updating to the newest patches, there is a need to overwrite <code>PayPalOrderCompleteProcessor</code> with modified logic:</p>
<pre><code class="language-php">&lt;?php

declare(strict_types=1);

namespace App\Processor;

use Sylius\Bundle\PayumBundle\Model\GatewayConfigInterface;
use Sylius\Component\Core\Model\OrderInterface;
use Sylius\Component\Core\Model\PaymentInterface;
use Sylius\Component\Core\Model\PaymentMethodInterface;
use Sylius\PayPalPlugin\Manager\PaymentStateManagerInterface;

final class PayPalOrderCompleteProcessor
{
    public function __construct(private readonly PaymentStateManagerInterface $paymentStateManager) {
    }

    public function completePayPalOrder(OrderInterface $order): void
    {
        $payment = $order-&gt;getLastPayment(PaymentInterface::STATE_PROCESSING);
        if ($payment === null) {
            return;
        }

        /** @var PaymentMethodInterface $paymentMethod */
        $paymentMethod = $payment-&gt;getMethod();
        /** @var GatewayConfigInterface $gatewayConfig */
        $gatewayConfig = $paymentMethod-&gt;getGatewayConfig();

        if ($gatewayConfig-&gt;getFactoryName() !== 'sylius.pay_pal') {
            return;
        }

        try {
            $this-&gt;verify($payment);
        } catch (\Exception) {
            $this-&gt;paymentStateManager-&gt;cancel($payment);

            return;
        }

        $this-&gt;paymentStateManager-&gt;complete($payment);
    }

    private function verify(PaymentInterface $payment): void
    {
        $totalAmount = $this-&gt;getTotalPaymentAmountFromPaypal($payment);

        if ($payment-&gt;getOrder()-&gt;getTotal() !== $totalAmount) {
            throw new \Exception();
        }
    }

    private function getTotalPaymentAmountFromPaypal(PaymentInterface $payment): int
    {
        $details = $payment-&gt;getDetails();

        return $details['payment_amount'] ?? 0;
    }
}
</code></pre>
<h3 id="important">IMPORTANT</h3>
<p>For <code>PayPalPlugin 2.x</code> change:</p>
<pre><code class="language-php">$gatewayConfig-&gt;getFactoryName() !== 'sylius.pay_pal'
</code></pre>
<p>to</p>
<pre><code class="language-php">$gatewayConfig-&gt;getFactoryName() !== SyliusPayPalExtension::PAYPAL_FACTORY_NAME
</code></pre>
<p>Also there is a need to overwrite <code>CompletePayPalOrderListener</code> with modified logic:</p>
<pre><code class="language-php">&lt;?php

declare(strict_types=1);

namespace App\EventListener\Workflow;

use App\Processor\PayPalOrderCompleteProcessor;
use Sylius\Component\Core\Model\OrderInterface;
use Symfony\Component\Workflow\Event\CompletedEvent;
use Webmozart\Assert\Assert;

final class CompletePayPalOrderListener
{
    public function __construct(private readonly PayPalOrderCompleteProcessor $completeProcessor)
    {
    }

    public function __invoke(CompletedEvent $event): void
    {
        /** @var OrderInterface $order */
        $order = $event-&gt;getSubject();
        Assert::isInstanceOf($order, OrderInterface::class);

        $this-&gt;completeProcessor-&gt;completePayPalOrder($order);
    }
}
</code></pre>
<p>And to overwrite <code>CaptureAction</code> with modified logic (if you didn't have it already):</p>
<pre><code class="language-php">&lt;?php

declare(strict_types=1);

namespace App\Payum\Action;

use Payum\Core\Action\ActionInterface;
use Payum\Core\Exception\RequestNotSupportedException;
use Payum\Core\Request\Capture;
use Sylius\Component\Core\Model\PaymentInterface;
use Sylius\Component\Core\Model\PaymentMethodInterface;
use Sylius\PayPalPlugin\Api\CacheAuthorizeClientApiInterface;
use Sylius\PayPalPlugin\Api\CreateOrderApiInterface;
use Sylius\PayPalPlugin\Payum\Action\StatusAction;
use Sylius\PayPalPlugin\Provider\UuidProviderInterface;

final class CaptureAction implements ActionInterface
{
    public function __construct(
        private CacheAuthorizeClientApiInterface $authorizeClientApi,
        private CreateOrderApiInterface $createOrderApi,
        private UuidProviderInterface $uuidProvider,
    ) {
    }

    /** @param Capture $request */
    public function execute($request): void
    {
        RequestNotSupportedException::assertSupports($this, $request);

        /** @var PaymentInterface $payment */
        $payment = $request-&gt;getModel();
        /** @var PaymentMethodInterface $paymentMethod */
        $paymentMethod = $payment-&gt;getMethod();

        $token = $this-&gt;authorizeClientApi-&gt;authorize($paymentMethod);

        $referenceId = $this-&gt;uuidProvider-&gt;provide();
        $content = $this-&gt;createOrderApi-&gt;create($token, $payment, $referenceId);

        if ($content['status'] === 'CREATED') {
            $payment-&gt;setDetails([
                'status' =&gt; StatusAction::STATUS_CAPTURED,
                'paypal_order_id' =&gt; $content['id'],
                'reference_id' =&gt; $referenceId,
                'payment_amount' =&gt; $payment-&gt;getAmount(),
            ]);
        }
    }

    public function supports($request): bool
    {
        return
            $request instanceof Capture &amp;&amp;
            $request-&gt;getModel() instanceof PaymentInterface
        ;
    }
}
</code></pre>
<p>After that, register services in the container when using PayPal 1.x:</p>
<pre><code class="language-yaml">Sylius\PayPalPlugin\EventListener\Workflow\CompletePayPalOrderListener:
    class: App\EventListener\Workflow\CompletePayPalOrderListener
    public: true
    arguments:
        - '@Sylius\PayPalPlugin\Processor\PayPalOrderCompleteProcessor'
    tags: 
        - { name: 'kernel.event_listener', event: 'workflow.sylius_order_checkout.completed.complete', priority: 100 }
    
Sylius\PayPalPlugin\Processor\PayPalOrderCompleteProcessor:
    class: App\Processor\PayPalOrderCompleteProcessor
    public: true
    arguments:
        - '@Sylius\PayPalPlugin\Manager\PaymentStateManagerInterface'

Sylius\PayPalPlugin\Payum\Action\CaptureAction:
    class: App\Payum\Action\CaptureAction
    public: true
    arguments:
        - '@Sylius\PayPalPlugin\Api\CacheAuthorizeClientApiInterface'
        - '@Sylius\PayPalPlugin\Api\CreateOrderApiInterface'
        - '@Sylius\PayPalPlugin\Provider\UuidProviderInterface'
    tags:
        - { name: 'payum.action', factory: 'sylius.pay_pal', alias: 'payum.action.capture' }
</code></pre>
<p>or when using PayPal 2.x:</p>
<pre><code class="language-yaml">sylius_paypal.listener.workflow.complete_paypal_order:
    class: App\EventListener\Workflow\CompletePayPalOrderListener
    public: true
    arguments:
        - '@sylius_paypal.processor.paypal_order_complete'
    tags: 
        - { name: 'kernel.event_listener', event: 'workflow.sylius_order_checkout.completed.complete', priority: 100 }
    
sylius_paypal.processor.paypal_order_complete:
    class: App\Processor\PayPalOrderCompleteProcessor
    public: true
    arguments:
        - '@sylius_paypal.manager.payment_state'

sylius_paypal.payum.action.capture:
    class: App\Payum\Action\CaptureAction
    public: true
    arguments:
        - '@sylius_paypal.api.cache_authorize_client'
        - '@sylius_paypal.api.create_order'
        - '@sylius_paypal.provider.uuid'
    tags:
        - { name: 'payum.action', factory: 'sylius.paypal', alias: 'payum.action.capture' }
</code></pre>
<h3 id="for-more-information">For more information</h3>
<p>If you have any questions or comments about this advisory:</p>
<ul>
<li>Open an issue in <a href="https://github.com/Sylius/Sylius/issues">Sylius issues</a></li>
<li>Email us at <a href="mailto:security@sylius.com">security@sylius.com</a></li>
</ul>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/Sylius/PayPalPlugin/security/advisories/GHSA-hxg4-65p5-9w37">https://github.com/Sylius/PayPalPlugin/security/advisories/GHSA-hxg4-65p5-9w37</a></li>
<li><a href="https://github.com/Sylius/PayPalPlugin/commit/5613df827a6d4fc50862229295976200a68e97aa">https://github.com/Sylius/PayPalPlugin/commit/5613df827a6d4fc50862229295976200a68e97aa</a></li>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2025-30152">https://nvd.nist.gov/vuln/detail/CVE-2025-30152</a></li>
<li><a href="https://github.com/advisories/GHSA-hxg4-65p5-9w37">https://github.com/advisories/GHSA-hxg4-65p5-9w37</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-hxg4-65p5-9w37</uri>
        </author>
        <category label="severity" term="MODERATE"/>
        <published>2025-03-19T16:46:30.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[sylius/paypal-plugin] Sylius PayPal Plugin has an Order Manipulation Vulnerability after PayPal Checkout]]></title>
        <id>https://github.com/advisories/GHSA-hxg4-65p5-9w37</id>
        <link href="https://github.com/advisories/GHSA-hxg4-65p5-9w37"/>
        <updated>2025-03-20T18:59:45.000Z</updated>
        <content type="html"><![CDATA[<p>A discovered vulnerability allows users to modify their shopping cart after completing the PayPal Checkout process and payment authorization. If a user initiates a PayPal transaction from a product page or the cart page and then returns to the order summary page, they can still manipulate the cart contents before finalizing the order. As a result, the order amount in Sylius may be higher than the amount actually captured by PayPal, leading to a scenario where merchants deliver products or services without full payment.</p>
<h3 id="impact">Impact</h3>
<ul>
<li>Users can exploit this flaw to receive products/services without paying the full amount.</li>
<li>Merchants may suffer financial losses due to underpaid orders.</li>
<li>Trust in the integrity of the payment process is compromised.</li>
</ul>
<h3 id="patches">Patches</h3>
<p>The issue is fixed in versions: 1.6.2, 1.7.2, 2.0.2 and above.</p>
<h3 id="workarounds">Workarounds</h3>
<p>To resolve the problem in the end application without updating to the newest patches, there is a need to overwrite <code>PayPalOrderCompleteProcessor</code> with modified logic:</p>
<pre><code class="language-php">&lt;?php

declare(strict_types=1);

namespace App\Processor;

use Sylius\Bundle\PayumBundle\Model\GatewayConfigInterface;
use Sylius\Component\Core\Model\OrderInterface;
use Sylius\Component\Core\Model\PaymentInterface;
use Sylius\Component\Core\Model\PaymentMethodInterface;
use Sylius\PayPalPlugin\Manager\PaymentStateManagerInterface;

final class PayPalOrderCompleteProcessor
{
    public function __construct(private readonly PaymentStateManagerInterface $paymentStateManager) {
    }

    public function completePayPalOrder(OrderInterface $order): void
    {
        $payment = $order-&gt;getLastPayment(PaymentInterface::STATE_PROCESSING);
        if ($payment === null) {
            return;
        }

        /** @var PaymentMethodInterface $paymentMethod */
        $paymentMethod = $payment-&gt;getMethod();
        /** @var GatewayConfigInterface $gatewayConfig */
        $gatewayConfig = $paymentMethod-&gt;getGatewayConfig();

        if ($gatewayConfig-&gt;getFactoryName() !== 'sylius.pay_pal') {
            return;
        }

        try {
            $this-&gt;verify($payment);
        } catch (\Exception) {
            $this-&gt;paymentStateManager-&gt;cancel($payment);

            return;
        }

        $this-&gt;paymentStateManager-&gt;complete($payment);
    }

    private function verify(PaymentInterface $payment): void
    {
        $totalAmount = $this-&gt;getTotalPaymentAmountFromPaypal($payment);

        if ($payment-&gt;getOrder()-&gt;getTotal() !== $totalAmount) {
            throw new \Exception();
        }
    }

    private function getTotalPaymentAmountFromPaypal(PaymentInterface $payment): int
    {
        $details = $payment-&gt;getDetails();

        return $details['payment_amount'] ?? 0;
    }
}
</code></pre>
<h3 id="important">IMPORTANT</h3>
<p>For <code>PayPalPlugin 2.x</code> change:</p>
<pre><code class="language-php">$gatewayConfig-&gt;getFactoryName() !== 'sylius.pay_pal'
</code></pre>
<p>to</p>
<pre><code class="language-php">$gatewayConfig-&gt;getFactoryName() !== SyliusPayPalExtension::PAYPAL_FACTORY_NAME
</code></pre>
<p>Also there is a need to overwrite <code>CompletePayPalOrderListener</code> with modified logic:</p>
<pre><code class="language-php">&lt;?php

declare(strict_types=1);

namespace App\EventListener\Workflow;

use App\Processor\PayPalOrderCompleteProcessor;
use Sylius\Component\Core\Model\OrderInterface;
use Symfony\Component\Workflow\Event\CompletedEvent;
use Webmozart\Assert\Assert;

final class CompletePayPalOrderListener
{
    public function __construct(private readonly PayPalOrderCompleteProcessor $completeProcessor)
    {
    }

    public function __invoke(CompletedEvent $event): void
    {
        /** @var OrderInterface $order */
        $order = $event-&gt;getSubject();
        Assert::isInstanceOf($order, OrderInterface::class);

        $this-&gt;completeProcessor-&gt;completePayPalOrder($order);
    }
}
</code></pre>
<p>And to overwrite <code>CaptureAction</code> with modified logic (if you didn't have it already):</p>
<pre><code class="language-php">&lt;?php

declare(strict_types=1);

namespace App\Payum\Action;

use Payum\Core\Action\ActionInterface;
use Payum\Core\Exception\RequestNotSupportedException;
use Payum\Core\Request\Capture;
use Sylius\Component\Core\Model\PaymentInterface;
use Sylius\Component\Core\Model\PaymentMethodInterface;
use Sylius\PayPalPlugin\Api\CacheAuthorizeClientApiInterface;
use Sylius\PayPalPlugin\Api\CreateOrderApiInterface;
use Sylius\PayPalPlugin\Payum\Action\StatusAction;
use Sylius\PayPalPlugin\Provider\UuidProviderInterface;

final class CaptureAction implements ActionInterface
{
    public function __construct(
        private CacheAuthorizeClientApiInterface $authorizeClientApi,
        private CreateOrderApiInterface $createOrderApi,
        private UuidProviderInterface $uuidProvider,
    ) {
    }

    /** @param Capture $request */
    public function execute($request): void
    {
        RequestNotSupportedException::assertSupports($this, $request);

        /** @var PaymentInterface $payment */
        $payment = $request-&gt;getModel();
        /** @var PaymentMethodInterface $paymentMethod */
        $paymentMethod = $payment-&gt;getMethod();

        $token = $this-&gt;authorizeClientApi-&gt;authorize($paymentMethod);

        $referenceId = $this-&gt;uuidProvider-&gt;provide();
        $content = $this-&gt;createOrderApi-&gt;create($token, $payment, $referenceId);

        if ($content['status'] === 'CREATED') {
            $payment-&gt;setDetails([
                'status' =&gt; StatusAction::STATUS_CAPTURED,
                'paypal_order_id' =&gt; $content['id'],
                'reference_id' =&gt; $referenceId,
                'payment_amount' =&gt; $payment-&gt;getAmount(),
            ]);
        }
    }

    public function supports($request): bool
    {
        return
            $request instanceof Capture &amp;&amp;
            $request-&gt;getModel() instanceof PaymentInterface
        ;
    }
}
</code></pre>
<p>After that, register services in the container when using PayPal 1.x:</p>
<pre><code class="language-yaml">Sylius\PayPalPlugin\EventListener\Workflow\CompletePayPalOrderListener:
    class: App\EventListener\Workflow\CompletePayPalOrderListener
    public: true
    arguments:
        - '@Sylius\PayPalPlugin\Processor\PayPalOrderCompleteProcessor'
    tags: 
        - { name: 'kernel.event_listener', event: 'workflow.sylius_order_checkout.completed.complete', priority: 100 }
    
Sylius\PayPalPlugin\Processor\PayPalOrderCompleteProcessor:
    class: App\Processor\PayPalOrderCompleteProcessor
    public: true
    arguments:
        - '@Sylius\PayPalPlugin\Manager\PaymentStateManagerInterface'

Sylius\PayPalPlugin\Payum\Action\CaptureAction:
    class: App\Payum\Action\CaptureAction
    public: true
    arguments:
        - '@Sylius\PayPalPlugin\Api\CacheAuthorizeClientApiInterface'
        - '@Sylius\PayPalPlugin\Api\CreateOrderApiInterface'
        - '@Sylius\PayPalPlugin\Provider\UuidProviderInterface'
    tags:
        - { name: 'payum.action', factory: 'sylius.pay_pal', alias: 'payum.action.capture' }
</code></pre>
<p>or when using PayPal 2.x:</p>
<pre><code class="language-yaml">sylius_paypal.listener.workflow.complete_paypal_order:
    class: App\EventListener\Workflow\CompletePayPalOrderListener
    public: true
    arguments:
        - '@sylius_paypal.processor.paypal_order_complete'
    tags: 
        - { name: 'kernel.event_listener', event: 'workflow.sylius_order_checkout.completed.complete', priority: 100 }
    
sylius_paypal.processor.paypal_order_complete:
    class: App\Processor\PayPalOrderCompleteProcessor
    public: true
    arguments:
        - '@sylius_paypal.manager.payment_state'

sylius_paypal.payum.action.capture:
    class: App\Payum\Action\CaptureAction
    public: true
    arguments:
        - '@sylius_paypal.api.cache_authorize_client'
        - '@sylius_paypal.api.create_order'
        - '@sylius_paypal.provider.uuid'
    tags:
        - { name: 'payum.action', factory: 'sylius.paypal', alias: 'payum.action.capture' }
</code></pre>
<h3 id="for-more-information">For more information</h3>
<p>If you have any questions or comments about this advisory:</p>
<ul>
<li>Open an issue in <a href="https://github.com/Sylius/Sylius/issues">Sylius issues</a></li>
<li>Email us at <a href="mailto:security@sylius.com">security@sylius.com</a></li>
</ul>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/Sylius/PayPalPlugin/security/advisories/GHSA-hxg4-65p5-9w37">https://github.com/Sylius/PayPalPlugin/security/advisories/GHSA-hxg4-65p5-9w37</a></li>
<li><a href="https://github.com/Sylius/PayPalPlugin/commit/5613df827a6d4fc50862229295976200a68e97aa">https://github.com/Sylius/PayPalPlugin/commit/5613df827a6d4fc50862229295976200a68e97aa</a></li>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2025-30152">https://nvd.nist.gov/vuln/detail/CVE-2025-30152</a></li>
<li><a href="https://github.com/advisories/GHSA-hxg4-65p5-9w37">https://github.com/advisories/GHSA-hxg4-65p5-9w37</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-hxg4-65p5-9w37</uri>
        </author>
        <category label="severity" term="MODERATE"/>
        <published>2025-03-19T16:46:30.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[getformwork/formwork] Cross-site scripting (XSS) vulnerability in Description metadata]]></title>
        <id>https://github.com/advisories/GHSA-5pxr-7m4j-jjc6</id>
        <link href="https://github.com/advisories/GHSA-5pxr-7m4j-jjc6"/>
        <updated>2025-03-19T14:49:47.000Z</updated>
        <content type="html"><![CDATA[<h3 id="summary">Summary</h3>
<p>Regardless of the role or privileges, no user should be able to inject malicious JavaScript (JS) scripts into the body HTML. an XSS (Cross-Site Scripting) vulnerability, specifically a Stored XSS, which affects all pages of the website. Once the JS script is embedded in the body HTML, the XSS will trigger on any page a victim visits, such as the about, blog, contact, or any other pages, except for the panel.</p>
<h3 id="impact">Impact</h3>
<p>This vulnerability allows attackers to inject malicious JS or HTML through a crafted payload into the vulnerable spot, achieving persistence and attacking numerous visitors or anyone accessing the website. The attack can be widespread and affect many users because the malicious JS will execute on every page, unlike an injection on a specific page (e.g., injecting on the About page would only affect that page). In this case, a single injection point leads to the execution of the malicious JS on all pages.</p>
<h3 id="patches">Patches</h3>
<ul>
<li><a href="https://github.com/getformwork/formwork/releases/tag/1.13.1"><strong>Formwork 1.13.1</strong></a> has been released with a patch that solves this vulnerability by escaping all metadata attributes.</li>
<li><a href="https://github.com/getformwork/formwork/commit/f5312015a5a5e89b95ef2bd07e496f8474d579c5"><strong>Formwork 2.x</strong> (f531201)</a> also escapes metadata attributes.</li>
</ul>
<h3 id="details">Details</h3>
<p>An attackers (requires administrator privilege) to execute arbitrary web scripts by modifying site options via /panel/options/site. This type of attack is suitable for persistence, affecting visitors across all pages (except the dashboard).</p>
<h3 id="poc">PoC</h3>
<ol>
<li>Log in with an Administrator user account.</li>
<li>Navigate to /panel/options/site/.</li>
<li>Inject the JS script by adding to the description field.</li>
<li>Simulate a victim who is not a site member visiting the website. You will notice that the JS script executes on every page they vis</li>
</ol>
<p><img alt="image" src="https://github.com/getformwork/formwork/assets/170840940/1c40be24-3367-4c80-bb44-9db64ef88970">
<img alt="image" src="https://github.com/getformwork/formwork/assets/170840940/68dd5bff-9db1-441b-a3b3-a0c014565f59">
<img alt="image" src="https://github.com/getformwork/formwork/assets/170840940/3cd84c39-9b44-49d0-8b6a-6c8aeda7e49f">
<img alt="image" src="https://github.com/getformwork/formwork/assets/170840940/f45afd87-80e9-4cf1-8121-bb4e121849c9"></p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/getformwork/formwork/security/advisories/GHSA-5pxr-7m4j-jjc6">https://github.com/getformwork/formwork/security/advisories/GHSA-5pxr-7m4j-jjc6</a></li>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2024-37160">https://nvd.nist.gov/vuln/detail/CVE-2024-37160</a></li>
<li><a href="https://github.com/getformwork/formwork/commit/9d471204f7ebb51c3c27131581c2b834315b5e0b">https://github.com/getformwork/formwork/commit/9d471204f7ebb51c3c27131581c2b834315b5e0b</a></li>
<li><a href="https://github.com/getformwork/formwork/commit/f5312015a5a5e89b95ef2bd07e496f8474d579c5">https://github.com/getformwork/formwork/commit/f5312015a5a5e89b95ef2bd07e496f8474d579c5</a></li>
<li><a href="https://github.com/advisories/GHSA-5pxr-7m4j-jjc6">https://github.com/advisories/GHSA-5pxr-7m4j-jjc6</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-5pxr-7m4j-jjc6</uri>
        </author>
        <category label="severity" term="MODERATE"/>
        <published>2024-06-07T19:37:10.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[clickstorm/cs-seo] Clickstorm SEO Allows Cross-Site Scripting (XSS)]]></title>
        <id>https://github.com/advisories/GHSA-vmgw-24w6-9v82</id>
        <link href="https://github.com/advisories/GHSA-vmgw-24w6-9v82"/>
        <updated>2025-03-19T02:15:30.000Z</updated>
        <content type="html"><![CDATA[<p>A cross-site scripting (XSS) vulnerability has been discovered in the Clickstorm SEO extension. This vulnerabily is exploitable by a logged in backend user utilizing the TYPO3 backend user interface. This user can create output in the HTML context by exploiting improperly encoded user input. Updates 6.7.0, 7.4.0, 8.3.0 and 9.2.0 are available for download.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/clickstorm/cs_seo/commit/46e15a22d52da227b110bf6e95c2bcbb2fe4f55f">https://github.com/clickstorm/cs_seo/commit/46e15a22d52da227b110bf6e95c2bcbb2fe4f55f</a></li>
<li><a href="https://github.com/FriendsOfPHP/security-advisories/blob/master/clickstorm/cs-seo/CVE-2025-30081.yaml">https://github.com/FriendsOfPHP/security-advisories/blob/master/clickstorm/cs-seo/CVE-2025-30081.yaml</a></li>
<li><a href="https://typo3.org/security/advisory/typo3-ext-sa-2025-003">https://typo3.org/security/advisory/typo3-ext-sa-2025-003</a></li>
<li><a href="https://github.com/advisories/GHSA-vmgw-24w6-9v82">https://github.com/advisories/GHSA-vmgw-24w6-9v82</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-vmgw-24w6-9v82</uri>
        </author>
        <category label="severity" term="MODERATE"/>
        <published>2025-03-19T02:15:29.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[clickstorm/cs-seo] Clickstorm SEO Allows Cross-Site Scripting (XSS)]]></title>
        <id>https://github.com/advisories/GHSA-vmgw-24w6-9v82</id>
        <link href="https://github.com/advisories/GHSA-vmgw-24w6-9v82"/>
        <updated>2025-03-19T02:15:30.000Z</updated>
        <content type="html"><![CDATA[<p>A cross-site scripting (XSS) vulnerability has been discovered in the Clickstorm SEO extension. This vulnerabily is exploitable by a logged in backend user utilizing the TYPO3 backend user interface. This user can create output in the HTML context by exploiting improperly encoded user input. Updates 6.7.0, 7.4.0, 8.3.0 and 9.2.0 are available for download.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/clickstorm/cs_seo/commit/46e15a22d52da227b110bf6e95c2bcbb2fe4f55f">https://github.com/clickstorm/cs_seo/commit/46e15a22d52da227b110bf6e95c2bcbb2fe4f55f</a></li>
<li><a href="https://github.com/FriendsOfPHP/security-advisories/blob/master/clickstorm/cs-seo/CVE-2025-30081.yaml">https://github.com/FriendsOfPHP/security-advisories/blob/master/clickstorm/cs-seo/CVE-2025-30081.yaml</a></li>
<li><a href="https://typo3.org/security/advisory/typo3-ext-sa-2025-003">https://typo3.org/security/advisory/typo3-ext-sa-2025-003</a></li>
<li><a href="https://github.com/advisories/GHSA-vmgw-24w6-9v82">https://github.com/advisories/GHSA-vmgw-24w6-9v82</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-vmgw-24w6-9v82</uri>
        </author>
        <category label="severity" term="MODERATE"/>
        <published>2025-03-19T02:15:29.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[clickstorm/cs-seo] Clickstorm SEO Allows Cross-Site Scripting (XSS)]]></title>
        <id>https://github.com/advisories/GHSA-vmgw-24w6-9v82</id>
        <link href="https://github.com/advisories/GHSA-vmgw-24w6-9v82"/>
        <updated>2025-03-19T02:15:30.000Z</updated>
        <content type="html"><![CDATA[<p>A cross-site scripting (XSS) vulnerability has been discovered in the Clickstorm SEO extension. This vulnerabily is exploitable by a logged in backend user utilizing the TYPO3 backend user interface. This user can create output in the HTML context by exploiting improperly encoded user input. Updates 6.7.0, 7.4.0, 8.3.0 and 9.2.0 are available for download.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/clickstorm/cs_seo/commit/46e15a22d52da227b110bf6e95c2bcbb2fe4f55f">https://github.com/clickstorm/cs_seo/commit/46e15a22d52da227b110bf6e95c2bcbb2fe4f55f</a></li>
<li><a href="https://github.com/FriendsOfPHP/security-advisories/blob/master/clickstorm/cs-seo/CVE-2025-30081.yaml">https://github.com/FriendsOfPHP/security-advisories/blob/master/clickstorm/cs-seo/CVE-2025-30081.yaml</a></li>
<li><a href="https://typo3.org/security/advisory/typo3-ext-sa-2025-003">https://typo3.org/security/advisory/typo3-ext-sa-2025-003</a></li>
<li><a href="https://github.com/advisories/GHSA-vmgw-24w6-9v82">https://github.com/advisories/GHSA-vmgw-24w6-9v82</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-vmgw-24w6-9v82</uri>
        </author>
        <category label="severity" term="MODERATE"/>
        <published>2025-03-19T02:15:29.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[clickstorm/cs-seo] Clickstorm SEO Allows Cross-Site Scripting (XSS)]]></title>
        <id>https://github.com/advisories/GHSA-vmgw-24w6-9v82</id>
        <link href="https://github.com/advisories/GHSA-vmgw-24w6-9v82"/>
        <updated>2025-03-19T02:15:30.000Z</updated>
        <content type="html"><![CDATA[<p>A cross-site scripting (XSS) vulnerability has been discovered in the Clickstorm SEO extension. This vulnerabily is exploitable by a logged in backend user utilizing the TYPO3 backend user interface. This user can create output in the HTML context by exploiting improperly encoded user input. Updates 6.7.0, 7.4.0, 8.3.0 and 9.2.0 are available for download.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/clickstorm/cs_seo/commit/46e15a22d52da227b110bf6e95c2bcbb2fe4f55f">https://github.com/clickstorm/cs_seo/commit/46e15a22d52da227b110bf6e95c2bcbb2fe4f55f</a></li>
<li><a href="https://github.com/FriendsOfPHP/security-advisories/blob/master/clickstorm/cs-seo/CVE-2025-30081.yaml">https://github.com/FriendsOfPHP/security-advisories/blob/master/clickstorm/cs-seo/CVE-2025-30081.yaml</a></li>
<li><a href="https://typo3.org/security/advisory/typo3-ext-sa-2025-003">https://typo3.org/security/advisory/typo3-ext-sa-2025-003</a></li>
<li><a href="https://github.com/advisories/GHSA-vmgw-24w6-9v82">https://github.com/advisories/GHSA-vmgw-24w6-9v82</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-vmgw-24w6-9v82</uri>
        </author>
        <category label="severity" term="MODERATE"/>
        <published>2025-03-19T02:15:29.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[codingms/additional-tca] Additional TCA Allows Cross-Site Scripting (XSS)]]></title>
        <id>https://github.com/advisories/GHSA-rrh3-cgmx-w62f</id>
        <link href="https://github.com/advisories/GHSA-rrh3-cgmx-w62f"/>
        <updated>2025-03-19T01:37:07.000Z</updated>
        <content type="html"><![CDATA[<p>A cross-site scripting (XSS) vulnerability has been discovered in the Additional TCA extension. This vulnerabily is exploitable by a logged in backend user utilizing the TYPO3 backend user interface. This user can create output in the HTML context by exploiting improperly encoded user input. Updates 1.15.17 and 1.16.9 are available for download.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/FriendsOfPHP/security-advisories/blob/master/codingms/additional-tca/CVE-2025-30083.yaml">https://github.com/FriendsOfPHP/security-advisories/blob/master/codingms/additional-tca/CVE-2025-30083.yaml</a></li>
<li><a href="https://gitlab.com/codingms/typo3-public/additional_tca">https://gitlab.com/codingms/typo3-public/additional_tca</a></li>
<li><a href="https://typo3.org/security/advisory/typo3-ext-sa-2025-002">https://typo3.org/security/advisory/typo3-ext-sa-2025-002</a></li>
<li><a href="https://github.com/advisories/GHSA-rrh3-cgmx-w62f">https://github.com/advisories/GHSA-rrh3-cgmx-w62f</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-rrh3-cgmx-w62f</uri>
        </author>
        <category label="severity" term="MODERATE"/>
        <published>2025-03-19T01:37:06.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[codingms/additional-tca] Additional TCA Allows Cross-Site Scripting (XSS)]]></title>
        <id>https://github.com/advisories/GHSA-rrh3-cgmx-w62f</id>
        <link href="https://github.com/advisories/GHSA-rrh3-cgmx-w62f"/>
        <updated>2025-03-19T01:37:07.000Z</updated>
        <content type="html"><![CDATA[<p>A cross-site scripting (XSS) vulnerability has been discovered in the Additional TCA extension. This vulnerabily is exploitable by a logged in backend user utilizing the TYPO3 backend user interface. This user can create output in the HTML context by exploiting improperly encoded user input. Updates 1.15.17 and 1.16.9 are available for download.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/FriendsOfPHP/security-advisories/blob/master/codingms/additional-tca/CVE-2025-30083.yaml">https://github.com/FriendsOfPHP/security-advisories/blob/master/codingms/additional-tca/CVE-2025-30083.yaml</a></li>
<li><a href="https://gitlab.com/codingms/typo3-public/additional_tca">https://gitlab.com/codingms/typo3-public/additional_tca</a></li>
<li><a href="https://typo3.org/security/advisory/typo3-ext-sa-2025-002">https://typo3.org/security/advisory/typo3-ext-sa-2025-002</a></li>
<li><a href="https://github.com/advisories/GHSA-rrh3-cgmx-w62f">https://github.com/advisories/GHSA-rrh3-cgmx-w62f</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-rrh3-cgmx-w62f</uri>
        </author>
        <category label="severity" term="MODERATE"/>
        <published>2025-03-19T01:37:06.000Z</published>
    </entry>
</feed>